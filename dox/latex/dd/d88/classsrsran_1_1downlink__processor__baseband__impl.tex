\doxysection{srsran\+::downlink\+\_\+processor\+\_\+baseband\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1downlink__processor__baseband__impl}{}\label{classsrsran_1_1downlink__processor__baseband__impl}\index{srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}}


Implements a software generic lower PHY downlink baseband processor.  




{\ttfamily \#include $<$downlink\+\_\+processor\+\_\+baseband\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::downlink\+\_\+processor\+\_\+baseband\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{d6/d38/classsrsran_1_1downlink__processor__baseband__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::downlink\+\_\+processor\+\_\+baseband\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{dd/df4/classsrsran_1_1downlink__processor__baseband__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1downlink__processor__baseband__impl_a5157501e0d49e46b107303c2e48360e4}{downlink\+\_\+processor\+\_\+baseband\+\_\+impl}} (\mbox{\hyperlink{classsrsran_1_1pdxch__processor__baseband}{pdxch\+\_\+processor\+\_\+baseband}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdxch\+\_\+proc\+\_\+baseband\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1amplitude__controller}{amplitude\+\_\+controller}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{amplitude\+\_\+control\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration}{downlink\+\_\+processor\+\_\+baseband\+\_\+configuration}} \&config)
\begin{DoxyCompactList}\small\item\em Constructs a software generic lower PHY downlink processor that can process downlink resource grids. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1downlink__processor__baseband__impl_a96f1bda2627956ec45279b522a3a3098}{connect}} (\mbox{\hyperlink{classsrsran_1_1downlink__processor__notifier}{downlink\+\_\+processor\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\+\_\+}})
\item 
\mbox{\hyperlink{structsrsran_1_1baseband__gateway__transmitter__metadata}{baseband\+\_\+gateway\+\_\+transmitter\+\_\+metadata}} \mbox{\hyperlink{classsrsran_1_1downlink__processor__baseband__impl_a33e603ca3078d5235b0e8dcaedecf49f}{process}} (\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer}{baseband\+\_\+gateway\+\_\+buffer\+\_\+writer}} \&buffer, \mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}} timestamp) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Processes any number of baseband samples. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1downlink__processor__baseband}{srsran\+::downlink\+\_\+processor\+\_\+baseband}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}downlink\+\_\+processor\+\_\+baseband} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implements a software generic lower PHY downlink baseband processor. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1downlink__processor__baseband__impl_a5157501e0d49e46b107303c2e48360e4}\label{classsrsran_1_1downlink__processor__baseband__impl_a5157501e0d49e46b107303c2e48360e4} 
\index{srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}!downlink\_processor\_baseband\_impl@{downlink\_processor\_baseband\_impl}}
\index{downlink\_processor\_baseband\_impl@{downlink\_processor\_baseband\_impl}!srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}}
\doxysubsubsection{\texorpdfstring{downlink\_processor\_baseband\_impl()}{downlink\_processor\_baseband\_impl()}}
{\footnotesize\ttfamily downlink\+\_\+processor\+\_\+baseband\+\_\+impl\+::downlink\+\_\+processor\+\_\+baseband\+\_\+impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1pdxch__processor__baseband}{pdxch\+\_\+processor\+\_\+baseband}} \&}]{pdxch\+\_\+proc\+\_\+baseband\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1amplitude__controller}{amplitude\+\_\+controller}} \&}]{amplitude\+\_\+control\+\_\+,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration}{downlink\+\_\+processor\+\_\+baseband\+\_\+configuration}} \&}]{config }\end{DoxyParamCaption})}



Constructs a software generic lower PHY downlink processor that can process downlink resource grids. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em pdxch\+\_\+proc\+\_\+baseband\+\_\+} & PDx\+CH processor baseband. \\
\hline
\mbox{\texttt{ in}}  & {\em amplitude\+\_\+control\+\_\+} & Amplitude controller. \\
\hline
\mbox{\texttt{ in}}  & {\em config} & Downlink processor configuration. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00034\ \ \ amplitude\_control\_logger(*config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a2b09862431f4a12d0c84e6dc62b56572}{logger}}),}
\DoxyCodeLine{00035\ \ \ pdxch\_proc\_baseband(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdxch\_proc\_baseband\_}}),}
\DoxyCodeLine{00036\ \ \ amplitude\_control(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{amplitude\_control\_}}),}
\DoxyCodeLine{00037\ \ \ nof\_slot\_tti\_in\_advance(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_aa98505014e1f374e2b8a70a46a0b7555}{nof\_slot\_tti\_in\_advance}}),}
\DoxyCodeLine{00038\ \ \ sector\_id(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_ab8ac33d690bcac3a905ec2b1dab14db1}{sector\_id}}),}
\DoxyCodeLine{00039\ \ \ scs(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_aa9880e04ba6ce6d66acc6047e542e4ff}{scs}}),}
\DoxyCodeLine{00040\ \ \ nof\_rx\_ports(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_af019d32857d166283d9529c0e3078a73}{nof\_tx\_ports}}),}
\DoxyCodeLine{00041\ \ \ nof\_samples\_per\_subframe(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a3ee312d1b46ae37b7ea7cb836008766a}{rate}}.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a33985f88e1d7b7a12f152273e5302bdf}{to\_kHz}}()),}
\DoxyCodeLine{00042\ \ \ nof\_slots\_per\_subframe(\mbox{\hyperlink{namespacesrsran_a45b408115d2fba72e768ef375c59da19}{get\_nof\_slots\_per\_subframe}}(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_aa9880e04ba6ce6d66acc6047e542e4ff}{scs}})),}
\DoxyCodeLine{00043\ \ \ nof\_symbols\_per\_slot(\mbox{\hyperlink{namespacesrsran_aa1d2bd5d3008afda19c0949d241a73f7}{get\_nsymb\_per\_slot}}(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a37d3a4f606bc7ce914e16640b515ad61}{cp}})),}
\DoxyCodeLine{00044\ \ \ temp\_buffer(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_af019d32857d166283d9529c0e3078a73}{nof\_tx\_ports}},\ 2\ *\ config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a3ee312d1b46ae37b7ea7cb836008766a}{rate}}.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a05c74a02ecc553999bf80a4819f4c7fa}{get\_dft\_size}}(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_aa9880e04ba6ce6d66acc6047e542e4ff}{scs}}))}
\DoxyCodeLine{00045\ \{}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_size\_no\_cp}}\ \ \ \ \ \ \ \ =\ config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a3ee312d1b46ae37b7ea7cb836008766a}{rate}}.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a05c74a02ecc553999bf80a4819f4c7fa}{get\_dft\_size}}(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_aa9880e04ba6ce6d66acc6047e542e4ff}{scs}});}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_symbols\_per\_subframe\ =\ nof\_symbols\_per\_slot\ *\ nof\_slots\_per\_subframe;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Setup\ symbol\ sizes.}}
\DoxyCodeLine{00050\ \ \ symbol\_sizes.reserve(nof\_symbols\_per\_subframe);}
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ !=\ nof\_symbols\_per\_subframe;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}})\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_size}}\ =\ config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a37d3a4f606bc7ce914e16640b515ad61}{cp}}.\mbox{\hyperlink{classsrsran_1_1cyclic__prefix_ac71cef705198bb0f9b4a83f5ee3f158b}{get\_length}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}},\ config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_aa9880e04ba6ce6d66acc6047e542e4ff}{scs}}).\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(config.\mbox{\hyperlink{structsrsran_1_1downlink__processor__baseband__configuration_a3ee312d1b46ae37b7ea7cb836008766a}{rate}}.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a3e20d54a0ea144abe33e32ac198b44e2}{to\_Hz}}());}
\DoxyCodeLine{00053\ \ \ \ \ symbol\_sizes.emplace\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_size\_no\_cp}});}
\DoxyCodeLine{00054\ \ \ \}}
\DoxyCodeLine{00055\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1downlink__processor__baseband__impl_a96f1bda2627956ec45279b522a3a3098}\label{classsrsran_1_1downlink__processor__baseband__impl_a96f1bda2627956ec45279b522a3a3098} 
\index{srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}!connect@{connect}}
\index{connect@{connect}!srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}}
\doxysubsubsection{\texorpdfstring{connect()}{connect()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::downlink\+\_\+processor\+\_\+baseband\+\_\+impl\+::connect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1downlink__processor__notifier}{downlink\+\_\+processor\+\_\+notifier}} \&}]{notifier\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00196\ \{\ notifier\ =\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\_}};\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1downlink__processor__baseband__impl_a33e603ca3078d5235b0e8dcaedecf49f}\label{classsrsran_1_1downlink__processor__baseband__impl_a33e603ca3078d5235b0e8dcaedecf49f} 
\index{srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}!process@{process}}
\index{process@{process}!srsran::downlink\_processor\_baseband\_impl@{srsran::downlink\_processor\_baseband\_impl}}
\doxysubsubsection{\texorpdfstring{process()}{process()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1baseband__gateway__transmitter__metadata}{baseband\+\_\+gateway\+\_\+transmitter\+\_\+metadata}} downlink\+\_\+processor\+\_\+baseband\+\_\+impl\+::process (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer}{baseband\+\_\+gateway\+\_\+buffer\+\_\+writer}} \&}]{buffer,  }\item[{\mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}}}]{timestamp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Processes any number of baseband samples. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em buffer} & Buffer to store the processed baseband samples. \\
\hline
\mbox{\texttt{ in}}  & {\em timestamp} & Time instant in which the first sample in the buffer is transmitted. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Metadata about the contents of the output buffer. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
The number of channels in {\ttfamily buffer} must be equal to the number of transmit ports for the sector. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1downlink__processor__baseband_ac6b556edb09c58fc74c3b18a8cda317a}{srsran\+::downlink\+\_\+processor\+\_\+baseband}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00114\ \{}
\DoxyCodeLine{00115\ \ \ srsran\_assert(nof\_rx\_ports\ ==\ buffer.\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer_afa3075744413424a97f676bd774196b9}{get\_nof\_channels}}(),\ \textcolor{stringliteral}{"{}Invalid\ number\ of\ channels."{}});}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_output\_samples}}\ =\ buffer.\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer_a1f272dc6d65ebeaba478bab5e9aea5bd}{get\_nof\_samples}}();}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{comment}{//\ Ouput\ buffer\ writing\ position\ index.}}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}}\ =\ 0;}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{comment}{//\ Output\ buffer\ metadata.}}
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{structsrsran_1_1baseband__gateway__transmitter__metadata}{baseband\_gateway\_transmitter\_metadata}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}};}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}}.\mbox{\hyperlink{structsrsran_1_1baseband__gateway__transmitter__metadata_a32dce4150547229e12679c13907b4507}{is\_empty}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ Generate\ baseband\ samples\ until\ the\ output\ buffer\ is\ full\ or\ there\ are\ no\ more\ transmission\ requests\ for\ the}}
\DoxyCodeLine{00126\ \ \ \textcolor{comment}{//\ current\ timestamp.}}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordflow}{while}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}}\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_output\_samples}})\ \&\&\ !\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}}.tx\_end.has\_value())\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{//\ Timestamp\ of\ the\ remaining\ samples\ to\ process.}}
\DoxyCodeLine{00129\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\_gateway\_timestamp}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}}\ =\ timestamp\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}};}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{comment}{//\ Number\ of\ samples\ by\ which\ to\ increment\ the\ writing\ index\ at\ the\ end\ of\ the\ current\ iterator.}}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_advanced\_samples}}\ =\ 0;}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{comment}{//\ Indicates\ whether\ samples\ have\ actually\ been\ processed\ and\ written\ into\ the\ output\ buffer.}}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{processed}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ If\ there\ are\ no\ samples\ available\ in\ the\ temporary\ buffer,\ process\ a\ new\ symbol.}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_a784d6482ce6a4f23737b10e143e8bf82}{get\_nof\_available\_samples}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}})\ ==\ 0)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ subframe\ index.}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sf}}\ =}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}}\ /\ nof\_samples\_per\_subframe)\ \%\ (\mbox{\hyperlink{namespacesrsran_a660ccd3cc382442fdadac290341f1524}{NOF\_SFNS}}\ *\ \mbox{\hyperlink{namespacesrsran_afe120c5fa59fc13e75fa47b6161f3ad3}{NOF\_SUBFRAMES\_PER\_FRAME}}));}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ sample\ index\ within\ the\ subframe.}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_sf}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}}\ \%\ nof\_samples\_per\_subframe;}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ symbol\ index\ within\ the\ subframe\ and\ the\ sample\ index\ within\ the\ OFDM\ symbol.}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_symbol}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_sf}};}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}}\ \ \ \ \ =\ 0;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_symbol}}\ >=\ symbol\_sizes[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}}])\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_symbol}}\ -\/=\ symbol\_sizes[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}}];}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}};}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ system\ slot\ index\ and\ the\ symbol\ index\ within\ the\ slot.}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_slot}}\ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sf}}\ *\ nof\_slots\_per\_subframe\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}}\ /\ nof\_symbols\_per\_slot;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}}\ \%\ nof\_symbols\_per\_slot;}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ slot\ point.}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1slot__point}{slot\_point}}\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}(\mbox{\hyperlink{namespacesrsran_a226e52de355262a1ad4e998b4cedefd7}{to\_numerology\_value}}(scs),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_slot}});}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{comment}{//\ Detect\ slot\ boundary.}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((!last\_notified\_slot.has\_value()\ ||\ (\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ >\ last\_notified\_slot.value()))\ \&\&\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ ==\ 0))\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ slot\ boundary.}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1lower__phy__timing__context}{lower\_phy\_timing\_context}}\ context;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ context.\mbox{\hyperlink{structsrsran_1_1lower__phy__timing__context_a0e971009bcce62ffe9af28fadc4dd139}{slot}}\ =\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ +\ nof\_slot\_tti\_in\_advance;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ last\_notified\_slot.emplace(\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}});}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ notifier-\/>\mbox{\hyperlink{classsrsran_1_1downlink__processor__notifier_ad0f1b1b20489158d776167da4fda1ae7}{on\_tti\_boundary}}(context);}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \textcolor{comment}{//\ Number\ of\ samples\ of\ the\ symbol\ to\ process.}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_nof\_samples}}\ =\ symbol\_sizes[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_sf}}];}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((buffer.\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer_a1f272dc6d65ebeaba478bab5e9aea5bd}{get\_nof\_samples}}()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}}\ >=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_nof\_samples}})\ \&\&\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_symbol}}\ ==\ 0))\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ The\ destination\ buffer\ is\ large\ enough\ to\ hold\ a\ new\ symbol\ and\ the\ process\ timestamp\ is\ aligned\ with\ the}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ symbol\ start,\ skip\ copying\ to\ a\ temporary\ buffer.}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer__view}{baseband\_gateway\_buffer\_writer\_view}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dest\_buffer}}(buffer,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_nof\_samples}});}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{processed}}\ =\ process\_new\_symbol(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dest\_buffer}},\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}});}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_advanced\_samples}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_nof\_samples}};}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clear\ the\ temporary\ buffer\ of\ previously\ stored\ samples.}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_ade84b1c07cc1c761fb20fb052466f179}{clear}}();}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Timestamp\ of\ the\ first\ sample\ of\ the\ current\ OFDM\ symbol.}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\_gateway\_timestamp}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_timestamp}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_sample\_symbol}};}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ the\ symbol\ into\ the\ temporary\ buffer.}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer}{baseband\_gateway\_buffer\_writer}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dest\_buffer}}\ =\ temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_a1842014653c327954be9437d319028fe}{write\_symbol}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_timestamp}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_nof\_samples}});}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!process\_new\_symbol(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dest\_buffer}},\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}))\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ symbol\ could\ not\ be\ processed,\ advance\ output\ buffer\ and\ invalidate\ the\ temporary\ buffer\ contents.}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_advanced\_samples}}\ =}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::min(temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_a784d6482ce6a4f23737b10e143e8bf82}{get\_nof\_available\_samples}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}}),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_output\_samples}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}});}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_ade84b1c07cc1c761fb20fb052466f179}{clear}}();}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00195\ \ \ \ \ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{//\ Read\ samples\ from\ the\ temporary\ buffer\ if\ available.}}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keywordflow}{if}\ (temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_a784d6482ce6a4f23737b10e143e8bf82}{get\_nof\_available\_samples}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}})\ >\ 0)\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \textcolor{comment}{//\ Output\ buffer\ view\ starting\ at\ the\ current\ writing\ position.}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer__view}{baseband\_gateway\_buffer\_writer\_view}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dest\_buffer}}(buffer,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_output\_samples}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}});}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ from\ the\ temporary\ buffer.}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_advanced\_samples}}\ =\ temp\_buffer.\mbox{\hyperlink{classsrsran_1_1detail_1_1baseband__symbol__buffer_a724712f3a0ae147cc12aff400cb63cc5}{read}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dest\_buffer}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{proc\_timestamp}});}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_advanced\_samples}}\ >\ 0)\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{processed}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00207\ \ \ \ \ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{comment}{//\ Update\ output\ buffer\ metadata.}}
\DoxyCodeLine{00210\ \ \ \ \ update\_metadata(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{processed}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}});}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{comment}{//\ Increment\ output\ writing\ index.}}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{writing\_index}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_advanced\_samples}};}
\DoxyCodeLine{00214\ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ Fill\ the\ unprocessed\ regions\ of\ the\ buffer\ with\ zeros.}}
\DoxyCodeLine{00217\ \ \ fill\_zeros(buffer,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}});}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}};}
\DoxyCodeLine{00220\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/lower/processors/downlink/downlink\+\_\+processor\+\_\+baseband\+\_\+impl.\+h\item 
lib/phy/lower/processors/downlink/downlink\+\_\+processor\+\_\+baseband\+\_\+impl.\+cpp\end{DoxyCompactItemize}
