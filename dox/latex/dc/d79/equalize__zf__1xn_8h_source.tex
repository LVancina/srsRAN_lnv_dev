\doxysection{equalize\+\_\+zf\+\_\+1xn.\+h}
\hypertarget{equalize__zf__1xn_8h_source}{}\label{equalize__zf__1xn_8h_source}\index{lib/phy/upper/equalization/equalize\_zf\_1xn.h@{lib/phy/upper/equalization/equalize\_zf\_1xn.h}}
\mbox{\hyperlink{equalize__zf__1xn_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ 2021-\/2024\ Software\ Radio\ Systems\ Limited}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ This\ file\ is\ part\ of\ srsRAN.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ srsRAN\ is\ free\ software:\ you\ can\ redistribute\ it\ and/or\ modify}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ it\ under\ the\ terms\ of\ the\ GNU\ Affero\ General\ Public\ License\ as}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ published\ by\ the\ Free\ Software\ Foundation,\ either\ version\ 3\ of}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ the\ License,\ or\ (at\ your\ option)\ any\ later\ version.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ srsRAN\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ GNU\ Affero\ General\ Public\ License\ for\ more\ details.}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ A\ copy\ of\ the\ GNU\ Affero\ General\ Public\ License\ can\ be\ found\ in}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ the\ LICENSE\ file\ in\ the\ top-\/level\ directory\ of\ this\ distribution}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ and\ at\ http://www.gnu.org/licenses/.}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{///\ \(\backslash\)file}}
\DoxyCodeLine{00024\ \textcolor{comment}{///\ \(\backslash\)brief\ Zero\ Forcing\ equalizer\ algorithm\ for\ a\ SIMO\ 1\ X\ N\ channel.}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{pragma}\ \textcolor{preprocessor}{once}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \mbox{\hyperlink{channel__equalizer__zf__impl_8h}{"{}channel\_equalizer\_zf\_impl.h"{}}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{if}\ \textcolor{preprocessor}{defined}\textcolor{preprocessor}{(}\textcolor{preprocessor}{\_\_AVX2\_\_}\textcolor{preprocessor}{)}\ \textcolor{preprocessor}{||}\ \textcolor{preprocessor}{defined}\textcolor{preprocessor}{(}\textcolor{preprocessor}{HAVE\_NEON}\textcolor{preprocessor}{)}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \textcolor{stringliteral}{"{}../../../srsvec/simd.h"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{endif}\ \textcolor{comment}{//\ \_\_AVX2\_\_\ ||\ HAVE\_NEON}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{namespace}\ \mbox{\hyperlink{namespacesrsran}{srsran}}\ \{}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{comment}{///\ \(\backslash\)brief\ Implementation\ of\ a\ Zero\ Forcing\ equalizer\ for\ a\ SIMO\ 1\ X\ \(\backslash\)c\ RX\_PORTS\ channel.}}
\DoxyCodeLine{00037\ \textcolor{comment}{///\ \(\backslash\)tparam\ RX\_PORTS\ \ \ \ \ \ \ \ \ Number\ of\ receive\ antenna\ ports.}}
\DoxyCodeLine{00038\ \textcolor{comment}{///\ \(\backslash\)param[out]\ eq\_symbols\ \ \ Resultant\ equalized\ symbols.}}
\DoxyCodeLine{00039\ \textcolor{comment}{///\ \(\backslash\)param[out]\ noise\_vars\ \ \ Noise\ variances\ after\ equalization.}}
\DoxyCodeLine{00040\ \textcolor{comment}{///\ \(\backslash\)param[in]\ \ ch\_symbols\ \ \ Channel\ symbols,\ i.e.,\ complex\ samples\ from\ the\ receive\ ports.}}
\DoxyCodeLine{00041\ \textcolor{comment}{///\ \(\backslash\)param[in]\ \ ch\_estimates\ Channel\ estimation\ coefficients.}}
\DoxyCodeLine{00042\ \textcolor{comment}{///\ \(\backslash\)param[in]\ \ noise\_var\_est\ Estimated\ noise\ variance.\ It\ is\ assumed\ to\ be\ the\ same\ for\ each\ receive\ port.}}
\DoxyCodeLine{00043\ \textcolor{comment}{///\ \(\backslash\)param[in]\ \ tx\_scaling\ \ \ Transmission\ gain\ scaling\ factor.}}
\DoxyCodeLine{00044\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{unsigned}\ RX\_PORTS>}
\DoxyCodeLine{00045\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacesrsran_a774ca6a7bd234a4276aa3e18869c0a9f}{equalize\_zf\_1xn}}(channel\_equalizer::re\_list\&\ \ \ \ \ \ \ \ \ \ \ eq\_symbols,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ channel\_equalizer::noise\_var\_list\&\ \ \ \ noise\_vars,}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ channel\_equalizer::re\_list\&\ \ \ \ \ ch\_symbols,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ channel\_equalizer::ch\_est\_list\&\ ch\_estimates,}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ noise\_var\_est,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tx\_scaling)}
\DoxyCodeLine{00051\ \{}
\DoxyCodeLine{00052\ \ \ \textcolor{comment}{//\ Number\ of\ RE\ to\ process.}}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_re\ =\ ch\_symbols.get\_dimension\_size(channel\_equalizer::re\_list::dims::re);}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ Views\ over\ the\ output\ data.}}
\DoxyCodeLine{00056\ \ \ span<\textcolor{keywordtype}{float}>\ nvars\_out\ \ \ =\ noise\_vars.get\_view(\{\});}
\DoxyCodeLine{00057\ \ \ span<cf\_t>\ \ symbols\_out\ =\ eq\_symbols.get\_view(\{\});}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{keywordtype}{unsigned}\ i\_re\ =\ 0;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{if}\ \textcolor{preprocessor}{defined}\textcolor{preprocessor}{(}\textcolor{preprocessor}{\_\_AVX2\_\_}\textcolor{preprocessor}{)}\ \textcolor{preprocessor}{||}\ \textcolor{preprocessor}{defined}\textcolor{preprocessor}{(}\textcolor{preprocessor}{HAVE\_NEON}\textcolor{preprocessor}{)}}
\DoxyCodeLine{00062\ \ \ \textcolor{comment}{//\ Views\ over\ the\ input\ data.}}
\DoxyCodeLine{00063\ \ \ std::array<span<\textcolor{keyword}{const}\ cf\_t>,\ MAX\_PORTS>\ port\_symbols;}
\DoxyCodeLine{00064\ \ \ std::array<span<\textcolor{keyword}{const}\ cf\_t>,\ MAX\_PORTS>\ port\_ests;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_port\ =\ 0;\ i\_port\ !=\ RX\_PORTS;\ ++i\_port)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ port\_symbols[i\_port]\ =\ ch\_symbols.get\_view(\{i\_port\});}
\DoxyCodeLine{00068\ \ \ \ \ port\_ests[i\_port]\ \ \ \ =\ ch\_estimates.get\_view(\{i\_port,\ 0\});}
\DoxyCodeLine{00069\ \ \ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \textcolor{comment}{//\ Create\ registers\ with\ zero\ and\ infinity\ values.}}
\DoxyCodeLine{00072\ \ \ simd\_f\_t\ zero\ \ \ \ \ =\ srsran\_simd\_f\_zero();}
\DoxyCodeLine{00073\ \ \ simd\_f\_t\ infinity\ =\ srsran\_simd\_f\_set1(std::numeric\_limits<\textcolor{keywordtype}{float}>::infinity());}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_re\_end\ =\ (nof\_re\ /\ SRSRAN\_SIMD\_CF\_SIZE)\ *\ SRSRAN\_SIMD\_CF\_SIZE;\ i\_re\ !=\ i\_re\_end;}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ i\_re\ +=\ SRSRAN\_SIMD\_CF\_SIZE)\ \{}
\DoxyCodeLine{00077\ \ \ \ \ simd\_f\_t\ \ ch\_mod\_sq\ =\ srsran\_simd\_f\_zero();}
\DoxyCodeLine{00078\ \ \ \ \ simd\_cf\_t\ re\_out\ \ \ \ =\ srsran\_simd\_cf\_zero();}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_port\ =\ 0;\ i\_port\ !=\ RX\_PORTS;\ ++i\_port)\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ input\ RE\ and\ channel\ estimate\ coefficients.}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ simd\_cf\_t\ re\_in\ \ =\ srsran\_simd\_cfi\_loadu(\&(port\_symbols[i\_port][i\_re]));}
\DoxyCodeLine{00083\ \ \ \ \ \ \ simd\_cf\_t\ ch\_est\ =\ srsran\_simd\_cfi\_loadu(\&(port\_ests[i\_port][i\_re]));}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ channel\ square\ norm,\ by\ accumulating\ the\ channel\ square\ absolute\ values.}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ ch\_mod\_sq\ =\ srsran\_simd\_f\_add(ch\_mod\_sq,\ srsran\_simd\_cf\_norm\_sq(ch\_est));}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ the\ matched\ channel\ filter\ to\ each\ received\ RE\ and\ accumulate\ the\ results.}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ re\_out\ =\ srsran\_simd\_cf\_add(re\_out,\ srsran\_simd\_cf\_conjprod(re\_in,\ ch\_est));}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ denominator\ of\ the\ pseudo-\/inverse.}}
\DoxyCodeLine{00093\ \ \ \ \ simd\_f\_t\ d\_pinv\ =\ srsran\_simd\_f\_mul(srsran\_simd\_f\_set1(tx\_scaling),\ ch\_mod\_sq);}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ Compute\ reciprocal\ of\ the\ denominator.}}
\DoxyCodeLine{00096\ \ \ \ \ simd\_f\_t\ d\_pinv\_rcp\ =\ srsran\_simd\_f\_rcp(d\_pinv);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{//\ Detect\ abnormal\ computation\ parameters.\ This\ detects\ whenever\ the\ channel\ estimate\ is\ zero\ or\ NaN.}}
\DoxyCodeLine{00099\ \ \ \ \ simd\_sel\_t\ isnormal\_mask\ =\ srsran\_simd\_f\_max(d\_pinv,\ zero);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{comment}{//\ Detect\ abnormal\ computation\ parameters.\ This\ detects\ whenever\ the\ channel\ estimate\ is\ infinity.}}
\DoxyCodeLine{00102\ \ \ \ \ isnormal\_mask\ =\ srsran\_simd\_sel\_and(isnormal\_mask,\ srsran\_simd\_f\_max(infinity,\ d\_pinv));}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ Calculate\ noise\ variances.}}
\DoxyCodeLine{00105\ \ \ \ \ simd\_f\_t\ vars\_out\ =\ srsran\_simd\_f\_mul(d\_pinv\_rcp,\ srsran\_simd\_f\_set1(noise\_var\_est\ /\ tx\_scaling));}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{comment}{//\ Detect\ whenever\ the\ post-\/equalization\ noise\ variances\ are\ zero,\ negative\ or\ NaN.}}
\DoxyCodeLine{00108\ \ \ \ \ isnormal\_mask\ =\ srsran\_simd\_sel\_and(isnormal\_mask,\ srsran\_simd\_f\_max(vars\_out,\ zero));}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ Detect\ whenever\ the\ post-\/equalizatino\ noise\ variances\ are\ set\ to\ infinity.}}
\DoxyCodeLine{00111\ \ \ \ \ isnormal\_mask\ =\ srsran\_simd\_sel\_and(isnormal\_mask,\ srsran\_simd\_f\_max(infinity,\ vars\_out));}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ If\ abnormal\ calculation\ parameters\ are\ detected,\ the\ noise\ variances\ are\ set\ to\ infinity.}}
\DoxyCodeLine{00114\ \ \ \ \ srsran\_simd\_f\_storeu(\&nvars\_out[i\_re],\ srsran\_simd\_f\_select(infinity,\ vars\_out,\ isnormal\_mask));}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ Normalize\ the\ gain\ of\ the\ channel\ combined\ with\ the\ equalization\ to\ unity.}}
\DoxyCodeLine{00117\ \ \ \ \ re\_out\ =\ srsran\_simd\_cf\_mul(re\_out,\ d\_pinv\_rcp);}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{comment}{//\ If\ abnormal\ calculation\ parameters\ are\ detected,\ the\ equalized\ symbols\ are\ set\ to\ zero.}}
\DoxyCodeLine{00120\ \ \ \ \ srsran\_simd\_cfi\_storeu(\&symbols\_out[i\_re],}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ srsran\_simd\_cf\_select(srsran\_simd\_cf\_set1(\{0,\ 0\}),\ re\_out,\ isnormal\_mask));}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{endif}\ \textcolor{comment}{//\ \_\_AVX2\_\_\ ||\ HAVE\_NEON}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{for}\ (;\ i\_re\ !=\ nof\_re;\ ++i\_re)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordtype}{float}\ ch\_mod\_sq\ =\ 0.0F;}
\DoxyCodeLine{00127\ \ \ \ \ cf\_t\ \ re\_out\ \ \ \ =\ 0.0F;}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_port\ =\ 0;\ i\_port\ !=\ RX\_PORTS;\ ++i\_port)\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ input\ RE\ and\ channel\ estimate\ coefficient.}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ cf\_t\ re\_in\ \ =\ ch\_symbols[\{i\_re,\ i\_port\}];}
\DoxyCodeLine{00132\ \ \ \ \ \ \ cf\_t\ ch\_est\ =\ ch\_estimates[\{i\_re,\ i\_port\}];}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ channel\ square\ norm,\ by\ accumulating\ the\ channel\ square\ absolute\ values.}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ ch\_mod\_sq\ +=\ \mbox{\hyperlink{namespacesrsran_a45740ff6c7d613055e252f31ce2b7939}{abs\_sq}}\mbox{\hyperlink{namespacesrsran_a45740ff6c7d613055e252f31ce2b7939}{(}}ch\_est\mbox{\hyperlink{namespacesrsran_a45740ff6c7d613055e252f31ce2b7939}{)}};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ the\ matched\ channel\ filter\ to\ each\ received\ RE\ and\ accumulate\ the\ results.}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ re\_out\ +=\ re\_in\ *\ std::conj(ch\_est);}
\DoxyCodeLine{00139\ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//\ Return\ values\ in\ case\ of\ abnormal\ computation\ parameters.\ These\ include\ negative,\ zero,\ NAN\ or\ INF\ noise}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ variances\ and\ zero,\ NAN\ or\ INF\ channel\ estimation\ coefficients.}}
\DoxyCodeLine{00143\ \ \ \ \ symbols\_out[i\_re]\ =\ 0;}
\DoxyCodeLine{00144\ \ \ \ \ nvars\_out[i\_re]\ \ \ =\ std::numeric\_limits<\textcolor{keywordtype}{float}>::infinity();}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordtype}{float}\ d\_pinv\ =\ tx\_scaling\ *\ ch\_mod\_sq;}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordflow}{if}\ (std::isnormal(d\_pinv)\ \&\&\ std::isnormal(noise\_var\_est)\ \&\&\ (noise\_var\_est\ >\ 0.0F))\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ reciprocal\ of\ the\ denominator.}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ d\_pinv\_rcp\ =\ 1.0F\ /\ d\_pinv;}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ the\ gain\ of\ the\ channel\ combined\ with\ the\ equalization\ to\ unity.}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ symbols\_out[i\_re]\ =\ re\_out\ *\ d\_pinv\_rcp;}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ noise\ variances.}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ nvars\_out[i\_re]\ =\ d\_pinv\_rcp\ *\ (noise\_var\_est\ /\ tx\_scaling);}
\DoxyCodeLine{00157\ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \}\ \textcolor{comment}{//\ namespace\ srsran}}

\end{DoxyCode}
