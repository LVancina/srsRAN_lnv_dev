\doxysection{srsran\+::log\+\_\+sink\+\_\+spy Class Reference}
\hypertarget{classsrsran_1_1log__sink__spy}{}\label{classsrsran_1_1log__sink__spy}\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}


This custom sink intercepts log messages to count error and warning log entries.  




{\ttfamily \#include $<$test\+\_\+utils.\+h$>$}



Inheritance diagram for srsran\+::log\+\_\+sink\+\_\+spy\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{d6/dbd/classsrsran_1_1log__sink__spy__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::log\+\_\+sink\+\_\+spy\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{d6/d36/classsrsran_1_1log__sink__spy__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1log__sink__spy_ab818af8c390f7a2d6e2cc7adaa2d1d81}{log\+\_\+sink\+\_\+spy}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrslog_1_1log__formatter}{srslog\+::log\+\_\+formatter}} $>$ f)
\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1log__sink__spy_ac0ae3c3c2a2b216653a80ea9e0b906dd}{get\+\_\+error\+\_\+counter}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Returns the number of log entries tagged as errors. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1log__sink__spy_a0f12d7afce3a2915402a933cad9a3527}{get\+\_\+warning\+\_\+counter}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Returns the number of log entries tagged as warnings. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1log__sink__spy_a41e7957ea952620e74ca15e753efd747}{reset\+\_\+counters}} ()
\begin{DoxyCompactList}\small\item\em Resets the counters back to 0. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrslog_1_1detail_1_1error__string}{srslog\+::detail\+::error\+\_\+string}} \mbox{\hyperlink{classsrsran_1_1log__sink__spy_a9d38934e7d165f35b83397c450d2e8c2}{write}} (\mbox{\hyperlink{classsrslog_1_1detail_1_1memory__buffer}{srslog\+::detail\+::memory\+\_\+buffer}} buffer) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Writes the provided memory buffer into the sink. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrslog_1_1detail_1_1error__string}{srslog\+::detail\+::error\+\_\+string}} \mbox{\hyperlink{classsrsran_1_1log__sink__spy_a8a89291738d164c1dae24fe907ee15ca}{flush}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Flushes any buffered contents to the backing store. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrslog_1_1sink}{srslog\+::sink}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrslog_1_1sink_a67b8e754a3c8f4e1668b7d9305fdbb58}{sink}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrslog_1_1log__formatter}{log\+\_\+formatter}} $>$ f)
\item 
\mbox{\hyperlink{classsrslog_1_1log__formatter}{log\+\_\+formatter}} \& \mbox{\hyperlink{classsrslog_1_1sink_ace34bef8911e2766143a6e79e36e687b}{get\+\_\+formatter}} ()
\begin{DoxyCompactList}\small\item\em Returns the formatter used by this sink. \end{DoxyCompactList}\item 
const \mbox{\hyperlink{classsrslog_1_1log__formatter}{log\+\_\+formatter}} \& \mbox{\hyperlink{classsrslog_1_1sink_aae43c1cb1aa24e9ae952b7ea18584fd3}{get\+\_\+formatter}} () const
\item 
virtual \mbox{\hyperlink{classsrslog_1_1detail_1_1error__string}{detail\+::error\+\_\+string}} \mbox{\hyperlink{classsrslog_1_1sink_acf4afffd3a90345c40b68ccae3c6b00d}{write\+\_\+error}} (\mbox{\hyperlink{classsrslog_1_1detail_1_1memory__buffer}{detail\+::memory\+\_\+buffer}} buffer)
\begin{DoxyCompactList}\small\item\em Writes as an error the provided memory buffer into the sink. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classchar}{char}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classsrsran_1_1log__sink__spy_a54a956030d976c92f270d8cc5c39654f}{name}} ()
\begin{DoxyCompactList}\small\item\em Identifier of this custom sink. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This custom sink intercepts log messages to count error and warning log entries. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1log__sink__spy_ab818af8c390f7a2d6e2cc7adaa2d1d81}\label{classsrsran_1_1log__sink__spy_ab818af8c390f7a2d6e2cc7adaa2d1d81} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!log\_sink\_spy@{log\_sink\_spy}}
\index{log\_sink\_spy@{log\_sink\_spy}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{log\_sink\_spy()}{log\_sink\_spy()}}
{\footnotesize\ttfamily srsran\+::log\+\_\+sink\+\_\+spy\+::log\+\_\+sink\+\_\+spy (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrslog_1_1log__formatter}{srslog\+::log\+\_\+formatter}} $>$}]{f }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00038\ \ \ \ \ \mbox{\hyperlink{classsrslog_1_1sink}{srslog::sink}}(std::move(f)),\ s(srslog::get\_default\_sink())}
\DoxyCodeLine{00039\ \ \ \{}
\DoxyCodeLine{00040\ \ \ \ \ error\_counter.store(0);}
\DoxyCodeLine{00041\ \ \ \ \ warning\_counter.store(0);}
\DoxyCodeLine{00042\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1log__sink__spy_a8a89291738d164c1dae24fe907ee15ca}\label{classsrsran_1_1log__sink__spy_a8a89291738d164c1dae24fe907ee15ca} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!flush@{flush}}
\index{flush@{flush}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{flush()}{flush()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrslog_1_1detail_1_1error__string}{srslog\+::detail\+::error\+\_\+string}} srsran\+::log\+\_\+sink\+\_\+spy\+::flush (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Flushes any buffered contents to the backing store. 



Implements \mbox{\hyperlink{classsrslog_1_1sink_a6f32149349a60fcf5c6ee68174ac5aa5}{srslog\+::sink}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \{\ \textcolor{keywordflow}{return}\ s.\mbox{\hyperlink{classsrslog_1_1sink_a6f32149349a60fcf5c6ee68174ac5aa5}{flush}}();\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1log__sink__spy_ac0ae3c3c2a2b216653a80ea9e0b906dd}\label{classsrsran_1_1log__sink__spy_ac0ae3c3c2a2b216653a80ea9e0b906dd} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!get\_error\_counter@{get\_error\_counter}}
\index{get\_error\_counter@{get\_error\_counter}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{get\_error\_counter()}{get\_error\_counter()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classunsigned}{unsigned}} srsran\+::log\+\_\+sink\+\_\+spy\+::get\+\_\+error\+\_\+counter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the number of log entries tagged as errors. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00049\ \ \ \{}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ Flush\ to\ make\ sure\ all\ entries\ have\ been\ processed\ by\ the\ backend.}}
\DoxyCodeLine{00051\ \ \ \ \ srslog::flush();}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{return}\ error\_counter.load();}
\DoxyCodeLine{00053\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1log__sink__spy_a0f12d7afce3a2915402a933cad9a3527}\label{classsrsran_1_1log__sink__spy_a0f12d7afce3a2915402a933cad9a3527} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!get\_warning\_counter@{get\_warning\_counter}}
\index{get\_warning\_counter@{get\_warning\_counter}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{get\_warning\_counter()}{get\_warning\_counter()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classunsigned}{unsigned}} srsran\+::log\+\_\+sink\+\_\+spy\+::get\+\_\+warning\+\_\+counter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the number of log entries tagged as warnings. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00057\ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{//\ Flush\ to\ make\ sure\ all\ entries\ have\ been\ processed\ by\ the\ backend.}}
\DoxyCodeLine{00059\ \ \ \ \ srslog::flush();}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{return}\ warning\_counter.load();}
\DoxyCodeLine{00061\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1log__sink__spy_a54a956030d976c92f270d8cc5c39654f}\label{classsrsran_1_1log__sink__spy_a54a956030d976c92f270d8cc5c39654f} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!name@{name}}
\index{name@{name}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{name()}{name()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classchar}{char}} \texorpdfstring{$\ast$}{*} srsran\+::log\+\_\+sink\+\_\+spy\+::name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Identifier of this custom sink. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00045\ \{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}log\_sink\_spy"{}};\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1log__sink__spy_a41e7957ea952620e74ca15e753efd747}\label{classsrsran_1_1log__sink__spy_a41e7957ea952620e74ca15e753efd747} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!reset\_counters@{reset\_counters}}
\index{reset\_counters@{reset\_counters}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{reset\_counters()}{reset\_counters()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::log\+\_\+sink\+\_\+spy\+::reset\+\_\+counters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Resets the counters back to 0. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00065\ \ \ \{}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ Flush\ to\ make\ sure\ all\ entries\ have\ been\ processed\ by\ the\ backend.}}
\DoxyCodeLine{00067\ \ \ \ \ srslog::flush();}
\DoxyCodeLine{00068\ \ \ \ \ error\_counter.store(0);}
\DoxyCodeLine{00069\ \ \ \ \ warning\_counter.store(0);}
\DoxyCodeLine{00070\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1log__sink__spy_a9d38934e7d165f35b83397c450d2e8c2}\label{classsrsran_1_1log__sink__spy_a9d38934e7d165f35b83397c450d2e8c2} 
\index{srsran::log\_sink\_spy@{srsran::log\_sink\_spy}!write@{write}}
\index{write@{write}!srsran::log\_sink\_spy@{srsran::log\_sink\_spy}}
\doxysubsubsection{\texorpdfstring{write()}{write()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrslog_1_1detail_1_1error__string}{srslog\+::detail\+::error\+\_\+string}} srsran\+::log\+\_\+sink\+\_\+spy\+::write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrslog_1_1detail_1_1memory__buffer}{srslog\+::detail\+::memory\+\_\+buffer}}}]{buffer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Writes the provided memory buffer into the sink. 



Implements \mbox{\hyperlink{classsrslog_1_1sink_ad88268d4cca4ef27ec7c4a95cda288b1}{srslog\+::sink}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00073\ \ \ \{}
\DoxyCodeLine{00074\ \ \ \ \ std::string\ entry(buffer.\mbox{\hyperlink{classsrslog_1_1detail_1_1memory__buffer_a16d30488bcfc2b4dd889f66d7fd64233}{data}}(),\ buffer.\mbox{\hyperlink{classsrslog_1_1detail_1_1memory__buffer_a911bbffed1ea236e25f5533ad1183791}{size}}());}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{if}\ (entry.find(\textcolor{stringliteral}{"{}[E]"{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ error\_counter.fetch\_add(1);}
\DoxyCodeLine{00077\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (entry.find(\textcolor{stringliteral}{"{}[W]"{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ warning\_counter.fetch\_add(1);}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{return}\ s.\mbox{\hyperlink{classsrslog_1_1sink_ad88268d4cca4ef27ec7c4a95cda288b1}{write}}(buffer);}
\DoxyCodeLine{00082\ \ \ \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/srsran/support/test\+\_\+utils.\+h\end{DoxyCompactItemize}
