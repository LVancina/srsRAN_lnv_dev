\doxysection{srsran\+::ta\+\_\+manager Class Reference}
\hypertarget{classsrsran_1_1ta__manager}{}\label{classsrsran_1_1ta__manager}\index{srsran::ta\_manager@{srsran::ta\_manager}}


Timing Advance manager for an UE.  




{\ttfamily \#include $<$ta\+\_\+manager.\+h$>$}



Collaboration diagram for srsran\+::ta\+\_\+manager\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{d5/d48/classsrsran_1_1ta__manager__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1ta__manager_a2407e7e2b84d5937ba468bf224a4e342}{ta\+\_\+manager}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1scheduler__ue__expert__config}{scheduler\+\_\+ue\+\_\+expert\+\_\+config}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expert\+\_\+cfg\+\_\+}}, \mbox{\hyperlink{namespacesrsran_aca64228c7486db8ce1f0a3118e8cedc8}{subcarrier\+\_\+spacing}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\+\_\+scs\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1dl__logical__channel__manager}{dl\+\_\+logical\+\_\+channel\+\_\+manager}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\+\_\+lc\+\_\+ch\+\_\+mgr\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ta__manager_a02a6c15cb2968b6ad23c8b3b3d011dfd}{slot\+\_\+indication}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\+\_\+sl}})
\begin{DoxyCompactList}\small\item\em Handles Timing Advance adaptation related tasks at slot indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ta__manager_af47ef18ba441dd0980133ae66e98cecf}{handle\+\_\+ul\+\_\+n\+\_\+ta\+\_\+update\+\_\+indication}} (\mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} tag\+\_\+id, int64\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n\+\_\+ta\+\_\+diff\+\_\+}}, \mbox{\hyperlink{classfloat}{float}} ul\+\_\+sinr)
\begin{DoxyCompactList}\small\item\em Handles N\+\_\+\+TA update indication. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Timing Advance manager for an UE. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1ta__manager_a2407e7e2b84d5937ba468bf224a4e342}\label{classsrsran_1_1ta__manager_a2407e7e2b84d5937ba468bf224a4e342} 
\index{srsran::ta\_manager@{srsran::ta\_manager}!ta\_manager@{ta\_manager}}
\index{ta\_manager@{ta\_manager}!srsran::ta\_manager@{srsran::ta\_manager}}
\doxysubsubsection{\texorpdfstring{ta\_manager()}{ta\_manager()}}
{\footnotesize\ttfamily ta\+\_\+manager\+::ta\+\_\+manager (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1scheduler__ue__expert__config}{scheduler\+\_\+ue\+\_\+expert\+\_\+config}} \&}]{expert\+\_\+cfg\+\_\+,  }\item[{\mbox{\hyperlink{namespacesrsran_aca64228c7486db8ce1f0a3118e8cedc8}{subcarrier\+\_\+spacing}}}]{ul\+\_\+scs\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1dl__logical__channel__manager}{dl\+\_\+logical\+\_\+channel\+\_\+manager}} \texorpdfstring{$\ast$}{*}}]{dl\+\_\+lc\+\_\+ch\+\_\+mgr\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00031\ \ \ ul\_scs(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_scs\_}}),\ dl\_lc\_ch\_mgr(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_lc\_ch\_mgr\_}}),\ expert\_cfg(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expert\_cfg\_}}),\ state(state\_t::idle)}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{if}\ (expert\_cfg.\mbox{\hyperlink{structsrsran_1_1scheduler__ue__expert__config_a67cd4b91e3fddeb698c56fb5af272ccb}{ta\_cmd\_offset\_threshold}}\ <\ 0)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ state\ =\ state\_t::disabled;}
\DoxyCodeLine{00035\ \ \ \}}
\DoxyCodeLine{00036\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1ta__manager_af47ef18ba441dd0980133ae66e98cecf}\label{classsrsran_1_1ta__manager_af47ef18ba441dd0980133ae66e98cecf} 
\index{srsran::ta\_manager@{srsran::ta\_manager}!handle\_ul\_n\_ta\_update\_indication@{handle\_ul\_n\_ta\_update\_indication}}
\index{handle\_ul\_n\_ta\_update\_indication@{handle\_ul\_n\_ta\_update\_indication}!srsran::ta\_manager@{srsran::ta\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_ul\_n\_ta\_update\_indication()}{handle\_ul\_n\_ta\_update\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ta\+\_\+manager\+::handle\+\_\+ul\+\_\+n\+\_\+ta\+\_\+update\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}}}]{tag\+\_\+id,  }\item[{int64\+\_\+t}]{n\+\_\+ta\+\_\+diff\+\_\+,  }\item[{\mbox{\hyperlink{classfloat}{float}}}]{ul\+\_\+sinr }\end{DoxyParamCaption})}



Handles N\+\_\+\+TA update indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00039\ \{}
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//\ [Implementation-\/defined]\ N\_TA\ update\ (N\_TA\_new\ -\/\ N\_TA\_old\ value\ in\ T\_C\ units)\ measurements\ are\ considered\ only\ if}}
\DoxyCodeLine{00041\ \ \ \textcolor{comment}{//\ the\ UL\ SINR\ reported\ in\ the\ corresponding\ indication\ message\ is\ higher\ than\ the\ threshold.}}
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{//\ NOTE:\ From\ the\ testing\ with\ COTS\ UE\ its\ observed\ that\ N\_TA\ update\ measurements\ with\ UL\ SINR\ less\ than\ 10\ dB\ were}}
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{//\ majorly\ outliers.}}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordflow}{if}\ (state\ ==\ state\_t::measure\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ ul\_sinr\ >\ expert\_cfg.\mbox{\hyperlink{structsrsran_1_1scheduler__ue__expert__config_a281abae62b5cabc978b94944d0297498}{ta\_update\_measurement\_ul\_sinr\_threshold}})\ \{}
\DoxyCodeLine{00045\ \ \ \ \ tag\_n\_ta\_diff\_measurements[tag\_id].emplace\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n\_ta\_diff\_}});}
\DoxyCodeLine{00046\ \ \ \}}
\DoxyCodeLine{00047\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ta__manager_a02a6c15cb2968b6ad23c8b3b3d011dfd}\label{classsrsran_1_1ta__manager_a02a6c15cb2968b6ad23c8b3b3d011dfd} 
\index{srsran::ta\_manager@{srsran::ta\_manager}!slot\_indication@{slot\_indication}}
\index{slot\_indication@{slot\_indication}!srsran::ta\_manager@{srsran::ta\_manager}}
\doxysubsubsection{\texorpdfstring{slot\_indication()}{slot\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ta\+\_\+manager\+::slot\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{current\+\_\+sl }\end{DoxyParamCaption})}



Handles Timing Advance adaptation related tasks at slot indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00050\ \{}
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{if}\ (state\ ==\ state\_t::disabled)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00053\ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ Update\ the\ measurement\ start\ time.}}
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ NOTE:\ When\ the\ state\ is\ idle,\ it\ denotes\ the\ start\ of\ measurement\ window.\ And\ when\ the\ measurement\ time\ reaches\ the}}
\DoxyCodeLine{00057\ \ \ \textcolor{comment}{//\ threshold\ only\ then\ I\ change\ the\ state\ back\ to\ idle\ (until\ then\ the\ state\ will\ be\ in\ measure)}}
\DoxyCodeLine{00058\ \ \ \textcolor{keywordflow}{if}\ (state\ ==\ state\_t::idle)\ \{}
\DoxyCodeLine{00059\ \ \ \ \ meas\_start\_time\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_sl}};}
\DoxyCodeLine{00060\ \ \ \ \ state\ \ \ \ \ \ \ \ \ \ \ =\ state\_t::measure;}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//\ Early\ return\ if\ measurement\ interval\ is\ short.}}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_sl}}\ -\/\ meas\_start\_time)\ <\ (\textcolor{keywordtype}{int})expert\_cfg.\mbox{\hyperlink{structsrsran_1_1scheduler__ue__expert__config_a80965f8325344a1172ecd3570e32292e}{ta\_measurement\_slot\_period}})\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classuint8__t}{uint8\_t}}\ tag\_id\ =\ 0;\ tag\_id\ <\ tag\_n\_ta\_diff\_measurements.size();\ ++tag\_id)\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{if}\ (tag\_n\_ta\_diff\_measurements[tag\_id].empty())\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{comment}{//\ Send\ Timing\ Advance\ command\ only\ if\ the\ offset\ is\ greater\ than\ threshold.}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ The\ new\ Timing\ Advance\ Command\ is\ a\ value\ ranging\ from\ [0,...,63]\ as\ per\ TS\ 38.213,\ clause\ 4.2.\ Hence,\ we}}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{//\ need\ to\ subtract\ a\ value\ of\ 31\ (as\ per\ equation\ in\ the\ same\ clause)\ to\ get\ the\ change\ in\ Timing\ Advance\ Command.}}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_t\_a}}\ =\ compute\_new\_t\_a(compute\_avg\_n\_ta\_difference(tag\_id));}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{if}\ (abs((\textcolor{keywordtype}{int})\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_t\_a}}\ -\/\ 31)\ >\ expert\_cfg.\mbox{\hyperlink{structsrsran_1_1scheduler__ue__expert__config_a67cd4b91e3fddeb698c56fb5af272ccb}{ta\_cmd\_offset\_threshold}})\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \textcolor{comment}{//\ Send\ Timing\ Advance\ Command\ to\ UE.}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ dl\_lc\_ch\_mgr-\/>\mbox{\hyperlink{classsrsran_1_1dl__logical__channel__manager_ab68a5d9cce32e5990eede9a1841f8ff4}{handle\_mac\_ce\_indication}}(}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \{.ce\_lcid\ =\ lcid\_dl\_sch\_t::TA\_CMD,\ .ce\_payload\ =\ \mbox{\hyperlink{structsrsran_1_1ta__cmd__ce__payload}{ta\_cmd\_ce\_payload}}\{.tag\_id\ =\ tag\_id,\ .ta\_cmd\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_t\_a}}\}\});}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ Reset\ stored\ measurements.}}
\DoxyCodeLine{00084\ \ \ \ \ reset\_measurements(tag\_id);}
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//\ Set\ TA\ manager\ state\ to\ idle.}}
\DoxyCodeLine{00088\ \ \ state\ =\ state\_t::idle;}
\DoxyCodeLine{00089\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/ue\+\_\+scheduling/ta\+\_\+manager.\+h\item 
lib/scheduler/ue\+\_\+scheduling/ta\+\_\+manager.\+cpp\end{DoxyCompactItemize}
