\doxysection{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up Class Reference}
\hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up}{}\label{classsrsran_1_1srs__cu__up_1_1cu__up}\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}


Inheritance diagram for srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/db4/classsrsran_1_1srs__cu__up_1_1cu__up__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d3/d3c/classsrsran_1_1srs__cu__up_1_1cu__up__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a94283f5d65ad73d71c95e0efbce9d803}{cu\+\_\+up}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration}{cu\+\_\+up\+\_\+configuration}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cfg\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_add8be552c371a7798186306378403106}{start}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a6c8bc9f0897168db36b7bdc83acaf767}{stop}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Stop the CU-\/\+UP. This call is blocking and only returns once all tasks in the CU-\/\+UP are completed. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ uint16\+\_\+t $>$ \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a438d4df84c677d97e537f72abab429c1}{get\+\_\+n3\+\_\+bind\+\_\+port}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Get the N3 bind port. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1e1ap__message__handler}{e1ap\+\_\+message\+\_\+handler}} \& \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a710a273f49fa296c1bb2799e5e7bb2b5}{get\+\_\+e1ap\+\_\+message\+\_\+handler}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Get the E1\+AP message handler interface. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__setup__response}{e1ap\+\_\+bearer\+\_\+context\+\_\+setup\+\_\+response}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_aa91bb78cd9d8ae82db1500e7d7e3b254}{handle\+\_\+bearer\+\_\+context\+\_\+setup\+\_\+request}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__setup__request}{e1ap\+\_\+bearer\+\_\+context\+\_\+setup\+\_\+request}} \&msg) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Create a new UE context and handle bearer setup request. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__modification__response}{e1ap\+\_\+bearer\+\_\+context\+\_\+modification\+\_\+response}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a1362c97b6d2cb83314f074f0a20afd91}{handle\+\_\+bearer\+\_\+context\+\_\+modification\+\_\+request}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__modification__request}{e1ap\+\_\+bearer\+\_\+context\+\_\+modification\+\_\+request}} \&msg) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Create a new UE context and handle bearer modification request. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a2fc5743a0a0016ff9f7040b89ecf24e0}{handle\+\_\+bearer\+\_\+context\+\_\+release\+\_\+command}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__release__command}{e1ap\+\_\+bearer\+\_\+context\+\_\+release\+\_\+command}} \&msg) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Handle bearer release command and remove the associated UE context. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_ae010f6bfb6d8e06af6cef11f12e9d5f0}{on\+\_\+e1ap\+\_\+connection\+\_\+establish}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Notifies the CU-\/\+UP about a successful E1\+AP connection. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a1e5dcc0bdaa3f96308a8c8c5de7a1682}{on\+\_\+e1ap\+\_\+connection\+\_\+drop}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Notifies the CU-\/\+CP about a dropped E1\+AP connection. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a168c8502e4f5421170c8bfb0821dd55c}{e1ap\+\_\+is\+\_\+connected}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Get the state of the E1\+AP connection. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1gtpu__demux__rx__upper__layer__interface}{gtpu\+\_\+demux\+\_\+rx\+\_\+upper\+\_\+layer\+\_\+interface}} \& \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a14a03ee10785cb4cf6c16a8c084e78a4}{get\+\_\+ngu\+\_\+pdu\+\_\+handler}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Get the NGu PDU handler interface. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a94283f5d65ad73d71c95e0efbce9d803}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a94283f5d65ad73d71c95e0efbce9d803} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!cu\_up@{cu\_up}}
\index{cu\_up@{cu\_up}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{cu\_up()}{cu\_up()}}
{\footnotesize\ttfamily cu\+\_\+up\+::cu\+\_\+up (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration}{cu\+\_\+up\+\_\+configuration}} \&}]{cfg\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}

\begin{quote}
Create and connect upper layers \end{quote}


\begin{quote}
Create e1ap \end{quote}


\begin{quote}
Create UE manager \end{quote}

\begin{DoxyCode}{0}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ cfg(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{config\_}}),\ main\_ctrl\_loop(128)}
\DoxyCodeLine{00052\ \{}
\DoxyCodeLine{00053\ \ \ assert\_cu\_up\_configuration\_valid(cfg);}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{comment}{//\ Create\ NG-\/U\ gateway,\ bind/open\ later\ (after\ GTP-\/U\ demux\ is\ connected)}}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{structsrsran_1_1udp__network__gateway__config}{udp\_network\_gateway\_config}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_config}}\ =\ \{\};}
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_config}}.bind\_address\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.net\_cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_ad265e95392f83decf5bb4a1faa485cba}{n3\_bind\_addr}};}
\DoxyCodeLine{00060\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_config}}.bind\_port\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.net\_cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_a29aa65fd19d144e7a6112873f0f907d4}{n3\_bind\_port}};}
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_config}}.rx\_max\_mmsg\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.net\_cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_a19ce76aaf4f9dcfd394d20ed08de021a}{n3\_rx\_max\_mmsg}};}
\DoxyCodeLine{00062\ \ \ \textcolor{comment}{//\ other\ params}}
\DoxyCodeLine{00063\ \ \ \mbox{\hyperlink{structsrsran_1_1udp__network__gateway__creation__message}{udp\_network\_gateway\_creation\_message}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_msg}}\ =\ \{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_config}},\ gw\_data\_gtpu\_demux\_adapter,\ *cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a461dd4774adb59857a0c5c8d276fdcdc}{io\_ul\_executor}}\};}
\DoxyCodeLine{00064\ \ \ ngu\_gw\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a02eec07ee9fc9748e71668a36d096cee}{create\_udp\_network\_gateway}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_gw\_msg}});}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ Create\ GTP-\/U\ demux}}
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{structsrsran_1_1gtpu__demux__creation__request}{gtpu\_demux\_creation\_request}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demux\_msg}}\ =\ \{\};}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demux\_msg}}.cfg.warn\_on\_drop\ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.n3\_cfg.warn\_on\_drop;}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demux\_msg}}.cu\_up\_exec\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a398c4f4a552908c709ca735fb62ccf29}{dl\_executor}};}
\DoxyCodeLine{00070\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demux\_msg}}.gtpu\_pcap\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.gtpu\_pcap;}
\DoxyCodeLine{00071\ \ \ ngu\_demux\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_ac5904a2a271471b6fad7f437cf44052d}{create\_gtpu\_demux}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demux\_msg}});}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{//\ Create\ GTP-\/U\ echo\ and\ register\ it\ at\ demux}}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{structsrsran_1_1gtpu__echo__creation__message}{gtpu\_echo\_creation\_message}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_echo\_msg}}\ =\ \{\};}
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_echo\_msg}}.gtpu\_pcap\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.gtpu\_pcap;}
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_echo\_msg}}.tx\_upper\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \&gtpu\_gw\_adapter;}
\DoxyCodeLine{00077\ \ \ ngu\_echo\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_ac1ef83968cbf244e63f93e302be8bbd5}{create\_gtpu\_echo}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ngu\_echo\_msg}});}
\DoxyCodeLine{00078\ \ \ ngu\_demux-\/>add\_tunnel(\mbox{\hyperlink{namespacesrsran_ae66ebdfbccf6edcfe04b5d33772b58a7}{GTPU\_PATH\_MANAGEMENT\_TEID}},\ ngu\_echo-\/>get\_rx\_upper\_layer\_interface());}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \textcolor{comment}{//\ Connect\ layers}}
\DoxyCodeLine{00081\ \ \ gw\_data\_gtpu\_demux\_adapter.connect\_gtpu\_demux(*ngu\_demux);}
\DoxyCodeLine{00082\ \ \ gtpu\_gw\_adapter.connect\_network\_gateway(*ngu\_gw);}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ Bind/open\ the\ gateway,\ start\ handling\ of\ incoming\ traffic\ from\ UPF,\ e.g.\ echo}}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ ngu\_gw-\/>create\_and\_bind())\ \{}
\DoxyCodeLine{00086\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Failed\ to\ create\ and\ connect\ N3\ gateway"{}});}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_ac052008ef957490250e3db69af1b5dbf}{epoll\_broker}}-\/>\mbox{\hyperlink{classsrsran_1_1io__broker_a6c24c2e4dd6318cd267f68739356e9bb}{register\_fd}}(ngu\_gw-\/>get\_socket\_fd(),\ [\textcolor{keyword}{this}](\textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fd}})\ \{\ ngu\_gw-\/>receive();\ \});}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Failed\ to\ register\ N3\ (GTP-\/U)\ network\ gateway\ at\ IO\ broker.\ socket\_fd=\{\}"{}},\ ngu\_gw-\/>get\_socket\_fd());}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ Create\ TEID\ allocator}}
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{structsrsran_1_1gtpu__allocator__creation__request}{gtpu\_allocator\_creation\_request}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_alloc\_msg}}\ =\ \{\};}
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_alloc\_msg}}.max\_nof\_teids\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ MAX\_NOF\_UES\ *\ MAX\_NOF\_PDU\_SESSIONS;}
\DoxyCodeLine{00096\ \ \ f1u\_teid\_allocator\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ create\_gtpu\_allocator(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_alloc\_msg}});}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00099\ \ \ e1ap\ =\ create\_e1ap(*cfg.e1ap.e1ap\_conn\_client,\ e1ap\_cu\_up\_ev\_notifier,\ *cfg.timers,\ *cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a5e394382adf623b95a2546ccff3e58f2}{ctrl\_executor}});}
\DoxyCodeLine{00100\ \ \ e1ap\_cu\_up\_ev\_notifier.connect\_cu\_up(*\textcolor{keyword}{this});}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ cfg.e1ap.e1ap\_conn\_mng\ =\ e1ap.get();}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00105\ \ \ ue\_mng\ =\ std::make\_unique<ue\_manager>(cfg.net\_cfg,}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cfg.n3\_cfg,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *e1ap,}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *cfg.timers,}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *cfg.f1u\_gateway,}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gtpu\_gw\_adapter,}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *ngu\_demux,}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *f1u\_teid\_allocator,}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *cfg.gtpu\_pcap,}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a5e394382adf623b95a2546ccff3e58f2}{ctrl\_executor}},}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger);}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \textcolor{comment}{//\ Start\ statistics\ report\ timer}}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{if}\ (cfg.statistics\_report\_period.count()\ >\ 0)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ statistics\_report\_timer\ =\ cfg.timers-\/>\mbox{\hyperlink{classsrsran_1_1timer__manager_ae7969b02b1e0306e319b93505212f36c}{create\_unique\_timer}}(*cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a5e394382adf623b95a2546ccff3e58f2}{ctrl\_executor}});}
\DoxyCodeLine{00120\ \ \ \ \ statistics\_report\_timer.\mbox{\hyperlink{classsrsran_1_1unique__timer_a79c9d6ec6c5942aa869ea4ba273536c5}{set}}(cfg.statistics\_report\_period,}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{keyword}{this}](\mbox{\hyperlink{namespacesrsran_aa72283f3567ebd1eb77b7dd882d6de33}{timer\_id\_t}}\ \textcolor{comment}{/*tid*/})\ \{\ on\_statistics\_report\_timer\_expired();\ \});}
\DoxyCodeLine{00122\ \ \ \ \ statistics\_report\_timer.\mbox{\hyperlink{classsrsran_1_1unique__timer_af3fa2fce72a8058698b971e498e0c262}{run}}();}
\DoxyCodeLine{00123\ \ \ \}}
\DoxyCodeLine{00124\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_aa59f27f84795e201dcd7b22a5025487f}\label{classsrsran_1_1srs__cu__up_1_1cu__up_aa59f27f84795e201dcd7b22a5025487f} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!````~cu\_up@{\texorpdfstring{$\sim$}{\string~}cu\_up}}
\index{````~cu\_up@{\texorpdfstring{$\sim$}{\string~}cu\_up}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}cu\_up()}{\string~cu\_up()}}
{\footnotesize\ttfamily cu\+\_\+up\+::\texorpdfstring{$\sim$}{\string~}cu\+\_\+up (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00206\ \{}
\DoxyCodeLine{00207\ \ \ \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up_a6c8bc9f0897168db36b7bdc83acaf767}{stop}}();}
\DoxyCodeLine{00208\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a168c8502e4f5421170c8bfb0821dd55c}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a168c8502e4f5421170c8bfb0821dd55c} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!e1ap\_is\_connected@{e1ap\_is\_connected}}
\index{e1ap\_is\_connected@{e1ap\_is\_connected}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{e1ap\_is\_connected()}{e1ap\_is\_connected()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+::e1ap\+\_\+is\+\_\+connected (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Get the state of the E1\+AP connection. 

\begin{DoxyReturn}{Returns}
True if E1\+AP is connected, false otherwise. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__interface_a089e6d407377ca7c350a581fb4dd5f97}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00069\ \{\ \textcolor{keywordflow}{return}\ e1ap\_connected;\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a710a273f49fa296c1bb2799e5e7bb2b5}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a710a273f49fa296c1bb2799e5e7bb2b5} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!get\_e1ap\_message\_handler@{get\_e1ap\_message\_handler}}
\index{get\_e1ap\_message\_handler@{get\_e1ap\_message\_handler}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{get\_e1ap\_message\_handler()}{get\_e1ap\_message\_handler()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1e1ap__message__handler}{e1ap\+\_\+message\+\_\+handler}} \& srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+::get\+\_\+e1ap\+\_\+message\+\_\+handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Get the E1\+AP message handler interface. 



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__interface_af84bc7484d7fe48145bf7d56507167e9}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00056\ \{\ \textcolor{keywordflow}{return}\ *e1ap;\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a438d4df84c677d97e537f72abab429c1}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a438d4df84c677d97e537f72abab429c1} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!get\_n3\_bind\_port@{get\_n3\_bind\_port}}
\index{get\_n3\_bind\_port@{get\_n3\_bind\_port}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{get\_n3\_bind\_port()}{get\_n3\_bind\_port()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ uint16\+\_\+t $>$ srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+::get\+\_\+n3\+\_\+bind\+\_\+port (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Get the N3 bind port. 



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__interface_a0e6e16aec51f3422fdb81518611c9662}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00053\ \{\ \textcolor{keywordflow}{return}\ ngu\_gw-\/>get\_bind\_port();\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a14a03ee10785cb4cf6c16a8c084e78a4}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a14a03ee10785cb4cf6c16a8c084e78a4} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!get\_ngu\_pdu\_handler@{get\_ngu\_pdu\_handler}}
\index{get\_ngu\_pdu\_handler@{get\_ngu\_pdu\_handler}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{get\_ngu\_pdu\_handler()}{get\_ngu\_pdu\_handler()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1gtpu__demux__rx__upper__layer__interface}{gtpu\+\_\+demux\+\_\+rx\+\_\+upper\+\_\+layer\+\_\+interface}} \& srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+::get\+\_\+ngu\+\_\+pdu\+\_\+handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Get the NGu PDU handler interface. 

\begin{DoxyReturn}{Returns}
The NGu PDU handler interface. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__ngu__interface_a92f66d240ac61d05143e2b794b8f1976}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+ngu\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00072\ \{\ \textcolor{keywordflow}{return}\ *ngu\_demux;\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a1362c97b6d2cb83314f074f0a20afd91}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a1362c97b6d2cb83314f074f0a20afd91} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!handle\_bearer\_context\_modification\_request@{handle\_bearer\_context\_modification\_request}}
\index{handle\_bearer\_context\_modification\_request@{handle\_bearer\_context\_modification\_request}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{handle\_bearer\_context\_modification\_request()}{handle\_bearer\_context\_modification\_request()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__modification__response}{e1ap\+\_\+bearer\+\_\+context\+\_\+modification\+\_\+response}} cu\+\_\+up\+::handle\+\_\+bearer\+\_\+context\+\_\+modification\+\_\+request (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__modification__request}{e1ap\+\_\+bearer\+\_\+context\+\_\+modification\+\_\+request}} \&}]{msg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Create a new UE context and handle bearer modification request. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em msg} & The original bearer modification request. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns message containing the index of the created UE and all response/failure message. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__interface_ab19705ae49c7b18b898025f9c93f0e31}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00362\ \{}
\DoxyCodeLine{00363\ \ \ \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1ue__context}{ue\_context}}*\ ue\_ctxt\ =\ ue\_mng-\/>find\_ue(msg.ue\_index);}
\DoxyCodeLine{00364\ \ \ \textcolor{keywordflow}{if}\ (ue\_ctxt\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00365\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Could\ not\ find\ UE\ context"{}});}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{return}\ \{\};}
\DoxyCodeLine{00367\ \ \ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ ue\_ctxt-\/>get\_logger().log\_debug(\textcolor{stringliteral}{"{}Handling\ BearerContextModificationRequest"{}});}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__modification__response}{e1ap\_bearer\_context\_modification\_response}}\ response\ =\ \{\};}
\DoxyCodeLine{00372\ \ \ response.ue\_index\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ue\_ctxt-\/>get\_index();}
\DoxyCodeLine{00373\ \ \ response.success\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \textcolor{keywordtype}{bool}\ new\_ul\_tnl\_info\_required\ =\ msg.new\_ul\_tnl\_info\_required\ ==\ std::string(\textcolor{stringliteral}{"{}required"{}});}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{if}\ (msg.ng\_ran\_bearer\_context\_mod\_request.has\_value())\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{comment}{//\ Traverse\ list\ of\ PDU\ sessions\ to\ be\ setup/modified}}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}}\ :}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ msg.ng\_ran\_bearer\_context\_mod\_request.value().pdu\_session\_res\_to\_setup\_mod\_list)\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ ue\_ctxt-\/>get\_logger().log\_debug(\textcolor{stringliteral}{"{}Setup/Modification\ of\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}}.pdu\_session\_id);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__setup__result}{pdu\_session\_setup\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}}\ =\ ue\_ctxt-\/>setup\_pdu\_session(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}});}
\DoxyCodeLine{00383\ \ \ \ \ \ \ process\_successful\_pdu\_resource\_setup\_mod\_outcome(response.pdu\_session\_resource\_setup\_list,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}});}
\DoxyCodeLine{00384\ \ \ \ \ \ \ response.success\ \&=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}}.success;\ \textcolor{comment}{//\ Update\ final\ result.}}
\DoxyCodeLine{00385\ \ \ \ \ \}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{comment}{//\ Traverse\ list\ of\ PDU\ sessions\ to\ be\ modified.}}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}}\ :\ msg.ng\_ran\_bearer\_context\_mod\_request.value().pdu\_session\_res\_to\_modify\_list)\ \{}
\DoxyCodeLine{00389\ \ \ \ \ \ \ ue\_ctxt-\/>get\_logger().log\_debug(\textcolor{stringliteral}{"{}Modifying\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}}.pdu\_session\_id);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__modification__result}{pdu\_session\_modification\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}}\ =}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ ue\_ctxt-\/>modify\_pdu\_session(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}},\ new\_ul\_tnl\_info\_required);}
\DoxyCodeLine{00392\ \ \ \ \ \ \ process\_successful\_pdu\_resource\_modification\_outcome(response.pdu\_session\_resource\_modified\_list,}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response.pdu\_session\_resource\_failed\_to\_modify\_list,}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}},}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ ue\_ctxt-\/>get\_logger().log\_debug(\textcolor{stringliteral}{"{}Modification\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}}.success\ ?\ \textcolor{stringliteral}{"{}successful"{}}\ :\ \textcolor{stringliteral}{"{}failed"{}});}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \ \ response.success\ \&=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{session\_result}}.success;\ \textcolor{comment}{//\ Update\ final\ result.}}
\DoxyCodeLine{00399\ \ \ \ \ \}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Traverse\ list\ of\ PDU\ sessions\ to\ be\ removed.}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}}\ :\ msg.ng\_ran\_bearer\_context\_mod\_request.value().pdu\_session\_res\_to\_rem\_list)\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ ue\_ctxt-\/>get\_logger().log\_info(\textcolor{stringliteral}{"{}Removing\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}});}
\DoxyCodeLine{00404\ \ \ \ \ \ \ ue\_ctxt-\/>remove\_pdu\_session(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_item}});}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \textcolor{comment}{//\ There\ is\ no\ IE\ to\ confirm\ successful\ removal.}}
\DoxyCodeLine{00406\ \ \ \ \ \}}
\DoxyCodeLine{00407\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00408\ \ \ \ \ ue\_ctxt-\/>get\_logger().log\_warning(\textcolor{stringliteral}{"{}Ignoring\ empty\ Bearer\ Context\ Modification\ Request"{}});}
\DoxyCodeLine{00409\ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{comment}{//\ 3.\ Create\ response}}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ response.success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{keywordflow}{return}\ response;}
\DoxyCodeLine{00416\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a2fc5743a0a0016ff9f7040b89ecf24e0}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a2fc5743a0a0016ff9f7040b89ecf24e0} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!handle\_bearer\_context\_release\_command@{handle\_bearer\_context\_release\_command}}
\index{handle\_bearer\_context\_release\_command@{handle\_bearer\_context\_release\_command}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{handle\_bearer\_context\_release\_command()}{handle\_bearer\_context\_release\_command()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} cu\+\_\+up\+::handle\+\_\+bearer\+\_\+context\+\_\+release\+\_\+command (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__release__command}{e1ap\+\_\+bearer\+\_\+context\+\_\+release\+\_\+command}} \&}]{msg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Handle bearer release command and remove the associated UE context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em msg} & The original bearer release command. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__interface_ae930fdd3a0bd3b629938a6065024ba0c}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00419\ \{}
\DoxyCodeLine{00420\ \ \ \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1ue__context}{ue\_context}}*\ ue\_ctxt\ =\ ue\_mng-\/>find\_ue(msg.ue\_index);}
\DoxyCodeLine{00421\ \ \ \textcolor{keywordflow}{if}\ (ue\_ctxt\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00422\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}ue=\{\}:\ Discarding\ E1\ Bearer\ Context\ Release\ Command.\ UE\ context\ not\ found"{}},\ msg.ue\_index);}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00424\ \ \ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ ue\_ctxt-\/>get\_logger().log\_debug(\textcolor{stringliteral}{"{}Received\ E1\ Bearer\ Context\ Release\ Command"{}});}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ ue\_mng-\/>remove\_ue(msg.ue\_index);}
\DoxyCodeLine{00429\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_aa91bb78cd9d8ae82db1500e7d7e3b254}\label{classsrsran_1_1srs__cu__up_1_1cu__up_aa91bb78cd9d8ae82db1500e7d7e3b254} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!handle\_bearer\_context\_setup\_request@{handle\_bearer\_context\_setup\_request}}
\index{handle\_bearer\_context\_setup\_request@{handle\_bearer\_context\_setup\_request}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{handle\_bearer\_context\_setup\_request()}{handle\_bearer\_context\_setup\_request()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__setup__response}{e1ap\+\_\+bearer\+\_\+context\+\_\+setup\+\_\+response}} cu\+\_\+up\+::handle\+\_\+bearer\+\_\+context\+\_\+setup\+\_\+request (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__setup__request}{e1ap\+\_\+bearer\+\_\+context\+\_\+setup\+\_\+request}} \&}]{msg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Create a new UE context and handle bearer setup request. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em msg} & The original bearer setup request. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns message containing the index of the created UE and all response/failure message. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__interface_ae37f9f5e9f1b9caaadfdeb332d3de36f}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00319\ \{}
\DoxyCodeLine{00320\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1e1ap__bearer__context__setup__response}{e1ap\_bearer\_context\_setup\_response}}\ response\ =\ \{\};}
\DoxyCodeLine{00321\ \ \ response.ue\_index\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ INVALID\_UE\_INDEX;}
\DoxyCodeLine{00322\ \ \ response.success\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \textcolor{comment}{//\ 1.\ Create\ new\ UE\ context}}
\DoxyCodeLine{00325\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1ue__context__cfg}{ue\_context\_cfg}}\ ue\_cfg\ =\ \{\};}
\DoxyCodeLine{00326\ \ \ fill\_sec\_as\_config(ue\_cfg.security\_info,\ msg.security\_info);}
\DoxyCodeLine{00327\ \ \ ue\_cfg.activity\_level\ \ \ \ \ \ \ \ =\ msg.activity\_notif\_level;}
\DoxyCodeLine{00328\ \ \ ue\_cfg.ue\_inactivity\_timeout\ =\ msg.ue\_inactivity\_timer;}
\DoxyCodeLine{00329\ \ \ ue\_cfg.qos\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cfg.qos;}
\DoxyCodeLine{00330\ \ \ \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1ue__context}{ue\_context}}*\ ue\_ctxt\ \ \ \ \ \ \ \ \ \ =\ ue\_mng-\/>add\_ue(ue\_cfg);}
\DoxyCodeLine{00331\ \ \ \textcolor{keywordflow}{if}\ (ue\_ctxt\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00332\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Could\ not\ create\ UE\ context"{}});}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordflow}{return}\ response;}
\DoxyCodeLine{00334\ \ \ \}}
\DoxyCodeLine{00335\ \ \ ue\_ctxt-\/>get\_logger().log\_info(\textcolor{stringliteral}{"{}UE\ created"{}});}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{comment}{//\ 2.\ Handle\ bearer\ context\ setup\ request}}
\DoxyCodeLine{00338\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}\ :\ msg.pdu\_session\_res\_to\_setup\_list)\ \{}
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__setup__result}{pdu\_session\_setup\_result}}\ result\ =\ ue\_ctxt-\/>setup\_pdu\_session(\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}});}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{if}\ (result.success)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ process\_successful\_pdu\_resource\_setup\_mod\_outcome(response.pdu\_session\_resource\_setup\_list,\ result);}
\DoxyCodeLine{00342\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1e1ap__pdu__session__resource__failed__item}{e1ap\_pdu\_session\_resource\_failed\_item}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_failed\_item}};}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_failed\_item}}.pdu\_session\_id\ =\ result.pdu\_session\_id;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_failed\_item}}.cause\ \ \ \ \ \ \ \ \ \ =\ result.cause;}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \ \ response.pdu\_session\_resource\_failed\_list.emplace(result.pdu\_session\_id,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_failed\_item}});}
\DoxyCodeLine{00349\ \ \ \ \ \}}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \textcolor{comment}{//\ 3.\ Create\ response}}
\DoxyCodeLine{00353\ \ \ response.ue\_index\ =\ ue\_ctxt-\/>get\_index();}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ response.success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{return}\ response;}
\DoxyCodeLine{00358\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a1e5dcc0bdaa3f96308a8c8c5de7a1682}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a1e5dcc0bdaa3f96308a8c8c5de7a1682} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!on\_e1ap\_connection\_drop@{on\_e1ap\_connection\_drop}}
\index{on\_e1ap\_connection\_drop@{on\_e1ap\_connection\_drop}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{on\_e1ap\_connection\_drop()}{on\_e1ap\_connection\_drop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} cu\+\_\+up\+::on\+\_\+e1ap\+\_\+connection\+\_\+drop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies the CU-\/\+CP about a dropped E1\+AP connection. 



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__connection__notifier_ab70824ed3458bbaa2a5bc679c2883e46}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+connection\+\_\+notifier}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00453\ \{}
\DoxyCodeLine{00454\ \ \ e1ap\_connected\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00455\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_ae010f6bfb6d8e06af6cef11f12e9d5f0}\label{classsrsran_1_1srs__cu__up_1_1cu__up_ae010f6bfb6d8e06af6cef11f12e9d5f0} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!on\_e1ap\_connection\_establish@{on\_e1ap\_connection\_establish}}
\index{on\_e1ap\_connection\_establish@{on\_e1ap\_connection\_establish}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{on\_e1ap\_connection\_establish()}{on\_e1ap\_connection\_establish()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} cu\+\_\+up\+::on\+\_\+e1ap\+\_\+connection\+\_\+establish (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies the CU-\/\+UP about a successful E1\+AP connection. 



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__e1ap__connection__notifier_a29bdf582b231daf2d0c59fc6e095fc34}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+e1ap\+\_\+connection\+\_\+notifier}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00448\ \{}
\DoxyCodeLine{00449\ \ \ e1ap\_connected\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00450\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_add8be552c371a7798186306378403106}\label{classsrsran_1_1srs__cu__up_1_1cu__up_add8be552c371a7798186306378403106} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!start@{start}}
\index{start@{start}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{start()}{start()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} cu\+\_\+up\+::start (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__interface}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00127\ \{}
\DoxyCodeLine{00128\ \ \ logger.info(\textcolor{stringliteral}{"{}CU-\/UP\ starting..."{}});}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ std::unique\_lock<std::mutex>\ lock(mutex);}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordflow}{if}\ (std::exchange(running,\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{00132\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}CU-\/UP\ already\ started.\ Ignoring\ start\ request"{}});}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00134\ \ \ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ std::promise<void>\ p;}
\DoxyCodeLine{00137\ \ \ std::future<void>\ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fut}}\ =\ p.get\_future();}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a5e394382adf623b95a2546ccff3e58f2}{ctrl\_executor}}-\/>\mbox{\hyperlink{classsrsran_1_1task__executor_a7ce182401ef2d2b419bfbed5b5e488f7}{execute}}([\textcolor{keyword}{this},\ \&p]()\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ main\_ctrl\_loop.schedule([this,\ \&p](coro\_context<async\_task<void>>\&\ ctx)\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ CORO\_BEGIN(ctx);}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Connect\ to\ CU-\/CP\ and\ send\ E1\ Setup\ Request\ and\ await\ for\ E1\ setup\ response.}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ CORO\_AWAIT(launch\_async<initial\_cu\_up\_setup\_routine>(cfg));}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Signal\ start()\ caller\ thread\ that\ the\ operation\ is\ complete.}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ p.set\_value();}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ CORO\_RETURN();}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \}))\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a630688b51219f81c5a47ec5650326afc}{report\_fatal\_error}}(\textcolor{stringliteral}{"{}Unable\ to\ initiate\ CU-\/UP\ setup\ routine"{}});}
\DoxyCodeLine{00153\ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \textcolor{comment}{//\ Block\ waiting\ for\ CU-\/UP\ setup\ to\ complete.}}
\DoxyCodeLine{00156\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fut}}.wait();}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ logger.info(\textcolor{stringliteral}{"{}CU-\/UP\ started\ successfully"{}});}
\DoxyCodeLine{00159\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1cu__up_a6c8bc9f0897168db36b7bdc83acaf767}\label{classsrsran_1_1srs__cu__up_1_1cu__up_a6c8bc9f0897168db36b7bdc83acaf767} 
\index{srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}!stop@{stop}}
\index{stop@{stop}!srsran::srs\_cu\_up::cu\_up@{srsran::srs\_cu\_up::cu\_up}}
\doxysubsubsection{\texorpdfstring{stop()}{stop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} cu\+\_\+up\+::stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Stop the CU-\/\+UP. This call is blocking and only returns once all tasks in the CU-\/\+UP are completed. 



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1cu__up__interface_a132844fe416411b47910fa4309f07381}{srsran\+::srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00162\ \{}
\DoxyCodeLine{00163\ \ \ std::unique\_lock<std::mutex>\ lock(mutex);}
\DoxyCodeLine{00164\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ std::exchange(running,\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00166\ \ \ \}}
\DoxyCodeLine{00167\ \ \ logger.debug(\textcolor{stringliteral}{"{}CU-\/UP\ stopping..."{}});}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ CU-\/UP\ stops\ listening\ to\ new\ GTPU\ Rx\ PDUs.}}
\DoxyCodeLine{00170\ \ \ \textcolor{keywordflow}{if}\ (ngu\_gw)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_ac052008ef957490250e3db69af1b5dbf}{epoll\_broker}}-\/>\mbox{\hyperlink{classsrsran_1_1io__broker_af6d46fbb345d9dbb3ea299748d7ce28f}{unregister\_fd}}(ngu\_gw-\/>get\_socket\_fd()))\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Failed\ to\ stop\ NG-\/U\ gateway\ socket"{}});}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \mbox{\hyperlink{classsrsran_1_1eager__async__task}{eager\_async\_task<void>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop}};}
\DoxyCodeLine{00177\ \ \ std::atomic<bool>\ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop\_stopped}}\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stop\_cu\_up\_main\_loop}}\ =\ [\textcolor{keyword}{this},\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop}},\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop\_stopped}}]()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop}}.empty())\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{comment}{//\ First\ call.\ Initiate\ shutdown\ operations.}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{comment}{//\ Stop\ main\ control\ loop\ and\ communicate\ back\ with\ the\ caller\ thread.}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop}}\ =\ main\_ctrl\_loop.request\_stop();}
\DoxyCodeLine{00185\ \ \ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop}}.ready())\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ main\ loop\ finished,\ return\ back\ to\ the\ caller.}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop\_stopped}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00190\ \ \ \ \ \}}
\DoxyCodeLine{00191\ \ \ \};}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{comment}{//\ Wait\ until\ the\ all\ tasks\ of\ the\ main\ loop\ are\ completed\ and\ main\ loop\ has\ stopped.}}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{main\_loop\_stopped}})\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ cfg.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__configuration_a5e394382adf623b95a2546ccff3e58f2}{ctrl\_executor}}-\/>\mbox{\hyperlink{classsrsran_1_1task__executor_a7ce182401ef2d2b419bfbed5b5e488f7}{execute}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stop\_cu\_up\_main\_loop}}))\ \{}
\DoxyCodeLine{00196\ \ \ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Unable\ to\ stop\ CU-\/UP"{}});}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ std::this\_thread::sleep\_for(std::chrono::milliseconds(10));}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ logger.info(\textcolor{stringliteral}{"{}CU-\/UP\ stopped\ successfully"{}});}
\DoxyCodeLine{00203\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/cu\+\_\+up/cu\+\_\+up\+\_\+impl.\+h\item 
lib/cu\+\_\+up/cu\+\_\+up\+\_\+impl.\+cpp\end{DoxyCompactItemize}
