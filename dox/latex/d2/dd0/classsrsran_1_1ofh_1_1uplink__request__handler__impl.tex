\doxysection{srsran\+::ofh\+::uplink\+\_\+request\+\_\+handler\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1ofh_1_1uplink__request__handler__impl}{}\label{classsrsran_1_1ofh_1_1uplink__request__handler__impl}\index{srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}}


Open Fronthaul uplink request handler.  




{\ttfamily \#include $<$ofh\+\_\+uplink\+\_\+request\+\_\+handler\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::ofh\+::uplink\+\_\+request\+\_\+handler\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=231pt]{df/d7e/classsrsran_1_1ofh_1_1uplink__request__handler__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::ofh\+::uplink\+\_\+request\+\_\+handler\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=231pt]{dc/dcc/classsrsran_1_1ofh_1_1uplink__request__handler__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__request__handler__impl_a253f82c905bf3ec48c3a10f88bdbfa02}{uplink\+\_\+request\+\_\+handler\+\_\+impl}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config}{uplink\+\_\+request\+\_\+handler\+\_\+impl\+\_\+config}} \&config, \mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__dependencies}{uplink\+\_\+request\+\_\+handler\+\_\+impl\+\_\+dependencies}} \&\&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dependencies}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__request__handler__impl_aec3a93283165d04eb44d31912d36a635}{handle\+\_\+prach\+\_\+occasion}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1prach__buffer__context}{prach\+\_\+buffer\+\_\+context}} \&context, \mbox{\hyperlink{classsrsran_1_1prach__buffer}{prach\+\_\+buffer}} \&buffer) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Requests the Open Fronthaul to capture a PRACH window. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__request__handler__impl_aaf2e4b299ef0662c6a4aa45c38e03b79}{handle\+\_\+new\+\_\+uplink\+\_\+slot}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1resource__grid__context}{resource\+\_\+grid\+\_\+context}} \&context, \mbox{\hyperlink{classsrsran_1_1resource__grid}{resource\+\_\+grid}} \&grid) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Requests the Open Fronthaul to provide an uplink slot. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__request__handler}{srsran\+::ofh\+::uplink\+\_\+request\+\_\+handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}uplink\+\_\+request\+\_\+handler} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Open Fronthaul uplink request handler. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1ofh_1_1uplink__request__handler__impl_a253f82c905bf3ec48c3a10f88bdbfa02}\label{classsrsran_1_1ofh_1_1uplink__request__handler__impl_a253f82c905bf3ec48c3a10f88bdbfa02} 
\index{srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}!uplink\_request\_handler\_impl@{uplink\_request\_handler\_impl}}
\index{uplink\_request\_handler\_impl@{uplink\_request\_handler\_impl}!srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}}
\doxysubsubsection{\texorpdfstring{uplink\_request\_handler\_impl()}{uplink\_request\_handler\_impl()}}
{\footnotesize\ttfamily uplink\+\_\+request\+\_\+handler\+\_\+impl\+::uplink\+\_\+request\+\_\+handler\+\_\+impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config}{uplink\+\_\+request\+\_\+handler\+\_\+impl\+\_\+config}} \&}]{config,  }\item[{\mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__dependencies}{uplink\+\_\+request\+\_\+handler\+\_\+impl\+\_\+dependencies}} \&\&}]{dependencies }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00053\ \ \ logger(*\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dependencies}}.logger),}
\DoxyCodeLine{00054\ \ \ is\_prach\_cp\_enabled(config.\mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config_a5503fc85b7c24d190c45538c04f88a72}{is\_prach\_cp\_enabled}}),}
\DoxyCodeLine{00055\ \ \ cp(config.\mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config_afc0184cbf6c885642df6859b34d07366}{cp}}),}
\DoxyCodeLine{00056\ \ \ tdd\_config(config.\mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config_a683d2af037237ec4b305b11050b81065}{tdd\_config}}),}
\DoxyCodeLine{00057\ \ \ prach\_eaxc(config.\mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config_a67bcfcbde785eb8237003dc6c73d7d83}{prach\_eaxc}}),}
\DoxyCodeLine{00058\ \ \ ul\_eaxc(config.\mbox{\hyperlink{structsrsran_1_1ofh_1_1uplink__request__handler__impl__config_aafd9225a1afcced850eb9c3df07f796d}{ul\_data\_eaxc}}),}
\DoxyCodeLine{00059\ \ \ ul\_slot\_repo\_ptr(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dependencies}}.ul\_slot\_repo),}
\DoxyCodeLine{00060\ \ \ ul\_prach\_repo\_ptr(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dependencies}}.ul\_prach\_repo),}
\DoxyCodeLine{00061\ \ \ ul\_slot\_repo(*ul\_slot\_repo\_ptr),}
\DoxyCodeLine{00062\ \ \ ul\_prach\_repo(*ul\_prach\_repo\_ptr),}
\DoxyCodeLine{00063\ \ \ data\_flow(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dependencies}}.data\_flow)),}
\DoxyCodeLine{00064\ \ \ frame\_pool\_ptr(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dependencies}}.frame\_pool\_ptr),}
\DoxyCodeLine{00065\ \ \ frame\_pool(*frame\_pool\_ptr)}
\DoxyCodeLine{00066\ \{}
\DoxyCodeLine{00067\ \ \ srsran\_assert(ul\_slot\_repo\_ptr,\ \textcolor{stringliteral}{"{}Invalid\ uplink\ repository"{}});}
\DoxyCodeLine{00068\ \ \ srsran\_assert(ul\_prach\_repo\_ptr,\ \textcolor{stringliteral}{"{}Invalid\ PRACH\ repository"{}});}
\DoxyCodeLine{00069\ \ \ srsran\_assert(data\_flow,\ \textcolor{stringliteral}{"{}Invalid\ data\ flow"{}});}
\DoxyCodeLine{00070\ \ \ srsran\_assert(frame\_pool\_ptr,\ \textcolor{stringliteral}{"{}Invalid\ frame\ pool"{}});}
\DoxyCodeLine{00071\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1ofh_1_1uplink__request__handler__impl_aaf2e4b299ef0662c6a4aa45c38e03b79}\label{classsrsran_1_1ofh_1_1uplink__request__handler__impl_aaf2e4b299ef0662c6a4aa45c38e03b79} 
\index{srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}!handle\_new\_uplink\_slot@{handle\_new\_uplink\_slot}}
\index{handle\_new\_uplink\_slot@{handle\_new\_uplink\_slot}!srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}}
\doxysubsubsection{\texorpdfstring{handle\_new\_uplink\_slot()}{handle\_new\_uplink\_slot()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} uplink\+\_\+request\+\_\+handler\+\_\+impl\+::handle\+\_\+new\+\_\+uplink\+\_\+slot (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1resource__grid__context}{resource\+\_\+grid\+\_\+context}} \&}]{context,  }\item[{\mbox{\hyperlink{classsrsran_1_1resource__grid}{resource\+\_\+grid}} \&}]{grid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Requests the Open Fronthaul to provide an uplink slot. 

The Open Fronthaul must process the slot described by {\ttfamily context}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em context} & Resource grid context. \\
\hline
\mbox{\texttt{ in}}  & {\em buffer} & Resource grid to store the processed slot. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__request__handler_ad10f78f9f0cc5be32e732d20b0ada422}{srsran\+::ofh\+::uplink\+\_\+request\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00153\ \{}
\DoxyCodeLine{00154\ \ \ logger.debug(\textcolor{stringliteral}{"{}Registering\ UL\ context\ entry\ for\ slot\ '\{\}'\ and\ sector\#\{\}"{}},\ context.\mbox{\hyperlink{structsrsran_1_1resource__grid__context_a520e03a16004ae2879ddb2f934c6b7d8}{slot}},\ context.\mbox{\hyperlink{structsrsran_1_1resource__grid__context_a20129b56ffe7fea937bad03d55a5e838}{sector}});}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ frame\_pool.\mbox{\hyperlink{classsrsran_1_1ether_1_1eth__frame__pool_a9b2a69ccee89c621193c915f23ed11f2}{clear\_uplink\_slot}}(context.\mbox{\hyperlink{structsrsran_1_1resource__grid__context_a520e03a16004ae2879ddb2f934c6b7d8}{slot}},\ logger);}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \textcolor{comment}{//\ Store\ the\ context\ in\ the\ repository.}}
\DoxyCodeLine{00159\ \ \ ul\_slot\_repo.\mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__context__repository_a1f1356881bbeec0a23017453acd78b19}{add}}(context,\ grid);}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{structsrsran_1_1ofh_1_1data__flow__cplane__type__1__context}{data\_flow\_cplane\_type\_1\_context}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}};}
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}}.\mbox{\hyperlink{structsrsran_1_1ofh_1_1data__flow__cplane__type__1__context_aca2da097645e28c93121b450117dd516}{slot}}\ \ \ \ \ \ \ \ \ =\ context.\mbox{\hyperlink{structsrsran_1_1resource__grid__context_a520e03a16004ae2879ddb2f934c6b7d8}{slot}};}
\DoxyCodeLine{00163\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}}.filter\_type\ \ =\ filter\_index\_type::standard\_channel\_filter;}
\DoxyCodeLine{00164\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}}.direction\ \ \ \ =\ data\_direction::uplink;}
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}}.symbol\_range\ =\ tdd\_config\ ?\ \mbox{\hyperlink{namespacesrsran_aa7df181c0c8aa3e214580bccdd5d2cdc}{get\_active\_tdd\_ul\_symbols}}(tdd\_config.value(),\ context.\mbox{\hyperlink{structsrsran_1_1resource__grid__context_a520e03a16004ae2879ddb2f934c6b7d8}{slot}}.\mbox{\hyperlink{classsrsran_1_1slot__point_a1808c0aeecc25d6382e49511028c010e}{slot\_index}}(),\ cp)}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structsrsran_1_1ofdm__symbol__range}{ofdm\_symbol\_range}}(0,\ \mbox{\hyperlink{namespacesrsran_aa1d2bd5d3008afda19c0949d241a73f7}{get\_nsymb\_per\_slot}}(cp));}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ eaxc\ :\ ul\_eaxc)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}}.eaxc\ =\ eaxc;}
\DoxyCodeLine{00170\ \ \ \ \ data\_flow-\/>enqueue\_section\_type\_1\_message(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{df\_context}});}
\DoxyCodeLine{00171\ \ \ \}}
\DoxyCodeLine{00172\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ofh_1_1uplink__request__handler__impl_aec3a93283165d04eb44d31912d36a635}\label{classsrsran_1_1ofh_1_1uplink__request__handler__impl_aec3a93283165d04eb44d31912d36a635} 
\index{srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}!handle\_prach\_occasion@{handle\_prach\_occasion}}
\index{handle\_prach\_occasion@{handle\_prach\_occasion}!srsran::ofh::uplink\_request\_handler\_impl@{srsran::ofh::uplink\_request\_handler\_impl}}
\doxysubsubsection{\texorpdfstring{handle\_prach\_occasion()}{handle\_prach\_occasion()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} uplink\+\_\+request\+\_\+handler\+\_\+impl\+::handle\+\_\+prach\+\_\+occasion (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1prach__buffer__context}{prach\+\_\+buffer\+\_\+context}} \&}]{context,  }\item[{\mbox{\hyperlink{classsrsran_1_1prach__buffer}{prach\+\_\+buffer}} \&}]{buffer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Requests the Open Fronthaul to capture a PRACH window. 

The Open Fronthaul must capture the window identified by {\ttfamily context}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em context} & PRACH window context. \\
\hline
\mbox{\texttt{ in}}  & {\em buffer} & PRACH buffer used to write the PRACH window. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1ofh_1_1uplink__request__handler_a41542e3a5f5412808b23c9123fe27449}{srsran\+::ofh\+::uplink\+\_\+request\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00074\ \{}
\DoxyCodeLine{00075\ \ \ logger.debug(\textcolor{stringliteral}{"{}Registering\ PRACH\ context\ entry\ for\ slot\ '\{\}'\ and\ sector\#\{\}"{}},\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a814ea3070cc63fb8dff774e11223cddf}{slot}},\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_aac17f389286b5f746f90619989c0ee90}{sector}});}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ frame\_pool.\mbox{\hyperlink{classsrsran_1_1ether_1_1eth__frame__pool_a9b2a69ccee89c621193c915f23ed11f2}{clear\_uplink\_slot}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a814ea3070cc63fb8dff774e11223cddf}{slot}},\ logger);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \textcolor{comment}{//\ Sampling\ rate\ defining\ the\ \(\backslash\)f\$T\_s\ =\ 1/(\(\backslash\)Delta\ f\_\{ref\}\ \(\backslash\)times\ N\_\{f,ref\})\(\backslash\)f\$\ parameter,\ see\ 3GPP\ TS38.211,}}
\DoxyCodeLine{00080\ \ \ \textcolor{comment}{//\ clause\ 4.1.}}
\DoxyCodeLine{00081\ \ \ \textcolor{comment}{//\ Open\ Fronthaul\ parameters\ timeOffset\ and\ cpLength\ are\ expressed\ in\ multiple\ of\ \(\backslash\)f\$T\_s\(\backslash\)f\$\ units.}}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ref\_srate\_Hz}}\ =\ 30.72e6;}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ Get\ preamble\ information\ (assuming\ only\ single\ occasion\ is\ supported).}}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{structsrsran_1_1prach__preamble__information}{prach\_preamble\_information}}\ preamble\_info\ =}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_aaea6c484cd5f8113a5b11434d68e371b}{is\_long\_preamble}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a75071d89f12c9df9cba8d45a312738db}{format}})}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ ?\ \mbox{\hyperlink{namespacesrsran_a41d072dc823c78c2627da83a877dcf5a}{get\_prach\_preamble\_long\_info}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a75071d89f12c9df9cba8d45a312738db}{format}})}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{namespacesrsran_a33cfd882b612da5eceff76a95662d0b3}{get\_prach\_preamble\_short\_info}}(context.format,\ \mbox{\hyperlink{namespacesrsran_a0d5bec5128991413e4e3a59ca6e16426}{to\_ra\_subcarrier\_spacing}}(context.pusch\_scs),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{true}});}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ Store\ the\ context\ in\ the\ repository,\ use\ correct\ slot\ index\ for\ long\ format\ accounting\ for\ PRACH\ duration.}}
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a7c2e3c58a56b57be024f8bfc3271186d}{is\_short\_preamble}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a75071d89f12c9df9cba8d45a312738db}{format}}))\ \{}
\DoxyCodeLine{00092\ \ \ \ \ ul\_prach\_repo.\mbox{\hyperlink{classsrsran_1_1ofh_1_1prach__context__repository_a5690531464cd4ef63cf6a844d64ac6fe}{add}}(context,\ buffer);}
\DoxyCodeLine{00093\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ nof\_symbols\_per\_slot\ =\ \mbox{\hyperlink{namespacesrsran_aa1d2bd5d3008afda19c0949d241a73f7}{get\_nsymb\_per\_slot}}(\mbox{\hyperlink{classsrsran_1_1cyclic__prefix_adb112068f1eb62e47a74b63b90d92b65a464683a58c4e07f845370a0eb40a0b67}{cyclic\_prefix::NORMAL}});}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_duration\_msec}}\ =}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a27de82e40cbcf71e597b17912aaf7722}{SUBFRAME\_DURATION\_MSEC}})\ /}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a45b408115d2fba72e768ef375c59da19}{get\_nof\_slots\_per\_subframe}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a62e868abf420e4401a860311e53309f9}{pusch\_scs}})\ *\ nof\_symbols\_per\_slot);}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{len\_msecs}}\ \ \ =\ (preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}.\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a2ff9cda97bc4196edee275927c1d9430}{to\_seconds}}()\ +\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_aef1493b57fbc2fdbc433976b4bdec7f4}{symbol\_length}}.\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a2ff9cda97bc4196edee275927c1d9430}{to\_seconds}}())\ *\ 1000;}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ nof\_symbols\ =\ std::ceil(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{len\_msecs}}\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_duration\_msec}});}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ prach\_length\_slots\ =}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ std::ceil(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a1530821e8cd26832c55cf63ceecaac38}{start\_symbol}}\ +\ nof\_symbols)\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(nof\_symbols\_per\_slot));}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ Subtract\ one\ to\ account\ for\ the\ current\ slot.}}
\DoxyCodeLine{00107\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1slot__point}{slot\_point}}\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ =\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a814ea3070cc63fb8dff774e11223cddf}{slot}}\ +\ (prach\_length\_slots\ -\/\ 1);}
\DoxyCodeLine{00108\ \ \ \ \ ul\_prach\_repo.\mbox{\hyperlink{classsrsran_1_1ofh_1_1prach__context__repository_a5690531464cd4ef63cf6a844d64ac6fe}{add}}(context,\ buffer,\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}});}
\DoxyCodeLine{00109\ \ \ \}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{if}\ (!is\_prach\_cp\_enabled)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{comment}{//\ Get\ frequency\ mapping\ information.}}
\DoxyCodeLine{00116\ \ \ \mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information}{prach\_frequency\_mapping\_information}}\ freq\_mapping\_info\ =}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a4ec686128158cd9524f64b7df77762bd}{prach\_frequency\_mapping\_get}}(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}},\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a62e868abf420e4401a860311e53309f9}{pusch\_scs}});}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \textcolor{comment}{//\ Add\ sixteen\ kappa\ to\ the\ cyclic\ prefix\ for\ short\ preamble.}}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a7c2e3c58a56b57be024f8bfc3271186d}{is\_short\_preamble}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a75071d89f12c9df9cba8d45a312738db}{format}}))\ \{}
\DoxyCodeLine{00121\ \ \ \ \ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}\ +=\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_aec95e7a791907476aea8a4fb4c7c1f2b}{phy\_time\_unit::from\_units\_of\_kappa}}(16);}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{unsigned}\ cp\_length\ =\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}.\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ref\_srate\_Hz}});}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ Determine\ the\ last\ symbol\ that\ starts\ right\ at\ or\ before\ the\ PRACH\ preamble\ (after\ the\ cyclic\ prefix).}}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pusch\_symbol\_duration}}\ =}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_aec95e7a791907476aea8a4fb4c7c1f2b}{phy\_time\_unit::from\_units\_of\_kappa}}((144U\ +\ 2048U)\ >>\ \mbox{\hyperlink{namespacesrsran_a226e52de355262a1ad4e998b4cedefd7}{to\_numerology\_value}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a62e868abf420e4401a860311e53309f9}{pusch\_scs}}))}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ .\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ref\_srate\_Hz}});}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{unsigned}\ prach\_start\_symbol\ =\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a1530821e8cd26832c55cf63ceecaac38}{start\_symbol}}\ +\ (cp\_length\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pusch\_symbol\_duration}});}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{keywordtype}{unsigned}\ K\ =\ (1000\ *\ \mbox{\hyperlink{namespacesrsran_a8c3848f1144990e3777cdc7e1ab27cf7}{scs\_to\_khz}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a62e868abf420e4401a860311e53309f9}{pusch\_scs}}))\ /\ \mbox{\hyperlink{namespacesrsran_a4172874a14aceea21d35086683d66f1b}{ra\_scs\_to\_Hz}}(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}});}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \mbox{\hyperlink{structsrsran_1_1ofh_1_1data__flow__cplane__scheduling__prach__context}{data\_flow\_cplane\_scheduling\_prach\_context}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}};}
\DoxyCodeLine{00134\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.\mbox{\hyperlink{structsrsran_1_1ofh_1_1data__flow__cplane__scheduling__prach__context_acdbfb0a50584458cfdfddfa7c47e6b3f}{slot}}\ \ \ \ \ \ \ \ \ \ \ \ =\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a814ea3070cc63fb8dff774e11223cddf}{slot}};}
\DoxyCodeLine{00135\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.nof\_repetitions\ =\ \mbox{\hyperlink{namespacesrsran_a7c4ecbbc13088764ba440e5bb5f62a35}{get\_preamble\_duration}}(context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a75071d89f12c9df9cba8d45a312738db}{format}});}
\DoxyCodeLine{00136\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.start\_symbol\ \ \ \ =\ prach\_start\_symbol;}
\DoxyCodeLine{00137\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.prach\_scs\ \ \ \ \ \ \ =\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}};}
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.scs\ \ \ \ \ \ \ \ \ \ \ \ \ =\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a62e868abf420e4401a860311e53309f9}{pusch\_scs}};}
\DoxyCodeLine{00139\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.prach\_nof\_rb\ \ \ \ =\ freq\_mapping\_info.\mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information_a3b237981f4c93ec4f4521c0ba1d09f4d}{nof\_rb\_ra}}\ *\ K;}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.time\_offset\ \ \ \ \ =\ cp\_length;}
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.prach\_start\_re\ \ =\ context.\mbox{\hyperlink{structsrsran_1_1prach__buffer__context_a6f03c08346fd55383e612f5d7d9358e4}{rb\_offset}}\ *\ K\ *\ \mbox{\hyperlink{namespacesrsran_a1d73f866251b700d7747204655a84500}{NOF\_SUBCARRIERS\_PER\_RB}};}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ Determine\ Open\ Fronthaul\ filter\ index.}}
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.filter\_type\ =\ get\_prach\_cplane\_filter\_index(context,\ preamble\_info);}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ eaxc\ :\ prach\_eaxc)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}}.eaxc\ =\ eaxc;}
\DoxyCodeLine{00148\ \ \ \ \ data\_flow-\/>enqueue\_section\_type\_3\_prach\_message(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cp\_prach\_context}});}
\DoxyCodeLine{00149\ \ \ \}}
\DoxyCodeLine{00150\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/ofh/transmitter/ofh\+\_\+uplink\+\_\+request\+\_\+handler\+\_\+impl.\+h\item 
lib/ofh/transmitter/ofh\+\_\+uplink\+\_\+request\+\_\+handler\+\_\+impl.\+cpp\end{DoxyCompactItemize}
