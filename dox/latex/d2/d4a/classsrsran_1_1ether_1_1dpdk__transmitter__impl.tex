\doxysection{srsran\+::ether\+::dpdk\+\_\+transmitter\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1ether_1_1dpdk__transmitter__impl}{}\label{classsrsran_1_1ether_1_1dpdk__transmitter__impl}\index{srsran::ether::dpdk\_transmitter\_impl@{srsran::ether::dpdk\_transmitter\_impl}}


DPDK Ethernet transmitter implementation.  




{\ttfamily \#include $<$dpdk\+\_\+ethernet\+\_\+transmitter.\+h$>$}



Inheritance diagram for srsran\+::ether\+::dpdk\+\_\+transmitter\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{d3/dd7/classsrsran_1_1ether_1_1dpdk__transmitter__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::ether\+::dpdk\+\_\+transmitter\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{dd/dde/classsrsran_1_1ether_1_1dpdk__transmitter__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1ether_1_1dpdk__transmitter__impl_a1f962d45b55b4976a9b2808b1ef82fd2}{dpdk\+\_\+transmitter\+\_\+impl}} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1ether_1_1dpdk__port__context}{dpdk\+\_\+port\+\_\+context}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\+\_\+ctx\+\_\+ptr\+\_\+}}, \mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ether_1_1dpdk__transmitter__impl_aba6afddefc624c74d7d830adaaeae7ef}{send}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ $>$ frames) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Sends the given list of frames through the underlying Ethernet link. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1ether_1_1gateway}{srsran\+::ether\+::gateway}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}gateway} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
DPDK Ethernet transmitter implementation. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1ether_1_1dpdk__transmitter__impl_a1f962d45b55b4976a9b2808b1ef82fd2}\label{classsrsran_1_1ether_1_1dpdk__transmitter__impl_a1f962d45b55b4976a9b2808b1ef82fd2} 
\index{srsran::ether::dpdk\_transmitter\_impl@{srsran::ether::dpdk\_transmitter\_impl}!dpdk\_transmitter\_impl@{dpdk\_transmitter\_impl}}
\index{dpdk\_transmitter\_impl@{dpdk\_transmitter\_impl}!srsran::ether::dpdk\_transmitter\_impl@{srsran::ether::dpdk\_transmitter\_impl}}
\doxysubsubsection{\texorpdfstring{dpdk\_transmitter\_impl()}{dpdk\_transmitter\_impl()}}
{\footnotesize\ttfamily srsran\+::ether\+::dpdk\+\_\+transmitter\+\_\+impl\+::dpdk\+\_\+transmitter\+\_\+impl (\begin{DoxyParamCaption}\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1ether_1_1dpdk__port__context}{dpdk\+\_\+port\+\_\+context}} $>$}]{port\+\_\+ctx\+\_\+ptr\+\_\+,  }\item[{\mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \&}]{logger\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00039\ \ \ \ \ logger(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\_}}),\ port\_ctx\_ptr(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_ctx\_ptr\_}})),\ port\_ctx(*port\_ctx\_ptr)}
\DoxyCodeLine{00040\ \ \ \{}
\DoxyCodeLine{00041\ \ \ \ \ srsran\_assert(port\_ctx\_ptr,\ \textcolor{stringliteral}{"{}Invalid\ port\ context"{}});}
\DoxyCodeLine{00042\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1ether_1_1dpdk__transmitter__impl_aba6afddefc624c74d7d830adaaeae7ef}\label{classsrsran_1_1ether_1_1dpdk__transmitter__impl_aba6afddefc624c74d7d830adaaeae7ef} 
\index{srsran::ether::dpdk\_transmitter\_impl@{srsran::ether::dpdk\_transmitter\_impl}!send@{send}}
\index{send@{send}!srsran::ether::dpdk\_transmitter\_impl@{srsran::ether::dpdk\_transmitter\_impl}}
\doxysubsubsection{\texorpdfstring{send()}{send()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} dpdk\+\_\+transmitter\+\_\+impl\+::send (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ $>$}]{frames }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Sends the given list of frames through the underlying Ethernet link. 



Implements \mbox{\hyperlink{classsrsran_1_1ether_1_1gateway_ad719b85c280c746f6c3991531e02f930}{srsran\+::ether\+::gateway}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{if}\ (frames.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ >=\ MAX\_BURST\_SIZE)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Unable\ to\ send\ a\ transmission\ burst\ size\ of\ '\{\}'\ frames\ in\ the\ DPDK\ Ethernet\ transmitter"{}},}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ frames.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00037\ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector<::rte\_mbuf*,\ MAX\_BURST\_SIZE>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}(frames.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_pktmbuf\_alloc\_bulk}}(port\_ctx.\mbox{\hyperlink{classsrsran_1_1ether_1_1dpdk__port__context_aa7ee82a40c6656e1336b7a5e1c0d7008}{get\_mempool}}(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.data(),\ frames.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}())\ <\ 0)\ \{}
\DoxyCodeLine{00041\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Not\ enough\ entries\ in\ the\ mempool\ to\ send\ '\{\}'\ frames\ in\ the\ DPDK\ Ethernet\ transmitter"{}},}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ frames.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ idx\ =\ 0,\ end\ =\ frames.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}();\ idx\ !=\ end;\ ++idx)\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}\ =\ frames[idx];}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_mbuf}}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbuf}}\ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}[idx];}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_pktmbuf\_append}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbuf}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}.size())\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_pktmbuf\_free}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbuf}});}
\DoxyCodeLine{00052\ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Unable\ to\ append\ '\{\}'\ bytes\ to\ the\ allocated\ mbuf\ in\ the\ DPDK\ Ethernet\ transmitter"{}},}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}.size());}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_pktmbuf\_free\_bulk}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.data(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.size());}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00056\ \ \ \ \ \}}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbuf}}-\/>data\_len\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}.size();}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbuf}}-\/>pkt\_len\ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}.size();}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}*\ data\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rte\_pktmbuf\_mtod}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbuf}},\ \mbox{\hyperlink{classuint8__t}{uint8\_t}}*);}
\DoxyCodeLine{00061\ \ \ \ \ std::memcpy(data,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}.data(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{frame}}.size());}
\DoxyCodeLine{00062\ \ \ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_sent\_packets}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_eth\_tx\_burst}}(port\_ctx.\mbox{\hyperlink{classsrsran_1_1ether_1_1dpdk__port__context_a2b7c700be4b618b2a62c7651e2db53d3}{get\_port\_id}}(),\ 0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.data(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.size());}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{compiler_8h_a1bdfef20c1237666a841b5c9b9c8e69b}{SRSRAN\_UNLIKELY}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_sent\_packets}}\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.size()))\ \{}
\DoxyCodeLine{00067\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}DPDK\ dropped\ '\{\}'\ packets\ out\ of\ a\ total\ of\ '\{\}'\ in\ the\ tx\ burst"{}},}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.size()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_sent\_packets}},}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.size());}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{buf\_idx}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_sent\_packets}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{last\_idx}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}.size();\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{buf\_idx}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{last\_idx}};\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{buf\_idx}})\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{::rte\_pktmbuf\_free}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mbufs}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{buf\_idx}}]);}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/ofh/ethernet/dpdk/dpdk\+\_\+ethernet\+\_\+transmitter.\+h\item 
lib/ofh/ethernet/dpdk/dpdk\+\_\+ethernet\+\_\+transmitter.\+cpp\end{DoxyCompactItemize}
