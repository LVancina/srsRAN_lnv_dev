\doxysection{srsran\+::fapi\+\_\+adaptor\+::mac\+\_\+to\+\_\+fapi\+\_\+translator Class Reference}
\hypertarget{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator}{}\label{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator}\index{srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}}


MAC-\/to-\/\+FAPI translator.  




{\ttfamily \#include $<$mac\+\_\+to\+\_\+fapi\+\_\+translator.\+h$>$}



Inheritance diagram for srsran\+::fapi\+\_\+adaptor\+::mac\+\_\+to\+\_\+fapi\+\_\+translator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{db/d2c/classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::fapi\+\_\+adaptor\+::mac\+\_\+to\+\_\+fapi\+\_\+translator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{d0/db4/classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_aa9a9dbd341a1f6e135795616444b52ec}{mac\+\_\+to\+\_\+fapi\+\_\+translator}} (\mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__message__gateway}{fapi\+::slot\+\_\+message\+\_\+gateway}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{msg\+\_\+gw\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__last__message__notifier}{fapi\+::slot\+\_\+last\+\_\+message\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{last\+\_\+msg\+\_\+notifier\+\_\+}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1precoding__matrix__mapper}{precoding\+\_\+matrix\+\_\+mapper}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pm\+\_\+mapper\+\_\+}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1uci__part2__correspondence__mapper}{uci\+\_\+part2\+\_\+correspondence\+\_\+mapper}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{part2\+\_\+mapper\+\_\+}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\+\_\+nof\+\_\+prbs\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a80ba7a09b76c852ce89a1689107ef7c1}{on\+\_\+new\+\_\+downlink\+\_\+scheduler\+\_\+results}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1mac__dl__sched__result}{mac\+\_\+dl\+\_\+sched\+\_\+result}} \&dl\+\_\+res) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Notifies scheduled SSB/\+PDCCH/\+PDSCH grants. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a3c528fd905a14735515d278d292c7058}{on\+\_\+new\+\_\+downlink\+\_\+data}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1mac__dl__data__result}{mac\+\_\+dl\+\_\+data\+\_\+result}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\+\_\+data}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Notifies scheduled PDSCH PDUs. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a402867ce9af3ed782271f03652767b0d}{on\+\_\+new\+\_\+uplink\+\_\+scheduler\+\_\+results}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1mac__ul__sched__result}{mac\+\_\+ul\+\_\+sched\+\_\+result}} \&ul\+\_\+res) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Notifies slot scheduled PUCCH/\+PUSCH grants. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a3862769c2da7345dfef4793709b4ffbb}{on\+\_\+cell\+\_\+results\+\_\+completion}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Notifies the completion of all cell results for the given slot. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
MAC-\/to-\/\+FAPI translator. 

This class listens to cell-\/specific MAC events carrying scheduling results and translates them into FAPI messages that are sent through the FAPI message gateway. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_aa9a9dbd341a1f6e135795616444b52ec}\label{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_aa9a9dbd341a1f6e135795616444b52ec} 
\index{srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}!mac\_to\_fapi\_translator@{mac\_to\_fapi\_translator}}
\index{mac\_to\_fapi\_translator@{mac\_to\_fapi\_translator}!srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}}
\doxysubsubsection{\texorpdfstring{mac\_to\_fapi\_translator()}{mac\_to\_fapi\_translator()}}
{\footnotesize\ttfamily srsran\+::fapi\+\_\+adaptor\+::mac\+\_\+to\+\_\+fapi\+\_\+translator\+::mac\+\_\+to\+\_\+fapi\+\_\+translator (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \&}]{logger\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__message__gateway}{fapi\+::slot\+\_\+message\+\_\+gateway}} \&}]{msg\+\_\+gw\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__last__message__notifier}{fapi\+::slot\+\_\+last\+\_\+message\+\_\+notifier}} \&}]{last\+\_\+msg\+\_\+notifier\+\_\+,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1precoding__matrix__mapper}{precoding\+\_\+matrix\+\_\+mapper}} $>$}]{pm\+\_\+mapper\+\_\+,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1fapi__adaptor_1_1uci__part2__correspondence__mapper}{uci\+\_\+part2\+\_\+correspondence\+\_\+mapper}} $>$}]{part2\+\_\+mapper\+\_\+,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{cell\+\_\+nof\+\_\+prbs\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00052\ \ \ \ \ logger(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\_}}),}
\DoxyCodeLine{00053\ \ \ \ \ msg\_gw(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{msg\_gw\_}}),}
\DoxyCodeLine{00054\ \ \ \ \ last\_msg\_notifier(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{last\_msg\_notifier\_}}),}
\DoxyCodeLine{00055\ \ \ \ \ pm\_mapper(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pm\_mapper\_}})),}
\DoxyCodeLine{00056\ \ \ \ \ part2\_mapper(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{part2\_mapper\_}})),}
\DoxyCodeLine{00057\ \ \ \ \ cell\_nof\_prbs(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_nof\_prbs\_}})}
\DoxyCodeLine{00058\ \ \ \{}
\DoxyCodeLine{00059\ \ \ \ \ srsran\_assert(pm\_mapper,\ \textcolor{stringliteral}{"{}Invalid\ precoding\ matrix\ mapper"{}});}
\DoxyCodeLine{00060\ \ \ \ \ srsran\_assert(part2\_mapper,\ \textcolor{stringliteral}{"{}Invalid\ Part2\ mapper"{}});}
\DoxyCodeLine{00061\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a3862769c2da7345dfef4793709b4ffbb}\label{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a3862769c2da7345dfef4793709b4ffbb} 
\index{srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}!on\_cell\_results\_completion@{on\_cell\_results\_completion}}
\index{on\_cell\_results\_completion@{on\_cell\_results\_completion}!srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}}
\doxysubsubsection{\texorpdfstring{on\_cell\_results\_completion()}{on\_cell\_results\_completion()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} mac\+\_\+to\+\_\+fapi\+\_\+translator\+::on\+\_\+cell\+\_\+results\+\_\+completion (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies the completion of all cell results for the given slot. 



Implements \mbox{\hyperlink{classsrsran_1_1mac__cell__result__notifier_aa2aafc4fdfc432b920631112a36e25b7}{srsran\+::mac\+\_\+cell\+\_\+result\+\_\+notifier}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00372\ \{}
\DoxyCodeLine{00373\ \ \ last\_msg\_notifier.\mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__last__message__notifier_a92370c1a42f9f34dc35745ecfab888da}{on\_last\_message}}(\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}});}
\DoxyCodeLine{00374\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a3c528fd905a14735515d278d292c7058}\label{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a3c528fd905a14735515d278d292c7058} 
\index{srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}!on\_new\_downlink\_data@{on\_new\_downlink\_data}}
\index{on\_new\_downlink\_data@{on\_new\_downlink\_data}!srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}}
\doxysubsubsection{\texorpdfstring{on\_new\_downlink\_data()}{on\_new\_downlink\_data()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} mac\+\_\+to\+\_\+fapi\+\_\+translator\+::on\+\_\+new\+\_\+downlink\+\_\+data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1mac__dl__data__result}{mac\+\_\+dl\+\_\+data\+\_\+result}} \&}]{dl\+\_\+data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies scheduled PDSCH PDUs. 



Implements \mbox{\hyperlink{classsrsran_1_1mac__cell__result__notifier_a7529a2aecae2b5d5fe40fcc0a085692a}{srsran\+::mac\+\_\+cell\+\_\+result\+\_\+notifier}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00245\ \{}
\DoxyCodeLine{00246\ \ \ srsran\_assert(!\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.si\_pdus.empty()\ ||\ !\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.rar\_pdus.empty()\ ||\ !\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.ue\_pdus.empty()\ ||}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.paging\_pdus.empty(),}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Received\ a\ mac\_dl\_data\_result\ object\ with\ zero\ payloads"{}});}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \mbox{\hyperlink{structsrsran_1_1fapi_1_1tx__data__request__message}{fapi::tx\_data\_request\_message}}\ msg;}
\DoxyCodeLine{00251\ \ \ \mbox{\hyperlink{classsrsran_1_1fapi_1_1tx__data__request__builder}{fapi::tx\_data\_request\_builder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}(msg);}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.set\_basic\_parameters(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.slot.sfn(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.slot.slot\_index());}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \textcolor{comment}{//\ Make\ sure\ PDUs\ are\ added\ to\ the\ builder\ in\ the\ same\ order\ as\ for\ the\ DL\_TTI.request\ message.}}
\DoxyCodeLine{00256\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}}\ =\ 0;}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \textcolor{comment}{//\ Add\ SIB1\ PDUs\ to\ the\ Tx\_Data.request\ message.}}
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.si\_pdus)\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_pdu\_custom\_payload(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}},\ pdu.cw\_index,\ \{pdu.pdu.data(),\ pdu.pdu.size()\});}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{keywordflow}{if}\ (pdu.cw\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}};}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \textcolor{comment}{//\ Add\ RAR\ PDUs\ to\ the\ Tx\_Data.request\ message.}}
\DoxyCodeLine{00267\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.rar\_pdus)\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_pdu\_custom\_payload(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}},\ pdu.cw\_index,\ \{pdu.pdu.data(),\ pdu.pdu.size()\});}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{if}\ (pdu.cw\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}};}
\DoxyCodeLine{00271\ \ \ \ \ \}}
\DoxyCodeLine{00272\ \ \ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ Add\ UE\ specific\ PDUs\ to\ the\ Tx\_Data.request\ message.}}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.ue\_pdus)\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_pdu\_custom\_payload(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}},\ pdu.cw\_index,\ \{pdu.pdu.data(),\ pdu.pdu.size()\});}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{if}\ (pdu.cw\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}};}
\DoxyCodeLine{00279\ \ \ \ \ \}}
\DoxyCodeLine{00280\ \ \ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \textcolor{comment}{//\ Add\ Paging\ PDU\ to\ the\ Tx\_Data.request\ message.}}
\DoxyCodeLine{00283\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data}}.paging\_pdus)\ \{}
\DoxyCodeLine{00284\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_pdu\_custom\_payload(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}},\ pdu.cw\_index,\ \{pdu.pdu.data(),\ pdu.pdu.size()\});}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordflow}{if}\ (pdu.cw\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fapi\_index}};}
\DoxyCodeLine{00287\ \ \ \ \ \}}
\DoxyCodeLine{00288\ \ \ \}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \textcolor{comment}{//\ Send\ the\ message.}}
\DoxyCodeLine{00291\ \ \ msg\_gw.\mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__message__gateway_aaa73d2080c75baa3ae8fbeac47524f09}{tx\_data\_request}}(msg);}
\DoxyCodeLine{00292\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a80ba7a09b76c852ce89a1689107ef7c1}\label{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a80ba7a09b76c852ce89a1689107ef7c1} 
\index{srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}!on\_new\_downlink\_scheduler\_results@{on\_new\_downlink\_scheduler\_results}}
\index{on\_new\_downlink\_scheduler\_results@{on\_new\_downlink\_scheduler\_results}!srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}}
\doxysubsubsection{\texorpdfstring{on\_new\_downlink\_scheduler\_results()}{on\_new\_downlink\_scheduler\_results()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} mac\+\_\+to\+\_\+fapi\+\_\+translator\+::on\+\_\+new\+\_\+downlink\+\_\+scheduler\+\_\+results (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1mac__dl__sched__result}{mac\+\_\+dl\+\_\+sched\+\_\+result}} \&}]{dl\+\_\+res }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies scheduled SSB/\+PDCCH/\+PDSCH grants. 



Implements \mbox{\hyperlink{classsrsran_1_1mac__cell__result__notifier_a455b4a208bbff1b8d0d49c13743b4155}{srsran\+::mac\+\_\+cell\+\_\+result\+\_\+notifier}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00189\ \{}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{structsrsran_1_1fapi_1_1dl__tti__request__message}{fapi::dl\_tti\_request\_message}}\ \ \ \ \ \ \ \ \ msg;}
\DoxyCodeLine{00191\ \ \ \mbox{\hyperlink{classsrsran_1_1fapi_1_1dl__tti__request__message__builder}{fapi::dl\_tti\_request\_message\_builder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}(msg);}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{comment}{//\ This\ FAPI\ implementation\ does\ not\ support\ PDU\ groups.}}
\DoxyCodeLine{00194\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\_pdu\_groups}}\ =\ 0;}
\DoxyCodeLine{00195\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.set\_basic\_parameters(dl\_res.slot.\mbox{\hyperlink{classsrsran_1_1slot__point_a19d7b2faaa1fcc74f3d01560339f7602}{sfn}}(),\ dl\_res.slot.\mbox{\hyperlink{classsrsran_1_1slot__point_a1808c0aeecc25d6382e49511028c010e}{slot\_index}}(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\_pdu\_groups}});}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \textcolor{comment}{//\ Add\ PDCCH\ PDUs\ to\ the\ DL\_TTI.request\ message.}}
\DoxyCodeLine{00198\ \ \ add\_pdcch\_pdus\_to\_builder(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}},}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ pdcch\_dl\_information>}}(dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_aae1df8a425201c6ebfb91c26fcc9df00}{dl\_pdcchs}}),}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dl\_res.dl\_pdcch\_pdus,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *pm\_mapper,}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cell\_nof\_prbs);}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \textcolor{comment}{//\ Add\ SSB\ PDUs\ to\ the\ DL\_TTI.request\ message.}}
\DoxyCodeLine{00205\ \ \ add\_ssb\_pdus\_to\_dl\_request(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}},\ dl\_res.ssb\_pdus);}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \textcolor{comment}{//\ Add\ CSI-\/RS\ PDUs\ to\ the\ DL\_TTI.request\ message.}}
\DoxyCodeLine{00208\ \ \ add\_csi\_rs\_pdus\_to\_dl\_request(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}},\ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_a016a37fd1ee0275aad81e1302eeb395e}{csi\_rs}});}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{comment}{//\ Add\ PDSCH\ PDUs\ to\ the\ DL\_TTI.request\ message.}}
\DoxyCodeLine{00211\ \ \ add\_pdsch\_pdus\_to\_dl\_request(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}},}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_a5ee9878bb01a4726e669e1e41dd37c30}{bc}}.sibs,}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_abaf1262de8629958b0e85372e63c0fc9}{rar\_grants}},}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_a48c4421ab1c01922b6aafbb094004231}{ue\_grants}},}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_ad86a99e2d4e1564815505bcf2cdfb324}{paging\_grants}},}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_a016a37fd1ee0275aad81e1302eeb395e}{csi\_rs}}.size(),}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *pm\_mapper,}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cell\_nof\_prbs);}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_pdsch\_pdu\_present\_in\_dl\_tti}}\ =\ msg.num\_pdus\_of\_each\_type[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(fapi::dl\_pdu\_type::PDSCH)]\ !=\ 0;}
\DoxyCodeLine{00221\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_ul\_dci\_present}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_abb0d6170cb04bf1b8ee85a8382327396}{ul\_pdcchs}}.size()\ !=\ 0;}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_pdsch\_pdu\_present\_in\_dl\_tti}}\ \&\&\ !\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_ul\_dci\_present}})\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.set\_last\_message\_in\_slot\_flag();}
\DoxyCodeLine{00225\ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \textcolor{comment}{//\ Validate\ the\ DL\_TTI.request\ message.}}
\DoxyCodeLine{00228\ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{error\_type<fapi::validator\_report>}}\ result\ =\ validate\_dl\_tti\_request(msg);}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \textcolor{keywordflow}{if}\ (!result)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ log\_validator\_report(result.error(),\ logger);}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ clear\_dl\_tti\_pdus(msg);}
\DoxyCodeLine{00234\ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{comment}{//\ Send\ the\ message.}}
\DoxyCodeLine{00237\ \ \ msg\_gw.\mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__message__gateway_ac0393eaddf0f8a34c1d543866a636779}{dl\_tti\_request}}(msg);}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_ul\_dci\_last\_message\_in\_slot}}\ =\ !\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_pdsch\_pdu\_present\_in\_dl\_tti}}\ \&\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_ul\_dci\_present}};}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ handle\_ul\_dci\_request(dl\_res.dl\_res-\/>\mbox{\hyperlink{structsrsran_1_1dl__sched__result_abb0d6170cb04bf1b8ee85a8382327396}{ul\_pdcchs}},\ dl\_res.ul\_pdcch\_pdus,\ dl\_res.slot,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_ul\_dci\_last\_message\_in\_slot}});}
\DoxyCodeLine{00242\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a402867ce9af3ed782271f03652767b0d}\label{classsrsran_1_1fapi__adaptor_1_1mac__to__fapi__translator_a402867ce9af3ed782271f03652767b0d} 
\index{srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}!on\_new\_uplink\_scheduler\_results@{on\_new\_uplink\_scheduler\_results}}
\index{on\_new\_uplink\_scheduler\_results@{on\_new\_uplink\_scheduler\_results}!srsran::fapi\_adaptor::mac\_to\_fapi\_translator@{srsran::fapi\_adaptor::mac\_to\_fapi\_translator}}
\doxysubsubsection{\texorpdfstring{on\_new\_uplink\_scheduler\_results()}{on\_new\_uplink\_scheduler\_results()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} mac\+\_\+to\+\_\+fapi\+\_\+translator\+::on\+\_\+new\+\_\+uplink\+\_\+scheduler\+\_\+results (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1mac__ul__sched__result}{mac\+\_\+ul\+\_\+sched\+\_\+result}} \&}]{ul\+\_\+res }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Notifies slot scheduled PUCCH/\+PUSCH grants. 



Implements \mbox{\hyperlink{classsrsran_1_1mac__cell__result__notifier_a48f4b5a78472f0df38653cab7300ec3f}{srsran\+::mac\+\_\+cell\+\_\+result\+\_\+notifier}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00302\ \{}
\DoxyCodeLine{00303\ \ \ \mbox{\hyperlink{structsrsran_1_1fapi_1_1ul__tti__request__message}{fapi::ul\_tti\_request\_message}}\ \ \ \ \ \ \ \ \ msg;}
\DoxyCodeLine{00304\ \ \ \mbox{\hyperlink{classsrsran_1_1fapi_1_1ul__tti__request__message__builder}{fapi::ul\_tti\_request\_message\_builder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}(msg);}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \textcolor{comment}{//\ :TODO:\ Should\ we\ check\ here\ the\ numerology\ matches\ incoming\ slot\ and\ configured\ numerology\ for\ cell?}}
\DoxyCodeLine{00307\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.set\_basic\_parameters(ul\_res.slot.\mbox{\hyperlink{classsrsran_1_1slot__point_a19d7b2faaa1fcc74f3d01560339f7602}{sfn}}(),\ ul\_res.slot.\mbox{\hyperlink{classsrsran_1_1slot__point_a1808c0aeecc25d6382e49511028c010e}{slot\_index}}());}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \textcolor{comment}{//\ Add\ PRACH\ PDUs\ to\ the\ UL\_TTI.request\ message.}}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ ul\_res.ul\_res-\/>prachs)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1fapi_1_1ul__prach__pdu__builder}{fapi::ul\_prach\_pdu\_builder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_builder}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_prach\_pdu();}
\DoxyCodeLine{00312\ \ \ \ \ convert\_prach\_mac\_to\_fapi(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_builder}},\ pdu);}
\DoxyCodeLine{00313\ \ \ \}}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \textcolor{comment}{//\ Add\ PUSCH\ PDUs\ to\ the\ UL\_TTI.request\ message.}}
\DoxyCodeLine{00316\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ ul\_res.ul\_res-\/>puschs)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1fapi_1_1ul__pusch__pdu__builder}{fapi::ul\_pusch\_pdu\_builder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_builder}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_pusch\_pdu();}
\DoxyCodeLine{00318\ \ \ \ \ convert\_pusch\_mac\_to\_fapi(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_builder}},\ pdu,\ *part2\_mapper);}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ :\ ul\_res.ul\_res-\/>pucchs)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1fapi_1_1ul__pucch__pdu__builder}{fapi::ul\_pucch\_pdu\_builder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_builder}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{builder}}.add\_pucch\_pdu(pdu.format);}
\DoxyCodeLine{00323\ \ \ \ \ convert\_pucch\_mac\_to\_fapi(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_builder}},\ pdu);}
\DoxyCodeLine{00324\ \ \ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \textcolor{comment}{//\ Validate\ the\ UL\_TTI.request\ message.}}
\DoxyCodeLine{00327\ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{error\_type<fapi::validator\_report>}}\ result\ =\ validate\_ul\_tti\_request(msg);}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \textcolor{keywordflow}{if}\ (!result)\ \{}
\DoxyCodeLine{00330\ \ \ \ \ log\_validator\_report(result.error(),\ logger);}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ clear\_ul\_tti\_pdus(msg);}
\DoxyCodeLine{00333\ \ \ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \textcolor{comment}{//\ Send\ the\ message.}}
\DoxyCodeLine{00336\ \ \ msg\_gw.\mbox{\hyperlink{classsrsran_1_1fapi_1_1slot__message__gateway_a9709e82f938215b584dce8b63927aa60}{ul\_tti\_request}}(msg);}
\DoxyCodeLine{00337\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/fapi\+\_\+adaptor/mac/mac\+\_\+to\+\_\+fapi\+\_\+translator.\+h\item 
lib/fapi\+\_\+adaptor/mac/mac\+\_\+to\+\_\+fapi\+\_\+translator.\+cpp\end{DoxyCompactItemize}
