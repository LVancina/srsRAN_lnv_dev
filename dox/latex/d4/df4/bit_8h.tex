\doxysection{include/srsran/srsvec/bit.h File Reference}
\hypertarget{bit_8h}{}\label{bit_8h}\index{include/srsran/srsvec/bit.h@{include/srsran/srsvec/bit.h}}


Bit manipulation function declarations.  


{\ttfamily \#include "{}srsran/adt/bit\+\_\+buffer.\+h"{}}\newline
{\ttfamily \#include "{}srsran/adt/span.\+h"{}}\newline
{\ttfamily \#include "{}srsran/phy/upper/log\+\_\+likelihood\+\_\+ratio.\+h"{}}\newline
{\ttfamily \#include $<$cstdint$>$}\newline
Include dependency graph for bit.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{db/de4/bit_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/d52/bit_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacesrsran}{srsran}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ \mbox{\hyperlink{bit_8h_ab8c0c071f2ec3061b8182a047ae0a11b}{srsran\+::srsvec\+::bit\+\_\+unpack}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ bits, \mbox{\hyperlink{classunsigned}{unsigned}} value, \mbox{\hyperlink{classunsigned}{unsigned}} nof\+\_\+bits)
\begin{DoxyCompactList}\small\item\em Unpacks an unsigned integer value into bits. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit_8h_a7142be7f56e3047a0a4f89499ae99b98}{srsran\+::srsvec\+::bit\+\_\+unpack}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ unpacked, const \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&packed)
\begin{DoxyCompactList}\small\item\em Unpacks a bit buffer into bits. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit_8h_a02a0184bb8834ab83b4b7b9fe01b6d94}{srsran\+::srsvec\+::bit\+\_\+unpack}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ unpacked, const \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&packed, \mbox{\hyperlink{classunsigned}{unsigned}} offset)
\begin{DoxyCompactList}\small\item\em Unpacks a bit buffer into bits. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{bit_8h_a9d81bdbdd2a7ef56f135616a11ac23be}{srsran\+::srsvec\+::bit\+\_\+pack}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ \&bits, \mbox{\hyperlink{classunsigned}{unsigned}} nof\+\_\+bits)
\begin{DoxyCompactList}\small\item\em Packs a number of bits into an integer value. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{bit_8h_aefbb91957b649802285faee4f5a82f86}{srsran\+::srsvec\+::bit\+\_\+pack}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ bits)
\begin{DoxyCompactList}\small\item\em Packs the input bits into an integer value. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit_8h_a326446df15426403a59eb282107ca050}{srsran\+::srsvec\+::bit\+\_\+pack}} (\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&packed, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ unpacked)
\begin{DoxyCompactList}\small\item\em Packs a number of bits into a bit buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit_8h_a0016e8f6bfb16c93fbceffa55dba1edb}{srsran\+::srsvec\+::bit\+\_\+pack}} (\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&packed, \mbox{\hyperlink{classunsigned}{unsigned}} offset, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ unpacked)
\begin{DoxyCompactList}\small\item\em Packs a number of bits into a bit buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit_8h_ae7846ece8a92263f3292c70feeba8ffb}{srsran\+::srsvec\+::copy\+\_\+offset}} (\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&output, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ input, \mbox{\hyperlink{classunsigned}{unsigned}} startpos)
\begin{DoxyCompactList}\small\item\em Copies {\ttfamily output.\+size()} bits from {\ttfamily input}, starting at {\ttfamily startpos}, into {\ttfamily output}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit_8h_aac3960537e5aea2fc3a505f9cb2b570a}{srsran\+::srsvec\+::copy\+\_\+offset}} (\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&output, \mbox{\hyperlink{classunsigned}{unsigned}} out\+\_\+offset, const \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&input, \mbox{\hyperlink{classunsigned}{unsigned}} in\+\_\+offset, \mbox{\hyperlink{classunsigned}{unsigned}} nof\+\_\+bits)
\begin{DoxyCompactList}\small\item\em Copies bits from one buffer to another. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Bit manipulation function declarations. 



\doxysubsection{Function Documentation}
\Hypertarget{bit_8h_a326446df15426403a59eb282107ca050}\label{bit_8h_a326446df15426403a59eb282107ca050} 
\index{bit.h@{bit.h}!bit\_pack@{bit\_pack}}
\index{bit\_pack@{bit\_pack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_pack()}{bit\_pack()}\hspace{0.1cm}{\footnotesize\ttfamily [1/4]}}
{\footnotesize\ttfamily void srsran\+::srsvec\+::bit\+\_\+pack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{packed,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{unpacked }\end{DoxyParamCaption})}



Packs a number of bits into a bit buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em packed} & Destination bit buffer. \\
\hline
\mbox{\texttt{ in}}  & {\em unpacked} & View of unpacked bits. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
The number of unpacked elements must be equal to the maximum number of bits supported by the bit buffer. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00241\ \{}
\DoxyCodeLine{00242\ \ \ srsran\_assert(packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ ==\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ packed\ number\ of\ bits\ (i.e.\{\})\ must\ be\ equal\ to\ the\ number\ of\ unpacked\ bits\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordtype}{unsigned}\ i\_byte\ =\ 0;}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX512F\_\_)\ \&\&\ defined(\_\_AVX512VBMI\_\_)\ \&\&\ defined(\_\_AVX512BW\_\_)}}
\DoxyCodeLine{00249\ \ \ \_\_mmask64*\ packed\_ptr\ =\ \textcolor{keyword}{reinterpret\_cast<}\_\_mmask64*\textcolor{keyword}{>}(packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}().data());}
\DoxyCodeLine{00250\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_byte\_end\ =\ (packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ 64)\ *\ 8;\ i\_byte\ !=\ i\_byte\_end;\ i\_byte\ +=\ 8)\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{comment}{//\ Load\ the\ 64\ input\ values\ into\ an\ AVX-\/512\ register.}}
\DoxyCodeLine{00252\ \ \ \ \ \_\_m512i\ reg\ =\ \_mm512\_loadu\_si512(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\_\_m512i*\textcolor{keyword}{>}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_a451a209648781b54503ae671408e16b8}{data}}()));}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{comment}{//\ Reverses\ bits\ within\ bytes.}}
\DoxyCodeLine{00255\ \ \ \ \ \_\_m512i\ permute\_mask\ =\ \_mm512\_set\_epi8(}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ off}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ 0x38,\ 0x39,\ 0x3a,\ 0x3b,\ 0x3c,\ 0x3d,\ 0x3e,\ 0x3f,}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ 0x30,\ 0x31,\ 0x32,\ 0x33,\ 0x34,\ 0x35,\ 0x36,\ 0x37,}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ 0x28,\ 0x29,\ 0x2a,\ 0x2b,\ 0x2c,\ 0x2d,\ 0x2e,\ 0x2f,}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ 0x20,\ 0x21,\ 0x22,\ 0x23,\ 0x24,\ 0x25,\ 0x26,\ 0x27,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ 0x18,\ 0x19,\ 0x1a,\ 0x1b,\ 0x1c,\ 0x1d,\ 0x1e,\ 0x1f,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ 0x10,\ 0x11,\ 0x12,\ 0x13,\ 0x14,\ 0x15,\ 0x16,\ 0x17,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ 0x08,\ 0x09,\ 0x0a,\ 0x0b,\ 0x0c,\ 0x0d,\ 0x0e,\ 0x0f,}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ 0x00,\ 0x01,\ 0x02,\ 0x03,\ 0x04,\ 0x05,\ 0x06,\ 0x07}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ on}}
\DoxyCodeLine{00266\ \ \ \ \ );}
\DoxyCodeLine{00267\ \ \ \ \ reg\ =\ \_mm512\_permutexvar\_epi8(permute\_mask,\ reg);}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{comment}{//\ Extract\ the\ LSBs\ using\ a\ bitwise\ AND\ operation.}}
\DoxyCodeLine{00270\ \ \ \ \ *(packed\_ptr++)\ =\ \_mm512\_test\_epi8\_mask(reg,\ \_mm512\_set1\_epi8(1));}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \ \ unpacked\ =\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ 64);}
\DoxyCodeLine{00273\ \ \ \}}
\DoxyCodeLine{00274\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ defined(\_\_AVX512F\_\_)\ \&\&\ defined(\_\_AVX512VBMI\_\_)\ \&\&\ defined(\_\_AVX512BW\_\_)}}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_byte\_end\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ 8;\ i\_byte\ !=\ i\_byte\_end;\ ++i\_byte)\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{byte}\ =\ pack\_8bit<unsigned>(unpacked.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(8));}
\DoxyCodeLine{00278\ \ \ \ \ unpacked\ \ \ \ \ \ =\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ 8);}
\DoxyCodeLine{00279\ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_ad751b3e6553b927661d5e2bb175894d6}{set\_byte}}(\textcolor{keywordtype}{byte},\ i\_byte);}
\DoxyCodeLine{00280\ \ \ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \textcolor{keywordflow}{if}\ (!unpacked.\mbox{\hyperlink{classsrsran_1_1span_a06f3393981b96d556095d9023b894a8f}{empty}}())\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bit\_offset\ =\ 8\ *\ (packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ 8);}
\DoxyCodeLine{00284\ \ \ \ \ std::array<uint8\_t,\ 8>\ temp\_unpacked;}
\DoxyCodeLine{00285\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<uint8\_t>}}\ \ \ \ \ \ \ \ \ \ unpacked2\ =\ temp\_unpacked;}
\DoxyCodeLine{00286\ \ \ \ \ srsvec::copy(unpacked2.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()),\ unpacked);}
\DoxyCodeLine{00287\ \ \ \ \ srsvec::zero(unpacked2.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(8\ -\/\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()));}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{byte}\ =\ pack\_8bit<unsigned>(unpacked2)\ >>\ (8\ -\/\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00290\ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a6a4cc3c118ab69642f23eaed6aa6868c}{insert}}(\textcolor{keywordtype}{byte},\ bit\_offset,\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00291\ \ \ \}}
\DoxyCodeLine{00292\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_a0016e8f6bfb16c93fbceffa55dba1edb}\label{bit_8h_a0016e8f6bfb16c93fbceffa55dba1edb} 
\index{bit.h@{bit.h}!bit\_pack@{bit\_pack}}
\index{bit\_pack@{bit\_pack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_pack()}{bit\_pack()}\hspace{0.1cm}{\footnotesize\ttfamily [2/4]}}
{\footnotesize\ttfamily void srsran\+::srsvec\+::bit\+\_\+pack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1bit__buffer}{srsran\+::bit\+\_\+buffer}} \&}]{packed,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{offset,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{unpacked }\end{DoxyParamCaption})}



Packs a number of bits into a bit buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em packed} & Destination bit buffer. \\
\hline
\mbox{\texttt{ in}}  & {\em offset} & Packed initial bit index. \\
\hline
\mbox{\texttt{ in}}  & {\em unpacked} & View of unpacked bits. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
The number of unpacked elements must be smaller than or equal to the maximum number of bits supported by the bit buffer minus {\ttfamily offset}. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00295\ \{}
\DoxyCodeLine{00296\ \ \ srsran\_assert(}
\DoxyCodeLine{00297\ \ \ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ >=\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ +\ offset,}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ packed\ number\ of\ bits\ (i.e.\{\})\ must\ be\ equal\ or\ higher\ to\ the\ number\ of\ packed\ bits\ +\ offset\ (i.e.,\ \{\}+\{\})."{}},}
\DoxyCodeLine{00299\ \ \ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00300\ \ \ \ \ \ \ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00301\ \ \ \ \ \ \ offset);}
\DoxyCodeLine{00302\ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ bits\ to\ align\ the\ packed\ data\ to\ byte\ boundary.}}
\DoxyCodeLine{00303\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_head\_bits\ =\ std::min((8\ -\/\ (offset\ \%\ 8))\ \%\ 8,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()));}
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{if}\ (nof\_head\_bits\ !=\ 0)\ \{}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{comment}{//\ Pack\ the\ bits\ of\ the\ head.}}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ head\_bits\ =\ \mbox{\hyperlink{bit_8h_a9d81bdbdd2a7ef56f135616a11ac23be}{bit\_pack}}(unpacked,\ nof\_head\_bits);}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{comment}{//\ Insert\ the\ packed\ head\ bits.}}
\DoxyCodeLine{00309\ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a6a4cc3c118ab69642f23eaed6aa6868c}{insert}}(head\_bits,\ offset,\ nof\_head\_bits);}
\DoxyCodeLine{00310\ \ \ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \textcolor{keywordtype}{unsigned}\ aligned\_offset\ =\ \mbox{\hyperlink{namespacesrsran_a6e5aee1d553dc6e825017842e4059adb}{divide\_ceil}}(offset,\ 8)\ *\ 8;}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{if}\ (packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ !=\ aligned\_offset)\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\_buffer}}\ aligned\_packed\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a36bd3d5ce1f04be9a8e5c2cbcfd2ebe3}{last}}(packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ -\/\ aligned\_offset).\mbox{\hyperlink{classsrsran_1_1bit__buffer_abba52fc044021e0e4492726fc8a4dc24}{first}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00315\ \ \ \ \ \mbox{\hyperlink{bit_8h_a9d81bdbdd2a7ef56f135616a11ac23be}{bit\_pack}}(aligned\_packed,\ unpacked);}
\DoxyCodeLine{00316\ \ \ \}}
\DoxyCodeLine{00317\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_a9d81bdbdd2a7ef56f135616a11ac23be}\label{bit_8h_a9d81bdbdd2a7ef56f135616a11ac23be} 
\index{bit.h@{bit.h}!bit\_pack@{bit\_pack}}
\index{bit\_pack@{bit\_pack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_pack()}{bit\_pack()}\hspace{0.1cm}{\footnotesize\ttfamily [3/4]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classunsigned}{unsigned}} srsran\+::srsvec\+::bit\+\_\+pack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ \&}]{bits,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{nof\+\_\+bits }\end{DoxyParamCaption})}



Packs a number of bits into an integer value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em bits} & View of unpacked bits. \\
\hline
\mbox{\texttt{ in}}  & {\em nof\+\_\+bits} & Indicates the number of bits. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer containing the packed bits. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
The number of elements in bits must be greater than or equal to {\ttfamily nof\+\_\+bits}. 

{\ttfamily nof\+\_\+bits} must not exceed 32 bits. 

After execution, {\ttfamily bits} will contain only the unused bits. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00212\ \{}
\DoxyCodeLine{00213\ \ \ srsran\_assert(nof\_bits\ <=\ 32U,\ \textcolor{stringliteral}{"{}Number\ of\ bits\ (\{\})\ exceeds\ maximum\ (32)."{}},\ nof\_bits);}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \textcolor{keywordtype}{unsigned}\ value\ =\ 0;}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ nof\_bits;\ i++)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ value\ |=\ (\mbox{\hyperlink{classunsigned}{unsigned}})bits[i]\ <<\ (nof\_bits\ -\/\ i\ -\/\ 1U);}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \textcolor{comment}{//\ Advance\ pointer}}
\DoxyCodeLine{00222\ \ \ bits\ =\ bits.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ nof\_bits);}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{return}\ value;}
\DoxyCodeLine{00225\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_aefbb91957b649802285faee4f5a82f86}\label{bit_8h_aefbb91957b649802285faee4f5a82f86} 
\index{bit.h@{bit.h}!bit\_pack@{bit\_pack}}
\index{bit\_pack@{bit\_pack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_pack()}{bit\_pack()}\hspace{0.1cm}{\footnotesize\ttfamily [4/4]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classunsigned}{unsigned}} srsran\+::srsvec\+::bit\+\_\+pack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{bits }\end{DoxyParamCaption})}



Packs the input bits into an integer value. 

The first bit in the sequence corresponds to the bit of index {\ttfamily  bits.\+size() -\/ 1 } of the returned value. The last value in the sequence corresponds to LSB of the returned value.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bits} & View of unpacked bits. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer containing the packed bits. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
The number of elements must not exceed 32 bits. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00228\ \{}
\DoxyCodeLine{00229\ \ \ srsran\_assert(bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ <=\ 32U,\ \textcolor{stringliteral}{"{}Number\ of\ bits\ (\{\})\ exceeds\ maximum\ (32)."{}},\ bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \textcolor{keywordtype}{unsigned}\ value\ =\ 0;}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0,\ nof\_bits\ =\ bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}();\ i\ !=\ nof\_bits;\ i++)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ value\ |=\ (\mbox{\hyperlink{classunsigned}{unsigned}})bits[i]\ <<\ (nof\_bits\ -\/\ i\ -\/\ 1U);}
\DoxyCodeLine{00235\ \ \ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keywordflow}{return}\ value;}
\DoxyCodeLine{00238\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_ab8c0c071f2ec3061b8182a047ae0a11b}\label{bit_8h_ab8c0c071f2ec3061b8182a047ae0a11b} 
\index{bit.h@{bit.h}!bit\_unpack@{bit\_unpack}}
\index{bit\_unpack@{bit\_unpack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_unpack()}{bit\_unpack()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ srsran\+::srsvec\+::bit\+\_\+unpack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{bits,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{value,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{nof\+\_\+bits }\end{DoxyParamCaption})}



Unpacks an unsigned integer value into bits. 

The first bit in the sequence corresponds to the bit of index {\ttfamily  nof\+\_\+bits -\/ 1 } of {\ttfamily value}. The LSB of {\ttfamily value} is mapped to the last element in the sequence.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em bits} & Unpacked bits sequence. \\
\hline
\mbox{\texttt{ in}}  & {\em value} & Provides the value to unpack. \\
\hline
\mbox{\texttt{ in}}  & {\em nof\+\_\+bits} & Indicates the number of bits to unpack. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A view of the remaining (behind {\ttfamily nof\+\_\+bits}) unpacked bits of {\ttfamily value}. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \{}
\DoxyCodeLine{00072\ \ \ srsran\_assert(bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ >=\ nof\_bits,\ \textcolor{stringliteral}{"{}Input\ span\ size\ is\ too\ small"{}});}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ nof\_bits;\ i++)\ \{}
\DoxyCodeLine{00075\ \ \ \ \ bits[i]\ =\ (value\ >>\ (nof\_bits\ -\/\ i\ -\/\ 1))\ \&\ 0x1;}
\DoxyCodeLine{00076\ \ \ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \textcolor{keywordflow}{return}\ bits.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ nof\_bits);}
\DoxyCodeLine{00079\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_a7142be7f56e3047a0a4f89499ae99b98}\label{bit_8h_a7142be7f56e3047a0a4f89499ae99b98} 
\index{bit.h@{bit.h}!bit\_unpack@{bit\_unpack}}
\index{bit\_unpack@{bit\_unpack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_unpack()}{bit\_unpack()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void srsran\+::srsvec\+::bit\+\_\+unpack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{unpacked,  }\item[{const \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{packed }\end{DoxyParamCaption})}



Unpacks a bit buffer into bits. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em unpacked} & View of the unpacked bits. \\
\hline
\mbox{\texttt{ in}}  & {\em packed} & Bit buffer to unpack. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
The number of unpacked elements must be equal to the packed number of bits. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00082\ \{}
\DoxyCodeLine{00083\ \ \ srsran\_assert(packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ ==\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ packed\ number\ of\ bits\ (i.e.\{\})\ must\ be\ equal\ to\ the\ number\ of\ unpacked\ bits\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//\ Read/write\ byte\ index.}}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordtype}{unsigned}\ i\_byte\ =\ 0;}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX512F\_\_)\ \&\&\ defined(\_\_AVX512VBMI\_\_)\ \&\&\ defined(\_\_AVX512BW\_\_)}}
\DoxyCodeLine{00091\ \ \ \textcolor{keyword}{const}\ \_\_mmask64*\ packed\_ptr\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\_\_mmask64*\textcolor{keyword}{>}(packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}().data());}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_byte\_end\ =\ (packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ 64)\ *\ 8;\ i\_byte\ !=\ i\_byte\_end;\ i\_byte\ +=\ 8)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//\ Load\ 64\ bits\ in\ a\ go\ as\ a\ mask.}}
\DoxyCodeLine{00094\ \ \ \ \ \_\_mmask64\ blend\_mask\ =\ *(packed\_ptr++);}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{comment}{//\ Load\ 64\ bits\ in\ a\ go.}}
\DoxyCodeLine{00097\ \ \ \ \ \_\_m512i\ reg\ =\ \_mm512\_mask\_blend\_epi8(blend\_mask,\ \_mm512\_set1\_epi8(0),\ \_mm512\_set1\_epi8(1));}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{//\ Reverses\ bits\ within\ bytes.}}
\DoxyCodeLine{00100\ \ \ \ \ \_\_m512i\ permute\_mask\ =\ \_mm512\_set\_epi8(}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ off}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ 0x38,\ 0x39,\ 0x3a,\ 0x3b,\ 0x3c,\ 0x3d,\ 0x3e,\ 0x3f,}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ 0x30,\ 0x31,\ 0x32,\ 0x33,\ 0x34,\ 0x35,\ 0x36,\ 0x37,}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ 0x28,\ 0x29,\ 0x2a,\ 0x2b,\ 0x2c,\ 0x2d,\ 0x2e,\ 0x2f,}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ 0x20,\ 0x21,\ 0x22,\ 0x23,\ 0x24,\ 0x25,\ 0x26,\ 0x27,}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ 0x18,\ 0x19,\ 0x1a,\ 0x1b,\ 0x1c,\ 0x1d,\ 0x1e,\ 0x1f,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ 0x10,\ 0x11,\ 0x12,\ 0x13,\ 0x14,\ 0x15,\ 0x16,\ 0x17,}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ 0x08,\ 0x09,\ 0x0a,\ 0x0b,\ 0x0c,\ 0x0d,\ 0x0e,\ 0x0f,}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ 0x00,\ 0x01,\ 0x02,\ 0x03,\ 0x04,\ 0x05,\ 0x06,\ 0x07}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ on}}
\DoxyCodeLine{00111\ \ \ \ \ );}
\DoxyCodeLine{00112\ \ \ \ \ reg\ =\ \_mm512\_permutexvar\_epi8(permute\_mask,\ reg);}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ Store\ register.}}
\DoxyCodeLine{00115\ \ \ \ \ \_mm512\_storeu\_si512(\textcolor{keyword}{reinterpret\_cast<}\_\_m512i*\textcolor{keyword}{>}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_a451a209648781b54503ae671408e16b8}{data}}()),\ reg);}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{//\ Advance\ unpacked\ buffer.}}
\DoxyCodeLine{00118\ \ \ \ \ unpacked\ =\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ 64);}
\DoxyCodeLine{00119\ \ \ \}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ defined(\_\_AVX512F\_\_)\ \&\&\ defined(\_\_AVX512VBMI\_\_)\ \&\&\ defined(\_\_AVX512BW\_\_)}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#if\ defined(\_\_AVX\_\_)\ \&\&\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ uint8\_t>}}\ packed\_buffer\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}();}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_byte\_end\ =\ (packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ 32)\ *\ 4;\ i\_byte\ !=\ i\_byte\_end;\ i\_byte\ +=\ 4)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{//\ Load\ input\ in\ different\ registers.}}
\DoxyCodeLine{00127\ \ \ \ \ \_\_m256i\ in\ =\ \_mm256\_setzero\_si256();}
\DoxyCodeLine{00128\ \ \ \ \ in\ \ \ \ \ \ \ \ \ =\ \_mm256\_insert\_epi8(in,\ packed\_buffer[i\_byte\ +\ 0],\ 0);}
\DoxyCodeLine{00129\ \ \ \ \ in\ \ \ \ \ \ \ \ \ =\ \_mm256\_insert\_epi8(in,\ packed\_buffer[i\_byte\ +\ 1],\ 8);}
\DoxyCodeLine{00130\ \ \ \ \ in\ \ \ \ \ \ \ \ \ =\ \_mm256\_insert\_epi8(in,\ packed\_buffer[i\_byte\ +\ 2],\ 16);}
\DoxyCodeLine{00131\ \ \ \ \ in\ \ \ \ \ \ \ \ \ =\ \_mm256\_insert\_epi8(in,\ packed\_buffer[i\_byte\ +\ 3],\ 24);}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{comment}{//\ Repeats\ each\ byte\ 8\ times.}}
\DoxyCodeLine{00134\ \ \ \ \ \_\_m256i\ shuffle\_mask\ =\ \_mm256\_setr\_epi8(}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ off}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ 8,\ 8,\ 8,\ 8,\ 8,\ 8,\ 8,\ 8,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ 8,\ 8,\ 8,\ 8,\ 8,\ 8,\ 8,\ 8}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ off}}
\DoxyCodeLine{00141\ \ \ \ \ );}
\DoxyCodeLine{00142\ \ \ \ \ in\ =\ \_mm256\_shuffle\_epi8(in,\ shuffle\_mask);}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ Selects\ each\ of\ the\ bits.}}
\DoxyCodeLine{00145\ \ \ \ \ \_\_m256i\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \_mm256\_set\_epi8(}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ off}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ 1,\ 2,\ 4,\ 8,\ 16,\ 32,\ 64,\ -\/128,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ 1,\ 2,\ 4,\ 8,\ 16,\ 32,\ 64,\ -\/128,}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ 1,\ 2,\ 4,\ 8,\ 16,\ 32,\ 64,\ -\/128,}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ 1,\ 2,\ 4,\ 8,\ 16,\ 32,\ 64,\ -\/128}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clang-\/format\ on}}
\DoxyCodeLine{00152\ \ \ \ \ );}
\DoxyCodeLine{00153\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \_mm256\_and\_si256(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ in);}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{comment}{//\ \ Moves\ the\ selected\ bit\ to\ the\ LSB\ of\ each\ output\ byte.}}
\DoxyCodeLine{00156\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \string~\_mm256\_cmpeq\_epi8(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \_mm256\_setzero\_si256());}
\DoxyCodeLine{00157\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \_mm256\_and\_si256(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \_mm256\_set1\_epi8(1));}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{comment}{//\ Store\ register.}}
\DoxyCodeLine{00160\ \ \ \ \ \_mm256\_storeu\_si256(\textcolor{keyword}{reinterpret\_cast<}\_\_m256i*\textcolor{keyword}{>}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_a451a209648781b54503ae671408e16b8}{data}}()),\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}});}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{//\ Advance\ unpacked\ buffer.}}
\DoxyCodeLine{00163\ \ \ \ \ unpacked\ =\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ 32);}
\DoxyCodeLine{00164\ \ \ \}}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ defined(\_\_AVX\_\_)\ \&\&\ defined(\_\_AVX2\_\_)}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_byte\_end\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ 8;\ i\_byte\ !=\ i\_byte\_end;\ ++i\_byte)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{//\ Extract\ byte.}}
\DoxyCodeLine{00169\ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \textcolor{keywordtype}{byte}\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a842a889b261b19ab4f37c070e74ad347}{get\_byte}}(i\_byte);}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{comment}{//\ Unpack\ byte.}}
\DoxyCodeLine{00171\ \ \ \ \ unpack\_8bit(unpacked.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(8),\ \textcolor{keywordtype}{byte});}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{comment}{//\ Advance\ unpacked\ buffer.}}
\DoxyCodeLine{00173\ \ \ \ \ unpacked\ =\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ 8);}
\DoxyCodeLine{00174\ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{comment}{//\ Unpack\ remainder\ bits.}}
\DoxyCodeLine{00177\ \ \ \textcolor{keywordflow}{if}\ (!unpacked.\mbox{\hyperlink{classsrsran_1_1span_a06f3393981b96d556095d9023b894a8f}{empty}}())\ \{}
\DoxyCodeLine{00178\ \ \ \ \ std::array<uint8\_t,\ 8>\ temp\_unpacked;}
\DoxyCodeLine{00179\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<uint8\_t>}}\ \ \ \ \ \ \ \ \ \ unpacked2\ =\ temp\_unpacked;}
\DoxyCodeLine{00180\ \ \ \ \ unpack\_8bit(unpacked2,\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_ab4650aa5eccca52eea8a7cb4d14702a7}{extract}}(8\ *\ i\_byte,\ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()));}
\DoxyCodeLine{00181\ \ \ \ \ srsvec::copy(unpacked,\ unpacked2.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()));}
\DoxyCodeLine{00182\ \ \ \}}
\DoxyCodeLine{00183\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_a02a0184bb8834ab83b4b7b9fe01b6d94}\label{bit_8h_a02a0184bb8834ab83b4b7b9fe01b6d94} 
\index{bit.h@{bit.h}!bit\_unpack@{bit\_unpack}}
\index{bit\_unpack@{bit\_unpack}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{bit\_unpack()}{bit\_unpack()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void srsran\+::srsvec\+::bit\+\_\+unpack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{unpacked,  }\item[{const \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{packed,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{offset }\end{DoxyParamCaption})}



Unpacks a bit buffer into bits. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em unpacked} & View of the unpacked bits. \\
\hline
\mbox{\texttt{ in}}  & {\em packed} & Bit buffer to unpack. \\
\hline
\mbox{\texttt{ in}}  & {\em offset} & Packed initial bit index. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00186\ \{}
\DoxyCodeLine{00187\ \ \ srsran\_assert(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ <=\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ -\/\ offset,}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ unpacked\ number\ of\ bits\ (i.e.\{\})\ must\ be\ equal\ or\ lower\ to\ the\ number\ of\ packed\ bits\ -\/\ offset\ "{}}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(i.e.,\ \{\}-\/\{\})."{}},}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ offset);}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ bits\ to\ align\ the\ packed\ data\ to\ byte\ boundary.}}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_head\_bits\ =\ std::min((8\ -\/\ (offset\ \%\ 8))\ \%\ 8,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()));}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordflow}{if}\ (nof\_head\_bits\ !=\ 0)\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{//\ Extract\ the\ alignment\ bits.}}
\DoxyCodeLine{00198\ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ head\_bits\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_ab4650aa5eccca52eea8a7cb4d14702a7}{extract}}(offset,\ nof\_head\_bits);}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ Unpack\ the\ head.}}
\DoxyCodeLine{00201\ \ \ \ \ unpacked\ =\ \mbox{\hyperlink{bit_8h_ab8c0c071f2ec3061b8182a047ae0a11b}{bit\_unpack}}(unpacked,\ head\_bits,\ nof\_head\_bits);}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \textcolor{keywordtype}{unsigned}\ aligned\_offset\ =\ \mbox{\hyperlink{namespacesrsran_a6e5aee1d553dc6e825017842e4059adb}{divide\_ceil}}(offset,\ 8)\ *\ 8;}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{if}\ (packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ !=\ aligned\_offset)\ \{}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\_buffer}}\ aligned\_packed\ =\ packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a36bd3d5ce1f04be9a8e5c2cbcfd2ebe3}{last}}(packed.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ -\/\ aligned\_offset).\mbox{\hyperlink{classsrsran_1_1bit__buffer_abba52fc044021e0e4492726fc8a4dc24}{first}}(unpacked.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00207\ \ \ \ \ \mbox{\hyperlink{bit_8h_ab8c0c071f2ec3061b8182a047ae0a11b}{bit\_unpack}}(unpacked,\ aligned\_packed);}
\DoxyCodeLine{00208\ \ \ \}}
\DoxyCodeLine{00209\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_ae7846ece8a92263f3292c70feeba8ffb}\label{bit_8h_ae7846ece8a92263f3292c70feeba8ffb} 
\index{bit.h@{bit.h}!copy\_offset@{copy\_offset}}
\index{copy\_offset@{copy\_offset}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{copy\_offset()}{copy\_offset()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void srsran\+::srsvec\+::copy\+\_\+offset (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1bit__buffer}{srsran\+::bit\+\_\+buffer}} \&}]{output,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{input,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{startpos }\end{DoxyParamCaption})}



Copies {\ttfamily output.\+size()} bits from {\ttfamily input}, starting at {\ttfamily startpos}, into {\ttfamily output}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Destination of the copy. \\
\hline
\mbox{\texttt{ in}}  & {\em input} & Data source to copy. \\
\hline
\mbox{\texttt{ in}}  & {\em startpos} & Bit position index to start the copy. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00320\ \{}
\DoxyCodeLine{00321\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ bits\_per\_word\ \ \ \ =\ 8;}
\DoxyCodeLine{00322\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_start\_word\ =\ startpos\ /\ bits\_per\_word;}
\DoxyCodeLine{00323\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_start\_mod\ \ =\ startpos\ \%\ bits\_per\_word;}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{keyword}{using\ }extended\_word\_t\ =\ \mbox{\hyperlink{classuint32__t}{uint32\_t}};}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_full\_words\ \ \ \ \ =\ output.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ bits\_per\_word;}
\DoxyCodeLine{00328\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_remainder\_bits\ =\ output.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ \%\ bits\_per\_word;}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<uint8\_t>}}\ buffer\ =\ output.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}();}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \textcolor{keywordflow}{if}\ (input\_start\_mod\ ==\ 0)\ \{}
\DoxyCodeLine{00333\ \ \ \ \ std::copy\_n(input.\mbox{\hyperlink{classsrsran_1_1span_a6202eea0b4569bf9ba5bf5b1574a03ae}{begin}}()\ +\ input\_start\_word,\ nof\_full\_words,\ buffer.\mbox{\hyperlink{classsrsran_1_1span_a6202eea0b4569bf9ba5bf5b1574a03ae}{begin}}());}
\DoxyCodeLine{00334\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ i\_word\ =\ 0;}
\DoxyCodeLine{00336\ \textcolor{preprocessor}{\#ifdef\ \_\_AVX2\_\_}}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\_word\_end\ =\ (nof\_full\_words\ /\ 32)\ *\ 32;\ i\_word\ !=\ i\_word\_end;\ i\_word\ +=\ 32)\ \{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \_\_m256i\ word0\ =\ \_mm256\_loadu\_si256(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\_\_m256i*\textcolor{keyword}{>}(\&input[input\_start\_word\ +\ i\_word]));}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \_\_m256i\ word1\ =\ \_mm256\_loadu\_si256(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\_\_m256i*\textcolor{keyword}{>}(\&input[input\_start\_word\ +\ i\_word\ +\ 1]));}
\DoxyCodeLine{00340\ \ \ \ \ \ \ word0\ \ \ \ \ \ \ \ \ =\ \_mm256\_and\_si256(\_mm256\_slli\_epi32(word0,\ input\_start\_mod),}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm256\_set1\_epi8(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_msb\_ones<uint8\_t>}}(bits\_per\_word\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_mod}})));}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word1}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm256\_and\_si256}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm256\_srli\_epi32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word1}},\ bits\_per\_word\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_mod}}),}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm256\_set1\_epi8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_lsb\_ones<uint8\_t>}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_mod}})));}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m256i}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word}}\ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm256\_or\_si256}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word0}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word1}});}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm256\_storeu\_si256}}(\textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m256i}}*\textcolor{keyword}{>}(\&buffer[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_word}}]),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word}});}
\DoxyCodeLine{00346\ \ \ \ \ \}}
\DoxyCodeLine{00347\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_AVX2\_\_}}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_word}}\ !=\ nof\_full\_words;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_word}})\ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{extended\_word\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{extended\_word\_t}}\textcolor{keyword}{>}(input[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_word}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_word}}])\ <<\ bits\_per\_word;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ |=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{extended\_word\_t}}\textcolor{keyword}{>}(input[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_word}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_word}}\ +\ 1]);}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ >>\ (bits\_per\_word\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_mod}});}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ \&=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_lsb\_ones<extended\_word\_t>}}(bits\_per\_word);}
\DoxyCodeLine{00353\ \ \ \ \ \ \ buffer[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_word}}]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classuint8__t}{uint8\_t}}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}});}
\DoxyCodeLine{00354\ \ \ \ \ \}}
\DoxyCodeLine{00355\ \ \ \}}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_remainder\_bits}}\ !=\ 0)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{extended\_word\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}}\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{extended\_word\_t}}\textcolor{keyword}{>}(input[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_word}}\ +\ nof\_full\_words])}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ bits\_per\_word;}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_mod}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_remainder\_bits}}\ >\ bits\_per\_word)\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}}\ |=\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{extended\_word\_t}}\textcolor{keyword}{>}(input[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_word}}\ +\ nof\_full\_words\ +\ 1]);}
\DoxyCodeLine{00362\ \ \ \ \ \}}
\DoxyCodeLine{00363\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}}\ >>\ (bits\_per\_word\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_start\_mod}});}
\DoxyCodeLine{00364\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}}\ \&=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}}\ \&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_lsb\_ones<extended\_word\_t>}}(bits\_per\_word);}
\DoxyCodeLine{00365\ \ \ \ \ buffer[nof\_full\_words]\ =\ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classuint8__t}{uint8\_t}}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder\_bits}})\ \&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_msb\_ones<uint8\_t>}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_remainder\_bits}});}
\DoxyCodeLine{00366\ \ \ \}}
\DoxyCodeLine{00367\ \}}

\end{DoxyCode}
\Hypertarget{bit_8h_aac3960537e5aea2fc3a505f9cb2b570a}\label{bit_8h_aac3960537e5aea2fc3a505f9cb2b570a} 
\index{bit.h@{bit.h}!copy\_offset@{copy\_offset}}
\index{copy\_offset@{copy\_offset}!bit.h@{bit.h}}
\doxysubsubsection{\texorpdfstring{copy\_offset()}{copy\_offset()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void srsran\+::srsvec\+::copy\+\_\+offset (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1bit__buffer}{srsran\+::bit\+\_\+buffer}} \&}]{output,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{out\+\_\+offset,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{input,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{in\+\_\+offset,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{nof\+\_\+bits }\end{DoxyParamCaption})}



Copies bits from one buffer to another. 

Copies {\ttfamily nof\+\_\+bits} bits from {\ttfamily input}, starting at {\ttfamily in\+\_\+offset}, into {\ttfamily output}, starting at {\ttfamily out\+\_\+offset}. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em output} & Destination of the copy. \\
\hline
\mbox{\texttt{ in}}  & {\em out\+\_\+offset} & Output bit position index to start the copy. \\
\hline
\mbox{\texttt{ in}}  & {\em input} & Data source to copy. \\
\hline
\mbox{\texttt{ in}}  & {\em in\+\_\+offset} & Input bit position index to start the copy. \\
\hline
\mbox{\texttt{ in}}  & {\em nof\+\_\+bits} & Number of bits to copy. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00374\ \{}
\DoxyCodeLine{00375\ \ \ srsran\_assert(input.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_offset}}\ >=\ nof\_bits,}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Input\ buffer\ size\ (i.e.,\ \{\})\ and\ reading\ offset\ (i.e.,\ \{\})\ cannot\ accomodate\ copy\ size\ of\ \{\}\ bits."{}},}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_offset}},}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nof\_bits);}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ srsran\_assert(input.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_offset}}\ >=\ nof\_bits,}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Output\ buffer\ size\ (i.e.,\ \{\})\ and\ writing\ offset\ (i.e.,\ \{\})\ cannot\ accomodate\ copy\ size\ of\ \{\}\ bits."{}},}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_offset}},}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nof\_bits);}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \textcolor{comment}{//\ 8\ bit\ per\ word.}}
\DoxyCodeLine{00388\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ bits\_per\_word\ =\ 8U;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_start\_word}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_offset}}\ /\ bits\_per\_word;}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_start\_mod}}\ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_offset}}\ \%\ bits\_per\_word;}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_start\_word}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_offset}}\ /\ bits\_per\_word;}
\DoxyCodeLine{00394\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_start\_mod}}\ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_offset}}\ \%\ bits\_per\_word;}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remaining\_bits}}\ =\ nof\_bits;}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ =\ 0;}
\DoxyCodeLine{00399\ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_start\_mod}}\ ==\ 0)\ \&\&\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_start\_mod}}\ ==\ 0))\ \{}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{comment}{//\ Determine\ the\ number\ of\ bit\ words\ to\ copy.}}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ nof\_words\ =\ nof\_bits\ /\ bits\_per\_word;}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ buffer\ views.}}
\DoxyCodeLine{00404\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<uint8\_t>}}\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_buffer}}\ =\ output.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}().subspan(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_start\_word}},\ nof\_words);}
\DoxyCodeLine{00405\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ uint8\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_buffer}}\ \ =\ input.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}().subspan(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_start\_word}},\ nof\_words);}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{comment}{//\ Copy\ data.}}
\DoxyCodeLine{00408\ \ \ \ \ srsvec::copy(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_buffer}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_buffer}});}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ remaining\ bits\ to\ copy.}}
\DoxyCodeLine{00411\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remaining\_bits}}\ -\/=\ nof\_words\ *\ bits\_per\_word;}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{comment}{//\ Increment\ input\ offset.}}
\DoxyCodeLine{00414\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ +=\ nof\_words\ *\ bits\_per\_word;}
\DoxyCodeLine{00415\ \ \ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remaining\_bits}}\ !=\ 0;)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{comment}{//\ Extract\ at\ most\ one\ byte\ from\ the\ input.}}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_to\_extract}}\ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remaining\_bits}},\ 8U);}
\DoxyCodeLine{00420\ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \ \textcolor{keywordtype}{byte}\ \ \ \ \ \ \ \ \ \ \ \ =\ input.\mbox{\hyperlink{classsrsran_1_1bit__buffer_ab4650aa5eccca52eea8a7cb4d14702a7}{extract}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{in\_offset}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_to\_extract}});}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{comment}{//\ Insert\ the\ extracted\ bits\ into\ the\ output\ buffer.}}
\DoxyCodeLine{00423\ \ \ \ \ output.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a6a4cc3c118ab69642f23eaed6aa6868c}{insert}}(\textcolor{keywordtype}{byte},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{out\_offset}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_to\_extract}});}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remaining\_bits}}\ -\/=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_to\_extract}};}
\DoxyCodeLine{00426\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_to\_extract}};}
\DoxyCodeLine{00427\ \ \ \}}
\DoxyCodeLine{00428\ \}}

\end{DoxyCode}
