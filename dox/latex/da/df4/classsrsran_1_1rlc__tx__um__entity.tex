\doxysection{srsran\+::rlc\+\_\+tx\+\_\+um\+\_\+entity Class Reference}
\hypertarget{classsrsran_1_1rlc__tx__um__entity}{}\label{classsrsran_1_1rlc__tx__um__entity}\index{srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}}


Inheritance diagram for srsran\+::rlc\+\_\+tx\+\_\+um\+\_\+entity\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d46/classsrsran_1_1rlc__tx__um__entity__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::rlc\+\_\+tx\+\_\+um\+\_\+entity\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d82/classsrsran_1_1rlc__tx__um__entity__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__um__entity_a8b12b113229add630c19904fa95e1b53}{rlc\+\_\+tx\+\_\+um\+\_\+entity}} (uint32\+\_\+t du\+\_\+index, \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}} rb\+\_\+id, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config}{rlc\+\_\+tx\+\_\+um\+\_\+config}} \&config, \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\+\_\+dn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__control__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+control\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\+\_\+cn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__notifier}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\+\_\+dn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcell\+\_\+executor\+\_\+}}, \mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{metrics\+\_\+enabled}}, \mbox{\hyperlink{classsrsran_1_1rlc__pcap}{rlc\+\_\+pcap}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcap\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__um__entity_add07a68147d63b9fbf12b0607537dfe1}{handle\+\_\+sdu}} (\mbox{\hyperlink{structsrsran_1_1rlc__sdu}{rlc\+\_\+sdu}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\+\_\+}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Interface for higher layers to pass SDUs into RLC. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__um__entity_ad60dc9008877a3222036b4f57ed98163}{discard\+\_\+sdu}} (uint32\+\_\+t pdcp\+\_\+sn) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Interface for higher layers to discard SDUs from RLC queue. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classsrsran_1_1rlc__tx__um__entity_a8f352f1b277d06618a880ec70c39d5c3}{pull\+\_\+pdu}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\+\_\+sdu\+\_\+buf}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Pulls a PDU from the lower end of the RLC TX entity No PDU is written if the size of {\ttfamily rlc\+\_\+pdu\+\_\+buf} is insufficient or the TX buffer is empty. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classsrsran_1_1rlc__tx__um__entity_ad537c8977ec07d1075bd3cbca4cd5b1f}{get\+\_\+buffer\+\_\+state}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Get the buffer status information This function provides the current buffer state of the RLC TX entity. This is the gross total size required to fully flush the TX entity (potentially by multiple calls to pull\+\_\+pdu). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1rlc__tx__entity}{srsran\+::rlc\+\_\+tx\+\_\+entity}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structsrsran_1_1rlc__tx__metrics}{rlc\+\_\+tx\+\_\+metrics}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__entity_ab835005656d9d0dbb67e19d6d49b3577}{get\+\_\+metrics}} ()
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__entity_a6c881c34347d814d0a59be6ed9eca264}{reset\+\_\+metrics}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{srsran\+::rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
{\bfseries rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{srsran\+::rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
{\bfseries rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Public Attributes inherited from \mbox{\hyperlink{structsrsran_1_1rlc__tx__metrics}{srsran\+::rlc\+\_\+tx\+\_\+metrics}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries num\+\_\+sdus}
\begin{DoxyCompactList}\small\item\em Number of SDUs. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries num\+\_\+of\+\_\+pulled\+\_\+sdus}
\begin{DoxyCompactList}\small\item\em Number of pulled SDUs. \end{DoxyCompactList}\item 
size\+\_\+t {\bfseries num\+\_\+sdu\+\_\+bytes}
\begin{DoxyCompactList}\small\item\em Number of SDU bytes. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries num\+\_\+dropped\+\_\+sdus}
\begin{DoxyCompactList}\small\item\em Number of dropped SDUs (due to full queue) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries num\+\_\+discarded\+\_\+sdus}
\begin{DoxyCompactList}\small\item\em Number of discarded SDUs (instructed from higher layer) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries num\+\_\+discard\+\_\+failures}
\begin{DoxyCompactList}\small\item\em Number of failed SDU discards (instructed from higher layer) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries sum\+\_\+sdu\+\_\+latency\+\_\+us}
\begin{DoxyCompactList}\small\item\em total SDU latency (in us)\texorpdfstring{$>$}{>} \end{DoxyCompactList}\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries num\+\_\+pdus\+\_\+no\+\_\+segmentation}
\begin{DoxyCompactList}\small\item\em Number of transmitted PDUs without segmentation. \end{DoxyCompactList}\item 
size\+\_\+t {\bfseries num\+\_\+pdu\+\_\+bytes\+\_\+no\+\_\+segmentation}
\begin{DoxyCompactList}\small\item\em Number of transmitted PDU bytes without segmentation. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a1c771f379fa63ba2137654c259563308}{rlc\+\_\+mode}} {\bfseries mode}
\begin{DoxyCompactList}\small\item\em RLC mode of the entity. \end{DoxyCompactList}\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
union \{\\
\>\mbox{\hyperlink{structsrsran_1_1rlc__tm__tx__metrics}{rlc\_tm\_tx\_metrics}} {\bfseries tm}\\
\>\mbox{\hyperlink{structsrsran_1_1rlc__um__tx__metrics}{rlc\_um\_tx\_metrics}} {\bfseries um}\\
\>\mbox{\hyperlink{structsrsran_1_1rlc__am__tx__metrics}{rlc\_am\_tx\_metrics}} {\bfseries am}\\
\} \mbox{\hyperlink{structsrsran_1_1rlc__tx__metrics_a97e10254bd7914a69ee8f0182d5dc2cc}{mode\_specific}}\\

\end{tabbing}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1rlc__tx__entity}{srsran\+::rlc\+\_\+tx\+\_\+entity}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__entity_a3d60bcedb1ee117619637568433ca906}{rlc\+\_\+tx\+\_\+entity}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} du\+\_\+index, \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}} rb\+\_\+id, \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\+\_\+dn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__control__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+control\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\+\_\+cn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__notifier}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\+\_\+dn\+\_\+}}, \mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{metrics\+\_\+enabled}}, \mbox{\hyperlink{classsrsran_1_1rlc__pcap}{rlc\+\_\+pcap}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcap\+\_\+}})
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classsrsran_1_1rlc__tx__entity}{srsran\+::rlc\+\_\+tx\+\_\+entity}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1prefixed__logger}{rlc\+\_\+bearer\+\_\+logger}} {\bfseries logger}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__metrics__container}{rlc\+\_\+tx\+\_\+metrics\+\_\+container}} {\bfseries metrics}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+notifier}} \& {\bfseries upper\+\_\+dn}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__control__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+control\+\_\+notifier}} \& {\bfseries upper\+\_\+cn}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__notifier}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+notifier}} \& {\bfseries lower\+\_\+dn}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__pcap}{rlc\+\_\+pcap}} \& {\bfseries pcap}
\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1rlc__tx__um__entity_a8b12b113229add630c19904fa95e1b53}\label{classsrsran_1_1rlc__tx__um__entity_a8b12b113229add630c19904fa95e1b53} 
\index{srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}!rlc\_tx\_um\_entity@{rlc\_tx\_um\_entity}}
\index{rlc\_tx\_um\_entity@{rlc\_tx\_um\_entity}!srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}}
\doxysubsubsection{\texorpdfstring{rlc\_tx\_um\_entity()}{rlc\_tx\_um\_entity()}}
{\footnotesize\ttfamily rlc\+\_\+tx\+\_\+um\+\_\+entity\+::rlc\+\_\+tx\+\_\+um\+\_\+entity (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{du\+\_\+index,  }\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}}}]{rb\+\_\+id,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config}{rlc\+\_\+tx\+\_\+um\+\_\+config}} \&}]{config,  }\item[{\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+notifier}} \&}]{upper\+\_\+dn\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__control__notifier}{rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+control\+\_\+notifier}} \&}]{upper\+\_\+cn\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__notifier}{rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+notifier}} \&}]{lower\+\_\+dn\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&}]{pcell\+\_\+executor\+\_\+,  }\item[{\mbox{\hyperlink{classbool}{bool}}}]{metrics\+\_\+enabled,  }\item[{\mbox{\hyperlink{classsrsran_1_1rlc__pcap}{rlc\+\_\+pcap}} \&}]{pcap\+\_\+ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__tx__entity}{rlc\_tx\_entity}}(du\_index,\ ue\_index,\ rb\_id,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\_dn\_}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\_cn\_}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\_dn\_}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{metrics\_enabled}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcap\_}}),}
\DoxyCodeLine{00040\ \ \ cfg(config),}
\DoxyCodeLine{00041\ \ \ sdu\_queue(cfg.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config_a3fb00116e2b31cadbbd16b456ac458bf}{queue\_size}},\ logger),}
\DoxyCodeLine{00042\ \ \ mod(\mbox{\hyperlink{namespacesrsran_abcf66419637f2dc1494305c3b8d7aaf5}{cardinality}}(to\_number(cfg.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config_ac5bff1bdd61720b654de8a9cc1afe73c}{sn\_field\_length}}))),}
\DoxyCodeLine{00043\ \ \ head\_len\_full(rlc\_um\_pdu\_header\_size\_complete\_sdu),}
\DoxyCodeLine{00044\ \ \ head\_len\_first(rlc\_um\_pdu\_header\_size\_no\_so(cfg.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config_ac5bff1bdd61720b654de8a9cc1afe73c}{sn\_field\_length}})),}
\DoxyCodeLine{00045\ \ \ head\_len\_not\_first(rlc\_um\_pdu\_header\_size\_with\_so(cfg.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config_ac5bff1bdd61720b654de8a9cc1afe73c}{sn\_field\_length}})),}
\DoxyCodeLine{00046\ \ \ pcell\_executor(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcell\_executor\_}}),}
\DoxyCodeLine{00047\ \ \ pcap\_context(ue\_index,\ rb\_id,\ config)}
\DoxyCodeLine{00048\ \{}
\DoxyCodeLine{00049\ \ \ metrics.metrics\_set\_mode(rlc\_mode::um\_bidir);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ logger.log\_info(\textcolor{stringliteral}{"{}RLC\ UM\ configured.\ \{\}"{}},\ cfg);}
\DoxyCodeLine{00052\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1rlc__tx__um__entity_ad60dc9008877a3222036b4f57ed98163}\label{classsrsran_1_1rlc__tx__um__entity_ad60dc9008877a3222036b4f57ed98163} 
\index{srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}!discard\_sdu@{discard\_sdu}}
\index{discard\_sdu@{discard\_sdu}!srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}}
\doxysubsubsection{\texorpdfstring{discard\_sdu()}{discard\_sdu()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} rlc\+\_\+tx\+\_\+um\+\_\+entity\+::discard\+\_\+sdu (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{pdcp\+\_\+sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Interface for higher layers to discard SDUs from RLC queue. 


\begin{DoxyParams}{Parameters}
{\em pdcp\+\_\+sn} & PDCP sequence number (SN) of the SDU that is to be discarded \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface_a349619ff887450259fa44a739d2980b6}{srsran\+::rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00076\ \{}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{if}\ (sdu\_queue.\mbox{\hyperlink{classsrsran_1_1rlc__sdu__queue__lockfree_a5918fa48177cf34b10fef220c8fc719f}{try\_discard}}(pdcp\_sn))\ \{}
\DoxyCodeLine{00078\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Discarded\ SDU.\ pdcp\_sn=\{\}"{}},\ pdcp\_sn);}
\DoxyCodeLine{00079\ \ \ \ \ metrics.metrics\_add\_discard(1);}
\DoxyCodeLine{00080\ \ \ \ \ handle\_changed\_buffer\_state();}
\DoxyCodeLine{00081\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00082\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Could\ not\ discard\ SDU.\ pdcp\_sn=\{\}"{}},\ pdcp\_sn);}
\DoxyCodeLine{00083\ \ \ \ \ metrics.metrics\_add\_discard\_failure(1);}
\DoxyCodeLine{00084\ \ \ \}}
\DoxyCodeLine{00085\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1rlc__tx__um__entity_ad537c8977ec07d1075bd3cbca4cd5b1f}\label{classsrsran_1_1rlc__tx__um__entity_ad537c8977ec07d1075bd3cbca4cd5b1f} 
\index{srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}!get\_buffer\_state@{get\_buffer\_state}}
\index{get\_buffer\_state@{get\_buffer\_state}!srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}}
\doxysubsubsection{\texorpdfstring{get\_buffer\_state()}{get\_buffer\_state()}}
{\footnotesize\ttfamily uint32\+\_\+t rlc\+\_\+tx\+\_\+um\+\_\+entity\+::get\+\_\+buffer\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Get the buffer status information This function provides the current buffer state of the RLC TX entity. This is the gross total size required to fully flush the TX entity (potentially by multiple calls to pull\+\_\+pdu). 

\begin{DoxyReturn}{Returns}
Provides the current buffer state 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface_a7cbb36d4595cc433e55261341ccc641a}{srsran\+::rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00268\ \{}
\DoxyCodeLine{00269\ \ \ std::lock\_guard<std::mutex>\ lock(mutex);}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \textcolor{comment}{//\ minimum\ bytes\ needed\ to\ tx\ all\ queued\ SDUs\ +\ each\ header}}
\DoxyCodeLine{00272\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{queue\_bytes}}\ =\ sdu\_queue.\mbox{\hyperlink{classsrsran_1_1rlc__sdu__queue__lockfree_ab2d800cfef5a9542f480da984fc3e2d0}{size\_bytes}}()\ +\ sdu\_queue.\mbox{\hyperlink{classsrsran_1_1rlc__sdu__queue__lockfree_a4c4aca80a693e78a7030d130e1116c09}{size\_sdus}}()\ *\ head\_len\_full;}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ minimum\ bytes\ needed\ to\ tx\ SDU\ under\ segmentation\ +\ header\ (if\ applicable)}}
\DoxyCodeLine{00275\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{segment\_bytes}}\ =\ 0;}
\DoxyCodeLine{00276\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a4d77b44f1d800f8b2f92bb76e80512f3}{empty}}())\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{segment\_bytes}}\ =\ (sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}()\ -\/\ next\_so)\ +\ head\_len\_not\_first;}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{queue\_bytes}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{segment\_bytes}};}
\DoxyCodeLine{00281\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1rlc__tx__um__entity_add07a68147d63b9fbf12b0607537dfe1}\label{classsrsran_1_1rlc__tx__um__entity_add07a68147d63b9fbf12b0607537dfe1} 
\index{srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}!handle\_sdu@{handle\_sdu}}
\index{handle\_sdu@{handle\_sdu}!srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}}
\doxysubsubsection{\texorpdfstring{handle\_sdu()}{handle\_sdu()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} rlc\+\_\+tx\+\_\+um\+\_\+entity\+::handle\+\_\+sdu (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1rlc__sdu}{rlc\+\_\+sdu}}}]{sdu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Interface for higher layers to pass SDUs into RLC. 


\begin{DoxyParams}{Parameters}
{\em sdu} & SDU to be handled \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__interface_a3672e8658872f39bbcbb61afa9a05235}{srsran\+::rlc\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+data\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00056\ \{}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordtype}{size\_t}\ sdu\_length\ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.buf.length();}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.time\_of\_arrival\ =\ std::chrono::high\_resolution\_clock::now();}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{if}\ (sdu\_queue.\mbox{\hyperlink{classsrsran_1_1rlc__sdu__queue__lockfree_a1a653b33da96f2caea9471794877464c}{write}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}))\ \{}
\DoxyCodeLine{00060\ \ \ \ \ logger.log\_info(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.buf.begin(),}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.buf.end(),}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}TX\ SDU.\ sdu\_len=\{\}\ pdcp\_sn=\{\}\ \{\}"{}},}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.buf.length(),}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.pdcp\_sn,}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sdu\_queue);}
\DoxyCodeLine{00066\ \ \ \ \ metrics.metrics\_add\_sdus(1,\ sdu\_length);}
\DoxyCodeLine{00067\ \ \ \ \ handle\_changed\_buffer\_state();}
\DoxyCodeLine{00068\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00069\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Dropped\ SDU.\ sdu\_len=\{\}\ pdcp\_sn=\{\}\ \{\}"{}},\ sdu\_length,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_}}.pdcp\_sn,\ sdu\_queue);}
\DoxyCodeLine{00070\ \ \ \ \ metrics.metrics\_add\_lost\_sdus(1);}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1rlc__tx__um__entity_a8f352f1b277d06618a880ec70c39d5c3}\label{classsrsran_1_1rlc__tx__um__entity_a8f352f1b277d06618a880ec70c39d5c3} 
\index{srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}!pull\_pdu@{pull\_pdu}}
\index{pull\_pdu@{pull\_pdu}!srsran::rlc\_tx\_um\_entity@{srsran::rlc\_tx\_um\_entity}}
\doxysubsubsection{\texorpdfstring{pull\_pdu()}{pull\_pdu()}}
{\footnotesize\ttfamily size\+\_\+t rlc\+\_\+tx\+\_\+um\+\_\+entity\+::pull\+\_\+pdu (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{rlc\+\_\+pdu\+\_\+buf }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Pulls a PDU from the lower end of the RLC TX entity No PDU is written if the size of {\ttfamily rlc\+\_\+pdu\+\_\+buf} is insufficient or the TX buffer is empty. 


\begin{DoxyParams}{Parameters}
{\em rlc\+\_\+pdu\+\_\+buf} & TX buffer where to encode an RLC Tx PDU. The encoded PDU size cannot exceed the size of the buffer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of bytes taken by the written RLC PDU. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1rlc__tx__lower__layer__interface_acdd2d3757d55392f35627a2a05e1fbcf}{srsran\+::rlc\+\_\+tx\+\_\+lower\+\_\+layer\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00089\ \{}
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\_sdu\_buf}}.size();}
\DoxyCodeLine{00091\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}MAC\ opportunity.\ grant\_len=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}});}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ Check\ available\ space\ -\/-\/\ we\ need\ at\ least\ the\ minimum\ header\ +\ 1\ payload\ Byte}}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}}\ <=\ head\_len\_full)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Cannot\ fit\ SDU\ into\ grant\_len=\{\}.\ head\_len\_full=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}},\ head\_len\_full);}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \textcolor{comment}{//\ Multiple\ threads\ can\ read\ from\ the\ SDU\ queue\ and\ change\ the}}
\DoxyCodeLine{00100\ \ \ \textcolor{comment}{//\ RLC\ UM\ TX\ state\ (current\ SDU,\ tx\_next\ and\ next\_so).}}
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ As\ such\ we\ need\ to\ lock\ to\ access\ these\ variables.}}
\DoxyCodeLine{00102\ \ \ std::lock\_guard<std::mutex>\ lock(mutex);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{comment}{//\ Get\ a\ new\ SDU,\ if\ none\ is\ currently\ being\ transmitted}}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{if}\ (sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a4d77b44f1d800f8b2f92bb76e80512f3}{empty}}())\ \{}
\DoxyCodeLine{00106\ \ \ \ \ srsran\_sanity\_check(next\_so\ ==\ 0,\ \textcolor{stringliteral}{"{}New\ TX\ SDU,\ but\ next\_so=\{\}\ >\ 0."{}},\ next\_so);}
\DoxyCodeLine{00107\ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Reading\ SDU\ from\ sdu\_queue.\ \{\}"{}},\ sdu\_queue);}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ sdu\_queue.\mbox{\hyperlink{classsrsran_1_1rlc__sdu__queue__lockfree_a5b2d6733746aaf17fd87a0743ba52501}{read}}(sdu))\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}SDU\ queue\ empty.\ grant\_len=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}});}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\};}
\DoxyCodeLine{00111\ \ \ \ \ \}}
\DoxyCodeLine{00112\ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Read\ SDU.\ sn=\{\}\ pdcp\_sn=\{\}\ sdu\_len=\{\}"{}},\ st.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__state_a6383b6ef13590b12ffdcbda9b03ba4be}{tx\_next}},\ sdu.pdcp\_sn,\ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}());}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ Notify\ the\ upper\ layer\ about\ the\ beginning\ of\ the\ transfer\ of\ the\ current\ SDU}}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (sdu.pdcp\_sn.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ upper\_dn.\mbox{\hyperlink{classsrsran_1_1rlc__tx__upper__layer__data__notifier_aa6056abcbe99afbd8359eb5617fd1687}{on\_transmitted\_sdu}}(sdu.pdcp\_sn.value());}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{comment}{//\ Prepare\ header}}
\DoxyCodeLine{00121\ \ \ \mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header}{rlc\_um\_pdu\_header}}\ header\ =\ \{\};}
\DoxyCodeLine{00122\ \ \ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_af8b1b6059c25d2772c2409b14f03bf1a}{sn}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ st.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__state_a6383b6ef13590b12ffdcbda9b03ba4be}{tx\_next}};}
\DoxyCodeLine{00123\ \ \ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_a3081b872c91bb3a49153b8a1b0cdcf44}{sn\_size}}\ \ \ \ \ \ \ \ \ \ \ =\ cfg.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__config_ac5bff1bdd61720b654de8a9cc1afe73c}{sn\_field\_length}};}
\DoxyCodeLine{00124\ \ \ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_a576b3037ef830805618ce863e585db93}{so}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ next\_so;}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \textcolor{comment}{//\ Get\ SI\ and\ expected\ header\ size}}
\DoxyCodeLine{00127\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expected\_hdr\_len}}\ =\ 0;}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ get\_si\_and\_expected\_header\_size(next\_so,\ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}},\ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expected\_hdr\_len}}))\ \{}
\DoxyCodeLine{00129\ \ \ \ \ logger.log\_debug(}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ fit\ any\ payload\ into\ grant\_len=\{\}.\ expected\_hdr\_len=\{\}\ si=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expected\_hdr\_len}},\ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}});}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \textcolor{comment}{//\ Pack\ header}}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}}\ =\ rlc\_um\_write\_data\_pdu\_header(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\_sdu\_buf}},\ header);}
\DoxyCodeLine{00136\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expected\_hdr\_len}},}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Failed\ to\ write\ header.\ header\_len=\{\}\ expected\_hdr\_len=\{\}"{}},}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}},}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{expected\_hdr\_len}});}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \textcolor{comment}{//\ Calculate\ the\ amount\ of\ data\ to\ move}}
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ space\ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}};}
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{payload\_len}}\ =\ space\ >=\ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}()\ -\/\ next\_so\ ?\ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}()\ -\/\ next\_so\ :\ space;}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{comment}{//\ Log\ PDU\ info}}
\DoxyCodeLine{00146\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Creating\ PDU.\ si=\{\}\ payload\_len=\{\}\ header\_len=\{\}\ sdu\_len=\{\}\ grant\_len=\{\}"{}},}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}},}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{payload\_len}},}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}},}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}(),}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}});}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ Assemble\ PDU}}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nwritten}}\ =\ \mbox{\hyperlink{namespacesrsran_a25b3f3ac88ceac35444d218355d229f9}{copy\_segments}}(\mbox{\hyperlink{classsrsran_1_1byte__buffer__view}{byte\_buffer\_view}}\{sdu.buf,\ next\_so,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{payload\_len}}\},}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\_sdu\_buf}}.subspan(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\_sdu\_buf}}.size()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}}));}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nwritten}}\ ==\ 0\ ||\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nwritten}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{payload\_len}})\ \{}
\DoxyCodeLine{00157\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Could\ not\ write\ PDU\ payload.\ \{\}\ payload\_len=\{\}\ grant\_len=\{\}"{}},\ header,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{payload\_len}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}});}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00159\ \ \ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \textcolor{keywordtype}{size\_t}\ pdu\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{header\_len}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nwritten}};}
\DoxyCodeLine{00162\ \ \ logger.log\_info(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\_sdu\_buf}}.data(),\ pdu\_size,\ \textcolor{stringliteral}{"{}TX\ PDU.\ \{\}\ pdu\_size=\{\}\ grant\_len=\{\}"{}},\ header,\ pdu\_size,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{grant\_len}});}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \textcolor{comment}{//\ Release\ SDU\ if\ needed}}
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{if}\ (header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}}\ ==\ \mbox{\hyperlink{namespacesrsran_a325c27da08346f5cd691cc27c8149798a4dff537721d1435566e8a133eeac2bdf}{rlc\_si\_field::full\_sdu}}\ ||\ header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}}\ ==\ \mbox{\hyperlink{namespacesrsran_a325c27da08346f5cd691cc27c8149798ad1cd941e9361399f0433d63e6f7d7c76}{rlc\_si\_field::last\_segment}})\ \{}
\DoxyCodeLine{00166\ \ \ \ \ sdu.buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7c8882b6403ea3f246d63c64dd122f10}{clear}}();}
\DoxyCodeLine{00167\ \ \ \ \ next\_so\ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{latency}}\ =\ std::chrono::duration\_cast<std::chrono::nanoseconds>(std::chrono::high\_resolution\_clock::now()\ -\/}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sdu.time\_of\_arrival);}
\DoxyCodeLine{00170\ \ \ \ \ metrics.metrics\_add\_sdu\_latency\_us(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{latency}}.count()\ /\ 1000);}
\DoxyCodeLine{00171\ \ \ \ \ metrics.metrics\_add\_pulled\_sdus(1);}
\DoxyCodeLine{00172\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{comment}{//\ advance\ SO\ offset}}
\DoxyCodeLine{00174\ \ \ \ \ next\_so\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{payload\_len}};}
\DoxyCodeLine{00175\ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{comment}{//\ Update\ SN\ if\ needed}}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordflow}{if}\ (header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}}\ ==\ \mbox{\hyperlink{namespacesrsran_a325c27da08346f5cd691cc27c8149798ad1cd941e9361399f0433d63e6f7d7c76}{rlc\_si\_field::last\_segment}})\ \{}
\DoxyCodeLine{00179\ \ \ \ \ st.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__state_a6383b6ef13590b12ffdcbda9b03ba4be}{tx\_next}}\ =\ (st.\mbox{\hyperlink{structsrsran_1_1rlc__tx__um__state_a6383b6ef13590b12ffdcbda9b03ba4be}{tx\_next}}\ +\ 1)\ \%\ mod;}
\DoxyCodeLine{00180\ \ \ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \textcolor{comment}{//\ Update\ metrics}}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordflow}{if}\ (header.\mbox{\hyperlink{structsrsran_1_1rlc__um__pdu__header_ad32a4861ad04c56f44937c696639fee3}{si}}\ ==\ \mbox{\hyperlink{namespacesrsran_a325c27da08346f5cd691cc27c8149798a4dff537721d1435566e8a133eeac2bdf}{rlc\_si\_field::full\_sdu}})\ \{}
\DoxyCodeLine{00184\ \ \ \ \ metrics.metrics\_add\_pdus\_no\_segmentation(1,\ pdu\_size);}
\DoxyCodeLine{00185\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00186\ \ \ \ \ metrics.metrics\_add\_pdus\_with\_segmentation\_um(1,\ pdu\_size);}
\DoxyCodeLine{00187\ \ \ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ Log\ state}}
\DoxyCodeLine{00190\ \ \ log\_state(srslog::basic\_levels::debug);}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ pcap.push\_pdu(pcap\_context,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mac\_sdu\_buf}}.subspan(0,\ pdu\_size));}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{return}\ pdu\_size;}
\DoxyCodeLine{00195\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/rlc/rlc\+\_\+tx\+\_\+um\+\_\+entity.\+h\item 
lib/rlc/rlc\+\_\+tx\+\_\+um\+\_\+entity.\+cpp\end{DoxyCompactItemize}
