\doxysection{srsran\+::pdcp\+\_\+entity\+\_\+tx Class Reference}
\hypertarget{classsrsran_1_1pdcp__entity__tx}{}\label{classsrsran_1_1pdcp__entity__tx}\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}


{\ttfamily \#include $<$pdcp\+\_\+entity\+\_\+tx.\+h$>$}



Inheritance diagram for srsran\+::pdcp\+\_\+entity\+\_\+tx\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/d7f/classsrsran_1_1pdcp__entity__tx__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::pdcp\+\_\+entity\+\_\+tx\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{de/df1/classsrsran_1_1pdcp__entity__tx__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_1_1discard__callback}{discard\+\_\+callback}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a309a144d983a03b587d9cf59a779127c}{pdcp\+\_\+entity\+\_\+tx}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rb\+\_\+id\+\_\+}}, \mbox{\hyperlink{structsrsran_1_1pdcp__tx__config}{pdcp\+\_\+tx\+\_\+config}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cfg\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__notifier}{pdcp\+\_\+tx\+\_\+lower\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\+\_\+dn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__notifier}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\+\_\+cn\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1timer__factory}{timer\+\_\+factory}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timers\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a84348e13aaec3959ac0ae9bdb4d325e7}{reestablish}} (\mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{security\+::sec\+\_\+128\+\_\+as\+\_\+config}} sec\+\_\+cfg) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Triggers re-\/establishment as specified in TS 38.\+323, section 5.\+1.\+2. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_afc28528760cb7959b00e8c36069ee71b}{set\+\_\+status\+\_\+provider}} (\mbox{\hyperlink{classsrsran_1_1pdcp__rx__status__provider}{pdcp\+\_\+rx\+\_\+status\+\_\+provider}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{status\+\_\+provider\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a1effbdab2dccfa3755c51be31faa7776}{handle\+\_\+sdu}} (\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} sdu) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\begin{DoxyCompactList}\small\item\em Receive an SDU from the upper layers, apply encryption and integrity protection and pass the resulting PDU to the lower layers. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a9fd33e0f17ed26d11818fc1fff7abd16}{handle\+\_\+transmit\+\_\+notification}} (uint32\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\+\_\+sn}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Informs the PDCP entity about the highest PDCP PDU sequence number of the PDCP PDU that was transmitted by the lower layers (i.\+e. by the RLC). \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a90587ae58ec5fe6cc614fff4ee5bf6c3}{handle\+\_\+delivery\+\_\+notification}} (uint32\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\+\_\+sn}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Informs the PDCP about the highest PDCP PDU sequence number of the PDCP PDU that was successfully delivered in sequence towards the UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a36ca57bcd175a017324947de403a4f5f}{handle\+\_\+status\+\_\+report}} (\mbox{\hyperlink{classsrsran_1_1byte__buffer__chain}{byte\+\_\+buffer\+\_\+chain}} status)
\begin{DoxyCompactList}\small\item\em Evaluates a PDCP status report. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a5664be94f802bc5eaad1d73e5f5b4fb4}{on\+\_\+status\+\_\+report}} (\mbox{\hyperlink{classsrsran_1_1byte__buffer__chain}{byte\+\_\+buffer\+\_\+chain}} status) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\begin{DoxyCompactList}\small\item\em Status report handler for TX entity. \end{DoxyCompactList}\item 
\mbox{\hyperlink{compiler_8h_a84270d7b45f0280051bd27685657e03e}{SRSRAN\+\_\+\+NODISCARD}} \mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a6263f068f434b6bbd58ffb4a730fed15}{write\+\_\+data\+\_\+pdu\+\_\+header}} (\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} \&buf, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header}{pdcp\+\_\+data\+\_\+pdu\+\_\+header}} \&hdr) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Writes the header of a PDCP data PDU according to the content of the associated object. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a1e2111d55ac320b4d46bd6ce5892e718}{set\+\_\+state}} (\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state}{pdcp\+\_\+tx\+\_\+state}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{st\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pdcp__tx__state}{pdcp\+\_\+tx\+\_\+state}} \& \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a82e4af0182f536f6a915a440828021c4}{get\+\_\+state}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a2527c3d87174c8f759f8613bfccc1000}{nof\+\_\+discard\+\_\+timers}} ()
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_ab5d4a40f52777fa8af1950a6737c8b28}{configure\+\_\+security}} (\mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{security\+::sec\+\_\+128\+\_\+as\+\_\+config}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\+\_\+cfg\+\_\+}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\begin{DoxyCompactList}\small\item\em Setup security. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a6cbb3b77b7e19293231b8081c05e97da}{set\+\_\+integrity\+\_\+protection}} (security\+::integrity\+\_\+enabled \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{integrity\+\_\+enabled\+\_\+}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a1837f60e5e5fb16bfb799fbc6f7113c1}{set\+\_\+ciphering}} (security\+::ciphering\+\_\+enabled \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ciphering\+\_\+enabled\+\_\+}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a33d852bf24e05ac2bb27169b65e5ac18}{send\+\_\+status\+\_\+report}} ()
\begin{DoxyCompactList}\small\item\em Sends a status report, as specified in TS 38.\+323, Sec. 5.\+4. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_aef9f1f7caf68ba929640031d001644a2}{data\+\_\+recovery}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Performs data recovery, as specified in TS 38.\+323, Sec. 5.\+5. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a44e914866995789ab85218f828b321f9}{reset}} ()
\begin{DoxyCompactList}\small\item\em Reset state variables to their initial state and drop all discard timers with all stored SDUs. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a873e30a3ef188b83f08a6bc922955d3c}{retransmit\+\_\+all\+\_\+pdus}} ()
\begin{DoxyCompactList}\small\item\em Retransmits all PDUs. Integrity protection and ciphering is re-\/applied. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
{\bfseries pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
{\bfseries pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{srsran\+::pdcp\+\_\+tx\+\_\+lower\+\_\+interface}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries pdcp\+\_\+tx\+\_\+lower\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{pdcp\+\_\+tx\+\_\+lower\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{pdcp\+\_\+tx\+\_\+lower\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{pdcp\+\_\+tx\+\_\+lower\+\_\+interface}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
{\bfseries pdcp\+\_\+tx\+\_\+lower\+\_\+interface} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{pdcp\+\_\+tx\+\_\+lower\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{pdcp\+\_\+tx\+\_\+lower\+\_\+interface}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface}{pdcp\+\_\+tx\+\_\+lower\+\_\+interface}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics}{srsran\+::pdcp\+\_\+tx\+\_\+metrics}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics_a818057f4b7e851437c1f69a599c08cdb}{metrics\+\_\+add\+\_\+sdus}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\+\_\+sdus\+\_\+}}, size\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\+\_\+sdu\+\_\+bytes\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics_a4c9f0e59ad28a2c3988b1c1b1a27d955}{metrics\+\_\+add\+\_\+pdus}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\+\_\+pdus\+\_\+}}, size\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\+\_\+pdu\+\_\+bytes\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics_a79a353bac7b5bddd74402e300c05cb61}{metrics\+\_\+add\+\_\+discard\+\_\+timouts}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\+\_\+discard\+\_\+timeouts\+\_\+}})
\item 
\mbox{\hyperlink{structsrsran_1_1pdcp__tx__metrics__container}{pdcp\+\_\+tx\+\_\+metrics\+\_\+container}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics_a13565982cf82362cf1482dc2453a5e93}{get\+\_\+metrics}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\begin{DoxyCompactList}\small\item\em Metrics interfaces. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1pdcp__tx__metrics__container}{pdcp\+\_\+tx\+\_\+metrics\+\_\+container}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics_a28abc6825ffe3848330d1c9a9dc61a4a}{get\+\_\+metrics\+\_\+and\+\_\+reset}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcp__tx__metrics_a49eaae0b910dc586bce0771ddd8fd929}{reset\+\_\+metrics}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{final}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base}{srsran\+::pdcp\+\_\+entity\+\_\+tx\+\_\+rx\+\_\+base}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a1aaf2f968f4520881d63b9ca0e73f4df}{pdcp\+\_\+entity\+\_\+tx\+\_\+rx\+\_\+base}} (\mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rb\+\_\+id\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a40dbb8c1c2d97d55fd44cc67ddc5361c}{pdcp\+\_\+rb\+\_\+type}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rb\+\_\+type\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a9e50d988260b31c9ea661e6ff525036f}{pdcp\+\_\+rlc\+\_\+mode}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rlc\+\_\+mode\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a6efd299a2e6b44aa7ae09878d4757fec}{pdcp\+\_\+sn\+\_\+size}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sn\+\_\+size\+\_\+}})
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a49f42b37d6149ee894f65191dc9cd590}{is\+\_\+srb}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a7d10e6a754901bf47e992f64c2e7e7dd}{is\+\_\+drb}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a48e5cf1083cfd5498bed1a60577ea12c}{is\+\_\+um}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a8ac05ae8054a419c238593fc736e135c}{is\+\_\+am}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a5f8f1e57de1c654ab9f4accffe80cb8c}{SN}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} count) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_af1205aba91ef7fe5d6d35f5c9c888fb7}{HFN}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} count) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_ab7c5e3c3bc748f0382e74091e2507089}{COUNT}} (\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} hfn, \mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} sn) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base}{srsran\+::pdcp\+\_\+entity\+\_\+tx\+\_\+rx\+\_\+base}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx__rx__base_a2d500113dfbaea034c67492ed1d68d04}{bearer\+\_\+id}}
\item 
\mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}} {\bfseries rb\+\_\+id}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_a40dbb8c1c2d97d55fd44cc67ddc5361c}{pdcp\+\_\+rb\+\_\+type}} {\bfseries rb\+\_\+type}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_a9e50d988260b31c9ea661e6ff525036f}{pdcp\+\_\+rlc\+\_\+mode}} {\bfseries rlc\+\_\+mode}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries hdr\+\_\+len\+\_\+bytes}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} {\bfseries window\+\_\+size}
\item 
\mbox{\hyperlink{classbool}{bool}} {\bfseries max\+\_\+count\+\_\+notified} = \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{false}}
\item 
\mbox{\hyperlink{classbool}{bool}} {\bfseries max\+\_\+count\+\_\+overflow} = \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{false}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_a6efd299a2e6b44aa7ae09878d4757fec}{pdcp\+\_\+sn\+\_\+size}} {\bfseries sn\+\_\+size}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\doxylink{classBase}{Base} class used for transmitting PDCP bearers. It provides interfaces for the PDCP bearers, for the higher and lower layers 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a309a144d983a03b587d9cf59a779127c}\label{classsrsran_1_1pdcp__entity__tx_a309a144d983a03b587d9cf59a779127c} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!pdcp\_entity\_tx@{pdcp\_entity\_tx}}
\index{pdcp\_entity\_tx@{pdcp\_entity\_tx}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{pdcp\_entity\_tx()}{pdcp\_entity\_tx()}}
{\footnotesize\ttfamily srsran\+::pdcp\+\_\+entity\+\_\+tx\+::pdcp\+\_\+entity\+\_\+tx (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\+\_\+id\+\_\+t}}}]{rb\+\_\+id\+\_\+,  }\item[{\mbox{\hyperlink{structsrsran_1_1pdcp__tx__config}{pdcp\+\_\+tx\+\_\+config}}}]{cfg\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__notifier}{pdcp\+\_\+tx\+\_\+lower\+\_\+notifier}} \&}]{lower\+\_\+dn\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__notifier}{pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+notifier}} \&}]{upper\+\_\+cn\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1timer__factory}{timer\+\_\+factory}}}]{timers\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00081\ \ \ \ \ pdcp\_entity\_tx\_rx\_base(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rb\_id\_}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cfg\_}}.rb\_type,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cfg\_}}.rlc\_mode,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cfg\_}}.sn\_size),}
\DoxyCodeLine{00082\ \ \ \ \ logger(\textcolor{stringliteral}{"{}PDCP"{}},\ \{ue\_index,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rb\_id\_}},\ \textcolor{stringliteral}{"{}DL"{}}\}),}
\DoxyCodeLine{00083\ \ \ \ \ cfg(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cfg\_}}),}
\DoxyCodeLine{00084\ \ \ \ \ lower\_dn(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\_dn\_}}),}
\DoxyCodeLine{00085\ \ \ \ \ upper\_cn(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\_cn\_}}),}
\DoxyCodeLine{00086\ \ \ \ \ timers(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timers\_}}),}
\DoxyCodeLine{00087\ \ \ \ \ tx\_window(create\_tx\_window(cfg.sn\_size))}
\DoxyCodeLine{00088\ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ Validate\ configuration}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_srb()\ \&\&\ (cfg.sn\_size\ !=\ pdcp\_sn\_size::size12bits))\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a355eafe8d872b8f555172fa7bcd1482f}{report\_error}}(\textcolor{stringliteral}{"{}PDCP\ SRB\ with\ invalid\ sn\_size.\ \{\}"{}},\ cfg);}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_srb()\ \&\&\ is\_um())\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a355eafe8d872b8f555172fa7bcd1482f}{report\_error}}(\textcolor{stringliteral}{"{}PDCP\ SRB\ cannot\ be\ used\ with\ RLC\ UM.\ \{\}"{}},\ cfg);}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_srb()\ \&\&\ cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Invalid\ SRB\ config\ with\ discard\_timer=\{\}"{}},\ cfg.discard\_timer);}
\DoxyCodeLine{00098\ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_drb()\ \&\&\ !cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Invalid\ DRB\ config,\ discard\_timer\ is\ not\ configured"{}});}
\DoxyCodeLine{00101\ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ direction\ =\ cfg.direction\ ==\ pdcp\_security\_direction::uplink\ ?\ security::security\_direction::uplink}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ security::security\_direction::downlink;}
\DoxyCodeLine{00105\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}PDCP\ configured.\ \{\}"{}},\ cfg);}
\DoxyCodeLine{00106\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_ab5d4a40f52777fa8af1950a6737c8b28}\label{classsrsran_1_1pdcp__entity__tx_ab5d4a40f52777fa8af1950a6737c8b28} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!configure\_security@{configure\_security}}
\index{configure\_security@{configure\_security}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{configure\_security()}{configure\_security()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::configure\+\_\+security (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{security\+::sec\+\_\+128\+\_\+as\+\_\+config}}}]{sec\+\_\+cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Setup security. 



Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface_af3d37729b5ab82f6af94cd91cb613eee}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00158\ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ srsran\_assert((is\_srb()\ \&\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}}.domain\ ==\ security::sec\_domain::rrc)\ ||}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (is\_drb()\ \&\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}}.domain\ ==\ security::sec\_domain::up),}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ sec\_domain=\{\}\ for\ \{\}\ in\ \{\}"{}},}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sec\_cfg.domain,}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rb\_type,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rb\_id);}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{//\ The\ 'NULL'\ integrity\ protection\ algorithm\ (nia0)\ is\ used\ only\ for\ SRBs\ and\ for\ the\ UE\ in\ limited\ service\ mode,}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{comment}{//\ see\ TS\ 33.501\ [11]\ and\ when\ used\ for\ SRBs,\ integrity\ protection\ is\ disabled\ for\ DRBs.\ In\ case\ the\ ′NULL'}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{comment}{//\ integrity\ protection\ algorithm\ is\ used,\ 'NULL'\ ciphering\ algorithm\ is\ also\ used.}}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{//\ Ref:\ TS\ 38.331\ Sec.\ 5.3.1.2}}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}}.integ\_algo\ ==\ security::integrity\_algorithm::nia0)\ \&\&}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ (is\_drb()\ ||\ (is\_srb()\ \&\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}}.cipher\_algo\ !=\ security::ciphering\_algorithm::nea0)))\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ logger.log\_error(}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Integrity\ algorithm\ NIA0\ is\ only\ permitted\ for\ SRBs\ configured\ with\ NEA0.\ is\_srb=\{\}\ NIA\{\}\ NEA\{\}"{}},}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ is\_srb(),}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}}.integ\_algo,}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}}.cipher\_algo);}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ sec\_cfg\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}};}
\DoxyCodeLine{00179\ \ \ \ \ logger.log\_info(}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Security\ configured:\ NIA\{\}\ NEA\{\}\ domain=\{\}"{}},\ sec\_cfg.integ\_algo,\ sec\_cfg.cipher\_algo,\ sec\_cfg.domain);}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordflow}{if}\ (sec\_cfg.k\_128\_int.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ logger.log\_info(sec\_cfg.k\_128\_int.value().data(),\ 16,\ \textcolor{stringliteral}{"{}128\ K\_int"{}});}
\DoxyCodeLine{00183\ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ logger.log\_info(sec\_cfg.k\_128\_enc.data(),\ 16,\ \textcolor{stringliteral}{"{}128\ K\_enc"{}});}
\DoxyCodeLine{00185\ \ \ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_aef9f1f7caf68ba929640031d001644a2}\label{classsrsran_1_1pdcp__entity__tx_aef9f1f7caf68ba929640031d001644a2} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!data\_recovery@{data\_recovery}}
\index{data\_recovery@{data\_recovery}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{data\_recovery()}{data\_recovery()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::data\+\_\+recovery (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Performs data recovery, as specified in TS 38.\+323, Sec. 5.\+5. 



Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface_a3b9ec7ba423def998541df126899acbe}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00378\ \{}
\DoxyCodeLine{00379\ \ \ srsran\_assert(is\_drb()\ \&\&\ cfg.rlc\_mode\ ==\ pdcp\_rlc\_mode::am,\ \textcolor{stringliteral}{"{}Invalid\ bearer\ type\ for\ data\ recovery."{}});}
\DoxyCodeLine{00380\ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Data\ recovery\ requested."{}});}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00383\ \textcolor{comment}{\ \ \ *\ TS\ 38.323\ Sec.\ 5.4.1:}}
\DoxyCodeLine{00384\ \textcolor{comment}{\ \ \ *\ [...]\ the\ receiving\ PDCP\ entity\ shall\ trigger\ a\ PDCP\ status\ report\ when:}}
\DoxyCodeLine{00385\ \textcolor{comment}{\ \ \ *\ [...]\ -\/upper\ layer\ requests\ a\ PDCP\ data\ recovery;\ [...]}}
\DoxyCodeLine{00386\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00387\ \ \ \textcolor{keywordflow}{if}\ (cfg.status\_report\_required)\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a33d852bf24e05ac2bb27169b65e5ac18}{send\_status\_report}}();}
\DoxyCodeLine{00389\ \ \ \}}
\DoxyCodeLine{00390\ \ \ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a873e30a3ef188b83f08a6bc922955d3c}{retransmit\_all\_pdus}}();}
\DoxyCodeLine{00391\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a82e4af0182f536f6a915a440828021c4}\label{classsrsran_1_1pdcp__entity__tx_a82e4af0182f536f6a915a440828021c4} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!get\_state@{get\_state}}
\index{get\_state@{get\_state}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{get\_state()}{get\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pdcp__tx__state}{pdcp\+\_\+tx\+\_\+state}} \& srsran\+::pdcp\+\_\+entity\+\_\+tx\+::get\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00150\ \{\ \textcolor{keywordflow}{return}\ st;\ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a90587ae58ec5fe6cc614fff4ee5bf6c3}\label{classsrsran_1_1pdcp__entity__tx_a90587ae58ec5fe6cc614fff4ee5bf6c3} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!handle\_delivery\_notification@{handle\_delivery\_notification}}
\index{handle\_delivery\_notification@{handle\_delivery\_notification}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{handle\_delivery\_notification()}{handle\_delivery\_notification()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::handle\+\_\+delivery\+\_\+notification (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{highest\+\_\+sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Informs the PDCP about the highest PDCP PDU sequence number of the PDCP PDU that was successfully delivered in sequence towards the UE. 

In case of RLC AM, the PDCP will stop the discard timers for all PDUs up to highest\+\_\+sn. In case of RLC UM, the PDCP will ignore this notification.


\begin{DoxyParams}{Parameters}
{\em highest\+\_\+sn} & Highest in a sequence delivered PDCP PDU sequence number. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface_a4f06eb3f10586bd8d2f809ba246a5b3c}{srsran\+::pdcp\+\_\+tx\+\_\+lower\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00486\ \{}
\DoxyCodeLine{00487\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Handling\ delivery\ notification\ for\ notif\_sn=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}});}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}}\ >=\ pdcp\_sn\_cardinality(cfg.sn\_size))\ \{}
\DoxyCodeLine{00489\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Invalid\ delivery\ notification\ for\ notif\_sn=\{\}\ exceeds\ sn\_size=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}},\ cfg.sn\_size);}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00491\ \ \ \}}
\DoxyCodeLine{00492\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}}\ =\ notification\_count\_estimation(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}});}
\DoxyCodeLine{00493\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}}\ >=\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}})\ \{}
\DoxyCodeLine{00494\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Got\ notification\ for\ invalid\ COUNT.\ notif\_count=\{\}\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}},\ st);}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00496\ \ \ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \ \ \textcolor{comment}{//\ Stop\ discard\ timers\ if\ required}}
\DoxyCodeLine{00499\ \ \ \textcolor{keywordflow}{if}\ (!cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00501\ \ \ \}}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \textcolor{keywordflow}{if}\ (is\_am())\ \{}
\DoxyCodeLine{00504\ \ \ \ \ stop\_discard\_timer(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}});}
\DoxyCodeLine{00505\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00506\ \ \ \ \ logger.log\_warning(\textcolor{stringliteral}{"{}Received\ PDU\ delivery\ notification\ on\ UM\ bearer.\ sn=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}});}
\DoxyCodeLine{00507\ \ \ \}}
\DoxyCodeLine{00508\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a1effbdab2dccfa3755c51be31faa7776}\label{classsrsran_1_1pdcp__entity__tx_a1effbdab2dccfa3755c51be31faa7776} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!handle\_sdu@{handle\_sdu}}
\index{handle\_sdu@{handle\_sdu}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{handle\_sdu()}{handle\_sdu()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::handle\+\_\+sdu (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}}}]{buf }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Receive an SDU from the upper layers, apply encryption and integrity protection and pass the resulting PDU to the lower layers. 


\begin{DoxyParams}{Parameters}
{\em sdu} & Buffer that hold the SDU from higher layers. \doxylink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{TS} 38.\+323 section 5.\+2.\+1\+: Transmit operation \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__data__interface_af3d7f1df312d7ee0adc10261080d3e0a}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+data\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00040\ \{}
\DoxyCodeLine{00041\ \ \ trace\_point\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_tp}}\ =\ \mbox{\hyperlink{namespacesrsran_a46a9d0c2069e595c7efbda41e108f76b}{up\_tracer}}.now();}
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{//\ Avoid\ TX'ing\ if\ we\ are\ close\ to\ overload\ RLC\ SDU\ queue}}
\DoxyCodeLine{00043\ \ \ \textcolor{keywordflow}{if}\ (st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_ab2acba6d2ab29e2e2945921f3ac59d25}{tx\_trans}}\ >\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}})\ \{}
\DoxyCodeLine{00044\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Invalid\ state,\ tx\_trans\ is\ larger\ than\ tx\_next.\ \{\}"{}},\ st);}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00046\ \ \ \}}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordflow}{if}\ ((st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}\ -\/\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_ab2acba6d2ab29e2e2945921f3ac59d25}{tx\_trans}})\ >=\ cfg.custom.rlc\_sdu\_queue)\ \{}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ cfg.custom.warn\_on\_drop)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Dropping\ SDU\ to\ avoid\ overloading\ RLC\ queue.\ rlc\_sdu\_queue=\{\}\ \{\}"{}},\ cfg.custom.rlc\_sdu\_queue,\ st);}
\DoxyCodeLine{00050\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ logger.log\_warning(}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Dropping\ SDU\ to\ avoid\ overloading\ RLC\ queue.\ rlc\_sdu\_queue=\{\}\ \{\}"{}},\ cfg.custom.rlc\_sdu\_queue,\ st);}
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00055\ \ \ \}}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordflow}{if}\ ((st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}\ -\/\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_ab2acba6d2ab29e2e2945921f3ac59d25}{tx\_trans}})\ >=\ (window\_size\ -\/\ 1))\ \{}
\DoxyCodeLine{00057\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Dropping\ SDU\ to\ avoid\ going\ over\ the\ TX\ window\ size.\ \{\}"{}},\ st);}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ metrics\_add\_sdus(1,\ buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}());}
\DoxyCodeLine{00062\ \ \ logger.log\_debug(buf.begin(),\ buf.end(),\ \textcolor{stringliteral}{"{}TX\ SDU.\ sdu\_len=\{\}"{}},\ buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a7168fb8841a83a60b60a2ae06b59662d}{length}}());}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//\ The\ PDCP\ is\ not\ allowed\ to\ use\ the\ same\ COUNT\ value\ more\ than\ once\ for\ a\ given\ security\ key,}}
\DoxyCodeLine{00065\ \ \ \textcolor{comment}{//\ see\ TS\ 38.331,\ section\ 5.3.1.2.\ To\ avoid\ this,\ we\ notify\ the\ RRC\ once\ we\ exceed\ a\ "{}maximum"{}}}
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ COUNT.\ It\ is\ then\ the\ RRC's\ responsibility\ to\ refresh\ the\ keys.\ We\ continue\ transmitting\ until}}
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ we\ reached\ a\ maximum\ hard\ COUNT,\ after\ which\ we\ simply\ refuse\ to\ TX\ any\ further.}}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{if}\ (st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}\ >=\ cfg.custom.max\_count.hard)\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{if}\ (!max\_count\_overflow)\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Reached\ maximum\ count,\ refusing\ to\ transmit\ further.\ count=\{\}"{}},\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00071\ \ \ \ \ \ \ upper\_cn.on\_protocol\_failure();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ max\_count\_overflow\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{if}\ (st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}\ >=\ cfg.custom.max\_count.notify)\ \{}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{if}\ (!max\_count\_notified)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ logger.log\_warning(\textcolor{stringliteral}{"{}Approaching\ count\ wrap-\/around,\ notifying\ RRC.\ count=\{\}"{}},\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00079\ \ \ \ \ \ \ upper\_cn.on\_max\_count\_reached();}
\DoxyCodeLine{00080\ \ \ \ \ \ \ max\_count\_notified\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ We\ will\ need\ a\ copy\ of\ the\ SDU\ for\ the\ discard\ timer\ when\ using\ AM}}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ sdu;}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{if}\ (cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}()\ \&\&\ is\_am())\ \{}
\DoxyCodeLine{00087\ \ \ \ \ sdu\ =\ buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_aa79a5e270dbb5dd01b83c034853b9fb3}{deep\_copy}}();}
\DoxyCodeLine{00088\ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ Perform\ header\ compression}}
\DoxyCodeLine{00091\ \ \ \textcolor{comment}{//\ TODO}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ Prepare\ header}}
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header}{pdcp\_data\_pdu\_header}}\ hdr\ =\ \{\};}
\DoxyCodeLine{00095\ \ \ hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ SN(st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{comment}{//\ Pack\ header}}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a6263f068f434b6bbd58ffb4a730fed15}{write\_data\_pdu\_header}}(buf,\ hdr))\ \{}
\DoxyCodeLine{00099\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Could\ not\ append\ PDU\ header,\ dropping\ SDU\ and\ notifying\ RRC.\ count=\{\}"{}},\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00100\ \ \ \ \ upper\_cn.on\_protocol\_failure();}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00102\ \ \ \}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{comment}{//\ Apply\ ciphering\ and\ integrity\ protection}}
\DoxyCodeLine{00105\ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{expected<byte\_buffer>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{exp\_buf}}\ =\ apply\_ciphering\_and\_integrity\_protection(std::move(buf),\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{exp\_buf}}.is\_error())\ \{}
\DoxyCodeLine{00107\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Could\ not\ apply\ ciphering\ and\ integrity\ protection,\ dropping\ SDU\ and\ notifying\ RRC.\ count=\{\}"{}},}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00109\ \ \ \ \ upper\_cn.on\_protocol\_failure();}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00111\ \ \ \}}
\DoxyCodeLine{00112\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{protected\_buf}}\ =\ std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{exp\_buf}}.value());}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \textcolor{comment}{//\ Create\ a\ discard\ timer\ and\ put\ into\ tx\_window.\ For\ AM,\ also\ store\ the\ SDU\ for\ a\ possible\ data\ recovery\ procedure.}}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{if}\ (cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1unique__timer}{unique\_timer}}\ discard\_timer\ =\ \{\};}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{//\ Only\ start\ for\ finite\ durations}}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordflow}{if}\ (cfg.discard\_timer.value()\ !=\ pdcp\_discard\_timer::infinity)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ discard\_timer\ =\ timers.create\_timer();}
\DoxyCodeLine{00120\ \ \ \ \ \ \ discard\_timer.\mbox{\hyperlink{classsrsran_1_1unique__timer_a79c9d6ec6c5942aa869ea4ba273536c5}{set}}(std::chrono::milliseconds(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(cfg.discard\_timer.value())),}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ discard\_callback\{this,\ st.tx\_next\});}
\DoxyCodeLine{00122\ \ \ \ \ \ \ discard\_timer.\mbox{\hyperlink{classsrsran_1_1unique__timer_af3fa2fce72a8058698b971e498e0c262}{run}}();}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{comment}{//\ If\ the\ place\ in\ the\ tx\_window\ is\ occupied\ by\ an\ old\ element\ from\ previous\ wrap,\ discard\ that\ element\ first.}}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (tx\_window-\/>has\_sn(st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}))\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{old\_count}}\ =\ (*tx\_window)[st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}].count;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Tx\ window\ full.\ Discarding\ old\_count=\{\}.\ tx\_next=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{old\_count}},\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00129\ \ \ \ \ \ \ discard\_pdu(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{old\_count}});}
\DoxyCodeLine{00130\ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ pdcp\_tx\_sdu\_info\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}\ =\ tx\_window-\/>add\_sn(st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}});}
\DoxyCodeLine{00133\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.count\ \ \ \ \ \ \ \ \ \ \ \ \ =\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}};}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.discard\_timer\ \ \ \ \ =\ std::move(discard\_timer);}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_am())\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.sdu\ =\ std::move(sdu);}
\DoxyCodeLine{00137\ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Added\ to\ tx\ window.\ count=\{\}\ discard\_timer=\{\}"{}},\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}},\ cfg.discard\_timer);}
\DoxyCodeLine{00139\ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \textcolor{comment}{//\ Write\ to\ lower\ layers}}
\DoxyCodeLine{00142\ \ \ write\_data\_pdu\_to\_lower\_layers(st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}},\ std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{protected\_buf}}));}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{comment}{//\ Increment\ TX\_NEXT}}
\DoxyCodeLine{00145\ \ \ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}++;}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \mbox{\hyperlink{namespacesrsran_a46a9d0c2069e595c7efbda41e108f76b}{up\_tracer}}\ <<\ \mbox{\hyperlink{structsrsran_1_1trace__event}{trace\_event}}\{\textcolor{stringliteral}{"{}pdcp\_tx\_pdu"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_tp}}\};}
\DoxyCodeLine{00148\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a36ca57bcd175a017324947de403a4f5f}\label{classsrsran_1_1pdcp__entity__tx_a36ca57bcd175a017324947de403a4f5f} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!handle\_status\_report@{handle\_status\_report}}
\index{handle\_status\_report@{handle\_status\_report}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{handle\_status\_report()}{handle\_status\_report()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::handle\+\_\+status\+\_\+report (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1byte__buffer__chain}{byte\+\_\+buffer\+\_\+chain}}}]{status }\end{DoxyParamCaption})}



Evaluates a PDCP status report. 

Ref\+: Ref\+: TS 38.\+323, Sec. 5.\+4.\+2, Sec. 6.\+2.\+3.\+1 and Sec. 6.\+3.\{9,10\}


\begin{DoxyParams}{Parameters}
{\em status} & The status report \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00225\ \{}
\DoxyCodeLine{00226\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ buf\ =\ \{status.\mbox{\hyperlink{classsrsran_1_1byte__buffer__chain_af8e967b918087a9351c9b584b421432d}{begin}}(),\ status.\mbox{\hyperlink{classsrsran_1_1byte__buffer__chain_aca957140abe27d915bf741cce7c1a4d5}{end}}()\};}
\DoxyCodeLine{00227\ \ \ \mbox{\hyperlink{classsrsran_1_1bit__decoder}{bit\_decoder}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dec}}(buf);}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ Unpack\ and\ check\ PDU\ header}}
\DoxyCodeLine{00230\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ dc\ =\ 0;}
\DoxyCodeLine{00231\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dec}}.unpack(dc,\ 1);}
\DoxyCodeLine{00232\ \ \ \textcolor{keywordflow}{if}\ (dc\ !=\ to\_number(\mbox{\hyperlink{namespacesrsran_a6e791999e341321921cec2656c25bbf7afc5364bf9dbfa34954526becad136d4b}{pdcp\_dc\_field::control}}))\ \{}
\DoxyCodeLine{00233\ \ \ \ \ logger.log\_warning(}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ buf.begin(),\ buf.end(),\ \textcolor{stringliteral}{"{}Invalid\ D/C\ field\ in\ status\ report.\ dc=\{\}"{}},\ to\_number(\mbox{\hyperlink{namespacesrsran_a6e791999e341321921cec2656c25bbf7afc5364bf9dbfa34954526becad136d4b}{pdcp\_dc\_field::control}}),\ dc);}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00236\ \ \ \}}
\DoxyCodeLine{00237\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ cpt\ =\ 0;}
\DoxyCodeLine{00238\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dec}}.unpack(cpt,\ 3);}
\DoxyCodeLine{00239\ \ \ \textcolor{keywordflow}{if}\ (cpt\ !=\ to\_number(\mbox{\hyperlink{namespacesrsran_a9692f6bdc224b67971d19a00a7bfb83da139a39643d328ece9f9f884bbd3d7a49}{pdcp\_control\_pdu\_type::status\_report}}))\ \{}
\DoxyCodeLine{00240\ \ \ \ \ logger.log\_warning(buf.begin(),}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buf.end(),}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ CPT\ field\ in\ status\ report.\ cpt=\{\}"{}},}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ to\_number(\mbox{\hyperlink{namespacesrsran_a9692f6bdc224b67971d19a00a7bfb83da139a39643d328ece9f9f884bbd3d7a49}{pdcp\_control\_pdu\_type::status\_report}}),}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cpt);}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00246\ \ \ \}}
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ reserved\ =\ 0;}
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dec}}.unpack(reserved,\ 4);}
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{if}\ (reserved\ !=\ 0)\ \{}
\DoxyCodeLine{00250\ \ \ \ \ logger.log\_warning(}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ buf.begin(),\ buf.end(),\ \textcolor{stringliteral}{"{}Ignoring\ status\ report\ because\ reserved\ bits\ are\ set.\ reserved=\{:\#x\}"{}},\ reserved);}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00253\ \ \ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \textcolor{comment}{//\ Unpack\ FMC\ field}}
\DoxyCodeLine{00256\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fmc}}\ =\ 0;}
\DoxyCodeLine{00257\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dec}}.unpack(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fmc}},\ 32);}
\DoxyCodeLine{00258\ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Status\ report.\ fmc=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fmc}});}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \textcolor{comment}{//\ Discard\ any\ SDU\ with\ COUNT\ <\ FMC}}
\DoxyCodeLine{00261\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classuint32__t}{uint32\_t}}\ count\ =\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a7514bd9e9e1091494546a48f34a2c91b}{tx\_next\_ack}};\ count\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fmc}};\ count++)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ discard\_pdu(count);}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{comment}{//\ Evaluate\ bitmap:\ discard\ any\ SDU\ with\ the\ bit\ in\ the\ bitmap\ set\ to\ 1}}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}}\ =\ 0;}
\DoxyCodeLine{00267\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dec}}.unpack(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}},\ 1))\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fmc}}++;}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{comment}{//\ Bit\ ==\ 0:\ PDCP\ SDU\ with\ COUNT\ =\ (FMC\ +\ bit\ position)\ modulo\ 2\string^32\ is\ missing.}}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{comment}{//\ Bit\ ==\ 1:\ PDCP\ SDU\ with\ COUNT\ =\ (FMC\ +\ bit\ position)\ modulo\ 2\string^32\ is\ correctly\ received.}}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}}\ ==\ 1)\ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ discard\_pdu(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{fmc}});}
\DoxyCodeLine{00273\ \ \ \ \ \}}
\DoxyCodeLine{00274\ \ \ \}}
\DoxyCodeLine{00275\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a9fd33e0f17ed26d11818fc1fff7abd16}\label{classsrsran_1_1pdcp__entity__tx_a9fd33e0f17ed26d11818fc1fff7abd16} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!handle\_transmit\_notification@{handle\_transmit\_notification}}
\index{handle\_transmit\_notification@{handle\_transmit\_notification}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{handle\_transmit\_notification()}{handle\_transmit\_notification()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::handle\+\_\+transmit\+\_\+notification (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{highest\+\_\+sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Informs the PDCP entity about the highest PDCP PDU sequence number of the PDCP PDU that was transmitted by the lower layers (i.\+e. by the RLC). 

In case of RLC AM, the PDCP will ignore this notification. In case of RLC UM, the PDCP will stop the discard timers for all PDUs up to highest\+\_\+sn.


\begin{DoxyParams}{Parameters}
{\em highest\+\_\+sn} & Highest transmitted PDCP PDU sequence number. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__lower__interface_a5f8543d42531b79425a52b62d944377a}{srsran\+::pdcp\+\_\+tx\+\_\+lower\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00455\ \{}
\DoxyCodeLine{00456\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Handling\ transmit\ notification\ for\ notif\_sn=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}});}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}}\ >=\ pdcp\_sn\_cardinality(cfg.sn\_size))\ \{}
\DoxyCodeLine{00458\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Invalid\ transmit\ notification\ for\ notif\_sn=\{\}\ exceeds\ sn\_size=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}},\ cfg.sn\_size);}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00460\ \ \ \}}
\DoxyCodeLine{00461\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}}\ =\ notification\_count\_estimation(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}});}
\DoxyCodeLine{00462\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}}\ <\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_ab2acba6d2ab29e2e2945921f3ac59d25}{tx\_trans}})\ \{}
\DoxyCodeLine{00463\ \ \ \ \ logger.log\_error(}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ notification\ SN,\ notif\_count\ is\ too\ low.\ notif\_sn=\{\}\ notif\_count=\{\}\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}},\ st);}
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00466\ \ \ \}}
\DoxyCodeLine{00467\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}}\ >=\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}})\ \{}
\DoxyCodeLine{00468\ \ \ \ \ logger.log\_error(}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ notification\ SN,\ notif\_count\ is\ too\ high.\ notif\_sn=\{\}\ notif\_count=\{\}\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_sn}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}},\ st);}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00471\ \ \ \}}
\DoxyCodeLine{00472\ \ \ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_ab2acba6d2ab29e2e2945921f3ac59d25}{tx\_trans}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}}\ +\ 1;}
\DoxyCodeLine{00473\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Updated\ tx\_trans.\ \{\}"{}},\ st);}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \textcolor{comment}{//\ Stop\ discard\ timers\ if\ required}}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{if}\ (!cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00478\ \ \ \}}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \textcolor{keywordflow}{if}\ (is\_um())\ \{}
\DoxyCodeLine{00481\ \ \ \ \ stop\_discard\_timer(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notif\_count}});}
\DoxyCodeLine{00482\ \ \ \}}
\DoxyCodeLine{00483\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a2527c3d87174c8f759f8613bfccc1000}\label{classsrsran_1_1pdcp__entity__tx_a2527c3d87174c8f759f8613bfccc1000} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!nof\_discard\_timers@{nof\_discard\_timers}}
\index{nof\_discard\_timers@{nof\_discard\_timers}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{nof\_discard\_timers()}{nof\_discard\_timers()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classuint32__t}{uint32\+\_\+t}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::nof\+\_\+discard\+\_\+timers (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00152\ \{\ \textcolor{keywordflow}{return}\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}}\ -\/\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a7514bd9e9e1091494546a48f34a2c91b}{tx\_next\_ack}};\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a5664be94f802bc5eaad1d73e5f5b4fb4}\label{classsrsran_1_1pdcp__entity__tx_a5664be94f802bc5eaad1d73e5f5b4fb4} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!on\_status\_report@{on\_status\_report}}
\index{on\_status\_report@{on\_status\_report}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{on\_status\_report()}{on\_status\_report()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::on\+\_\+status\+\_\+report (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1byte__buffer__chain}{byte\+\_\+buffer\+\_\+chain}}}]{status }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Status report handler for TX entity. 


\begin{DoxyParams}{Parameters}
{\em status} & The status PDU to be processed by the PDCP TX entity \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__status__handler_a7e931d0de6193a2325694d379f2bf119}{srsran\+::pdcp\+\_\+tx\+\_\+status\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00130\ \{\ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a36ca57bcd175a017324947de403a4f5f}{handle\_status\_report}}(std::move(status));\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a84348e13aaec3959ac0ae9bdb4d325e7}\label{classsrsran_1_1pdcp__entity__tx_a84348e13aaec3959ac0ae9bdb4d325e7} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!reestablish@{reestablish}}
\index{reestablish@{reestablish}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{reestablish()}{reestablish()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::reestablish (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{security\+::sec\+\_\+128\+\_\+as\+\_\+config}}}]{sec\+\_\+cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Triggers re-\/establishment as specified in TS 38.\+323, section 5.\+1.\+2. 



Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface_a75d408ad1e21c63037fdaa1f2baa2157}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00151\ \{}
\DoxyCodeLine{00152\ \ \ \textcolor{comment}{//\ -\/\ for\ UM\ DRBs\ and\ AM\ DRBs,\ reset\ the\ ROHC\ protocol\ for\ uplink\ and\ start\ with\ an\ IR\ state\ in\ U-\/mode\ (as}}
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ \ \ defined\ in\ RFC\ 3095\ [8]\ and\ RFC\ 4815\ [9])\ if\ drb-\/ContinueROHC\ is\ not\ configured\ in\ TS\ 38.331\ [3];}}
\DoxyCodeLine{00154\ \ \ \textcolor{comment}{//\ -\/\ for\ UM\ DRBs\ and\ AM\ DRBs,\ reset\ the\ EHC\ protocol\ for\ uplink\ if\ drb-\/ContinueEHC-\/UL\ is\ not\ configured\ in}}
\DoxyCodeLine{00155\ \ \ \textcolor{comment}{//\ \ \ TS\ 38.331\ [3];}}
\DoxyCodeLine{00156\ \ \ \textcolor{comment}{//\ \ \ Header\ compression\ not\ supported\ yet\ (TODO).}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \textcolor{comment}{//\ -\/\ for\ UM\ DRBs\ and\ SRBs,\ set\ TX\_NEXT\ to\ the\ initial\ value;}}
\DoxyCodeLine{00159\ \ \ \textcolor{comment}{//\ -\/\ for\ SRBs,\ discard\ all\ stored\ PDCP\ SDUs\ and\ PDCP\ PDUs;}}
\DoxyCodeLine{00160\ \ \ \textcolor{keywordflow}{if}\ (is\_srb()\ ||\ is\_um())\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a44e914866995789ab85218f828b321f9}{reset}}();\ \textcolor{comment}{//\ While\ not\ explicitly\ stated\ in\ the\ spec,}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ there\ is\ no\ point\ in\ storing\ PDCP\ UM\ PDUs.}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ They\ cannot\ be\ RETXed\ and\ RLC\ already\ discarded\ them.}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Also,\ this\ avoids\ having\ multiple\ discard\ timers}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ associated\ with\ the\ with\ the\ same\ COUNT.}}
\DoxyCodeLine{00166\ \ \ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \textcolor{comment}{//\ -\/\ apply\ the\ ciphering\ algorithm\ and\ key\ provided\ by\ upper\ layers\ during\ the\ PDCP\ entity\ re-\/establishment}}
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ \ \ procedure;}}
\DoxyCodeLine{00170\ \ \ \textcolor{comment}{//\ -\/\ apply\ the\ integrity\ protection\ algorithm\ and\ key\ provided\ by\ upper\ layers\ during\ the\ PDCP\ entity\ re-\/}}
\DoxyCodeLine{00171\ \ \ \textcolor{comment}{//\ \ \ establishment\ procedure;}}
\DoxyCodeLine{00172\ \ \ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_ab5d4a40f52777fa8af1950a6737c8b28}{configure\_security}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_cfg\_}});}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \textcolor{comment}{//\ -\/\ for\ UM\ DRBs,\ for\ each\ PDCP\ SDU\ already\ associated\ with\ a\ PDCP\ SN\ but\ for\ which\ a\ corresponding\ PDU\ has}}
\DoxyCodeLine{00175\ \ \ \textcolor{comment}{//\ \ \ not\ previously\ been\ submitted\ to\ lower\ layers,\ and;}}
\DoxyCodeLine{00176\ \ \ \textcolor{comment}{//\ -\/\ for\ AM\ DRBs\ for\ Uu\ interface\ whose\ PDCP\ entities\ were\ suspended,\ from\ the\ first\ PDCP\ SDU\ for\ which\ the}}
\DoxyCodeLine{00177\ \ \ \textcolor{comment}{//\ \ \ successful\ delivery\ of\ the\ corresponding\ PDCP\ Data\ PDU\ has\ not\ been\ confirmed\ by\ lower\ layers,\ for\ each}}
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{//\ \ \ PDCP\ SDU\ already\ associated\ with\ a\ PDCP\ SN:}}
\DoxyCodeLine{00179\ \ \ \textcolor{comment}{//\ \ \ -\/\ consider\ the\ PDCP\ SDUs\ as\ received\ from\ upper\ layer;}}
\DoxyCodeLine{00180\ \ \ \textcolor{comment}{//\ \ \ -\/\ perform\ transmission\ of\ the\ PDCP\ SDUs\ in\ ascending\ order\ of\ the\ COUNT\ value\ associated\ to\ the\ PDCP}}
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//\ \ \ \ \ SDU\ prior\ to\ the\ PDCP\ re-\/establishment\ without\ restarting\ the\ discardTimer,\ as\ specified\ in\ clause\ 5.2.1;}}
\DoxyCodeLine{00182\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//\ \ For\ UM\ DRBs,\ when\ SDUs\ are\ associated\ with\ a\ PDCP\ SN\ they\ are\ immediately\ pushed\ to\ the\ lower-\/layer.}}
\DoxyCodeLine{00184\ \ \ \textcolor{comment}{//\ \ As\ such,\ there\ is\ nothing\ to\ do\ here.}}
\DoxyCodeLine{00185\ \ \ \textcolor{comment}{//\ \ For\ AM\ DRBs,\ PDCP\ entity\ suspension\ is\ not\ supported\ yet\ (TODO).}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \textcolor{comment}{//\ -\/\ for\ AM\ DRBs\ whose\ PDCP\ entities\ were\ not\ suspended,\ from\ the\ first\ PDCP\ SDU\ for\ which\ the\ successful}}
\DoxyCodeLine{00188\ \ \ \textcolor{comment}{//\ \ \ delivery\ of\ the\ corresponding\ PDCP\ Data\ PDU\ has\ not\ been\ confirmed\ by\ lower\ layers,\ perform\ retransmission}}
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ \ \ or\ transmission\ of\ all\ the\ PDCP\ SDUs\ already\ associated\ with\ PDCP\ SNs\ in\ ascending\ order\ of\ the\ COUNT}}
\DoxyCodeLine{00190\ \ \ \textcolor{comment}{//\ \ \ values\ associated\ to\ the\ PDCP\ SDU\ prior\ to\ the\ PDCP\ entity\ re-\/establishment\ as\ specified\ below:}}
\DoxyCodeLine{00191\ \ \ \textcolor{comment}{//\ \ \ -\/\ perform\ header\ compression\ of\ the\ PDCP\ SDU\ using\ ROHC\ as\ specified\ in\ the\ clause\ 5.7.4\ and/or\ using}}
\DoxyCodeLine{00192\ \ \ \textcolor{comment}{//\ \ \ \ \ EHC\ as\ specified\ in\ the\ clause\ 5.12.4;}}
\DoxyCodeLine{00193\ \ \ \textcolor{comment}{//\ \ \ -\/\ perform\ integrity\ protection\ and\ ciphering\ of\ the\ PDCP\ SDU\ using\ the\ COUNT\ value\ associated\ with\ this}}
\DoxyCodeLine{00194\ \ \ \textcolor{comment}{//\ \ \ \ \ PDCP\ SDU\ as\ specified\ in\ the\ clause\ 5.9\ and\ 5.8;}}
\DoxyCodeLine{00195\ \ \ \textcolor{comment}{//\ \ \ -\/\ submit\ the\ resulting\ PDCP\ Data\ PDU\ to\ lower\ layer,\ as\ specified\ in\ clause\ 5.2.1.}}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordflow}{if}\ (is\_am())\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a873e30a3ef188b83f08a6bc922955d3c}{retransmit\_all\_pdus}}();}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a44e914866995789ab85218f828b321f9}\label{classsrsran_1_1pdcp__entity__tx_a44e914866995789ab85218f828b321f9} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!reset@{reset}}
\index{reset@{reset}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::reset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Reset state variables to their initial state and drop all discard timers with all stored SDUs. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00394\ \{}
\DoxyCodeLine{00395\ \ \ st\ =\ \{\};}
\DoxyCodeLine{00396\ \ \ tx\_window-\/>clear();}
\DoxyCodeLine{00397\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Entity\ was\ reset.\ \{\}"{}},\ st);}
\DoxyCodeLine{00398\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a873e30a3ef188b83f08a6bc922955d3c}\label{classsrsran_1_1pdcp__entity__tx_a873e30a3ef188b83f08a6bc922955d3c} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!retransmit\_all\_pdus@{retransmit\_all\_pdus}}
\index{retransmit\_all\_pdus@{retransmit\_all\_pdus}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{retransmit\_all\_pdus()}{retransmit\_all\_pdus()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::retransmit\+\_\+all\+\_\+pdus (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Retransmits all PDUs. Integrity protection and ciphering is re-\/applied. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00401\ \{}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{if}\ (!cfg.discard\_timer.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00403\ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Cannot\ retransmit.\ No\ discard\ timer\ configured."{}});}
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00405\ \ \ \}}
\DoxyCodeLine{00406\ \ \ \textcolor{keywordflow}{if}\ (!is\_am())\ \{}
\DoxyCodeLine{00407\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Cannot\ retransmit.\ Not\ an\ AM\ bearer."{}});}
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00409\ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{comment}{//\ Since\ we\ are\ retransmitting,\ rewind\ tx\_trans\ to\ tx\_next\_ack}}
\DoxyCodeLine{00412\ \ \ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_ab2acba6d2ab29e2e2945921f3ac59d25}{tx\_trans}}\ =\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a7514bd9e9e1091494546a48f34a2c91b}{tx\_next\_ack}};}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classuint32__t}{uint32\_t}}\ count\ =\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a7514bd9e9e1091494546a48f34a2c91b}{tx\_next\_ack}};\ count\ <\ st.\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state_a1b07558b26af82f2d421d788ca23bcab}{tx\_next}};\ count++)\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{if}\ (tx\_window-\/>has\_sn(count))\ \{}
\DoxyCodeLine{00416\ \ \ \ \ \ \ pdcp\_tx\_sdu\_info\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}\ =\ (*tx\_window)[count];}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \ \ \textcolor{comment}{//\ Prepare\ header}}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header}{pdcp\_data\_pdu\_header}}\ hdr\ =\ \{\};}
\DoxyCodeLine{00420\ \ \ \ \ \ \ hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ SN(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.count);}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \ \ \ \ \textcolor{comment}{//\ Pack\ header}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ buf\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.sdu.\mbox{\hyperlink{classsrsran_1_1byte__buffer_aa79a5e270dbb5dd01b83c034853b9fb3}{deep\_copy}}();}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a6263f068f434b6bbd58ffb4a730fed15}{write\_data\_pdu\_header}}(buf,\ hdr))\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ logger.log\_error(}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Could\ not\ append\ PDU\ header,\ dropping\ SDU\ and\ notifying\ RRC.\ count=\{\}\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.count,\ st);}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ upper\_cn.on\_protocol\_failure();}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \textcolor{comment}{//\ Perform\ header\ compression\ if\ required}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \textcolor{comment}{//\ (TODO)}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \ \ \textcolor{comment}{//\ Perform\ integrity\ protection\ and\ ciphering}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{expected<byte\_buffer>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{exp\_buf}}\ =\ apply\_ciphering\_and\_integrity\_protection(std::move(buf),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.count);}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{exp\_buf}}.is\_error())\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Could\ not\ apply\ ciphering\ and\ integrity\ protection\ during\ retransmissions,\ dropping\ SDU\ and\ "{}}}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}notifying\ RRC.\ count=\{\}\ \{\}"{}},}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.count,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ st);}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ upper\_cn.on\_protocol\_failure();}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{protected\_buf}}\ =\ std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{exp\_buf}}.value());}
\DoxyCodeLine{00446\ \ \ \ \ \ \ write\_data\_pdu\_to\_lower\_layers(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdu\_info}}.count,\ std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{protected\_buf}}));}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ \ \ \}}
\DoxyCodeLine{00449\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a33d852bf24e05ac2bb27169b65e5ac18}\label{classsrsran_1_1pdcp__entity__tx_a33d852bf24e05ac2bb27169b65e5ac18} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!send\_status\_report@{send\_status\_report}}
\index{send\_status\_report@{send\_status\_report}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{send\_status\_report()}{send\_status\_report()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcp\+\_\+entity\+\_\+tx\+::send\+\_\+status\+\_\+report (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Sends a status report, as specified in TS 38.\+323, Sec. 5.\+4. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00367\ \{}
\DoxyCodeLine{00368\ \ \ \textcolor{keywordflow}{if}\ (cfg.status\_report\_required)\ \{}
\DoxyCodeLine{00369\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Status\ report\ triggered."{}});}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ \mbox{\hyperlink{namespacesrsran_a9692f6bdc224b67971d19a00a7bfb83da139a39643d328ece9f9f884bbd3d7a49}{status\_report}}\ =\ status\_provider-\/>\mbox{\hyperlink{classsrsran_1_1pdcp__rx__status__provider_aa8f7c435d14e6257c5ca9e1727344c5f}{compile\_status\_report}}();}
\DoxyCodeLine{00371\ \ \ \ \ write\_control\_pdu\_to\_lower\_layers(std::move(\mbox{\hyperlink{namespacesrsran_a9692f6bdc224b67971d19a00a7bfb83da139a39643d328ece9f9f884bbd3d7a49}{status\_report}}));}
\DoxyCodeLine{00372\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00373\ \ \ \ \ logger.log\_warning(\textcolor{stringliteral}{"{}Status\ report\ triggered\ but\ not\ configured."{}});}
\DoxyCodeLine{00374\ \ \ \}}
\DoxyCodeLine{00375\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a1837f60e5e5fb16bfb799fbc6f7113c1}\label{classsrsran_1_1pdcp__entity__tx_a1837f60e5e5fb16bfb799fbc6f7113c1} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!set\_ciphering@{set\_ciphering}}
\index{set\_ciphering@{set\_ciphering}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{set\_ciphering()}{set\_ciphering()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::set\+\_\+ciphering (\begin{DoxyParamCaption}\item[{security\+::ciphering\+\_\+enabled}]{ciphering\+\_\+enabled\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00203\ \ \ \{}
\DoxyCodeLine{00204\ \ \ \ \ ciphering\_enabled\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ciphering\_enabled\_}};}
\DoxyCodeLine{00205\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Set\ ciphering\_enabled=\{\}"{}},\ ciphering\_enabled);}
\DoxyCodeLine{00206\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a6cbb3b77b7e19293231b8081c05e97da}\label{classsrsran_1_1pdcp__entity__tx_a6cbb3b77b7e19293231b8081c05e97da} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!set\_integrity\_protection@{set\_integrity\_protection}}
\index{set\_integrity\_protection@{set\_integrity\_protection}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{set\_integrity\_protection()}{set\_integrity\_protection()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::set\+\_\+integrity\+\_\+protection (\begin{DoxyParamCaption}\item[{security\+::integrity\+\_\+enabled}]{integrity\+\_\+enabled\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [final]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1pdcp__tx__upper__control__interface}{srsran\+::pdcp\+\_\+tx\+\_\+upper\+\_\+control\+\_\+interface}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \ \ \{}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{integrity\_enabled\_}}\ ==\ security::integrity\_enabled::on)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!sec\_cfg.k\_128\_int.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Cannot\ enable\ integrity\ protection:\ Integrity\ key\ is\ not\ configured."{}});}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!sec\_cfg.integ\_algo.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}())\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Cannot\ enable\ integrity\ protection:\ Integrity\ algorithm\ is\ not\ configured."{}});}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ integrity\_enabled\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{integrity\_enabled\_}};}
\DoxyCodeLine{00200\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Set\ integrity\_enabled=\{\}"{}},\ integrity\_enabled);}
\DoxyCodeLine{00201\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a1e2111d55ac320b4d46bd6ce5892e718}\label{classsrsran_1_1pdcp__entity__tx_a1e2111d55ac320b4d46bd6ce5892e718} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!set\_state@{set\_state}}
\index{set\_state@{set\_state}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{set\_state()}{set\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::set\+\_\+state (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1pdcp__tx__state}{pdcp\+\_\+tx\+\_\+state}}}]{st\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00145\ \ \ \{}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pdcp__entity__tx_a44e914866995789ab85218f828b321f9}{reset}}();}
\DoxyCodeLine{00147\ \ \ \ \ st\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{st\_}};}
\DoxyCodeLine{00148\ \ \ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_afc28528760cb7959b00e8c36069ee71b}\label{classsrsran_1_1pdcp__entity__tx_afc28528760cb7959b00e8c36069ee71b} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!set\_status\_provider@{set\_status\_provider}}
\index{set\_status\_provider@{set\_status\_provider}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{set\_status\_provider()}{set\_status\_provider()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::pdcp\+\_\+entity\+\_\+tx\+::set\+\_\+status\+\_\+provider (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1pdcp__rx__status__provider}{pdcp\+\_\+rx\+\_\+status\+\_\+provider}} \texorpdfstring{$\ast$}{*}}]{status\+\_\+provider\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00112\ \{\ status\_provider\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{status\_provider\_}};\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcp__entity__tx_a6263f068f434b6bbd58ffb4a730fed15}\label{classsrsran_1_1pdcp__entity__tx_a6263f068f434b6bbd58ffb4a730fed15} 
\index{srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}!write\_data\_pdu\_header@{write\_data\_pdu\_header}}
\index{write\_data\_pdu\_header@{write\_data\_pdu\_header}!srsran::pdcp\_entity\_tx@{srsran::pdcp\_entity\_tx}}
\doxysubsubsection{\texorpdfstring{write\_data\_pdu\_header()}{write\_data\_pdu\_header()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pdcp\+\_\+entity\+\_\+tx\+::write\+\_\+data\+\_\+pdu\+\_\+header (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} \&}]{buf,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header}{pdcp\+\_\+data\+\_\+pdu\+\_\+header}} \&}]{hdr }\end{DoxyParamCaption}) const}



Writes the header of a PDCP data PDU according to the content of the associated object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em buf} & Reference to a \doxylink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer} that is appended by the header bytes \\
\hline
\mbox{\texttt{ in}}  & {\em hdr} & Reference to a \doxylink{structsrsran_1_1pdcp__data__pdu__header}{pdcp\+\_\+data\+\_\+pdu\+\_\+header} that represents the header content \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00547\ \{}
\DoxyCodeLine{00548\ \ \ \textcolor{comment}{//\ Sanity\ check:\ 18-\/bit\ SN\ not\ allowed\ for\ SRBs}}
\DoxyCodeLine{00549\ \ \ srsran\_assert(}
\DoxyCodeLine{00550\ \ \ \ \ \ \ !(is\_srb()\ \&\&\ cfg.sn\_size\ ==\ pdcp\_sn\_size::size18bits),\ \textcolor{stringliteral}{"{}Invalid\ SN\ size\ for\ SRB.\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \textcolor{keywordtype}{unsigned}\ hdr\_len\ =\ cfg.sn\_size\ ==\ pdcp\_sn\_size::size12bits\ ?\ 2\ :\ 3;}
\DoxyCodeLine{00553\ \ \ \textcolor{keyword}{auto}\ \ \ \ \ view\ \ \ \ =\ buf.\mbox{\hyperlink{classsrsran_1_1byte__buffer_ad8dbd27b3715bfe6abc890fbfd170245}{reserve\_prepend}}(cfg.sn\_size\ ==\ pdcp\_sn\_size::size12bits\ ?\ 2\ :\ 3);}
\DoxyCodeLine{00554\ \ \ \textcolor{keywordflow}{if}\ (view.length()\ !=\ hdr\_len)\ \{}
\DoxyCodeLine{00555\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Not\ enough\ space\ to\ write\ header.\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00557\ \ \ \}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \mbox{\hyperlink{classsrsran_1_1detail_1_1byte__buffer__segment__byte__iterator__impl}{byte\_buffer::iterator}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ =\ buf.begin();}
\DoxyCodeLine{00560\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ ==\ buf.end())\ \{}
\DoxyCodeLine{00561\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Not\ enough\ space\ to\ write\ header.\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00562\ \ \ \}}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ \ \ \textcolor{comment}{//\ Set\ D/C\ if\ required}}
\DoxyCodeLine{00565\ \ \ \textcolor{keywordflow}{if}\ (is\_drb())\ \{}
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{comment}{//\ D/C\ bit\ field\ (1).}}
\DoxyCodeLine{00567\ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ =\ 0x80;}
\DoxyCodeLine{00568\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{comment}{//\ No\ D/C\ bit\ field.}}
\DoxyCodeLine{00570\ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ =\ 0x00;}
\DoxyCodeLine{00571\ \ \ \}}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ \ \ \textcolor{comment}{//\ Add\ SN}}
\DoxyCodeLine{00574\ \ \ \textcolor{keywordflow}{switch}\ (cfg.sn\_size)\ \{}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keywordflow}{case}\ pdcp\_sn\_size::size12bits:}
\DoxyCodeLine{00576\ \ \ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ |=\ (hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \&\ 0x00000f00U)\ >>\ 8U;}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}++;}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ ==\ buf.end())\ \{}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Not\ enough\ space\ to\ write\ header.\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ =\ hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \&\ 0x000000ffU;}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keywordflow}{case}\ pdcp\_sn\_size::size18bits:}
\DoxyCodeLine{00584\ \ \ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ |=\ (hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \&\ 0x00030000U)\ >>\ 16U;}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}++;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ ==\ buf.end())\ \{}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Not\ enough\ space\ to\ write\ header.\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00589\ \ \ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ =\ (hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \&\ 0x0000ff00U)\ >>\ 8U;}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}++;}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ ==\ buf.end())\ \{}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Not\ enough\ space\ to\ write\ header.\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00594\ \ \ \ \ \ \ *\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hdr\_writer}}\ =\ hdr.\mbox{\hyperlink{structsrsran_1_1pdcp__data__pdu__header_a510d279e02871dcc93b5fc4e4d76e110}{sn}}\ \&\ 0x000000ffU;}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00597\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Invalid\ sn\_size=\{\}"{}},\ cfg.sn\_size);}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00599\ \ \ \}}
\DoxyCodeLine{00600\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00601\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/pdcp/pdcp\+\_\+entity\+\_\+tx.\+h\item 
lib/pdcp/pdcp\+\_\+entity\+\_\+tx.\+cpp\end{DoxyCompactItemize}
