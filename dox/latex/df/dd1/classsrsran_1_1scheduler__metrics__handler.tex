\doxysection{srsran\+::scheduler\+\_\+metrics\+\_\+handler Class Reference}
\hypertarget{classsrsran_1_1scheduler__metrics__handler}{}\label{classsrsran_1_1scheduler__metrics__handler}\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}


\doxylink{classHandler}{Handler} of scheduler slot metrics.  




{\ttfamily \#include $<$scheduler\+\_\+metrics\+\_\+handler.\+h$>$}



Inheritance diagram for srsran\+::scheduler\+\_\+metrics\+\_\+handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d9/d0e/classsrsran_1_1scheduler__metrics__handler__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::scheduler\+\_\+metrics\+\_\+handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d9/dd5/classsrsran_1_1scheduler__metrics__handler__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_ac4142249957c95fe4b5f5a69628b644e}{scheduler\+\_\+metrics\+\_\+handler}} (msecs metrics\+\_\+report\+\_\+period, \mbox{\hyperlink{classsrsran_1_1scheduler__ue__metrics__notifier}{scheduler\+\_\+ue\+\_\+metrics\+\_\+notifier}} \&notifier)
\begin{DoxyCompactList}\small\item\em Creates a scheduler UE metrics handler. In case the metrics\+\_\+report\+\_\+period is zero, no metrics are reported. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_aae9c742ae0dadd2ab2e8e0e71e449586}{handle\+\_\+ue\+\_\+creation}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} rnti, \mbox{\hyperlink{namespacesrsran_ae2a7787d776e7d6ee8959beb6b368286}{pci\+\_\+t}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcell\+\_\+pci}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\+\_\+prbs}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Register creation of a UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a650e66ac7cde2e021fbb2f87f48834b1}{handle\+\_\+ue\+\_\+deletion}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Register removal of a UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a0755c662b8f2268fbdee06923b302459}{handle\+\_\+crc\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__crc__pdu__indication}{ul\+\_\+crc\+\_\+pdu\+\_\+indication}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\+\_\+pdu}}, \mbox{\hyperlink{classsrsran_1_1units_1_1bytes}{units\+::bytes}} tbs)
\begin{DoxyCompactList}\small\item\em Register CRC indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a2ee861c06168f75518709b4c2ecd5a61}{handle\+\_\+csi\+\_\+report}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1csi__report__data}{csi\+\_\+report\+\_\+data}} \&csi)
\begin{DoxyCompactList}\small\item\em Register CSI report metric. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_af7471a9b23189e8d0f1afa0faf235092}{handle\+\_\+dl\+\_\+harq\+\_\+ack}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{classbool}{bool}} ack, \mbox{\hyperlink{classsrsran_1_1units_1_1bytes}{units\+::bytes}} tbs)
\begin{DoxyCompactList}\small\item\em Register HARQ-\/\+ACK UCI indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a72777975e9e487d6db9a26c08a312039}{handle\+\_\+harq\+\_\+timeout}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{classbool}{bool}} is\+\_\+dl) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Register HARQ timeout. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a6e4f25d8ec9c5136211a605d524480ef}{handle\+\_\+pucch\+\_\+sinr}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ \mbox{\hyperlink{classfloat}{float}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\+\_\+sinr}})
\begin{DoxyCompactList}\small\item\em Register PUCCH SINR. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_ae145075dfaf3f5ea6f7f4d0988935ab6}{handle\+\_\+ul\+\_\+bsr\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__bsr__indication__message}{ul\+\_\+bsr\+\_\+indication\+\_\+message}} \&bsr)
\begin{DoxyCompactList}\small\item\em Handle UL BSR indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a775ca5759c1bbed03fbf9fb47d725733}{handle\+\_\+ul\+\_\+phr\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__phr__indication__message}{ul\+\_\+phr\+\_\+indication\+\_\+message}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\+\_\+ind}})
\begin{DoxyCompactList}\small\item\em Handle UL PHR indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a843953e9d43f49853bddb729e0886798}{handle\+\_\+dl\+\_\+buffer\+\_\+state\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__buffer__state__indication__message}{dl\+\_\+buffer\+\_\+state\+\_\+indication\+\_\+message}} \&dl\+\_\+bs)
\begin{DoxyCompactList}\small\item\em Handle DL Buffer Status indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_abc092a207333c6e214401566aacc960a}{push\+\_\+result}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} sl\+\_\+tx, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1sched__result}{sched\+\_\+result}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+result}})
\begin{DoxyCompactList}\small\item\em Handle results stored in the scheduler result and push new entry. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a012943eb25e6a9d2eeca459deb9ac83e}{connected}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Checks whether the metrics reporting is active. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\doxylink{classHandler}{Handler} of scheduler slot metrics. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_ac4142249957c95fe4b5f5a69628b644e}\label{classsrsran_1_1scheduler__metrics__handler_ac4142249957c95fe4b5f5a69628b644e} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!scheduler\_metrics\_handler@{scheduler\_metrics\_handler}}
\index{scheduler\_metrics\_handler@{scheduler\_metrics\_handler}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{scheduler\_metrics\_handler()}{scheduler\_metrics\_handler()}}
{\footnotesize\ttfamily scheduler\+\_\+metrics\+\_\+handler\+::scheduler\+\_\+metrics\+\_\+handler (\begin{DoxyParamCaption}\item[{msecs}]{metrics\+\_\+report\+\_\+period,  }\item[{\mbox{\hyperlink{classsrsran_1_1scheduler__ue__metrics__notifier}{scheduler\+\_\+ue\+\_\+metrics\+\_\+notifier}} \&}]{notifier }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Creates a scheduler UE metrics handler. In case the metrics\+\_\+report\+\_\+period is zero, no metrics are reported. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00029\ \ \ notifier(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\_}}),\ report\_period(metrics\_report\_period)}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a012943eb25e6a9d2eeca459deb9ac83e}\label{classsrsran_1_1scheduler__metrics__handler_a012943eb25e6a9d2eeca459deb9ac83e} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!connected@{connected}}
\index{connected@{connected}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{connected()}{connected()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::scheduler\+\_\+metrics\+\_\+handler\+::connected (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Checks whether the metrics reporting is active. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00079\ \{\ \textcolor{keywordflow}{return}\ report\_period\ !=\ std::chrono::nanoseconds\{0\};\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a0755c662b8f2268fbdee06923b302459}\label{classsrsran_1_1scheduler__metrics__handler_a0755c662b8f2268fbdee06923b302459} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_crc\_indication@{handle\_crc\_indication}}
\index{handle\_crc\_indication@{handle\_crc\_indication}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_crc\_indication()}{handle\_crc\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+crc\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__crc__pdu__indication}{ul\+\_\+crc\+\_\+pdu\+\_\+indication}} \&}]{crc\+\_\+pdu,  }\item[{\mbox{\hyperlink{classsrsran_1_1units_1_1bytes}{units\+::bytes}}}]{tbs }\end{DoxyParamCaption})}



Register CRC indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00055\ \{}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_pdu}}.ue\_index))\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_pdu}}.ue\_index];}
\DoxyCodeLine{00058\ \ \ \ \ u.data.count\_crc\_acks\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_pdu}}.tb\_crc\_success\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00059\ \ \ \ \ u.data.count\_crc\_pdus++;}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_pdu}}.ul\_sinr\_metric.has\_value())\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ u.data.nof\_pusch\_snr\_reports++;}
\DoxyCodeLine{00062\ \ \ \ \ \ \ u.data.sum\_pusch\_snrs\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_pdu}}.ul\_sinr\_metric.value();}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_pdu}}.tb\_crc\_success)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ u.data.sum\_ul\_tb\_bytes\ +=\ tbs.\mbox{\hyperlink{classsrsran_1_1strong__type_a1a71ac48ba41b4a070b32e296c177db0}{value}}();}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \}}
\DoxyCodeLine{00068\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a2ee861c06168f75518709b4c2ecd5a61}\label{classsrsran_1_1scheduler__metrics__handler_a2ee861c06168f75518709b4c2ecd5a61} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_csi\_report@{handle\_csi\_report}}
\index{handle\_csi\_report@{handle\_csi\_report}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_csi\_report()}{handle\_csi\_report()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+csi\+\_\+report (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1csi__report__data}{csi\+\_\+report\+\_\+data}} \&}]{csi }\end{DoxyParamCaption})}



Register CSI report metric. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \{}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(ue\_index))\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[ue\_index];}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{if}\ (csi.\mbox{\hyperlink{structsrsran_1_1csi__report__data_a79da9b19f2196d93fab2bc0b78259b31}{first\_tb\_wideband\_cqi}}.has\_value())\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ u.last\_cqi\ =\ csi.\mbox{\hyperlink{structsrsran_1_1csi__report__data_a79da9b19f2196d93fab2bc0b78259b31}{first\_tb\_wideband\_cqi}}-\/>to\_uint();}
\DoxyCodeLine{00076\ \ \ \ \ \}}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{if}\ (csi.\mbox{\hyperlink{structsrsran_1_1csi__report__data_ac8a10f256f1699ea545ef86a092412b3}{ri}}.has\_value())\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ u.last\_ri\ =\ csi.\mbox{\hyperlink{structsrsran_1_1csi__report__data_ac8a10f256f1699ea545ef86a092412b3}{ri}}-\/>to\_uint();}
\DoxyCodeLine{00079\ \ \ \ \ \}}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a843953e9d43f49853bddb729e0886798}\label{classsrsran_1_1scheduler__metrics__handler_a843953e9d43f49853bddb729e0886798} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_dl\_buffer\_state\_indication@{handle\_dl\_buffer\_state\_indication}}
\index{handle\_dl\_buffer\_state\_indication@{handle\_dl\_buffer\_state\_indication}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_dl\_buffer\_state\_indication()}{handle\_dl\_buffer\_state\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+dl\+\_\+buffer\+\_\+state\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__buffer__state__indication__message}{dl\+\_\+buffer\+\_\+state\+\_\+indication\+\_\+message}} \&}]{dl\+\_\+bs }\end{DoxyParamCaption})}



Handle DL Buffer Status indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00143\ \{}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(dl\_bs.ue\_index))\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[dl\_bs.ue\_index];}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ Store\ last\ DL\ buffer\ state.}}
\DoxyCodeLine{00148\ \ \ \ \ u.last\_dl\_bs[dl\_bs.lcid]\ =\ dl\_bs.bs;}
\DoxyCodeLine{00149\ \ \ \}}
\DoxyCodeLine{00150\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_af7471a9b23189e8d0f1afa0faf235092}\label{classsrsran_1_1scheduler__metrics__handler_af7471a9b23189e8d0f1afa0faf235092} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_dl\_harq\_ack@{handle\_dl\_harq\_ack}}
\index{handle\_dl\_harq\_ack@{handle\_dl\_harq\_ack}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_dl\_harq\_ack()}{handle\_dl\_harq\_ack()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+dl\+\_\+harq\+\_\+ack (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{classbool}{bool}}}]{ack,  }\item[{\mbox{\hyperlink{classsrsran_1_1units_1_1bytes}{units\+::bytes}}}]{tbs }\end{DoxyParamCaption})}



Register HARQ-\/\+ACK UCI indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \{}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(ue\_index))\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[ue\_index];}
\DoxyCodeLine{00087\ \ \ \ \ u.data.count\_uci\_harq\_acks\ +=\ ack\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00088\ \ \ \ \ u.data.count\_uci\_harqs++;}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{if}\ (ack)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ u.data.sum\_dl\_tb\_bytes\ +=\ tbs.\mbox{\hyperlink{classsrsran_1_1strong__type_a1a71ac48ba41b4a070b32e296c177db0}{value}}();}
\DoxyCodeLine{00091\ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \}}
\DoxyCodeLine{00093\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a72777975e9e487d6db9a26c08a312039}\label{classsrsran_1_1scheduler__metrics__handler_a72777975e9e487d6db9a26c08a312039} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_harq\_timeout@{handle\_harq\_timeout}}
\index{handle\_harq\_timeout@{handle\_harq\_timeout}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_harq\_timeout()}{handle\_harq\_timeout()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+harq\+\_\+timeout (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{classbool}{bool}}}]{is\+\_\+dl }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Register HARQ timeout. 



Implements \mbox{\hyperlink{classsrsran_1_1harq__timeout__handler_a61aec4e21d4d5daa293647c06016261c}{srsran\+::harq\+\_\+timeout\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00096\ \{}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(ue\_index))\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[ue\_index];}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_dl)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ u.data.count\_uci\_harqs++;}
\DoxyCodeLine{00101\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ u.data.count\_crc\_pdus++;}
\DoxyCodeLine{00103\ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \}}
\DoxyCodeLine{00105\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a6e4f25d8ec9c5136211a605d524480ef}\label{classsrsran_1_1scheduler__metrics__handler_a6e4f25d8ec9c5136211a605d524480ef} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_pucch\_sinr@{handle\_pucch\_sinr}}
\index{handle\_pucch\_sinr@{handle\_pucch\_sinr}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_pucch\_sinr()}{handle\_pucch\_sinr()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+pucch\+\_\+sinr (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ \mbox{\hyperlink{classfloat}{float}} $>$}]{pucch\+\_\+sinr }\end{DoxyParamCaption})}



Register PUCCH SINR. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00108\ \{}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(ue\_index))\ \{}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[ue\_index];}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_sinr}}.has\_value())\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ u.data.nof\_pucch\_snr\_reports++;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ u.data.sum\_pucch\_snrs\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_sinr}}.value();}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \}}
\DoxyCodeLine{00116\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_aae9c742ae0dadd2ab2e8e0e71e449586}\label{classsrsran_1_1scheduler__metrics__handler_aae9c742ae0dadd2ab2e8e0e71e449586} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_ue\_creation@{handle\_ue\_creation}}
\index{handle\_ue\_creation@{handle\_ue\_creation}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_ue\_creation()}{handle\_ue\_creation()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+ue\+\_\+creation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{rnti,  }\item[{\mbox{\hyperlink{namespacesrsran_ae2a7787d776e7d6ee8959beb6b368286}{pci\+\_\+t}}}]{pcell\+\_\+pci,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{num\+\_\+prbs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Register creation of a UE. 



Implements \mbox{\hyperlink{classsrsran_1_1sched__metrics__ue__configurator_a7eeac817b825dd5c6802a39d9959b771}{srsran\+::sched\+\_\+metrics\+\_\+ue\+\_\+configurator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \{}
\DoxyCodeLine{00038\ \ \ ues.\mbox{\hyperlink{classsrsran_1_1slotted__id__table_a06f82a62f3afc5d562f9a56aea2e405c}{emplace}}(ue\_index);}
\DoxyCodeLine{00039\ \ \ ues[ue\_index].rnti\ \ \ \ \ =\ rnti;}
\DoxyCodeLine{00040\ \ \ ues[ue\_index].ue\_index\ =\ ue\_index;}
\DoxyCodeLine{00041\ \ \ ues[ue\_index].pci\ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pcell\_pci}};}
\DoxyCodeLine{00042\ \ \ ues[ue\_index].nof\_prbs\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{num\_prbs}};}
\DoxyCodeLine{00043\ \ \ rnti\_to\_ue\_index\_lookup.emplace(rnti,\ ue\_index);}
\DoxyCodeLine{00044\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a650e66ac7cde2e021fbb2f87f48834b1}\label{classsrsran_1_1scheduler__metrics__handler_a650e66ac7cde2e021fbb2f87f48834b1} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_ue\_deletion@{handle\_ue\_deletion}}
\index{handle\_ue\_deletion@{handle\_ue\_deletion}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_ue\_deletion()}{handle\_ue\_deletion()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+ue\+\_\+deletion (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Register removal of a UE. 



Implements \mbox{\hyperlink{classsrsran_1_1sched__metrics__ue__configurator_ad8d8f4e1b5b23299ea59bf3b4adb2e82}{srsran\+::sched\+\_\+metrics\+\_\+ue\+\_\+configurator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00047\ \{}
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(ue\_index))\ \{}
\DoxyCodeLine{00049\ \ \ \ \ rnti\_to\_ue\_index\_lookup.erase(ues[ue\_index].rnti);}
\DoxyCodeLine{00050\ \ \ \ \ ues.\mbox{\hyperlink{classsrsran_1_1slotted__id__table_afe9254a71b0676ffe21290993d39cdf3}{erase}}(ue\_index);}
\DoxyCodeLine{00051\ \ \ \}}
\DoxyCodeLine{00052\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_ae145075dfaf3f5ea6f7f4d0988935ab6}\label{classsrsran_1_1scheduler__metrics__handler_ae145075dfaf3f5ea6f7f4d0988935ab6} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_ul\_bsr\_indication@{handle\_ul\_bsr\_indication}}
\index{handle\_ul\_bsr\_indication@{handle\_ul\_bsr\_indication}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_ul\_bsr\_indication()}{handle\_ul\_bsr\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+ul\+\_\+bsr\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__bsr__indication__message}{ul\+\_\+bsr\+\_\+indication\+\_\+message}} \&}]{bsr }\end{DoxyParamCaption})}



Handle UL BSR indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00119\ \{}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(bsr.ue\_index))\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[bsr.ue\_index];}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{comment}{//\ Store\ last\ BSR.}}
\DoxyCodeLine{00124\ \ \ \ \ u.last\_bsr\ =\ 0;}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{comment}{//\ TODO:\ Handle\ different\ BSR\ formats.}}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ bsr.reported\_lcgs.size();\ ++i)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ u.last\_bsr\ +=\ bsr.reported\_lcgs[i].nof\_bytes;}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_a775ca5759c1bbed03fbf9fb47d725733}\label{classsrsran_1_1scheduler__metrics__handler_a775ca5759c1bbed03fbf9fb47d725733} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!handle\_ul\_phr\_indication@{handle\_ul\_phr\_indication}}
\index{handle\_ul\_phr\_indication@{handle\_ul\_phr\_indication}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{handle\_ul\_phr\_indication()}{handle\_ul\_phr\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::handle\+\_\+ul\+\_\+phr\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__phr__indication__message}{ul\+\_\+phr\+\_\+indication\+\_\+message}} \&}]{phr\+\_\+ind }\end{DoxyParamCaption})}



Handle UL PHR indication. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00133\ \{}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{if}\ (ues.contains(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.ue\_index))\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ues[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.ue\_index];}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ Store\ last\ PHR.}}
\DoxyCodeLine{00138\ \ \ \ \ u.last\_phr\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.phr;}
\DoxyCodeLine{00139\ \ \ \}}
\DoxyCodeLine{00140\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1scheduler__metrics__handler_abc092a207333c6e214401566aacc960a}\label{classsrsran_1_1scheduler__metrics__handler_abc092a207333c6e214401566aacc960a} 
\index{srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}!push\_result@{push\_result}}
\index{push\_result@{push\_result}!srsran::scheduler\_metrics\_handler@{srsran::scheduler\_metrics\_handler}}
\doxysubsubsection{\texorpdfstring{push\_result()}{push\_result()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} scheduler\+\_\+metrics\+\_\+handler\+::push\+\_\+result (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl\+\_\+tx,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1sched__result}{sched\+\_\+result}} \&}]{slot\+\_\+result }\end{DoxyParamCaption})}



Handle results stored in the scheduler result and push new entry. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00208\ \{}
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{if}\ (report\_period\_slots\ ==\ 0)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{comment}{//\ The\ SCS\ common\ is\ now\ known.}}
\DoxyCodeLine{00211\ \ \ \ \ usecs\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_dur}}\ \ \ \ \ \ =\ usecs\{1000U\ >>\ sl\_tx.\mbox{\hyperlink{classsrsran_1_1slot__point_a6f661d08d0210402eeb539bddbb7a8d0}{numerology}}()\};}
\DoxyCodeLine{00212\ \ \ \ \ report\_period\_slots\ =\ usecs\{report\_period\}\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_dur}};}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ handle\_slot\_result(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_result}});}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ ++slot\_counter;}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{if}\ (slot\_counter\ >=\ report\_period\_slots)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ report\_metrics();}
\DoxyCodeLine{00220\ \ \ \ \ slot\_counter\ =\ 0;}
\DoxyCodeLine{00221\ \ \ \}}
\DoxyCodeLine{00222\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/logging/scheduler\+\_\+metrics\+\_\+handler.\+h\item 
lib/scheduler/logging/scheduler\+\_\+metric\+\_\+handler.\+cpp\end{DoxyCompactItemize}
