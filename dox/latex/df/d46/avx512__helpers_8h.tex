\doxysection{lib/ofh/compression/avx512\+\_\+helpers.h File Reference}
\hypertarget{avx512__helpers_8h}{}\label{avx512__helpers_8h}\index{lib/ofh/compression/avx512\_helpers.h@{lib/ofh/compression/avx512\_helpers.h}}


AVX512 support for OFH Compression algorithms.  


{\ttfamily \#include $<$immintrin.\+h$>$}\newline
Include dependency graph for avx512\+\_\+helpers.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=193pt]{d7/d1c/avx512__helpers_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/dcd/avx512__helpers_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacesrsran}{srsran}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{avx512__helpers_8h_ab96281e7fbdbcab932b9fe0173e0d7f3}\label{avx512__helpers_8h_ab96281e7fbdbcab932b9fe0173e0d7f3} 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{using}} {\bfseries srsran\+::ofh\+::mm512\+::\+\_\+mm512\+\_\+comparator} = \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} (\texorpdfstring{$\ast$}{*})(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} a, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} b)
\begin{DoxyCompactList}\small\item\em Type of AVX512 intrinsic calculating min or max values between two vectors. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$\mbox{\hyperlink{avx512__helpers_8h_ab96281e7fbdbcab932b9fe0173e0d7f3}{\+\_\+mm512\+\_\+comparator}} COMPARE$>$ }\\\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{avx512__helpers_8h_ad2eabcd25afaafd26760fe2e28623797}{srsran\+::ofh\+::mm512\+::find\+\_\+abs\+\_\+min\+\_\+max\+\_\+values}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{v0\+\_\+epi16}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{v1\+\_\+epi16}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{v2\+\_\+epi16}})
\begin{DoxyCompactList}\small\item\em Finds the maximum (or minimum) 16bit sample in each of the four input resource blocks, returns its absolute value. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{avx512__helpers_8h_a896eb6546ff9996a6289e1ac7bf46171}{srsran\+::ofh\+::mm512\+::calculate\+\_\+max\+\_\+abs}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r0\+\_\+epi16}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r1\+\_\+epi16}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r2\+\_\+epi16}})
\begin{DoxyCompactList}\small\item\em Finds maximum absolute value across 16bit IQ samples in each of the four input resource blocks passed in three AVX512 registers. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{avx512__helpers_8h_a43ee7ca16282ba3bc2a32e8513b397b3}{srsran\+::ofh\+::mm512\+::determine\+\_\+bfp\+\_\+exponent}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r0\+\_\+epi16}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r1\+\_\+epi16}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r2\+\_\+epi16}}, \mbox{\hyperlink{classunsigned}{unsigned}} data\+\_\+width)
\begin{DoxyCompactList}\small\item\em Determines BFP exponent for each of the four input RBs passed in three AVX512 registers. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
AVX512 support for OFH Compression algorithms. 



\doxysubsection{Function Documentation}
\Hypertarget{avx512__helpers_8h_a896eb6546ff9996a6289e1ac7bf46171}\label{avx512__helpers_8h_a896eb6546ff9996a6289e1ac7bf46171} 
\index{avx512\_helpers.h@{avx512\_helpers.h}!calculate\_max\_abs@{calculate\_max\_abs}}
\index{calculate\_max\_abs@{calculate\_max\_abs}!avx512\_helpers.h@{avx512\_helpers.h}}
\doxysubsubsection{\texorpdfstring{calculate\_max\_abs()}{calculate\_max\_abs()}}
{\footnotesize\ttfamily \+\_\+\+\_\+m512i srsran\+::ofh\+::mm512\+::calculate\+\_\+max\+\_\+abs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{r0\+\_\+epi16,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{r1\+\_\+epi16,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{r2\+\_\+epi16 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Finds maximum absolute value across 16bit IQ samples in each of the four input resource blocks passed in three AVX512 registers. 

The content of the three input AVX512 registers is represented in the table below. Here RBx stands for one unique RE (pair of IQ samples, 32 bits long) pertaining to a respective RB\+: \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{9}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }\\\cline{1-9}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }\\\cline{1-9}
\endhead
{\ttfamily r0\+\_\+epi16\+:}   &RB0 RB0   &RB0 RB0   &RB0 RB0   &RB0 RB0   &RB0 RB0   &RB0 RB0   &RB1 RB1   &RB1 RB1    \\\cline{1-9}
{\ttfamily r1\+\_\+epi16\+:}   &RB1 RB1   &RB1 RB1   &RB1 RB1   &RB1 RB1   &RB2 RB2   &RB2 RB2   &RB2 RB2   &RB2 RB2    \\\cline{1-9}
{\ttfamily r2\+\_\+epi16\+:}   &RB2 RB2   &RB2 RB2   &RB3 RB3   &RB3 RB3   &RB3 RB3   &RB3 RB3   &RB3 RB3   &RB3 RB3   \\\cline{1-9}
\end{longtabu}



\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em r0\+\_\+epi16} & AVX512 register storing 16bit IQ pairs of the first and second RBs. \\
\hline
\mbox{\texttt{ in}}  & {\em r1\+\_\+epi16} & AVX512 register storing 16bit IQ pairs of the second and third RBs. \\
\hline
\mbox{\texttt{ in}}  & {\em r2\+\_\+epi16} & AVX512 register storing 16bit IQ pairs of the third and fourth RBs. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An AVX512 register storing the result for each of the four RBs in every 128bit lane. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00108\ \{}
\DoxyCodeLine{00109\ \ \ \textcolor{keyword}{const}\ \_\_m512i\ ONE\_EPI16\ =\ \_mm512\_set1\_epi16(1);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{comment}{//\ Permute\ input\ vectors\ so\ that\ the\ pairwise\ comparison\ can\ be\ used.\ The\ resulting\ vectors\ look\ as\ follows:}}
\DoxyCodeLine{00112\ \ \ \textcolor{comment}{//\ [\ RB0\ RB0\ |\ RB0\ RB0\ |\ RB1\ RB1\ |\ RB1\ RB1\ |\ RB2\ RB2\ |\ RB2\ RB2\ |\ RB3\ RB3\ |\ RB3\ RB3\ ]}}
\DoxyCodeLine{00113\ \ \ \textcolor{comment}{//\ [\ RB0\ RB0\ |\ RB0\ RB0\ |\ RB1\ RB1\ |\ RB1\ RB1\ |\ RB2\ RB2\ |\ RB2\ RB2\ |\ RB3\ RB3\ |\ RB3\ RB3\ ]}}
\DoxyCodeLine{00114\ \ \ \textcolor{comment}{//\ [\ RB0\ RB0\ |\ RB0\ RB0\ |\ RB1\ RB1\ |\ RB1\ RB1\ |\ RB2\ RB2\ |\ RB2\ RB2\ |\ RB3\ RB3\ |\ RB3\ RB3\ ]}}
\DoxyCodeLine{00115\ \ \ \_\_m512i\ v0\_epi16\ =}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \_mm512\_mask\_shuffle\_i64x2(r0\_epi16,\ 0b11111100,\ r1\_epi16,\ r2\_epi16,\ (\_MM\_PERM\_ENUM)\_MM\_SHUFFLE(1,\ 0,\ 0,\ 0));}
\DoxyCodeLine{00117\ \ \ \_\_m512i\ v1\_epi16\ =}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \_mm512\_mask\_shuffle\_i64x2(r1\_epi16,\ 0b11000011,\ r0\_epi16,\ r2\_epi16,\ (\_MM\_PERM\_ENUM)\_MM\_SHUFFLE(2,\ 0,\ 0,\ 1));}
\DoxyCodeLine{00119\ \ \ \_\_m512i\ v2\_epi16\ =}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \_mm512\_mask\_shuffle\_i64x2(r2\_epi16,\ 0b00111111,\ r0\_epi16,\ r1\_epi16,\ (\_MM\_PERM\_ENUM)\_MM\_SHUFFLE(0,\ 3,\ 3,\ 2));}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \_\_m512i\ abs\_min\_epu16\ =\ find\_abs\_min\_max\_values<\_mm512\_min\_epi16>(v0\_epi16,\ v1\_epi16,\ v2\_epi16);}
\DoxyCodeLine{00123\ \ \ \_\_m512i\ abs\_max\_epu16\ =\ find\_abs\_min\_max\_values<\_mm512\_max\_epi16>(v0\_epi16,\ v1\_epi16,\ v2\_epi16);}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ Subtract\ 1\ from\ absolute\ minimum\ value.}}
\DoxyCodeLine{00126\ \ \ abs\_min\_epu16\ =\ \_mm512\_subs\_epu16(abs\_min\_epu16,\ ONE\_EPI16);}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{return}\ \_mm512\_max\_epu16(abs\_min\_epu16,\ abs\_max\_epu16);}
\DoxyCodeLine{00129\ \}}

\end{DoxyCode}
\Hypertarget{avx512__helpers_8h_a43ee7ca16282ba3bc2a32e8513b397b3}\label{avx512__helpers_8h_a43ee7ca16282ba3bc2a32e8513b397b3} 
\index{avx512\_helpers.h@{avx512\_helpers.h}!determine\_bfp\_exponent@{determine\_bfp\_exponent}}
\index{determine\_bfp\_exponent@{determine\_bfp\_exponent}!avx512\_helpers.h@{avx512\_helpers.h}}
\doxysubsubsection{\texorpdfstring{determine\_bfp\_exponent()}{determine\_bfp\_exponent()}}
{\footnotesize\ttfamily \+\_\+\+\_\+m512i srsran\+::ofh\+::mm512\+::determine\+\_\+bfp\+\_\+exponent (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{r0\+\_\+epi16,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{r1\+\_\+epi16,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{r2\+\_\+epi16,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{data\+\_\+width }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Determines BFP exponent for each of the four input RBs passed in three AVX512 registers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em r0\+\_\+epi16} & AVX512 register storing 16bit IQ pairs of the first and second RBs. \\
\hline
\mbox{\texttt{ in}}  & {\em r1\+\_\+epi16} & AVX512 register storing 16bit IQ pairs of the second and third RBs. \\
\hline
\mbox{\texttt{ in}}  & {\em r2\+\_\+epi16} & AVX512 register storing 16bit IQ pairs of the third and fourth RBs. \\
\hline
\mbox{\texttt{ in}}  & {\em data\+\_\+width} & Compressed samples bit width.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Four exponents in the LSB bits of every 128bit lane. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00139\ \{}
\DoxyCodeLine{00140\ \ \ \textcolor{comment}{//\ Max\ allowed\ exponent\ (account\ for\ the\ extra\ 16\ MSBs\ and\ a\ sign\ bit\ counted\ by\ \_mm512\_lzcnt\_epi32\ intrinsic).}}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordtype}{unsigned}\ max\_lzcnt\ \ \ \ \ =\ (16\ -\/\ data\_width)\ +\ 16\ +\ 1;}
\DoxyCodeLine{00142\ \ \ \_\_m512i\ \ max\_exp\_epu32\ =\ \_mm512\_set1\_epi32(max\_lzcnt);}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{comment}{//\ Calculate\ maximum\ absolute\ values\ in\ the\ four\ PRBs.}}
\DoxyCodeLine{00145\ \ \ \_\_m512i\ max\_abs\_epu16\ =\ \mbox{\hyperlink{ofh_2compression_2avx2__helpers_8h_a1877ae3f8653c849ee2f0ba6708d79be}{calculate\_max\_abs}}(r0\_epi16,\ r1\_epi16,\ r2\_epi16);}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ Mask\ out\ 16\ MSB\ bits\ in\ each\ 32bit\ word.}}
\DoxyCodeLine{00148\ \ \ max\_abs\_epu16\ =\ \_mm512\_and\_epi32(max\_abs\_epu16,\ \_mm512\_set1\_epi32(0x0000ffff));}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//\ Compute\ BFP\ exponent\ as\ a\ number\ of\ leading\ zeros.}}
\DoxyCodeLine{00151\ \ \ \_\_m512i\ lz\_count\_epi32\ =\ \_mm512\_lzcnt\_epi32(max\_abs\_epu16);}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ Subtract\ with\ saturation.}}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{return}\ \_mm512\_subs\_epu16(max\_exp\_epu32,\ lz\_count\_epi32);}
\DoxyCodeLine{00155\ \}}

\end{DoxyCode}
\Hypertarget{avx512__helpers_8h_ad2eabcd25afaafd26760fe2e28623797}\label{avx512__helpers_8h_ad2eabcd25afaafd26760fe2e28623797} 
\index{avx512\_helpers.h@{avx512\_helpers.h}!find\_abs\_min\_max\_values@{find\_abs\_min\_max\_values}}
\index{find\_abs\_min\_max\_values@{find\_abs\_min\_max\_values}!avx512\_helpers.h@{avx512\_helpers.h}}
\doxysubsubsection{\texorpdfstring{find\_abs\_min\_max\_values()}{find\_abs\_min\_max\_values()}}
{\footnotesize\ttfamily template$<$\+\_\+mm512\+\_\+comparator COMPARE$>$ \\
\+\_\+\+\_\+m512i srsran\+::ofh\+::mm512\+::find\+\_\+abs\+\_\+min\+\_\+max\+\_\+values (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{v0\+\_\+epi16,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{v1\+\_\+epi16,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\+\_\+\+\_\+m512i}}}]{v2\+\_\+epi16 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Finds the maximum (or minimum) 16bit sample in each of the four input resource blocks, returns its absolute value. 

Finds absolute maximum (or minimum, depending on the comparator passed as the template argument) values for each of the four RBs passed in three AVX512 registers.

AVX512 register bits are evenly divided between four RBs so that IQ samples of each RB occupy one 128bit lane. The following diagram shows the input format. Here RBx stands for one unique RE (a pair of IQ samples, 32 bits long) pertaining to a respective RB\+: \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{9}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }\\\cline{1-9}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }\\\cline{1-9}
\endhead
{\ttfamily v0\+\_\+epi16\+:}   &RB0 RB0   &RB0 RB0   &RB1 RB1   &RB1 RB1   &RB2 RB2   &RB2 RB2   &RB3 RB3   &RB3 RB3    \\\cline{1-9}
{\ttfamily v1\+\_\+epi16\+:}   &RB0 RB0   &RB0 RB0   &RB1 RB1   &RB1 RB1   &RB2 RB2   &RB2 RB2   &RB3 RB3   &RB3 RB3    \\\cline{1-9}
{\ttfamily v2\+\_\+epi16\+:}   &RB0 RB0   &RB0 RB0   &RB1 RB1   &RB1 RB1   &RB2 RB2   &RB2 RB2   &RB3 RB3   &RB3 RB3   \\\cline{1-9}
\end{longtabu}


The function first performs vertical min/max search across the three registers (comparing 16bit samples), then horizontal min/max across elements in each 128bit lane of the resulting vector. Finally, the function takes the absolute value of the four 16bit samples computed thus far.


\begin{DoxyTemplParams}{Template Parameters}
{\em COMPARE} & AVX512 intrinsic used for comparison, either {\ttfamily \+\_\+mm512\+\_\+min\+\_\+epi16} or {\ttfamily \+\_\+mm512\+\_\+max\+\_\+epi16}. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em v0\+\_\+epi16} & AVX512 register storing first four IQ pairs of each of the four RB. \\
\hline
\mbox{\texttt{ in}}  & {\em v1\+\_\+epi16} & AVX512 register storing second four IQ pairs of each of the four RB. \\
\hline
\mbox{\texttt{ in}}  & {\em v2\+\_\+epi16} & AVX512 register storing last four IQ pairs of each of the four RB.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An AVX512 register storing the result for each of the four RBs in every 128bit lane. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00064\ \{}
\DoxyCodeLine{00065\ \ \ \textcolor{comment}{//\ Find\ vertical\ min/max\ across\ every\ 8\ 16bit\ values\ pertaining\ to\ the\ same\ PRB.}}
\DoxyCodeLine{00066\ \ \ \_\_m512i\ cmp\_8val\_epi16\ =\ COMPARE(COMPARE(v0\_epi16,\ v1\_epi16),\ v2\_epi16);}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ Swap\ 64bit\ words\ inside\ 128bit\ lanes\ and\ find\ 4\ min/max\ values.}}
\DoxyCodeLine{00069\ \ \ \_\_m512i\ cmp\_8val\_swp\_epi16\ =}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \_mm512\_mask\_shuffle\_epi32(\_mm512\_set1\_epi64(0),\ 0xffff,\ cmp\_8val\_epi16,\ (\_MM\_PERM\_ENUM)\_MM\_SHUFFLE(1,\ 0,\ 3,\ 2));}
\DoxyCodeLine{00071\ \ \ \_\_m512i\ cmp\_4val\_epi16\ =\ COMPARE(cmp\_8val\_epi16,\ cmp\_8val\_swp\_epi16);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{//\ Swap\ 32bit\ words\ and\ find\ 2\ min/max\ values.}}
\DoxyCodeLine{00074\ \ \ \_\_m512i\ cmp\_4val\_swp\_epi16\ =}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \_mm512\_mask\_shuffle\_epi32(\_mm512\_set1\_epi64(0),\ 0xffff,\ cmp\_4val\_epi16,\ (\_MM\_PERM\_ENUM)\_MM\_SHUFFLE(2,\ 3,\ 0,\ 1));}
\DoxyCodeLine{00076\ \ \ \_\_m512i\ cmp\_2val\_epi16\ =\ COMPARE(cmp\_4val\_epi16,\ cmp\_4val\_swp\_epi16);}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \textcolor{comment}{//\ Swap\ 16bit\ words\ and\ find\ final\ min/max\ values\ for\ each\ PRB.}}
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{const}\ \_\_m512i\ shuffle\_mask\ =\ \_mm512\_setr\_epi64(0x0504070601000302,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0d0c0f0e09080b0a,}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0504070601000302,}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0d0c0f0e09080b0a,}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0504070601000302,}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0d0c0f0e09080b0a,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0504070601000302,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x0d0c0f0e09080b0a);}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \_\_m512i\ cmp\_2val\_swp\_epi16\ =\ \_mm512\_shuffle\_epi8(cmp\_2val\_epi16,\ shuffle\_mask);}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{return}\ \_mm512\_abs\_epi16(COMPARE(cmp\_2val\_epi16,\ cmp\_2val\_swp\_epi16));}
\DoxyCodeLine{00090\ \}}

\end{DoxyCode}
