\doxysection{srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1radio__session__uhd__impl}{}\label{classsrsran_1_1radio__session__uhd__impl}\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}


Describes a radio session based on UHD that also implements the management and data plane functions.  




{\ttfamily \#include $<$radio\+\_\+uhd\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d3/dc0/classsrsran_1_1radio__session__uhd__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/d71/classsrsran_1_1radio__session__uhd__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}} \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_aab525b9376c32a2a641110aca6031602}{read\+\_\+current\+\_\+time}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Gets the current time. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a3250d926cc32e410d939cf36bde73d6a}{radio\+\_\+session\+\_\+uhd\+\_\+impl}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1radio}{radio\+\_\+configuration\+::radio}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\+\_\+config}}, \mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&async\+\_\+executor, \mbox{\hyperlink{classsrsran_1_1radio__notification__handler}{radio\+\_\+notification\+\_\+handler}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\+\_\+}})
\begin{DoxyCompactList}\small\item\em Constructs a radio session based on UHD. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a5d832ca7f42c3fa0892f6d099709e39e}{is\+\_\+successful}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Indicates that the radio session was initialized succesfully. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1radio__management__plane}{radio\+\_\+management\+\_\+plane}} \& \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a66bafd232886c2f2d0f6482899c672fe}{get\+\_\+management\+\_\+plane}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Gets the management plane. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1baseband__gateway}{baseband\+\_\+gateway}} \& \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a31fd519e4b75e2b674a1e02439d6ac96}{get\+\_\+baseband\+\_\+gateway}} (\mbox{\hyperlink{classunsigned}{unsigned}} stream\+\_\+id) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Gets the data plane. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_abec06709e819a7c04e7f7aed5bb62bce}{start}} (\mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{init\+\_\+time}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Starts the radio operation. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}{stop}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Stops the radio session operation. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a7640e0930e7072e538a0c75e28483100}{set\+\_\+tx\+\_\+gain}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\+\_\+idx}}, \mbox{\hyperlink{classdouble}{double}} gain\+\_\+dB) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Set the transmission gain of a given port in runtime. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1radio__session__uhd__impl_a31e48fb0e5809d7538c23afe9ff415f4}{set\+\_\+rx\+\_\+gain}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\+\_\+idx}}, \mbox{\hyperlink{classdouble}{double}} gain\+\_\+dB) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Set the reception gain of a given port in runtime. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Describes a radio session based on UHD that also implements the management and data plane functions. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a3250d926cc32e410d939cf36bde73d6a}\label{classsrsran_1_1radio__session__uhd__impl_a3250d926cc32e410d939cf36bde73d6a} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!radio\_session\_uhd\_impl@{radio\_session\_uhd\_impl}}
\index{radio\_session\_uhd\_impl@{radio\_session\_uhd\_impl}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{radio\_session\_uhd\_impl()}{radio\_session\_uhd\_impl()}}
{\footnotesize\ttfamily radio\+\_\+session\+\_\+uhd\+\_\+impl\+::radio\+\_\+session\+\_\+uhd\+\_\+impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1radio}{radio\+\_\+configuration\+::radio}} \&}]{radio\+\_\+config,  }\item[{\mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&}]{async\+\_\+executor,  }\item[{\mbox{\hyperlink{classsrsran_1_1radio__notification__handler}{radio\+\_\+notification\+\_\+handler}} \&}]{notifier\+\_\+ }\end{DoxyParamCaption})}



Constructs a radio session based on UHD. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00205\ \ \ actual\_sampling\_rate\_Hz(0.0),\ async\_executor(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{async\_executor\_}}),\ notifier(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\_}})}
\DoxyCodeLine{00206\ \{}
\DoxyCodeLine{00207\ \ \ \textcolor{comment}{//\ Disable\ fast-\/path\ (U/L/O)\ messages.}}
\DoxyCodeLine{00208\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{setenv}}(\textcolor{stringliteral}{"{}UHD\_LOG\_FASTPATH\_DISABLE"{}},\ \textcolor{stringliteral}{"{}1"{}},\ 0);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{comment}{//\ Set\ real\ time\ priority\ to\ UHD\ threads.\ All\ threads\ created\ from\ this\ thread\ inherit\ the\ priority.}}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uhd\_set\_thread\_priority}}(0.90,\ \textcolor{keyword}{true})\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{UHD\_ERROR\_NONE}})\ \{}
\DoxyCodeLine{00212\ \ \ \ \ fmt::print(stderr,\ \textcolor{stringliteral}{"{}Warning:\ Scheduling\ priority\ of\ UHD\ not\ changed.\ Cause:\ Not\ enough\ privileges.\(\backslash\)n"{}});}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \textcolor{comment}{//\ Set\ the\ logging\ level.}}
\DoxyCodeLine{00216\ \textcolor{preprocessor}{\#ifdef\ UHD\_LOG\_INFO}}
\DoxyCodeLine{00217\ \ \ uhd::log::severity\_level\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}}\ =\ uhd::log::severity\_level::info;}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.log\_level.empty())\ \{}
\DoxyCodeLine{00219\ \ \ \ \ std::string\ log\_level\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.log\_level;}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ e\ :\ log\_level)\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ e\ =\ std::toupper(e);}
\DoxyCodeLine{00223\ \ \ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{if}\ (log\_level\ ==\ \textcolor{stringliteral}{"{}WARNING"{}})\ \{}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}}\ =\ uhd::log::severity\_level::warning;}
\DoxyCodeLine{00227\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (log\_level\ ==\ \textcolor{stringliteral}{"{}INFO"{}})\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}}\ =\ uhd::log::severity\_level::info;}
\DoxyCodeLine{00229\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (log\_level\ ==\ \textcolor{stringliteral}{"{}DEBUG"{}})\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}}\ =\ uhd::log::severity\_level::debug;}
\DoxyCodeLine{00231\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (log\_level\ ==\ \textcolor{stringliteral}{"{}TRACE"{}})\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}}\ =\ uhd::log::severity\_level::trace;}
\DoxyCodeLine{00233\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}}\ =\ uhd::log::severity\_level::error;}
\DoxyCodeLine{00235\ \ \ \ \ \}}
\DoxyCodeLine{00236\ \ \ \}}
\DoxyCodeLine{00237\ \ \ uhd::log::set\_console\_level(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{severity\_level}});}
\DoxyCodeLine{00238\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{total\_rx\_channel\_count}}\ =\ 0;}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream}{radio\_configuration::stream}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_config}}\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.rx\_streams)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{total\_rx\_channel\_count}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_config}}.channels.size();}
\DoxyCodeLine{00243\ \ \ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{total\_tx\_channel\_count}}\ =\ 0;}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream}{radio\_configuration::stream}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_config}}\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.rx\_streams)\ \{}
\DoxyCodeLine{00247\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{total\_tx\_channel\_count}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_config}}.channels.size();}
\DoxyCodeLine{00248\ \ \ \}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \textcolor{comment}{//\ Open\ device.}}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordflow}{if}\ (!device.usrp\_make(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.args))\ \{}
\DoxyCodeLine{00252\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Failed\ to\ open\ device\ with\ address\ '\{\}':\ \{\}\(\backslash\)n"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.args,\ device.get\_error\_message());}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{comment}{//\ Validate\ USRP\ connection.}}
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{if}\ (!device.is\_connection\_valid())\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00259\ \ \ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ std::set<radio\_uhd\_device\_type::types>\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{automatic\_mcr\_devices}}\ =\ \{\mbox{\hyperlink{classsrsran_1_1radio__uhd__device__type_a89fef702251e27c3e616fa7654d56fdaa49007b2908a3d74ee65c762d016ba5ec}{radio\_uhd\_device\_type::types::B2xx}}\};}
\DoxyCodeLine{00262\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{automatic\_mcr\_devices}}.count(device.get\_type()))\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{if}\ (!device.set\_automatic\_master\_clock\_rate(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.sampling\_rate\_hz))\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Error\ setting\ master\ clock\ rate.\ \{\}\(\backslash\)n"{}},\ device.get\_error\_message());}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ \ \ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ is\_locked\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00270\ \ \ std::string\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sensor\_name}};}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \textcolor{comment}{//\ Set\ sync\ source.}}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{if}\ (!device.set\_sync\_source(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.clock))\ \{}
\DoxyCodeLine{00274\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Error:\ couldn't\ set\ sync\ source:\ \{\}\(\backslash\)n"{}},\ device.get\_error\_message());}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00276\ \ \ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \textcolor{comment}{//\ Set\ GPS\ time\ if\ GPSDO\ is\ selected.}}
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.clock.sync\ ==\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1clock__sources_ae4eeb4b5e361127a9b79d11d0fc68b4da5d2ec3ee1c91c66c2a282efb4c12c2a5}{radio\_configuration::clock\_sources::source::GPSDO}})\ \{}
\DoxyCodeLine{00280\ \ \ \ \ set\_time\_to\_gps\_time();}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{comment}{//\ Select\ oscillator\ sensor\ name.}}
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.clock.sync\ ==\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1clock__sources_ae4eeb4b5e361127a9b79d11d0fc68b4da5d2ec3ee1c91c66c2a282efb4c12c2a5}{radio\_configuration::clock\_sources::source::GPSDO}})\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sensor\_name}}\ =\ \textcolor{stringliteral}{"{}gps\_locked"{}};}
\DoxyCodeLine{00286\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sensor\_name}}\ =\ \textcolor{stringliteral}{"{}ref\_locked"{}};}
\DoxyCodeLine{00288\ \ \ \}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \textcolor{comment}{//\ Wait\ until\ external\ reference\ /\ GPS\ is\ locked.}}
\DoxyCodeLine{00291\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.clock.sync\ ==\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1clock__sources_ae4eeb4b5e361127a9b79d11d0fc68b4da5d2ec3ee1c91c66c2a282efb4c12c2a5}{radio\_configuration::clock\_sources::source::GPSDO}}\ ||}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.clock.sync\ ==\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1clock__sources_ae4eeb4b5e361127a9b79d11d0fc68b4da3932d629fb5e2be9d09b3a4485b3cc9d}{radio\_configuration::clock\_sources::source::EXTERNAL}})\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{comment}{//\ blocks\ until\ clock\ source\ is\ locked}}
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ wait\_sensor\_locked(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sensor\_name}},\ \textcolor{keyword}{true},\ CLOCK\_TIMEOUT\_MS))\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Could\ not\ lock\ reference\ clock\ source.\ Sensor:\ \{\}=\{\}.\(\backslash\)n"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sensor\_name}},\ is\_locked\ ?\ \textcolor{stringliteral}{"{}true"{}}\ :\ \textcolor{stringliteral}{"{}false"{}});}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00297\ \ \ \ \ \}}
\DoxyCodeLine{00298\ \ \ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \textcolor{comment}{//\ Set\ Tx\ rate.}}
\DoxyCodeLine{00301\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_tx\_rate\_Hz}}\ =\ 0.0;}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordflow}{if}\ (!device.set\_tx\_rate(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_tx\_rate\_Hz}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.sampling\_rate\_hz))\ \{}
\DoxyCodeLine{00303\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Error:\ setting\ Tx\ sampling\ rate.\ \{\}\(\backslash\)n"{}},\ device.get\_error\_message());}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00305\ \ \ \}}
\DoxyCodeLine{00306\ \ \ srsran\_assert(std::isnormal(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_tx\_rate\_Hz}}),\ \textcolor{stringliteral}{"{}Actual\ transmit\ sampling\ rate\ is\ invalid."{}});}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ Set\ Rx\ rate.}}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_rx\_rate\_Hz}}\ =\ 0.0;}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{if}\ (!device.set\_rx\_rate(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_rx\_rate\_Hz}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.sampling\_rate\_hz))\ \{}
\DoxyCodeLine{00311\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Error:\ setting\ Rx\ sampling\ rate.\ \{\}\(\backslash\)n"{}},\ device.get\_error\_message());}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00313\ \ \ \}}
\DoxyCodeLine{00314\ \ \ srsran\_assert(std::isnormal(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_rx\_rate\_Hz}}),\ \textcolor{stringliteral}{"{}Actual\ receive\ sampling\ rate\ is\ invalid."{}});}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{comment}{//\ Overwrite\ actual.}}
\DoxyCodeLine{00317\ \ \ actual\_sampling\_rate\_Hz\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_rx\_rate\_Hz}};}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{comment}{//\ Reset\ timestamps.}}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{total\_rx\_channel\_count}}\ >\ 1\ ||\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{total\_tx\_channel\_count}}\ >\ 1)\ \&\&}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.clock.sync\ !=\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1clock__sources_ae4eeb4b5e361127a9b79d11d0fc68b4da5d2ec3ee1c91c66c2a282efb4c12c2a5}{radio\_configuration::clock\_sources::source::GPSDO}})\ \{}
\DoxyCodeLine{00322\ \ \ \ \ device.set\_time\_unknown\_pps(uhd::time\_spec\_t());}
\DoxyCodeLine{00323\ \ \ \}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{comment}{//\ Lists\ of\ stream\ descriptions.}}
\DoxyCodeLine{00326\ \ \ std::vector<radio\_uhd\_tx\_stream::stream\_description>\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_stream\_description\_list}};}
\DoxyCodeLine{00327\ \ \ std::vector<radio\_uhd\_rx\_stream::stream\_description>\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_stream\_description\_list}};}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \textcolor{comment}{//\ Force\ OTW\ format\ if\ it\ is\ set\ to\ default,\ the\ device\ is\ a\ B2xx\ and\ the\ total\ sampling\ rate\ exceeds\ 30.72MHz.}}
\DoxyCodeLine{00330\ \ \ radio\_configuration::over\_the\_wire\_format\ otw\_format\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.otw\_format;}
\DoxyCodeLine{00331\ \ \ \textcolor{keywordflow}{if}\ ((otw\_format\ ==\ radio\_configuration::over\_the\_wire\_format::DEFAULT)\ \&\&}
\DoxyCodeLine{00332\ \ \ \ \ \ \ (device.get\_type()\ ==\ \mbox{\hyperlink{classsrsran_1_1radio__uhd__device__type_a89fef702251e27c3e616fa7654d56fdaa49007b2908a3d74ee65c762d016ba5ec}{radio\_uhd\_device\_type::types::B2xx}})\ \&\&}
\DoxyCodeLine{00333\ \ \ \ \ \ \ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.rx\_streams.size()\ *\ actual\_sampling\_rate\_Hz\ >\ 30.72e6))\ \{}
\DoxyCodeLine{00334\ \ \ \ \ otw\_format\ =\ radio\_configuration::over\_the\_wire\_format::SC12;}
\DoxyCodeLine{00335\ \ \ \}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{comment}{//\ For\ each\ transmit\ stream,\ create\ stream\ and\ configure\ RF\ ports.}}
\DoxyCodeLine{00338\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.tx\_streams.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}})\ \{}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{comment}{//\ Select\ stream.}}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream}{radio\_configuration::stream}}\&\ stream\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.tx\_streams[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}}];}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{comment}{//\ Prepare\ stream\ description.}}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description}{radio\_uhd\_tx\_stream::stream\_description}}\ stream\_description\ =\ \{\};}
\DoxyCodeLine{00344\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a0b39a3d7e25b882fe9df16c12261a205}{id}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}};}
\DoxyCodeLine{00345\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a89f85e9688c6da7ee462ed4db9dbd261}{otw\_format}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ otw\_format;}
\DoxyCodeLine{00346\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a89497c1d91cdff37584f5a22c8e486ea}{srate\_hz}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_tx\_rate\_Hz}};}
\DoxyCodeLine{00347\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a17ce29a7744ec618d672612ecf64ddc9}{args}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_adc4761f7758b7fc95b81aa96c9c72563}{args}};}
\DoxyCodeLine{00348\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_ab14d678d7817a917dee36b70d47c368f}{discontiuous\_tx}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.discontinuous\_tx;}
\DoxyCodeLine{00349\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a2ab94d35a33dde3fa34c14ca5b76489e}{power\_ramping\_us}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.power\_ramping\_us;}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{comment}{//\ Setup\ ports.}}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ !=\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_abd26def5f6fa41404201189f128ee6b1}{channels}}.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}})\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \textcolor{comment}{//\ Select\ the\ port\ index.}}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}}\ =\ tx\_port\_map.size();}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ channel\ port.}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a84f5275c39bc7989a7e83004fb5fb326}{ports}}.emplace\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}});}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \ \ \textcolor{comment}{//\ Save\ the\ stream\ and\ channel\ indexes\ for\ the\ port.}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ tx\_port\_map.emplace\_back(port\_to\_stream\_channel(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}));}
\DoxyCodeLine{00361\ \ \ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{comment}{//\ Setup\ port.}}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ !=\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_abd26def5f6fa41404201189f128ee6b1}{channels}}.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}})\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ port\ index.}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}}\ =\ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__tx__stream_1_1stream__description_a84f5275c39bc7989a7e83004fb5fb326}{ports}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}];}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ port\ configuration.}}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1channel}{radio\_configuration::channel}}\&\ channel\ =\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_abd26def5f6fa41404201189f128ee6b1}{channels}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}];}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ gain.}}
\DoxyCodeLine{00372\ \ \ \ \ \ \ set\_tx\_gain\_unprotected(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}},\ channel.gain\_dB);}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ frequency.}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!set\_tx\_freq(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}},\ channel.freq))\ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \textcolor{comment}{//\ Inform\ about\ ignored\ argument.}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!channel.args.empty())\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Warning:\ transmitter\ \{\}\ unused\ args.\(\backslash\)n"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}});}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00383\ \ \ \ \ \}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{comment}{//\ Add\ stream\ description\ to\ the\ list.}}
\DoxyCodeLine{00386\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_stream\_description\_list}}.emplace\_back(stream\_description);}
\DoxyCodeLine{00387\ \ \ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \textcolor{comment}{//\ For\ each\ receive\ stream,\ create\ stream\ and\ configure\ RF\ ports.}}
\DoxyCodeLine{00390\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.rx\_streams.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}})\ \{}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{comment}{//\ Select\ stream.}}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream}{radio\_configuration::stream}}\&\ stream\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.rx\_streams[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}}];}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{comment}{//\ Prepare\ stream\ description.}}
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description}{radio\_uhd\_rx\_stream::stream\_description}}\ stream\_description\ =\ \{\};}
\DoxyCodeLine{00396\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description_ab9e55f09b4a0a0f745a8cf6d7d50db27}{id}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}};}
\DoxyCodeLine{00397\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description_aa813d3b67c95c0f8bcc5926326e4f605}{otw\_format}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ otw\_format;}
\DoxyCodeLine{00398\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description_a160a068916afba455cecdd6e78d722e7}{srate\_Hz}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{actual\_rx\_rate\_Hz}};}
\DoxyCodeLine{00399\ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description_abf37805031be90db14ffb9095aa36429}{args}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_adc4761f7758b7fc95b81aa96c9c72563}{args}};}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Setup\ ports.}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ !=\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_abd26def5f6fa41404201189f128ee6b1}{channels}}.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}})\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{comment}{//\ Select\ the\ port\ index.}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}}\ =\ rx\_port\_map.size();}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ channel\ port.}}
\DoxyCodeLine{00407\ \ \ \ \ \ \ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description_a531feb877c4b39052df94d3459225cc1}{ports}}.emplace\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}});}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \textcolor{comment}{//\ Save\ the\ stream\ and\ channel\ indexes\ for\ the\ port.}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ rx\_port\_map.emplace\_back(port\_to\_stream\_channel(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_idx}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}));}
\DoxyCodeLine{00411\ \ \ \ \ \}}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{comment}{//\ Setup\ port.}}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}\ !=\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_abd26def5f6fa41404201189f128ee6b1}{channels}}.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}})\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ port\ index.}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}}\ =\ stream\_description.\mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description_a531feb877c4b39052df94d3459225cc1}{ports}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}];}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ port\ configuration.}}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1channel}{radio\_configuration::channel}}\&\ channel\ =\ stream.\mbox{\hyperlink{structsrsran_1_1radio__configuration_1_1stream_abd26def5f6fa41404201189f128ee6b1}{channels}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{channel\_idx}}];}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ gain.}}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!set\_rx\_gain\_unprotected(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}},\ channel.gain\_dB))\ \{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ frequency.}}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!set\_rx\_freq(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}},\ channel.freq))\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \textcolor{comment}{//\ Inform\ about\ ignored\ argument.}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!channel.args.empty())\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Warning:\ transmitter\ \{\}\ unused\ args.\(\backslash\)n"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}});}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00435\ \ \ \ \ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{comment}{//\ Add\ stream\ description\ to\ the\ list.}}
\DoxyCodeLine{00438\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_stream\_description\_list}}.emplace\_back(stream\_description);}
\DoxyCodeLine{00439\ \ \ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \textcolor{comment}{//\ Create\ baseband\ gateways.}}
\DoxyCodeLine{00442\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_stream}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_stream}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{radio\_config}}.tx\_streams.size();\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_stream}})\ \{}
\DoxyCodeLine{00443\ \ \ \ \ bb\_gateways.emplace\_back(std::make\_unique<radio\_uhd\_baseband\_gateway>(}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ device,\ async\_executor,\ notifier,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_stream\_description\_list}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_stream}}],\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_stream\_description\_list}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_stream}}]));}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{comment}{//\ Early\ return\ if\ the\ gateway\ was\ not\ successfully\ created.}}
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{keywordflow}{if}\ (!bb\_gateways.back()-\/>is\_successful())\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00449\ \ \ \ \ \}}
\DoxyCodeLine{00450\ \ \ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \textcolor{comment}{//\ Restore\ thread\ priorities.}}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uhd\_set\_thread\_priority}}(0,\ \textcolor{keyword}{false})\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{UHD\_ERROR\_NONE}})\ \{}
\DoxyCodeLine{00454\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Error:\ setting\ UHD\ thread\ priority.\(\backslash\)n"{}});}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00456\ \ \ \}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \textcolor{comment}{//\ Transition\ to\ successfully\ initialized.}}
\DoxyCodeLine{00459\ \ \ state\ =\ states::SUCCESSFUL\_INIT;}
\DoxyCodeLine{00460\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a31fd519e4b75e2b674a1e02439d6ac96}\label{classsrsran_1_1radio__session__uhd__impl_a31fd519e4b75e2b674a1e02439d6ac96} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!get\_baseband\_gateway@{get\_baseband\_gateway}}
\index{get\_baseband\_gateway@{get\_baseband\_gateway}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{get\_baseband\_gateway()}{get\_baseband\_gateway()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1baseband__gateway}{baseband\+\_\+gateway}} \& srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+::get\+\_\+baseband\+\_\+gateway (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{stream\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Gets the data plane. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em stream\+\_\+id} & Stream identifier. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The reference to the data plane for this radio session. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
An assertion is triggered if the stream identifier is invalid. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1radio__session_a49553db2d5fb97c4126ab0b8013bb663}{srsran\+::radio\+\_\+session}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00123\ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \ srsran\_assert(stream\_id\ <\ bb\_gateways.size(),}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Stream\ identifier\ (i.e.,\ \{\})\ exceeds\ the\ number\ of\ baseband\ gateways\ (i.e.,\ \{\})"{}},}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stream\_id,}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bb\_gateways.size());}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{return}\ *bb\_gateways[stream\_id];}
\DoxyCodeLine{00129\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a66bafd232886c2f2d0f6482899c672fe}\label{classsrsran_1_1radio__session__uhd__impl_a66bafd232886c2f2d0f6482899c672fe} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!get\_management\_plane@{get\_management\_plane}}
\index{get\_management\_plane@{get\_management\_plane}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{get\_management\_plane()}{get\_management\_plane()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1radio__management__plane}{radio\+\_\+management\+\_\+plane}} \& srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+::get\+\_\+management\+\_\+plane (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Gets the management plane. 

\begin{DoxyReturn}{Returns}
The reference to the management plane for this radio session. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1radio__session_a8f181b7c4b8f967d44b2f25515ceede0}{srsran\+::radio\+\_\+session}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00119\ \{\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a5d832ca7f42c3fa0892f6d099709e39e}\label{classsrsran_1_1radio__session__uhd__impl_a5d832ca7f42c3fa0892f6d099709e39e} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!is\_successful@{is\_successful}}
\index{is\_successful@{is\_successful}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{is\_successful()}{is\_successful()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+::is\+\_\+successful (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Indicates that the radio session was initialized succesfully. 

\begin{DoxyReturn}{Returns}
True if no exception is caught during initialization. Otherwise false. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00116\ \{\ \textcolor{keywordflow}{return}\ (state\ !=\ states::UNINITIALIZED);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_aab525b9376c32a2a641110aca6031602}\label{classsrsran_1_1radio__session__uhd__impl_aab525b9376c32a2a641110aca6031602} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!read\_current\_time@{read\_current\_time}}
\index{read\_current\_time@{read\_current\_time}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{read\_current\_time()}{read\_current\_time()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}} radio\+\_\+session\+\_\+uhd\+\_\+impl\+::read\+\_\+current\+\_\+time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Gets the current time. 



Implements \mbox{\hyperlink{classsrsran_1_1radio__session_a0994b4d52fda9184950ef2b941ef1a7b}{srsran\+::radio\+\_\+session}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00492\ \{}
\DoxyCodeLine{00493\ \ \ uhd::time\_spec\_t\ time;}
\DoxyCodeLine{00494\ \ \ \textcolor{keywordflow}{if}\ (!device.get\_time\_now(time))\ \{}
\DoxyCodeLine{00495\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Error\ retrieving\ time.\(\backslash\)n"{}});}
\DoxyCodeLine{00496\ \ \ \}}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{return}\ time.to\_ticks(actual\_sampling\_rate\_Hz);}
\DoxyCodeLine{00498\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a31e48fb0e5809d7538c23afe9ff415f4}\label{classsrsran_1_1radio__session__uhd__impl_a31e48fb0e5809d7538c23afe9ff415f4} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!set\_rx\_gain@{set\_rx\_gain}}
\index{set\_rx\_gain@{set\_rx\_gain}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{set\_rx\_gain()}{set\_rx\_gain()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+::set\+\_\+rx\+\_\+gain (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{port\+\_\+id,  }\item[{\mbox{\hyperlink{classdouble}{double}}}]{gain\+\_\+dB }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Set the reception gain of a given port in runtime. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em port\+\_\+id} & Indicates the port identifier. \\
\hline
\mbox{\texttt{ in}}  & {\em gain\+\_\+dB} & Indicates the new gain. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the operation is successful. Otherwise, false. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
The port identifier is indexed from stream ascending order and then port. 
\end{DoxyNote}


Implements \mbox{\hyperlink{classsrsran_1_1radio__management__plane_a640cbb0f0dad3ee3c383987c60ce3e71}{srsran\+::radio\+\_\+management\+\_\+plane}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00141\ \{\ \textcolor{keywordflow}{return}\ set\_rx\_gain\_unprotected(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}},\ gain\_dB);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a7640e0930e7072e538a0c75e28483100}\label{classsrsran_1_1radio__session__uhd__impl_a7640e0930e7072e538a0c75e28483100} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!set\_tx\_gain@{set\_tx\_gain}}
\index{set\_tx\_gain@{set\_tx\_gain}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{set\_tx\_gain()}{set\_tx\_gain()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::radio\+\_\+session\+\_\+uhd\+\_\+impl\+::set\+\_\+tx\+\_\+gain (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{port\+\_\+id,  }\item[{\mbox{\hyperlink{classdouble}{double}}}]{gain\+\_\+dB }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Set the transmission gain of a given port in runtime. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em port\+\_\+id} & Indicates the port identifier. \\
\hline
\mbox{\texttt{ in}}  & {\em gain\+\_\+dB} & Indicates the new gain. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the operation is successful. Otherwise, false. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
The port identifier is indexed from stream ascending order and then port. 
\end{DoxyNote}


Implements \mbox{\hyperlink{classsrsran_1_1radio__management__plane_ac0a8bb664019e6637372a92d78cea99a}{srsran\+::radio\+\_\+management\+\_\+plane}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138\ \{\ \textcolor{keywordflow}{return}\ set\_tx\_gain\_unprotected(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{port\_idx}},\ gain\_dB);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_abec06709e819a7c04e7f7aed5bb62bce}\label{classsrsran_1_1radio__session__uhd__impl_abec06709e819a7c04e7f7aed5bb62bce} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!start@{start}}
\index{start@{start}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{start()}{start()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} radio\+\_\+session\+\_\+uhd\+\_\+impl\+::start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}}}]{init\+\_\+time }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Starts the radio operation. 

It requests all radio streams to start simultaneously.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em init\+\_\+time} & Initial time in which streaming shall start. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Radio streams run until halted by a call of the \doxylink{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}{stop()} method. 

Calling \doxylink{classsrsran_1_1radio__session__uhd__impl_abec06709e819a7c04e7f7aed5bb62bce}{start()} more than once results in undefined behavior, even after calling \doxylink{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}{stop()}. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1radio__session_a793081cb27d4a66be880959af97fa9ea}{srsran\+::radio\+\_\+session}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00485\ \{}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{if}\ (!start\_rx\_stream(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{init\_time}}))\ \{}
\DoxyCodeLine{00487\ \ \ \ \ fmt::print(\textcolor{stringliteral}{"{}Failed\ to\ start\ Rx\ streams.\(\backslash\)n"{}});}
\DoxyCodeLine{00488\ \ \ \}}
\DoxyCodeLine{00489\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}\label{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448} 
\index{srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}!stop@{stop}}
\index{stop@{stop}!srsran::radio\_session\_uhd\_impl@{srsran::radio\_session\_uhd\_impl}}
\doxysubsubsection{\texorpdfstring{stop()}{stop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} radio\+\_\+session\+\_\+uhd\+\_\+impl\+::stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Stops the radio session operation. 

Any call to radio operation after calling \doxylink{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}{stop()} will return instantly without interacting with the physical radio.

\begin{DoxyRemark}{Remarks}
Calling \doxylink{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}{stop()} without having called \doxylink{classsrsran_1_1radio__session__uhd__impl_abec06709e819a7c04e7f7aed5bb62bce}{start()} results in undefined behavior. 

Calling \doxylink{classsrsran_1_1radio__session__uhd__impl_abec06709e819a7c04e7f7aed5bb62bce}{start()} after \doxylink{classsrsran_1_1radio__session__uhd__impl_a29ac3fe3d2fda51cc90d56d7bde80448}{stop()} results in undefined behavior. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1radio__session_aeb7baacf9aa88b71e9968d8e46d970c2}{srsran\+::radio\+\_\+session}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00463\ \{}
\DoxyCodeLine{00464\ \ \ \textcolor{comment}{//\ Transition\ state\ to\ stop.}}
\DoxyCodeLine{00465\ \ \ state\ =\ states::STOP;}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \textcolor{comment}{//\ Signal\ stop\ for\ each\ transmit\ stream.}}
\DoxyCodeLine{00468\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ gateway\ :\ bb\_gateways)\ \{}
\DoxyCodeLine{00469\ \ \ \ \ gateway-\/>get\_tx\_stream().stop();}
\DoxyCodeLine{00470\ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{comment}{//\ Signal\ stop\ for\ each\ receive\ stream.}}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ gateway\ :\ bb\_gateways)\ \{}
\DoxyCodeLine{00474\ \ \ \ \ gateway-\/>get\_rx\_stream().stop();}
\DoxyCodeLine{00475\ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \textcolor{comment}{//\ Wait\ for\ streams\ to\ join.}}
\DoxyCodeLine{00478\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ gateway\ :\ bb\_gateways)\ \{}
\DoxyCodeLine{00479\ \ \ \ \ gateway-\/>get\_tx\_stream().wait\_stop();}
\DoxyCodeLine{00480\ \ \ \ \ gateway-\/>get\_rx\_stream().wait\_stop();}
\DoxyCodeLine{00481\ \ \ \}}
\DoxyCodeLine{00482\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/radio/uhd/radio\+\_\+uhd\+\_\+impl.\+h\item 
lib/radio/uhd/radio\+\_\+uhd\+\_\+impl.\+cpp\end{DoxyCompactItemize}
