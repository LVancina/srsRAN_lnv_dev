\doxysection{srsran\+::backend\+\_\+pcap\+\_\+writer Class Reference}
\hypertarget{classsrsran_1_1backend__pcap__writer}{}\label{classsrsran_1_1backend__pcap__writer}\index{srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}}


This class provides a thread-\/safe interface to write to the pcap file, by only allowing accesses to the file via a single executor.  




{\ttfamily \#include $<$backend\+\_\+pcap\+\_\+writer.\+h$>$}



Collaboration diagram for srsran\+::backend\+\_\+pcap\+\_\+writer\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{d5/dc7/classsrsran_1_1backend__pcap__writer__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classsrsran_1_1backend__pcap__writer_a662157c4e6f4bd7cf8f9bc25e42a9ac6}\label{classsrsran_1_1backend__pcap__writer_a662157c4e6f4bd7cf8f9bc25e42a9ac6} 
{\bfseries backend\+\_\+pcap\+\_\+writer} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dlt\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::string \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{layer\+\_\+name\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::string \&filename, \mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{backend\+\_\+exec\+\_\+}})
\item 
\Hypertarget{classsrsran_1_1backend__pcap__writer_ab2cde813470d62ccb1fe822d36bc27e4}\label{classsrsran_1_1backend__pcap__writer_ab2cde813470d62ccb1fe822d36bc27e4} 
{\bfseries backend\+\_\+pcap\+\_\+writer} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1backend__pcap__writer}{backend\+\_\+pcap\+\_\+writer}} \&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}})=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\Hypertarget{classsrsran_1_1backend__pcap__writer_a0a4cff810dfd2b90e290e994b0d38d23}\label{classsrsran_1_1backend__pcap__writer_a0a4cff810dfd2b90e290e994b0d38d23} 
\mbox{\hyperlink{classsrsran_1_1backend__pcap__writer}{backend\+\_\+pcap\+\_\+writer}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1backend__pcap__writer}{backend\+\_\+pcap\+\_\+writer}} \&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}})=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\Hypertarget{classsrsran_1_1backend__pcap__writer_a1016fc73595b072f67082d9bcd0ec701}\label{classsrsran_1_1backend__pcap__writer_a1016fc73595b072f67082d9bcd0ec701} 
{\bfseries backend\+\_\+pcap\+\_\+writer} (\mbox{\hyperlink{classsrsran_1_1backend__pcap__writer}{backend\+\_\+pcap\+\_\+writer}} \&\&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}})=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\Hypertarget{classsrsran_1_1backend__pcap__writer_ad075a1fba08add2c7ace7b2089ff5383}\label{classsrsran_1_1backend__pcap__writer_ad075a1fba08add2c7ace7b2089ff5383} 
\mbox{\hyperlink{classsrsran_1_1backend__pcap__writer}{backend\+\_\+pcap\+\_\+writer}} \& {\bfseries operator=} (\mbox{\hyperlink{classsrsran_1_1backend__pcap__writer}{backend\+\_\+pcap\+\_\+writer}} \&\&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}})=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1backend__pcap__writer_a1d01ef367ee0162b389763b8c079a484}{close}} ()
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1backend__pcap__writer_a3585a817907dc7b8163d26f510e42d89}{is\+\_\+write\+\_\+enabled}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1backend__pcap__writer_a646267f22da21dfa805aca0fd9937660}{write\+\_\+pdu}} (\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} pdu)
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1backend__pcap__writer_aa1b4580b7542627e7847208a77dfcd83}{write\+\_\+pdu}} (\mbox{\hyperlink{classsrsran_1_1pcap__pdu__data}{pcap\+\_\+pdu\+\_\+data}} pdu)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This class provides a thread-\/safe interface to write to the pcap file, by only allowing accesses to the file via a single executor. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1backend__pcap__writer_af93c4b59a1a3b73b99936a46b93f26b7}\label{classsrsran_1_1backend__pcap__writer_af93c4b59a1a3b73b99936a46b93f26b7} 
\index{srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}!````~backend\_pcap\_writer@{\texorpdfstring{$\sim$}{\string~}backend\_pcap\_writer}}
\index{````~backend\_pcap\_writer@{\texorpdfstring{$\sim$}{\string~}backend\_pcap\_writer}!srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}backend\_pcap\_writer()}{\string~backend\_pcap\_writer()}}
{\footnotesize\ttfamily backend\+\_\+pcap\+\_\+writer\+::\texorpdfstring{$\sim$}{\string~}backend\+\_\+pcap\+\_\+writer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00069\ \{}
\DoxyCodeLine{00070\ \ \ close();}
\DoxyCodeLine{00071\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1backend__pcap__writer_a1d01ef367ee0162b389763b8c079a484}\label{classsrsran_1_1backend__pcap__writer_a1d01ef367ee0162b389763b8c079a484} 
\index{srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}!close@{close}}
\index{close@{close}!srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}}
\doxysubsubsection{\texorpdfstring{close()}{close()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} backend\+\_\+pcap\+\_\+writer\+::close (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00074\ \{}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prev\_value}}\ =\ is\_open.exchange(\textcolor{keyword}{false},\ std::memory\_order\_relaxed);}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prev\_value}})\ \{}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//\ It\ was\ already\ closed.}}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00079\ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ logger.debug(\textcolor{stringliteral}{"{}Scheduling\ the\ closing\ of\ the\ \(\backslash\)"{}\{\}\(\backslash\)"{}\ pcap\ writer"{}},\ layer\_name);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{//\ The\ pcap\ writing\ is\ still\ enabled.\ Dispatch\ closing\ of\ the\ pcap\ writer\ to\ backend\ executor.}}
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ Note:\ We\ block\ waiting\ until\ the\ pcap\ finishes\ closing.}}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{namespacesrsran_a7b1865b527be10b8c856e60871d2e2fe}{force\_blocking\_execute}}(}
\DoxyCodeLine{00086\ \ \ \ \ \ \ backend\_exec,}
\DoxyCodeLine{00087\ \ \ \ \ \ \ [\textcolor{keyword}{this}]()\ \{\ writer.close();\ \},}
\DoxyCodeLine{00088\ \ \ \ \ \ \ []()\ \{\ std::this\_thread::sleep\_for(std::chrono::milliseconds(100));\ \});}
\DoxyCodeLine{00089\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1backend__pcap__writer_a3585a817907dc7b8163d26f510e42d89}\label{classsrsran_1_1backend__pcap__writer_a3585a817907dc7b8163d26f510e42d89} 
\index{srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}!is\_write\_enabled@{is\_write\_enabled}}
\index{is\_write\_enabled@{is\_write\_enabled}!srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}}
\doxysubsubsection{\texorpdfstring{is\_write\_enabled()}{is\_write\_enabled()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::backend\+\_\+pcap\+\_\+writer\+::is\+\_\+write\+\_\+enabled (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00078\ \{\ \textcolor{keywordflow}{return}\ is\_open.load(std::memory\_order\_relaxed);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1backend__pcap__writer_a646267f22da21dfa805aca0fd9937660}\label{classsrsran_1_1backend__pcap__writer_a646267f22da21dfa805aca0fd9937660} 
\index{srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}!write\_pdu@{write\_pdu}}
\index{write\_pdu@{write\_pdu}!srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}}
\doxysubsubsection{\texorpdfstring{write\_pdu()}{write\_pdu()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} backend\+\_\+pcap\+\_\+writer\+::write\+\_\+pdu (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}}}]{pdu }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00092\ \{}
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{if}\ (pdu.\mbox{\hyperlink{classsrsran_1_1byte__buffer_a4d77b44f1d800f8b2f92bb76e80512f3}{empty}}())\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00095\ \ \ \}}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ is\_write\_enabled())\ \{}
\DoxyCodeLine{00097\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Dropped\ \{\}\ PCAP\ PDU.\ Cause:\ The\ pcap\ file\ is\ closed"{}},\ layer\_name);}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00099\ \ \ \}}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ backend\_exec.\mbox{\hyperlink{classsrsran_1_1task__executor_a296e1c4285dafdbfcbc912c3006690a4}{defer}}([\textcolor{keyword}{this},\ pdu\ =\ std::move(pdu)]()\ \{\ write\_pdu\_impl(pdu);\ \}))\ \{}
\DoxyCodeLine{00101\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Dropped\ \{\}\ PCAP\ PDU.\ Cause:\ Task\ executor\ queue\ is\ full"{}},\ layer\_name);}
\DoxyCodeLine{00102\ \ \ \}}
\DoxyCodeLine{00103\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1backend__pcap__writer_aa1b4580b7542627e7847208a77dfcd83}\label{classsrsran_1_1backend__pcap__writer_aa1b4580b7542627e7847208a77dfcd83} 
\index{srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}!write\_pdu@{write\_pdu}}
\index{write\_pdu@{write\_pdu}!srsran::backend\_pcap\_writer@{srsran::backend\_pcap\_writer}}
\doxysubsubsection{\texorpdfstring{write\_pdu()}{write\_pdu()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} backend\+\_\+pcap\+\_\+writer\+::write\+\_\+pdu (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1pcap__pdu__data}{pcap\+\_\+pdu\+\_\+data}}}]{pdu }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00106\ \{}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{if}\ (pdu.payload().\mbox{\hyperlink{classsrsran_1_1byte__buffer_a4d77b44f1d800f8b2f92bb76e80512f3}{empty}}())\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00109\ \ \ \}}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ is\_write\_enabled())\ \{}
\DoxyCodeLine{00111\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Dropped\ \{\}\ PCAP\ PDU.\ Cause:\ The\ pcap\ file\ is\ closed"{}},\ layer\_name);}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ backend\_exec.\mbox{\hyperlink{classsrsran_1_1task__executor_a296e1c4285dafdbfcbc912c3006690a4}{defer}}([\textcolor{keyword}{this},\ pdu\ =\ std::move(pdu)]()\ \{\ write\_context\_pdu\_impl(pdu);\ \}))\ \{}
\DoxyCodeLine{00115\ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Dropped\ \{\}\ PCAP\ PDU.\ Cause:\ Task\ executor\ queue\ is\ full"{}},\ layer\_name);}
\DoxyCodeLine{00116\ \ \ \}}
\DoxyCodeLine{00117\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/pcap/backend\+\_\+pcap\+\_\+writer.\+h\item 
lib/pcap/backend\+\_\+pcap\+\_\+writer.\+cpp\end{DoxyCompactItemize}
