\doxysection{srsran\+::dl\+\_\+harq\+\_\+process Class Reference}
\hypertarget{classsrsran_1_1dl__harq__process}{}\label{classsrsran_1_1dl__harq__process}\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}


Inheritance diagram for srsran\+::dl\+\_\+harq\+\_\+process\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d7/df4/classsrsran_1_1dl__harq__process__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::dl\+\_\+harq\+\_\+process\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/dd6/classsrsran_1_1dl__harq__process__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsrsran_1_1dl__harq__process_1_1alloc__params}{alloc\+\_\+params}}
\begin{DoxyCompactList}\small\item\em Parameters relative to the last used PDSCH PDU that get stored in the HARQ process for future reuse. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsrsran_1_1dl__harq__process_1_1dl__ack__info__result}{dl\+\_\+ack\+\_\+info\+\_\+result}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum class \mbox{\hyperlink{classsrsran_1_1dl__harq__process_ac54b21b50c80ee2addc6624668107cb1}{status\+\_\+update}} \{ {\bfseries acked}
, {\bfseries nacked}
, {\bfseries no\+\_\+update}
, {\bfseries error}
 \}
\begin{DoxyCompactList}\small\item\em Update to the HARQ process state after a HARQ-\/\+ACK is received. \end{DoxyCompactList}\item 
enum class \mbox{\hyperlink{classsrsran_1_1dl__harq__process_aff5dfd52e5f8f7eeeeb0c513f6f01a8d}{tb\+\_\+tx\+\_\+request}} \{ {\bfseries newtx}
, {\bfseries retx}
, {\bfseries disabled}
 \}
\begin{DoxyCompactList}\small\item\em Called on every new TB transmission/retransmission, when 2 TBs are used. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef}{empty}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Checks whether the HARQ process has no TBs currently active. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a7ccc8dee176194af632872aa2732dd07}{has\+\_\+pending\+\_\+retx}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Checks whether there is at least one TB with pending new\+\_\+retx. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a7c57e5628a3131cf3896b61696eb908b}{is\+\_\+waiting\+\_\+ack}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Checks whether the UL HARQ process is busy but waiting for an ACK. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__harq__process_1_1alloc__params}{alloc\+\_\+params}} \& \mbox{\hyperlink{classsrsran_1_1dl__harq__process_ad4d77ca89e13c47dfeb6fca29fbada75}{last\+\_\+alloc\+\_\+params}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Getter of the PDCCH/\+PDSCH parameters used in the last Tx. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a302fa3ad6546b57c27fd7fe91402d5e8}{new\+\_\+tx}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\+\_\+slot}}, \mbox{\hyperlink{classunsigned}{unsigned}} k1, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\+\_\+harq\+\_\+nof\+\_\+retxs}}, \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} harq\+\_\+bit\+\_\+idx, \mbox{\hyperlink{namespacesrsran_adaab0f63f541585966388e78a87120b4}{cqi\+\_\+value}} cqi, \mbox{\hyperlink{classunsigned}{unsigned}} nof\+\_\+layers)
\begin{DoxyCompactList}\small\item\em Called on every new TB transmission, when only one TB is active. It marks this HARQ process as busy and stores respective TB information. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_af84b7d7c563830eca885c16530c18c96}{new\+\_\+retx}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\+\_\+slot}}, \mbox{\hyperlink{classunsigned}{unsigned}} k1, \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} harq\+\_\+bit\+\_\+idx)
\begin{DoxyCompactList}\small\item\em Called on every TB retransmission, when only one TB is active. This function assumes that the HARQ TB is in pending new\+\_\+retx state. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_abe6e3c4c4a970459a49396642d1b52e7}{tx\+\_\+2\+\_\+tb}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\+\_\+slot}}, \mbox{\hyperlink{classunsigned}{unsigned}} k1, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_aff5dfd52e5f8f7eeeeb0c513f6f01a8d}{tb\+\_\+tx\+\_\+request}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\+\_\+tx\+\_\+req}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\+\_\+harq\+\_\+nof\+\_\+retxs}}, \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} harq\+\_\+bit\+\_\+idx)
\item 
\mbox{\hyperlink{classsrsran_1_1dl__harq__process_ac54b21b50c80ee2addc6624668107cb1}{status\+\_\+update}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_acea910a4a29c4e108e0fd97494022b80}{ack\+\_\+info}} (uint32\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\+\_\+idx}}, \mbox{\hyperlink{namespacesrsran_ad15571815e2fd31523e75ed1b2b5012a}{mac\+\_\+harq\+\_\+ack\+\_\+report\+\_\+status}} ack, \mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ \mbox{\hyperlink{classfloat}{float}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\+\_\+snr}})
\begin{DoxyCompactList}\small\item\em Updates the ACK state of the HARQ process. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_ad9c66e3c42b93dac12eaf59f9f6a86b6}{save\+\_\+alloc\+\_\+params}} (\mbox{\hyperlink{namespacesrsran_ac0a93d3e0aa8452e32308d5038bcad49}{dci\+\_\+dl\+\_\+rnti\+\_\+config\+\_\+type}} dci\+\_\+cfg\+\_\+type, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pdsch__information}{pdsch\+\_\+information}} \&pdsch)
\begin{DoxyCompactList}\small\item\em Stores grant parameters that are associated with the HARQ allocation (e.\+g. DCI format, PRBs, MCS) so that they can be later fetched and optionally reused. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a305bbec13917f962d566f49d21097333}{increment\+\_\+pucch\+\_\+counter}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process}{srsran\+::detail\+::harq\+\_\+process$<$ true $>$}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a32e89cddebce66f1314ae6ef5d2f86db}{harq\+\_\+process}} (\mbox{\hyperlink{namespacesrsran_a5afde872b5d597c47d3674cc7f86b19b}{harq\+\_\+id\+\_\+t}} h\+\_\+id, \mbox{\hyperlink{classsrsran_1_1harq__logger}{harq\+\_\+logger}} \&logger\+\_\+, \mbox{\hyperlink{classsrsran_1_1ue__harq__timeout__notifier}{ue\+\_\+harq\+\_\+timeout\+\_\+notifier}} timeout\+\_\+notif=\{\}, \mbox{\hyperlink{classunsigned}{unsigned}} max\+\_\+ack\+\_\+wait\+\_\+in\+\_\+slots\+\_\+=DEFAULT\+\_\+\+ACK\+\_\+\+TIMEOUT\+\_\+\+SLOTS)
\begin{DoxyCompactList}\small\item\em HARQ process constructor. \end{DoxyCompactList}\item 
void {\bfseries slot\+\_\+indication} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+tx)
\begin{DoxyCompactList}\small\item\em Indicate the beginning of a new slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} {\bfseries slot\+\_\+tx} () const
\begin{DoxyCompactList}\small\item\em Last slot when a SCH grant was scheduled for this HARQ process. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} {\bfseries slot\+\_\+ack} () const
\begin{DoxyCompactList}\small\item\em Slot when the last SCH grant of this HARQ process is supposed to be ACKed. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} {\bfseries empty} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx) const
\begin{DoxyCompactList}\small\item\em Checks whether a specified TB is empty. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} {\bfseries has\+\_\+pending\+\_\+retx} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx) const
\begin{DoxyCompactList}\small\item\em Checks whether specified TB has pending new\+\_\+retx. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} {\bfseries is\+\_\+waiting\+\_\+ack} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx) const
\begin{DoxyCompactList}\small\item\em Checks whether specified TB is expecting an ACK. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} {\bfseries max\+\_\+nof\+\_\+harq\+\_\+retxs} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx) const
\item 
const transport\+\_\+block \& {\bfseries tb} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx) const
\begin{DoxyCompactList}\small\item\em Getter for TB parameters. \end{DoxyCompactList}\item 
void {\bfseries reset} ()
\begin{DoxyCompactList}\small\item\em Resets HARQ process state. \end{DoxyCompactList}\item 
void {\bfseries cancel\+\_\+harq\+\_\+retxs} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx)
\begin{DoxyCompactList}\small\item\em Cancels the HARQ process by stopping retransmissions of the currently held TB. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} {\bfseries get\+\_\+slot\+\_\+ack\+\_\+timeout} () const
\begin{DoxyCompactList}\small\item\em Getter of the slot when the HARQ process will assume that the ACK/\+CRC went missing. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Public Attributes inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process}{srsran\+::detail\+::harq\+\_\+process$<$ true $>$}}}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{namespacesrsran_a5afde872b5d597c47d3674cc7f86b19b}{harq\+\_\+id\+\_\+t}} {\bfseries id}
\begin{DoxyCompactList}\small\item\em HARQ process id. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process}{srsran\+::detail\+::harq\+\_\+process$<$ true $>$}}}
\begin{DoxyCompactItemize}
\item 
static constexpr \mbox{\hyperlink{classunsigned}{unsigned}} {\bfseries DEFAULT\+\_\+\+ACK\+\_\+\+TIMEOUT\+\_\+\+SLOTS}
\begin{DoxyCompactList}\small\item\em Default timeout in slots after which the HARQ process assumes that the CRC/\+ACK went missing (implementation-\/defined). \end{DoxyCompactList}\item 
static constexpr \mbox{\hyperlink{classunsigned}{unsigned}} {\bfseries SHORT\+\_\+\+ACK\+\_\+\+TIMEOUT\+\_\+\+DTX}
\item 
static constexpr size\+\_\+t {\bfseries MAX\+\_\+\+NOF\+\_\+\+TBS}
\begin{DoxyCompactList}\small\item\em Maximum number of Transport Blocks as per TS38.\+321, 5.\+3.\+2.\+1 and 5.\+4.\+2.\+1. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process}{srsran\+::detail\+::harq\+\_\+process$<$ true $>$}}}
\begin{DoxyCompactItemize}
\item 
void {\bfseries tx\+\_\+common} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+tx, \mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+ack)
\item 
void {\bfseries new\+\_\+tx\+\_\+tb\+\_\+common} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx, \mbox{\hyperlink{classunsigned}{unsigned}} max\+\_\+nof\+\_\+harq\+\_\+retxs, \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} harq\+\_\+bit\+\_\+idx)
\item 
void {\bfseries new\+\_\+retx\+\_\+tb\+\_\+common} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx, \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} harq\+\_\+bit\+\_\+idx)
\item 
\mbox{\hyperlink{classbool}{bool}} {\bfseries ack\+\_\+info\+\_\+common} (uint32\+\_\+t tb\+\_\+idx, \mbox{\hyperlink{classbool}{bool}} ack)
\begin{DoxyCompactList}\small\item\em Updates the ACK state of the TB of the HARQ process. \end{DoxyCompactList}\item 
void {\bfseries reset\+\_\+tb} (\mbox{\hyperlink{classunsigned}{unsigned}} tb\+\_\+idx)
\begin{DoxyCompactList}\small\item\em Clear the contents of a specific TB of this HARQ process and resets it back to empty state. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process}{srsran\+::detail\+::harq\+\_\+process$<$ true $>$}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1harq__logger}{harq\+\_\+logger}} \& {\bfseries logger}
\begin{DoxyCompactList}\small\item\em HARQ entity logger used by this HARQ process. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1ue__harq__timeout__notifier}{ue\+\_\+harq\+\_\+timeout\+\_\+notifier}} {\bfseries timeout\+\_\+notifier}
\begin{DoxyCompactList}\small\item\em Notifier used by this HARQ process when there is a timeout. \end{DoxyCompactList}\item 
const \mbox{\hyperlink{classunsigned}{unsigned}} {\bfseries max\+\_\+ack\+\_\+wait\+\_\+in\+\_\+slots}
\begin{DoxyCompactList}\small\item\em Maximum value of time interval, in slots, before the HARQ process assumes that the ACK/\+CRC went missing. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} {\bfseries last\+\_\+slot\+\_\+ind}
\begin{DoxyCompactList}\small\item\em Last slot indication. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a07dfe837dcacf644ac6f88837defc04f}{last\+\_\+slot\+\_\+tx}}
\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_afa6c1b681769339446023fd322ecbde8}{last\+\_\+slot\+\_\+ack}}
\item 
\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} {\bfseries slot\+\_\+ack\+\_\+timeout}
\begin{DoxyCompactList}\small\item\em Slot when the HARQ process will assume that the ACK/\+CRC went missing. \end{DoxyCompactList}\item 
std\+::array$<$ transport\+\_\+block, MAX\+\_\+\+NOF\+\_\+\+TBS $>$ {\bfseries tb\+\_\+array}
\end{DoxyCompactItemize}


\doxysubsection{Member Enumeration Documentation}
\Hypertarget{classsrsran_1_1dl__harq__process_ac54b21b50c80ee2addc6624668107cb1}\label{classsrsran_1_1dl__harq__process_ac54b21b50c80ee2addc6624668107cb1} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!status\_update@{status\_update}}
\index{status\_update@{status\_update}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{status\_update}{status\_update}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{enum}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{class}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_ac54b21b50c80ee2addc6624668107cb1}{srsran\+::dl\+\_\+harq\+\_\+process\+::status\+\_\+update}}\hspace{0.3cm}{\ttfamily [strong]}}



Update to the HARQ process state after a HARQ-\/\+ACK is received. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00267\ \{\ acked,\ nacked,\ no\_update,\ error\ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_aff5dfd52e5f8f7eeeeb0c513f6f01a8d}\label{classsrsran_1_1dl__harq__process_aff5dfd52e5f8f7eeeeb0c513f6f01a8d} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!tb\_tx\_request@{tb\_tx\_request}}
\index{tb\_tx\_request@{tb\_tx\_request}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{tb\_tx\_request}{tb\_tx\_request}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{enum}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{class}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_aff5dfd52e5f8f7eeeeb0c513f6f01a8d}{srsran\+::dl\+\_\+harq\+\_\+process\+::tb\+\_\+tx\+\_\+request}}\hspace{0.3cm}{\ttfamily [strong]}}



Called on every new TB transmission/retransmission, when 2 TBs are used. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00331\ \{\ newtx,\ retx,\ disabled\ \};}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1dl__harq__process_acea910a4a29c4e108e0fd97494022b80}\label{classsrsran_1_1dl__harq__process_acea910a4a29c4e108e0fd97494022b80} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!ack\_info@{ack\_info}}
\index{ack\_info@{ack\_info}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{ack\_info()}{ack\_info()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1dl__harq__process_ac54b21b50c80ee2addc6624668107cb1}{dl\+\_\+harq\+\_\+process\+::status\+\_\+update}} dl\+\_\+harq\+\_\+process\+::ack\+\_\+info (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{tb\+\_\+idx,  }\item[{\mbox{\hyperlink{namespacesrsran_ad15571815e2fd31523e75ed1b2b5012a}{mac\+\_\+harq\+\_\+ack\+\_\+report\+\_\+status}}}]{ack,  }\item[{\mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ \mbox{\hyperlink{classfloat}{float}} $>$}]{pucch\+\_\+snr }\end{DoxyParamCaption})}



Updates the ACK state of the HARQ process. 

\begin{DoxyReturn}{Returns}
The result of a HARQ receiving an HARQ-\/\+ACK bit. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00247\ \{}
\DoxyCodeLine{00248\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a7c57e5628a3131cf3896b61696eb908b}{is\_waiting\_ack}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}))\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{comment}{//\ If\ the\ HARQ\ process\ is\ not\ expected\ an\ HARQ-\/ACK\ anymore,\ it\ means\ that\ it\ has\ already\ been\ ACKed/NACKed.}}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keywordflow}{return}\ status\_update::error;}
\DoxyCodeLine{00251\ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \textcolor{keywordflow}{if}\ (ack\ !=\ mac\_harq\_ack\_report\_status::dtx\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ last\_pucch\_snr.\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_snr}}.has\_value()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ last\_pucch\_snr.value()\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_snr}}.value())))\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{comment}{//\ Case:\ If\ there\ was\ no\ previous\ HARQ-\/ACK\ decoded\ or\ the\ previous\ HARQ-\/ACK\ had\ lower\ SNR,\ this\ HARQ-\/ACK\ is\ chosen.}}
\DoxyCodeLine{00256\ \ \ \ \ chosen\_ack\ \ \ \ \ =\ ack;}
\DoxyCodeLine{00257\ \ \ \ \ last\_pucch\_snr\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_snr}};}
\DoxyCodeLine{00258\ \ \ \}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \textcolor{keywordflow}{if}\ (pucch\_ack\_to\_receive\ <=\ 1)\ \{}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{comment}{//\ Case:\ This\ is\ the\ last\ HARQ-\/ACK\ that\ is\ expected\ for\ this\ HARQ\ process.}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a5ce6a0d9d0f9beb8f6ab3110754aa4f2}{base\_type::ack\_info\_common}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}},\ chosen\_ack\ ==\ mac\_harq\_ack\_report\_status::ack);}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keywordflow}{if}\ (chosen\_ack\ !=\ mac\_harq\_ack\_report\_status::ack\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef}{empty}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}))\ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_ad7e0f4d9da7d133212dda53c348404fb}{logger}}.info(\textcolor{keywordtype}{id},}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Discarding\ HARQ\ process\ tb=\{\}\ with\ tbs=\{\}.\ Cause:\ Maximum\ number\ of\ reTxs\ \{\}\ exceeded"{}},}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}},}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>tbs\_bytes,}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_nof\_harq\_retxs(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}));}
\DoxyCodeLine{00270\ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{return}\ chosen\_ack\ ==\ mac\_harq\_ack\_report\_status::ack\ ?\ status\_update::acked\ :\ status\_update::nacked;}
\DoxyCodeLine{00272\ \ \ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ Case:\ This\ is\ not\ the\ last\ PUCCH\ HARQ-\/ACK\ that\ is\ expected\ for\ this\ HARQ\ process.}}
\DoxyCodeLine{00275\ \ \ pucch\_ack\_to\_receive-\/-\/;}
\DoxyCodeLine{00276\ \ \ tb\_array[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}].ack\_on\_timeout\ =\ chosen\_ack\ ==\ mac\_harq\_ack\_report\_status::ack;}
\DoxyCodeLine{00277\ \ \ \textcolor{comment}{//\ We\ reduce\ the\ HARQ\ process\ timeout\ to\ receive\ the\ next\ HARQ-\/ACK.\ This\ is\ done\ because\ the\ two\ HARQ-\/ACKs\ should}}
\DoxyCodeLine{00278\ \ \ \textcolor{comment}{//\ arrive\ almost\ simultaneously,\ and\ we\ in\ case\ the\ second\ goes\ missing,\ we\ don't\ want\ to\ block\ the\ HARQ\ for\ too\ long.}}
\DoxyCodeLine{00279\ \ \ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_adb49d584080fc9bfbe52271d4043c1ad}{slot\_ack\_timeout}}\ =\ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a5f6845494254d1a9e47cf75632e58223}{last\_slot\_ind}}\ +\ SHORT\_ACK\_TIMEOUT\_DTX;}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \textcolor{keywordflow}{return}\ status\_update::no\_update;}
\DoxyCodeLine{00282\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef}\label{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!empty@{empty}}
\index{empty@{empty}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{empty()}{empty()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::dl\+\_\+harq\+\_\+process\+::empty (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Checks whether the HARQ process has no TBs currently active. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00306\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a7bacbfff919533bb0e77bac0b634b573}{base\_type::empty}}(0)\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ base\_type::\mbox{\hyperlink{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef}{empty}}(1);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_a7ccc8dee176194af632872aa2732dd07}\label{classsrsran_1_1dl__harq__process_a7ccc8dee176194af632872aa2732dd07} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!has\_pending\_retx@{has\_pending\_retx}}
\index{has\_pending\_retx@{has\_pending\_retx}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{has\_pending\_retx()}{has\_pending\_retx()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::dl\+\_\+harq\+\_\+process\+::has\+\_\+pending\+\_\+retx (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Checks whether there is at least one TB with pending new\+\_\+retx. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00309\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a9cb73980ed9d17579518de736c86210d}{base\_type::has\_pending\_retx}}(0)\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ base\_type::\mbox{\hyperlink{classsrsran_1_1dl__harq__process_a7ccc8dee176194af632872aa2732dd07}{has\_pending\_retx}}(1);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_a305bbec13917f962d566f49d21097333}\label{classsrsran_1_1dl__harq__process_a305bbec13917f962d566f49d21097333} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!increment\_pucch\_counter@{increment\_pucch\_counter}}
\index{increment\_pucch\_counter@{increment\_pucch\_counter}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{increment\_pucch\_counter()}{increment\_pucch\_counter()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} dl\+\_\+harq\+\_\+process\+::increment\+\_\+pucch\+\_\+counter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00310\ \{}
\DoxyCodeLine{00311\ \ \ ++pucch\_ack\_to\_receive;}
\DoxyCodeLine{00312\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_a7c57e5628a3131cf3896b61696eb908b}\label{classsrsran_1_1dl__harq__process_a7c57e5628a3131cf3896b61696eb908b} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!is\_waiting\_ack@{is\_waiting\_ack}}
\index{is\_waiting\_ack@{is\_waiting\_ack}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{is\_waiting\_ack()}{is\_waiting\_ack()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::dl\+\_\+harq\+\_\+process\+::is\+\_\+waiting\+\_\+ack (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Checks whether the UL HARQ process is busy but waiting for an ACK. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00312\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_a22fe37de33da5a82210f32c40e44f51b}{base\_type::is\_waiting\_ack}}(0)\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ base\_type::\mbox{\hyperlink{classsrsran_1_1dl__harq__process_a7c57e5628a3131cf3896b61696eb908b}{is\_waiting\_ack}}(1);\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_ad4d77ca89e13c47dfeb6fca29fbada75}\label{classsrsran_1_1dl__harq__process_ad4d77ca89e13c47dfeb6fca29fbada75} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!last\_alloc\_params@{last\_alloc\_params}}
\index{last\_alloc\_params@{last\_alloc\_params}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{last\_alloc\_params()}{last\_alloc\_params()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__harq__process_1_1alloc__params}{alloc\+\_\+params}} \& srsran\+::dl\+\_\+harq\+\_\+process\+::last\+\_\+alloc\+\_\+params (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Getter of the PDCCH/\+PDSCH parameters used in the last Tx. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00315\ \{\ \textcolor{keywordflow}{return}\ prev\_tx\_params;\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_af84b7d7c563830eca885c16530c18c96}\label{classsrsran_1_1dl__harq__process_af84b7d7c563830eca885c16530c18c96} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!new\_retx@{new\_retx}}
\index{new\_retx@{new\_retx}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{new\_retx()}{new\_retx()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} dl\+\_\+harq\+\_\+process\+::new\+\_\+retx (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{pdsch\+\_\+slot,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{k1,  }\item[{\mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}}}]{harq\+\_\+bit\+\_\+idx }\end{DoxyParamCaption})}



Called on every TB retransmission, when only one TB is active. This function assumes that the HARQ TB is in pending new\+\_\+retx state. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00214\ \{}
\DoxyCodeLine{00215\ \ \ base\_type::tx\_common(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\_slot}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\_slot}}\ +\ k1);}
\DoxyCodeLine{00216\ \ \ base\_type::new\_retx\_tb\_common(0,\ harq\_bit\_idx);}
\DoxyCodeLine{00217\ \ \ pucch\_ack\_to\_receive\ =\ 0;}
\DoxyCodeLine{00218\ \ \ chosen\_ack\ \ \ \ \ \ \ \ \ \ \ =\ mac\_harq\_ack\_report\_status::dtx;}
\DoxyCodeLine{00219\ \ \ last\_pucch\_snr\ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a2e817fa4d4a8084eb1746ee8d1440679}{nullopt}};}
\DoxyCodeLine{00220\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_a302fa3ad6546b57c27fd7fe91402d5e8}\label{classsrsran_1_1dl__harq__process_a302fa3ad6546b57c27fd7fe91402d5e8} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!new\_tx@{new\_tx}}
\index{new\_tx@{new\_tx}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{new\_tx()}{new\_tx()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} dl\+\_\+harq\+\_\+process\+::new\+\_\+tx (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{pdsch\+\_\+slot,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{k1,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{max\+\_\+harq\+\_\+nof\+\_\+retxs,  }\item[{\mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}}}]{harq\+\_\+bit\+\_\+idx,  }\item[{\mbox{\hyperlink{namespacesrsran_adaab0f63f541585966388e78a87120b4}{cqi\+\_\+value}}}]{cqi,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{nof\+\_\+layers }\end{DoxyParamCaption})}



Called on every new TB transmission, when only one TB is active. It marks this HARQ process as busy and stores respective TB information. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00200\ \{}
\DoxyCodeLine{00201\ \ \ base\_type::tx\_common(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\_slot}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\_slot}}\ +\ k1);}
\DoxyCodeLine{00202\ \ \ base\_type::new\_tx\_tb\_common(0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_harq\_nof\_retxs}},\ harq\_bit\_idx);}
\DoxyCodeLine{00203\ \ \ prev\_tx\_params\ \ \ \ \ \ \ \ \ \ \ \ =\ \{\};}
\DoxyCodeLine{00204\ \ \ prev\_tx\_params.cqi\ \ \ \ \ \ \ \ =\ cqi;}
\DoxyCodeLine{00205\ \ \ prev\_tx\_params.nof\_layers\ =\ nof\_layers;}
\DoxyCodeLine{00206\ \ \ prev\_tx\_params.tb[0].emplace();}
\DoxyCodeLine{00207\ \ \ prev\_tx\_params.tb[1].reset();}
\DoxyCodeLine{00208\ \ \ pucch\_ack\_to\_receive\ =\ 0;}
\DoxyCodeLine{00209\ \ \ chosen\_ack\ \ \ \ \ \ \ \ \ \ \ =\ mac\_harq\_ack\_report\_status::dtx;}
\DoxyCodeLine{00210\ \ \ last\_pucch\_snr\ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a2e817fa4d4a8084eb1746ee8d1440679}{nullopt}};}
\DoxyCodeLine{00211\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_ad9c66e3c42b93dac12eaf59f9f6a86b6}\label{classsrsran_1_1dl__harq__process_ad9c66e3c42b93dac12eaf59f9f6a86b6} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!save\_alloc\_params@{save\_alloc\_params}}
\index{save\_alloc\_params@{save\_alloc\_params}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{save\_alloc\_params()}{save\_alloc\_params()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} dl\+\_\+harq\+\_\+process\+::save\+\_\+alloc\+\_\+params (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_ac0a93d3e0aa8452e32308d5038bcad49}{dci\+\_\+dl\+\_\+rnti\+\_\+config\+\_\+type}}}]{dci\+\_\+cfg\+\_\+type,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pdsch__information}{pdsch\+\_\+information}} \&}]{pdsch }\end{DoxyParamCaption})}



Stores grant parameters that are associated with the HARQ allocation (e.\+g. DCI format, PRBs, MCS) so that they can be later fetched and optionally reused. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00285\ \{}
\DoxyCodeLine{00286\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}\ =\ \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef}{empty}}(0)\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1pdsch__codeword}{pdsch\_codeword}}\&\ cw\ :\ pdsch.codewords)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{classsrsran_1_1dl__harq__process_a84adccf19cb19a9a41622c6b6c7761ef}{empty}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}),\ \textcolor{stringliteral}{"{}Setting\ allocation\ parameters\ for\ empty\ DL\ HARQ\ process\ id=\{\}\ TB"{}},\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00289\ \ \ \ \ srsran\_assert(\mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_ab9e3038edccbdcf995a2e202286c2b0e}{tb}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}).nof\_retxs\ ==\ 0\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ dci\_cfg\_type\ ==\ prev\_tx\_params.dci\_cfg\_type,}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}DCI\ format\ and\ RNTI\ type\ cannot\ change\ during\ DL\ HARQ\ retxs"{}});}
\DoxyCodeLine{00291\ \ \ \ \ srsran\_assert(\mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_ab9e3038edccbdcf995a2e202286c2b0e}{tb}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}).nof\_retxs\ ==\ 0\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>tbs\_bytes\ ==\ cw.tb\_size\_bytes,}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}TBS\ cannot\ change\ during\ DL\ HARQ\ retxs\ (\{\}!=\{\}).\ Previous\ MCS=\{\},\ RBs=\{\}.\ New\ MCS=\{\},\ RBs=\{\}"{}},}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>tbs\_bytes,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cw.tb\_size\_bytes,}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>mcs,}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_tx\_params.rbs,}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cw.mcs\_index,}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pdsch.rbs);}
\DoxyCodeLine{00299\ \ \ \ \ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>mcs\_table\ =\ cw.mcs\_table;}
\DoxyCodeLine{00300\ \ \ \ \ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>mcs\ \ \ \ \ \ \ =\ cw.mcs\_index;}
\DoxyCodeLine{00301\ \ \ \ \ prev\_tx\_params.tb[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}}]-\/>tbs\_bytes\ =\ cw.tb\_size\_bytes;}
\DoxyCodeLine{00302\ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_idx}};}
\DoxyCodeLine{00303\ \ \ \}}
\DoxyCodeLine{00304\ \ \ prev\_tx\_params.dci\_cfg\_type\ =\ dci\_cfg\_type;}
\DoxyCodeLine{00305\ \ \ prev\_tx\_params.rbs\ \ \ \ \ \ \ \ \ \ =\ pdsch.rbs;}
\DoxyCodeLine{00306\ \ \ prev\_tx\_params.nof\_symbols\ \ =\ pdsch.symbols.\mbox{\hyperlink{classsrsran_1_1interval_ac47a815285449ead553a43a0b5f85f63}{length}}();}
\DoxyCodeLine{00307\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1dl__harq__process_abe6e3c4c4a970459a49396642d1b52e7}\label{classsrsran_1_1dl__harq__process_abe6e3c4c4a970459a49396642d1b52e7} 
\index{srsran::dl\_harq\_process@{srsran::dl\_harq\_process}!tx\_2\_tb@{tx\_2\_tb}}
\index{tx\_2\_tb@{tx\_2\_tb}!srsran::dl\_harq\_process@{srsran::dl\_harq\_process}}
\doxysubsubsection{\texorpdfstring{tx\_2\_tb()}{tx\_2\_tb()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} dl\+\_\+harq\+\_\+process\+::tx\+\_\+2\+\_\+tb (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{pdsch\+\_\+slot,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{k1,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1dl__harq__process_aff5dfd52e5f8f7eeeeb0c513f6f01a8d}{tb\+\_\+tx\+\_\+request}} $>$}]{tb\+\_\+tx\+\_\+req,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{max\+\_\+harq\+\_\+nof\+\_\+retxs,  }\item[{\mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}}}]{harq\+\_\+bit\+\_\+idx }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00227\ \{}
\DoxyCodeLine{00228\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_tx\_req}}.size()\ ==\ 2,\ \textcolor{stringliteral}{"{}This\ function\ should\ only\ be\ called\ when\ 2\ TBs\ are\ active"{}});}
\DoxyCodeLine{00229\ \ \ srsran\_assert(}
\DoxyCodeLine{00230\ \ \ \ \ \ \ std::any\_of(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_tx\_req}}.begin(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_tx\_req}}.end(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{classsrsran_1_1detail_1_1harq__process_ab9e3038edccbdcf995a2e202286c2b0e}{tb}})\ \{\ return\ tb\ !=\ tb\_tx\_request::disabled;\ \}),}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}At\ least\ one\ TB\ must\ be\ enabled\ in\ a\ HARQ\ allocation"{}});}
\DoxyCodeLine{00232\ \ \ base\_type::tx\_common(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\_slot}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdsch\_slot}}\ +\ k1);}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_tx\_req}}.size();\ ++i)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_tx\_req}}[i]\ ==\ tb\_tx\_request::newtx)\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ base\_type::new\_tx\_tb\_common(i,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_harq\_nof\_retxs}},\ harq\_bit\_idx);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ prev\_tx\_params.tb[i].emplace();}
\DoxyCodeLine{00237\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tb\_tx\_req}}[i]\ ==\ tb\_tx\_request::retx)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ base\_type::new\_retx\_tb\_common(i,\ harq\_bit\_idx);}
\DoxyCodeLine{00239\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ prev\_tx\_params.tb[i].reset();}
\DoxyCodeLine{00241\ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \}}
\DoxyCodeLine{00243\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/ue\+\_\+scheduling/harq\+\_\+process.\+h\item 
lib/scheduler/ue\+\_\+scheduling/harq\+\_\+process.\+cpp\end{DoxyCompactItemize}
