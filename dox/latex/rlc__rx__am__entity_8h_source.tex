\doxysection{rlc\+\_\+rx\+\_\+am\+\_\+entity.\+h}
\hypertarget{rlc__rx__am__entity_8h_source}{}\label{rlc__rx__am__entity_8h_source}\index{lib/rlc/rlc\_rx\_am\_entity.h@{lib/rlc/rlc\_rx\_am\_entity.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ 2021-\/2024\ Software\ Radio\ Systems\ Limited}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ This\ file\ is\ part\ of\ srsRAN.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ srsRAN\ is\ free\ software:\ you\ can\ redistribute\ it\ and/or\ modify}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ it\ under\ the\ terms\ of\ the\ GNU\ Affero\ General\ Public\ License\ as}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ published\ by\ the\ Free\ Software\ Foundation,\ either\ version\ 3\ of}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ the\ License,\ or\ (at\ your\ option)\ any\ later\ version.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ srsRAN\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ GNU\ Affero\ General\ Public\ License\ for\ more\ details.}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ A\ copy\ of\ the\ GNU\ Affero\ General\ Public\ License\ can\ be\ found\ in}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ the\ LICENSE\ file\ in\ the\ top-\/level\ directory\ of\ this\ distribution}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ and\ at\ http://www.gnu.org/licenses/.}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}rlc\_am\_interconnect.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}rlc\_am\_pdu.h"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}rlc\_rx\_entity.h"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}srsran/support/executors/task\_executor.h"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}srsran/support/sdu\_window.h"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}srsran/support/timers.h"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}fmt/format.h"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ <set>}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesrsran}{srsran}}\ \{}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment}{rlc\_rx\_am\_sdu\_segment}}\ \{}
\DoxyCodeLine{00038\ \ \ \mbox{\hyperlink{namespacesrsran_a325c27da08346f5cd691cc27c8149798}{rlc\_si\_field}}\ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment_a2a8f7776bd8ac940d7a787c1ca7bf8e2}{si}};\ \ \ \ \ \ }
\DoxyCodeLine{00039\ \ \ uint16\_t\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment_a537a250025f0f33b6a3061bcca038948}{so}};\ \ \ \ \ \ }
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer__slice}{byte\_buffer\_slice}}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment_ab4580e4835647702cd722a2ce7c25a95}{payload}};\ }
\DoxyCodeLine{00041\ \};}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment__cmp}{rlc\_rx\_am\_sdu\_segment\_cmp}}\ \{}
\DoxyCodeLine{00045\ \ \ \textcolor{keywordtype}{bool}\ operator()(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment}{rlc\_rx\_am\_sdu\_segment}}\&\ a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment}{rlc\_rx\_am\_sdu\_segment}}\&\ b)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ a.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment_a537a250025f0f33b6a3061bcca038948}{so}}\ <\ b.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment_a537a250025f0f33b6a3061bcca038948}{so}};\ \}}
\DoxyCodeLine{00046\ \};}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__info}{rlc\_rx\_am\_sdu\_info}}\ \{}
\DoxyCodeLine{00050\ \ \ \textcolor{comment}{//\ TODO:\ Refactor\ this\ struct.}}
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{//\ Move\ the\ following\ rlc\_rx\_am\ methods\ here:}}
\DoxyCodeLine{00052\ \ \ \textcolor{comment}{//\ -\/\ add\ segments\ without\ duplicates}}
\DoxyCodeLine{00053\ \ \ \textcolor{comment}{//\ -\/\ assemble\ SDU}}
\DoxyCodeLine{00054\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fully\_received\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_gap\ \ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ std::set<rlc\_rx\_am\_sdu\_segment,\ rlc\_rx\_am\_sdu\_segment\_cmp>\ segments;\ \textcolor{comment}{//\ Set\ of\ segments\ with\ SO\ as\ key}}
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer__chain}{byte\_buffer\_chain}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sdu\ =\ \{\};}
\DoxyCodeLine{00058\ \};}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00062\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state}{rlc\_rx\_am\_state}}\ \{}
\DoxyCodeLine{00067\ \ \ uint32\_t\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_a5f38fb1ce910683b80b0f4152366860d}{rx\_next}}\ =\ 0;}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00071\ \ \ uint32\_t\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_a0d31d8c83910799533270ab0fc55728b}{rx\_next\_status\_trigger}}\ =\ 0;}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00076\ \ \ uint32\_t\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_ae3c1a73acad8bea3a9c90863e7b56a39}{rx\_highest\_status}}\ =\ 0;}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00081\ \ \ uint32\_t\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_aa791211a124cb176410289c9994dd851}{rx\_next\_highest}}\ =\ 0;}
\DoxyCodeLine{00082\ \};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity}{rlc\_rx\_am\_entity}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__entity}{rlc\_rx\_entity}},\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__status__provider}{rlc\_rx\_am\_status\_provider}}}
\DoxyCodeLine{00085\ \{}
\DoxyCodeLine{00086\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00088\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__config}{rlc\_rx\_am\_config}}\ cfg;}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state}{rlc\_rx\_am\_state}}\ st;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00094\ \ \ uint32\_t\ max\_nof\_sn\_per\_status\_report;\ \textcolor{comment}{//\ keep\ this\ attribute\ close\ to\ st\ (cache)}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__tx__am__status__handler}{rlc\_tx\_am\_status\_handler}}*\ status\_handler\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__tx__am__status__notifier}{rlc\_tx\_am\_status\_notifier}}*\ status\_notifier\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00101\ \ \ std::atomic<bool>\ do\_status\ =\ \{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00104\ \ \ \textcolor{keyword}{const}\ uint32\_t\ mod;}
\DoxyCodeLine{00106\ \ \ \textcolor{keyword}{const}\ uint32\_t\ am\_window\_size;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00109\ \ \ std::unique\_ptr<sdu\_window<rlc\_rx\_am\_sdu\_info>>\ rx\_window;}
\DoxyCodeLine{00111\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ rx\_window\_not\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ rx\_window\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00116\ \ \ std::array<rlc\_am\_status\_pdu,\ 3>\ status\_buf;}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00119\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__am__status__pdu}{rlc\_am\_status\_pdu}}*\ status\_builder\ =\ \&status\_buf[0];}
\DoxyCodeLine{00121\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__am__status__pdu}{rlc\_am\_status\_pdu}}*\ status\_cached\ =\ \&status\_buf[1];}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__am__status__pdu}{rlc\_am\_status\_pdu}}*\ status\_shared\ =\ \&status\_buf[2];}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00126\ \ \ std::atomic<uint32\_t>\ status\_report\_size;}
\DoxyCodeLine{00127\ \ \ std::atomic<bool>\ \ \ \ \ status\_prohibit\_timer\_is\_running\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00130\ \ \ std::mutex\ status\_report\_mutex;}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00136\ \ \ \mbox{\hyperlink{classsrsran_1_1unique__timer}{unique\_timer}}\ status\_prohibit\_timer;}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{classsrsran_1_1unique__timer}{unique\_timer}}\ reassembly\_timer;}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \mbox{\hyperlink{classsrsran_1_1task__executor}{task\_executor}}\&\ ue\_executor;}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \mbox{\hyperlink{structsrsran_1_1pcap__rlc__pdu__context}{pcap\_rlc\_pdu\_context}}\ pcap\_context;}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00150\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity}{rlc\_rx\_am\_entity}}(uint32\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ du\_index\_,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\_ue\_index\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_index,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1rb__id__t}{rb\_id\_t}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rb\_id,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__config}{rlc\_rx\_am\_config}}\&\ \ \ \ \ \ \ \ \ \ \ config,}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__rx__upper__layer__data__notifier}{rlc\_rx\_upper\_layer\_data\_notifier}}\&\ upper\_dn\_,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1timer__factory}{timer\_factory}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ timers,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1task__executor}{task\_executor}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_executor,}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ metrics\_enabled,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__pcap}{rlc\_pcap}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pcap\_);}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \textcolor{comment}{//\ Rx/Tx\ interconnect}}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordtype}{void}\ set\_status\_handler(\mbox{\hyperlink{classsrsran_1_1rlc__tx__am__status__handler}{rlc\_tx\_am\_status\_handler}}*\ status\_handler\_)\ \{\ status\_handler\ =\ status\_handler\_;\ \}}
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{void}\ set\_status\_notifier(\mbox{\hyperlink{classsrsran_1_1rlc__tx__am__status__notifier}{rlc\_tx\_am\_status\_notifier}}*\ status\_notifier\_)\ \{\ status\_notifier\ =\ status\_notifier\_;\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \textcolor{comment}{//\ Interfaces\ for\ lower\ layers}}
\DoxyCodeLine{00165\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_a99c640c41aa46f6710d0607b0a1fcbcc}{handle\_pdu}}(\mbox{\hyperlink{classsrsran_1_1byte__buffer__slice}{byte\_buffer\_slice}}\ buf)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \textcolor{comment}{//\ Status\ provider\ for\ Tx\ entity}}
\DoxyCodeLine{00168\ \ \ \mbox{\hyperlink{classsrsran_1_1rlc__am__status__pdu}{rlc\_am\_status\_pdu}}\&\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_ad92f2b9382aab5788250fa51f1366127}{get\_status\_pdu}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00169\ \ \ uint32\_t\ \ \ \ \ \ \ \ \ \ \ get\_status\_pdu\_length()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00170\ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\_report\_required()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00174\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_a59bc273574decbc39e0bd190e894476a}{notify\_status\_report\_changed}}();}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ *\ Window\ helpers}}
\DoxyCodeLine{00178\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00194\ \ \ uint32\_t\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_abe3135881a67cfced087174567df69e4}{rx\_mod\_base}}(uint32\_t\ sn)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ (sn\ -\/\ st.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_a5f38fb1ce910683b80b0f4152366860d}{rx\_next}})\ \%\ mod;\ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00199\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_aad274ab50d6a72b1ed33c1827b9a30bf}{inside\_rx\_window}}(uint32\_t\ sn)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00200\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{comment}{//\ RX\_Next\ <=\ SN\ <\ RX\_Next\ +\ AM\_Window\_Size}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_abe3135881a67cfced087174567df69e4}{rx\_mod\_base}}(sn)\ <\ am\_window\_size;}
\DoxyCodeLine{00203\ \ \ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00211\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_aabe9ef92e15580943ba06e003ceb2536}{valid\_ack\_sn}}(uint32\_t\ sn)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00212\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ RX\_Next\ <\ SN\ <=\ RX\_Next\ +\ AM\_Window\_Size}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{return}\ (0\ <\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_abe3135881a67cfced087174567df69e4}{rx\_mod\_base}}(sn))\ \&\&\ (\mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_abe3135881a67cfced087174567df69e4}{rx\_mod\_base}}(sn)\ <=\ am\_window\_size);}
\DoxyCodeLine{00215\ \ \ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ \ \ *\ Testing\ helpers}}
\DoxyCodeLine{00219\ \textcolor{comment}{\ \ \ */}}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_a1d878fba3d449db26a3521a5e2c8aab2}{set\_state}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state}{rlc\_rx\_am\_state}}\&\ st\_)\ \{\ this-\/>st\ =\ st\_;\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00230\ \ \ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state}{rlc\_rx\_am\_state}}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_ae094631ee62e14ce57db8f76cb176717}{get\_state}}()\ \{\ \textcolor{keywordflow}{return}\ st;\ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00236\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsrsran_1_1rlc__rx__am__entity_a8b952e9ecba9ffba097b3e7307506cf3}{is\_t\_reassembly\_running}}()\ \{\ \textcolor{keywordflow}{return}\ reassembly\_timer.\mbox{\hyperlink{classsrsran_1_1unique__timer_a600954b52cb062982a086792c201b9d9}{is\_running}}();\ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordtype}{void}\ handle\_control\_pdu(\mbox{\hyperlink{classsrsran_1_1byte__buffer__slice}{byte\_buffer\_slice}}\ buf);}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00247\ \ \ \textcolor{keywordtype}{void}\ handle\_data\_pdu(\mbox{\hyperlink{classsrsran_1_1byte__buffer__slice}{byte\_buffer\_slice}}\ buf);}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00254\ \ \ \textcolor{keywordtype}{bool}\ handle\_full\_data\_sdu(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__am__pdu__header}{rlc\_am\_pdu\_header}}\&\ header,\ \mbox{\hyperlink{classsrsran_1_1byte__buffer__slice}{byte\_buffer\_slice}}\ payload);}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00262\ \ \ \textcolor{keywordtype}{bool}\ handle\_segment\_data\_sdu(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__am__pdu__header}{rlc\_am\_pdu\_header}}\&\ header,\ \mbox{\hyperlink{classsrsran_1_1byte__buffer__slice}{byte\_buffer\_slice}}\ payload);}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00271\ \ \ \textcolor{keywordtype}{bool}\ store\_segment(\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__info}{rlc\_rx\_am\_sdu\_info}}\&\ sdu\_info,\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__segment}{rlc\_rx\_am\_sdu\_segment}}\ new\_segment);}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00277\ \ \ \textcolor{keywordtype}{void}\ update\_segment\_inventory(\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__info}{rlc\_rx\_am\_sdu\_info}}\&\ rx\_sdu)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00281\ \ \ \textcolor{keywordtype}{void}\ refresh\_status\_report();}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00284\ \ \ \textcolor{keywordtype}{void}\ store\_status\_report();}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \textcolor{keywordtype}{void}\ on\_expired\_status\_prohibit\_timer();}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00294\ \ \ \textcolor{keywordtype}{void}\ on\_expired\_reassembly\_timer();}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00299\ \ \ std::unique\_ptr<sdu\_window<rlc\_rx\_am\_sdu\_info>>\ create\_rx\_window(\mbox{\hyperlink{namespacesrsran_a8b7450158a751f78ab498cc921d3eae7}{rlc\_am\_sn\_size}}\ sn\_size);}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{keywordtype}{void}\ log\_state(srslog::basic\_levels\ level)\ \{\ logger.log(level,\ \textcolor{stringliteral}{"{}RX\ entity\ state.\ \{\}"{}},\ st);\ \}}
\DoxyCodeLine{00302\ \};}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \}\ \textcolor{comment}{//\ namespace\ srsran}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \textcolor{keyword}{namespace\ }fmt\ \{}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00309\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structformatter}{formatter}}<\mbox{\hyperlink{namespacesrsran}{srsran}}::rlc\_rx\_am\_sdu\_info>\ \{}
\DoxyCodeLine{00310\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ParseContext>}
\DoxyCodeLine{00311\ \ \ \textcolor{keyword}{auto}\ parse(ParseContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(ctx.begin())}
\DoxyCodeLine{00312\ \ \ \{}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordflow}{return}\ ctx.begin();}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ FormatContext>}
\DoxyCodeLine{00317\ \ \ \textcolor{keyword}{auto}\ format(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__sdu__info}{srsran::rlc\_rx\_am\_sdu\_info}}\&\ info,\ FormatContext\&\ ctx)}
\DoxyCodeLine{00318\ \ \ \ \ \ \ -\/>\ \textcolor{keyword}{decltype}(std::declval<FormatContext>().out())}
\DoxyCodeLine{00319\ \ \ \{}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{return}\ format\_to(ctx.out(),}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}nof\_segments=\{\}\ has\_gap=\{\}\ fully\_received=\{\}\ sdu\_len=\{\}"{}},}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ info.segments.size(),}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ info.has\_gap,}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ info.fully\_received,}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ info.sdu.length());}
\DoxyCodeLine{00326\ \ \ \}}
\DoxyCodeLine{00327\ \};}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00330\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structformatter}{formatter}}<\mbox{\hyperlink{namespacesrsran}{srsran}}::rlc\_rx\_am\_state>\ \{}
\DoxyCodeLine{00331\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ParseContext>}
\DoxyCodeLine{00332\ \ \ \textcolor{keyword}{auto}\ parse(ParseContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(ctx.begin())}
\DoxyCodeLine{00333\ \ \ \{}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{return}\ ctx.begin();}
\DoxyCodeLine{00335\ \ \ \}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ FormatContext>}
\DoxyCodeLine{00338\ \ \ \textcolor{keyword}{auto}\ format(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state}{srsran::rlc\_rx\_am\_state}}\&\ st,\ FormatContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(std::declval<FormatContext>().out())}
\DoxyCodeLine{00339\ \ \ \{}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{return}\ format\_to(ctx.out(),}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}rx\_next=\{\}\ rx\_next\_status\_trigger=\{\}\ rx\_highest\_status=\{\}\ rx\_next\_highest=\{\}"{}},}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_a5f38fb1ce910683b80b0f4152366860d}{rx\_next}},}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_a0d31d8c83910799533270ab0fc55728b}{rx\_next\_status\_trigger}},}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_ae3c1a73acad8bea3a9c90863e7b56a39}{rx\_highest\_status}},}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ st.\mbox{\hyperlink{structsrsran_1_1rlc__rx__am__state_aa791211a124cb176410289c9994dd851}{rx\_next\_highest}});}
\DoxyCodeLine{00346\ \ \ \}}
\DoxyCodeLine{00347\ \};}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \}\ \textcolor{comment}{//\ namespace\ fmt}}

\end{DoxyCode}
