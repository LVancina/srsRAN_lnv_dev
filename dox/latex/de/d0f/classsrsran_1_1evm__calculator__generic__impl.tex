\doxysection{srsran\+::evm\+\_\+calculator\+\_\+generic\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1evm__calculator__generic__impl}{}\label{classsrsran_1_1evm__calculator__generic__impl}\index{srsran::evm\_calculator\_generic\_impl@{srsran::evm\_calculator\_generic\_impl}}


Generic software implementation of the EVM calculator interface.  




{\ttfamily \#include $<$evm\+\_\+calculator\+\_\+generic\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::evm\+\_\+calculator\+\_\+generic\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{dc/d72/classsrsran_1_1evm__calculator__generic__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::evm\+\_\+calculator\+\_\+generic\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{da/d41/classsrsran_1_1evm__calculator__generic__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1evm__calculator__generic__impl_a80fabb343f6de57da0492ba6b05cb486}{evm\+\_\+calculator\+\_\+generic\+\_\+impl}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1modulation__mapper}{modulation\+\_\+mapper}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulator\+\_\+}})
\begin{DoxyCompactList}\small\item\em Default constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classfloat}{float}} \mbox{\hyperlink{classsrsran_1_1evm__calculator__generic__impl_ac74bd67c8d0d6da16e1c81dcde941f4d}{calculate}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1log__likelihood__ratio}{log\+\_\+likelihood\+\_\+ratio}} $>$ soft\+\_\+bits, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}} $>$ symbols, \mbox{\hyperlink{namespacesrsran_a7d1f3285d6ba6d2621f9d919681802df}{modulation\+\_\+scheme}} modulation) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Calculates the EVM for a transmission. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1evm__calculator}{srsran\+::evm\+\_\+calculator}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}evm\+\_\+calculator} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Generic software implementation of the EVM calculator interface. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1evm__calculator__generic__impl_a80fabb343f6de57da0492ba6b05cb486}\label{classsrsran_1_1evm__calculator__generic__impl_a80fabb343f6de57da0492ba6b05cb486} 
\index{srsran::evm\_calculator\_generic\_impl@{srsran::evm\_calculator\_generic\_impl}!evm\_calculator\_generic\_impl@{evm\_calculator\_generic\_impl}}
\index{evm\_calculator\_generic\_impl@{evm\_calculator\_generic\_impl}!srsran::evm\_calculator\_generic\_impl@{srsran::evm\_calculator\_generic\_impl}}
\doxysubsubsection{\texorpdfstring{evm\_calculator\_generic\_impl()}{evm\_calculator\_generic\_impl()}}
{\footnotesize\ttfamily srsran\+::evm\+\_\+calculator\+\_\+generic\+\_\+impl\+::evm\+\_\+calculator\+\_\+generic\+\_\+impl (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1modulation__mapper}{modulation\+\_\+mapper}} $>$}]{modulator\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Default constructor. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00037\ \ \ \ \ modulator(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulator\_}})),\ temp\_hard\_bits(MAX\_NOF\_BITS),\ temp\_modulated(MAX\_NOF\_SYMBOLS)}
\DoxyCodeLine{00038\ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ srsran\_assert(modulator,\ \textcolor{stringliteral}{"{}Invalid\ modulator."{}});}
\DoxyCodeLine{00040\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1evm__calculator__generic__impl_ac74bd67c8d0d6da16e1c81dcde941f4d}\label{classsrsran_1_1evm__calculator__generic__impl_ac74bd67c8d0d6da16e1c81dcde941f4d} 
\index{srsran::evm\_calculator\_generic\_impl@{srsran::evm\_calculator\_generic\_impl}!calculate@{calculate}}
\index{calculate@{calculate}!srsran::evm\_calculator\_generic\_impl@{srsran::evm\_calculator\_generic\_impl}}
\doxysubsubsection{\texorpdfstring{calculate()}{calculate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classfloat}{float}} evm\+\_\+calculator\+\_\+generic\+\_\+impl\+::calculate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1log__likelihood__ratio}{log\+\_\+likelihood\+\_\+ratio}} $>$}]{soft\+\_\+bits,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}} $>$}]{symbols,  }\item[{\mbox{\hyperlink{namespacesrsran_a7d1f3285d6ba6d2621f9d919681802df}{modulation\+\_\+scheme}}}]{modulation }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Calculates the EVM for a transmission. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em soft\+\_\+bits} & The soft bits from the modulation demapper. \\
\hline
\mbox{\texttt{ in}}  & {\em symbols} & The complex-\/valued channel symbols, prior to the modulation demapper. \\
\hline
\mbox{\texttt{ in}}  & {\em modulation} & The modulation scheme. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The calculated EVM. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
The size of {\ttfamily soft\+\_\+bits} must be equal to the size of {\ttfamily symbols} times the number of bits per symbol corresponding to {\ttfamily modulation}. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1evm__calculator_afc74ff721378a740d1402de77703ac25}{srsran\+::evm\+\_\+calculator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00033\ \{}
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{//\ Get\ modulation\ order.}}
\DoxyCodeLine{00035\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_per\_symbol}}\ =\ \mbox{\hyperlink{namespacesrsran_af78ee928d6d8a3d8ff6bbc753f50c44e}{get\_bits\_per\_symbol}}(modulation);}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{comment}{//\ Verify\ that\ soft\ bits\ and\ symbols\ dimensions\ are\ consistent.}}
\DoxyCodeLine{00038\ \ \ srsran\_assert(soft\_bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ ==\ symbols.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_per\_symbol}},}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ number\ of\ soft\ bits\ (i.e.,\ \{\})\ is\ not\ consistent\ with\ the\ number\ of\ symbols\ (i.e.,\ \{\})\ and\ "{}}}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}modulation\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ soft\_bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ symbols.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a5fa5b607b51bce906141a06d7ecdebbf}{to\_string}}(modulation));}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_symbols\ =\ symbols.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}();}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordtype}{float}\ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{avg\_power}}\ \ \ =\ 0.0;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{while}\ (!soft\_bits.\mbox{\hyperlink{classsrsran_1_1span_a06f3393981b96d556095d9023b894a8f}{empty}}())\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_symbols}}\ =}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ std::min(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(symbols.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(MAX\_NOF\_SYMBOLS));}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_bits}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_symbols}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bits\_per\_symbol}};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ Perform\ hard-\/decision.}}
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\_buffer}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hard\_bits}}\ =\ temp\_hard\_bits.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abba52fc044021e0e4492726fc8a4dc24}{first}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_bits}});}
\DoxyCodeLine{00055\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a6dff3aa5abb3f4bb10b46513b48a373e}{hard\_decision}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hard\_bits}},\ soft\_bits.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_bits}}));}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ Modulate.}}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulated}}\ =\ temp\_modulated.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_symbols}});}
\DoxyCodeLine{00059\ \ \ \ \ modulator-\/>modulate(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulated}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{hard\_bits}},\ modulation);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ Calculate\ EVM.}}
\DoxyCodeLine{00062\ \ \ \ \ srsvec::subtract(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulated}},\ symbols.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_symbols}}),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulated}});}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ Accumulate\ power.}}
\DoxyCodeLine{00065\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{avg\_power}}\ +=\ std::real(srsvec::dot\_prod(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulated}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{modulated}}));}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ Pop\ bits\ and\ symbols.}}
\DoxyCodeLine{00068\ \ \ \ \ symbols\ \ \ =\ symbols.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(symbols.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_symbols}});}
\DoxyCodeLine{00069\ \ \ \ \ soft\_bits\ =\ soft\_bits.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(soft\_bits.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_nof\_bits}});}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \textcolor{keywordflow}{return}\ std::sqrt(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{avg\_power}}\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(nof\_symbols));}
\DoxyCodeLine{00073\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/upper/channel\+\_\+modulation/evm\+\_\+calculator\+\_\+generic\+\_\+impl.\+h\item 
lib/phy/upper/channel\+\_\+modulation/evm\+\_\+calculator\+\_\+generic\+\_\+impl.\+cpp\end{DoxyCompactItemize}
