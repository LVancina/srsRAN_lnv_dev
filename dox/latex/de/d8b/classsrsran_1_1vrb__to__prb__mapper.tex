\doxysection{srsran\+::vrb\+\_\+to\+\_\+prb\+\_\+mapper Class Reference}
\hypertarget{classsrsran_1_1vrb__to__prb__mapper}{}\label{classsrsran_1_1vrb__to__prb__mapper}\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}


Describes a VRB-\/to-\/\+PRB mapping.  




{\ttfamily \#include $<$vrb\+\_\+to\+\_\+prb\+\_\+mapper.\+h$>$}



Collaboration diagram for srsran\+::vrb\+\_\+to\+\_\+prb\+\_\+mapper\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{dc/dbc/classsrsran_1_1vrb__to__prb__mapper__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_ae45061a694614cb1fe59eff1d5399aff}{is\+\_\+interleaved}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Checks whether the resource allocation is interleaved. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_a02d89a247ca59d6b263bc36950cb5b8a}{get\+\_\+coreset\+\_\+start}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Gets the CORESET start VRB index. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1static__vector}{static\+\_\+vector}}$<$ uint16\+\_\+t, MAX\+\_\+\+RB $>$ \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_aac8db67cffbf371950907e01628291fc}{get\+\_\+allocation\+\_\+indices}} (\mbox{\hyperlink{classunsigned}{unsigned}} bwp\+\_\+size) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Calculates a PDSCH allocation PRB indices. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_a70de9d159495c3b0b6807b30cd18dde2}{operator==}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Equal comparison between two VRB-\/to-\/\+PRB mappers. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_a6b5eb4ca05dfc0a2341e620d5017d09d}{create\+\_\+non\+\_\+interleaved\+\_\+common\+\_\+ss}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+start\+\_\+coreset}})
\begin{DoxyCompactList}\small\item\em Creates a non-\/interleaved VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled by DCI Format 1\+\_\+0 in common SS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_a1fbbbd83e1da31a757c1069c5676aab3}{create\+\_\+non\+\_\+interleaved\+\_\+other}} ()
\begin{DoxyCompactList}\small\item\em Creates a non-\/interleaved VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled by DCI other than Format 1\+\_\+0 in common SS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_a481bd08edede9b6b82bf9ecdc993590f}{create\+\_\+interleaved\+\_\+coreset0}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+start\+\_\+coreset}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+bwp\+\_\+init\+\_\+size}})
\begin{DoxyCompactList}\small\item\em Creates a VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled with DCI Format 1\+\_\+0 with the CRC scrambled by SI-\/\+RNTI in Type0-\/\+PDCCH common SS in CORESET0. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_ace5eabc929800582a5659026b3f3d6c8}{create\+\_\+interleaved\+\_\+common}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+start\+\_\+coreset}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+bwp\+\_\+i\+\_\+start}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+bwp\+\_\+init\+\_\+size}})
\begin{DoxyCompactList}\small\item\em Creates a VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled by DCI format 1\+\_\+0 in any common SS except Type0-\/\+PDCCH common SS in CORESET0. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{static}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_aef120cb6aac7ab159ec3c269a7389d6b}{create\+\_\+interleaved\+\_\+other}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+bwp\+\_\+i\+\_\+start}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\+\_\+bwp\+\_\+i\+\_\+size}}, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\+\_\+i}})
\begin{DoxyCompactList}\small\item\em Creates a VRB-\/to-\/\+PRB mapper for all other PDSCH transmissions with interleaved mapping. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Describes a VRB-\/to-\/\+PRB mapping. 

This class abstracts the virtual to physical resource mapping for PDSCH.

The default constructor is equivalent to use \doxylink{classsrsran_1_1vrb__to__prb__mapper_a1fbbbd83e1da31a757c1069c5676aab3}{create\+\_\+non\+\_\+interleaved\+\_\+other()}. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_ace5eabc929800582a5659026b3f3d6c8}\label{classsrsran_1_1vrb__to__prb__mapper_ace5eabc929800582a5659026b3f3d6c8} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!create\_interleaved\_common@{create\_interleaved\_common}}
\index{create\_interleaved\_common@{create\_interleaved\_common}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{create\_interleaved\_common()}{create\_interleaved\_common()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::create\+\_\+interleaved\+\_\+common (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+start\+\_\+coreset,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+bwp\+\_\+i\+\_\+start,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+bwp\+\_\+init\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Creates a VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled by DCI format 1\+\_\+0 in any common SS except Type0-\/\+PDCCH common SS in CORESET0. 

Implemented as per TS38.\+211 Section 7.\+3.\+1.\+6 Case 4\+:
\begin{DoxyItemize}
\item the set of $N_{BWP,init}^{size}$ virtual RBs starting at $N_{BWP,i}^{start}$ is divided into  $N_{bundle}=\lceil (N_{BWP,init}^{size} + ((N_{BWP,i}^{start} + N_{start}^{CORESET}) \bmod L))/L
\rceil$,
\item the bundle size is $L=2$,
\item the first RB bundle consists of $L - ((N_{BWP,init}^{size} + N_{start}^{CORESET}) \bmod L)$,
\item the last RB bundle consists of $(N_{BWP,init}^{size} + N_{BWP,i}^{start} + N_{start}^{CORESET}) \bmod L$ if $(N_{BWP,init}^{size} + N_{BWP,i}^{start} + N_{start}^{CORESET}) \bmod L > 0$ and $L$ RB otherwise, and
\item all other resource block bundles consist of $L$ RBs.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em N\+\_\+start\+\_\+coreset} & VRB index of the lowest-\/numbered RB in the CORESET used for the DCI transmission as $N_{start}^{CORESET}$. \\
\hline
\mbox{\texttt{ in}}  & {\em N\+\_\+bwp\+\_\+i\+\_\+start} & BWP $i$ starting position $N_{BWP,i}^{start}$. \\
\hline
\mbox{\texttt{ in}}  & {\em N\+\_\+bwp\+\_\+init\+\_\+size} & The size in RBs of CORESET0 if available, otherwise the initial bandwidth part size as $N_{BWP,init}^{size}$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A VRB-\/to-\/\+PRB mapper instance. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00122\ \{}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\_to\_prb\_mapper}}\ mapper;}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ Constant\ bundle\ size.}}
\DoxyCodeLine{00126\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}}\ =\ 2;}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{comment}{//\ Set\ CORESET\ start.}}
\DoxyCodeLine{00129\ \ \ mapper.coreset\_start\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}};}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ Set\ bundle\ size\ as\ interleaved.}}
\DoxyCodeLine{00132\ \ \ mapper.nof\_bundles\ =\ \mbox{\hyperlink{namespacesrsran_a6e5aee1d553dc6e825017842e4059adb}{divide\_ceil}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_init\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}});}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \textcolor{comment}{//\ Set\ the\ size\ of\ the\ first\ bundle.}}
\DoxyCodeLine{00135\ \ \ mapper.first\_bundle\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}}\ -\/\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}})\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}});}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{comment}{//\ Set\ the\ size\ of\ the\ last\ bundle.}}
\DoxyCodeLine{00138\ \ \ mapper.last\_bundle\_size\ =\ (((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_init\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}})\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}})\ >\ 0)}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_init\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}})\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}})}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}};}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{comment}{//\ All\ other\ RBs\ are\ set\ to\ L.}}
\DoxyCodeLine{00143\ \ \ mapper.other\_bundle\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}};}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{return}\ mapper;}
\DoxyCodeLine{00146\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_a481bd08edede9b6b82bf9ecdc993590f}\label{classsrsran_1_1vrb__to__prb__mapper_a481bd08edede9b6b82bf9ecdc993590f} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!create\_interleaved\_coreset0@{create\_interleaved\_coreset0}}
\index{create\_interleaved\_coreset0@{create\_interleaved\_coreset0}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{create\_interleaved\_coreset0()}{create\_interleaved\_coreset0()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::create\+\_\+interleaved\+\_\+coreset0 (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+start\+\_\+coreset,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+bwp\+\_\+init\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Creates a VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled with DCI Format 1\+\_\+0 with the CRC scrambled by SI-\/\+RNTI in Type0-\/\+PDCCH common SS in CORESET0. 

Implemented as per TS38.\+211 Section 7.\+3.\+1.\+6 Case 3\+:
\begin{DoxyItemize}
\item the number of bundles is calculated as $N_{bundle}=\lceil N_{BWP,init}^{size}/L \rceil$,
\item the last RB bundle consists of $N_{BWP,init}^{size} \bmod L$ if $N_{BWP,init}^{size} \bmod L > 0$,
\item all other resource block bundles consist of $L$ RBs, and
\item the bundle size is $L=2$.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em N\+\_\+start\+\_\+coreset} & VRB index of the lowest-\/numbered RB in the CORESET used for the DCI transmission as $N_{start}^{CORESET}$. \\
\hline
\mbox{\texttt{ in}}  & {\em N\+\_\+bwp\+\_\+init\+\_\+size} & The size in RBs of CORESET0 as $N_{BWP,init}^{size}$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A VRB-\/to-\/\+PRB mapper instance. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00098\ \{}
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\_to\_prb\_mapper}}\ mapper;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ CORESET0\ constant\ bundle\ size.}}
\DoxyCodeLine{00102\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}}\ =\ 2;}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{comment}{//\ Set\ CORESET\ start.}}
\DoxyCodeLine{00105\ \ \ mapper.coreset\_start\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \textcolor{comment}{//\ Set\ bundle\ size\ as\ interleaved.}}
\DoxyCodeLine{00108\ \ \ mapper.nof\_bundles\ =\ \mbox{\hyperlink{namespacesrsran_a6e5aee1d553dc6e825017842e4059adb}{divide\_ceil}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_init\_size}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}});}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{comment}{//\ Set\ the\ size\ of\ the\ last\ bundle.}}
\DoxyCodeLine{00111\ \ \ mapper.last\_bundle\_size\ =\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_init\_size}}\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}}\ >\ 0)\ ?\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_init\_size}}\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}})\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \textcolor{comment}{//\ All\ other\ RBs\ are\ set\ to\ L.}}
\DoxyCodeLine{00114\ \ \ mapper.first\_bundle\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}};}
\DoxyCodeLine{00115\ \ \ mapper.other\_bundle\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L}};}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{return}\ mapper;}
\DoxyCodeLine{00118\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_aef120cb6aac7ab159ec3c269a7389d6b}\label{classsrsran_1_1vrb__to__prb__mapper_aef120cb6aac7ab159ec3c269a7389d6b} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!create\_interleaved\_other@{create\_interleaved\_other}}
\index{create\_interleaved\_other@{create\_interleaved\_other}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{create\_interleaved\_other()}{create\_interleaved\_other()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::create\+\_\+interleaved\+\_\+other (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+bwp\+\_\+i\+\_\+start,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+bwp\+\_\+i\+\_\+size,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{L\+\_\+i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Creates a VRB-\/to-\/\+PRB mapper for all other PDSCH transmissions with interleaved mapping. 

Implemented as per TS38.\+211 Section 7.\+3.\+1.\+6 Case 5\+:
\begin{DoxyItemize}
\item the set of $N_{BWP,i}^{size}$ virtual RBs starting at $N_{BWP,i}^{start}$ is divided into $N_{bundle}=\lceil (N_{BWP,i}^{size} + (N_{BWP,i}^{start} \bmod L_i))/L_i \rceil$,
\item the first RB bundle consists of $L_i - N_{BWP,i}^{size} \bmod L_i$,
\item the last RB bundle consists of $(N_{BWP,i}^{size}+N_{BWP,i}^{start}) \bmod L_i$ if $(N_{BWP,i}^{size}+N_{BWP,i}^{start}) \bmod L_i > 0$ and $L_i$ RBs otherwise,
\item all other resource block bundles consist of $L_i$ RBs.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em N\+\_\+bwp\+\_\+i\+\_\+start} & BWP $i$ starting position $N_{BWP,i}^{start}$. \\
\hline
\mbox{\texttt{ in}}  & {\em N\+\_\+bwp\+\_\+i\+\_\+size} & BWP $i$ size $N_{BWP,i}^{size}$. \\
\hline
\mbox{\texttt{ in}}  & {\em L\+\_\+i} & RB Bundle size for BWP $i$ in RBs $L_i$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A VRB-\/to-\/\+PRB mapper instance. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00150\ \{}
\DoxyCodeLine{00151\ \ \ \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\_to\_prb\_mapper}}\ mapper;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//\ Set\ number\ of\ bundles\ as\ interleaved.}}
\DoxyCodeLine{00154\ \ \ mapper.nof\_bundles\ =\ \mbox{\hyperlink{namespacesrsran_a6e5aee1d553dc6e825017842e4059adb}{divide\_ceil}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}});}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \textcolor{comment}{//\ Set\ the\ size\ of\ the\ first\ bundle.}}
\DoxyCodeLine{00157\ \ \ mapper.first\_bundle\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}}\ -\/\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_size}}\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}});}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \textcolor{comment}{//\ Set\ the\ size\ of\ the\ last\ bundle.}}
\DoxyCodeLine{00160\ \ \ mapper.last\_bundle\_size\ =\ (((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}})\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}})\ >\ 0)\ ?\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_bwp\_i\_start}})\ \%\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}})\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}};}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \textcolor{comment}{//\ All\ other\ RBs\ are\ set\ to\ L.}}
\DoxyCodeLine{00163\ \ \ mapper.other\_bundle\_size\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{L\_i}};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{return}\ mapper;}
\DoxyCodeLine{00166\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_a6b5eb4ca05dfc0a2341e620d5017d09d}\label{classsrsran_1_1vrb__to__prb__mapper_a6b5eb4ca05dfc0a2341e620d5017d09d} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!create\_non\_interleaved\_common\_ss@{create\_non\_interleaved\_common\_ss}}
\index{create\_non\_interleaved\_common\_ss@{create\_non\_interleaved\_common\_ss}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{create\_non\_interleaved\_common\_ss()}{create\_non\_interleaved\_common\_ss()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::create\+\_\+non\+\_\+interleaved\+\_\+common\+\_\+ss (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{N\+\_\+start\+\_\+coreset }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Creates a non-\/interleaved VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled by DCI Format 1\+\_\+0 in common SS. 

Implemented as per TS38.\+211 Section 7.\+3.\+1.\+6 Case 1\+:
\begin{DoxyItemize}
\item A virtual resource $n$ is mapped to the physical block $n + N_{start}^{CORESET}$.
\end{DoxyItemize}

If the PDSCH is scheduled with DCI format 1\+\_\+0 with the CRC scrambled by SI-\/\+RNTI in Type0-\/\+PDCCH common search space in CORESET 0, the BWP start and size must match with the CORESET0 start and size. Consequently, $N_{start}^{CORESET}$ must be zero.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em N\+\_\+start\+\_\+coreset} & VRB index of the lowest-\/numbered RB in the CORESET used for the DCI transmission as $N_{start}^{CORESET}$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A VRB-\/to-\/\+PRB mapper instance. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00079\ \{}
\DoxyCodeLine{00080\ \ \ \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\_to\_prb\_mapper}}\ mapper;}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{//\ Set\ CORESET\ start.}}
\DoxyCodeLine{00083\ \ \ mapper.coreset\_start\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{N\_start\_coreset}};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{comment}{//\ Set\ bundle\ size\ as\ non-\/interleaved.}}
\DoxyCodeLine{00086\ \ \ mapper.nof\_bundles\ =\ 0;}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{return}\ mapper;}
\DoxyCodeLine{00089\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_a1fbbbd83e1da31a757c1069c5676aab3}\label{classsrsran_1_1vrb__to__prb__mapper_a1fbbbd83e1da31a757c1069c5676aab3} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!create\_non\_interleaved\_other@{create\_non\_interleaved\_other}}
\index{create\_non\_interleaved\_other@{create\_non\_interleaved\_other}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{create\_non\_interleaved\_other()}{create\_non\_interleaved\_other()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::create\+\_\+non\+\_\+interleaved\+\_\+other (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Creates a non-\/interleaved VRB-\/to-\/\+PRB mapper for PDSCH transmissions scheduled by DCI other than Format 1\+\_\+0 in common SS. 

Implemented as per TS38.\+211 Section 7.\+3.\+1.\+6 Case 2\+:
\begin{DoxyItemize}
\item A virtual resouce $n$ is mapped to the physical block $n$.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
A VRB-\/to-\/\+PRB mapper instance. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00092\ \{}
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ Keep\ default\ values.}}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\_to\_prb\_mapper}}();}
\DoxyCodeLine{00095\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_aac8db67cffbf371950907e01628291fc}\label{classsrsran_1_1vrb__to__prb__mapper_aac8db67cffbf371950907e01628291fc} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!get\_allocation\_indices@{get\_allocation\_indices}}
\index{get\_allocation\_indices@{get\_allocation\_indices}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{get\_allocation\_indices()}{get\_allocation\_indices()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1static__vector}{static\+\_\+vector}}$<$ uint16\+\_\+t, MAX\+\_\+\+RB $>$ vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::get\+\_\+allocation\+\_\+indices (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{bwp\+\_\+size }\end{DoxyParamCaption}) const}



Calculates a PDSCH allocation PRB indices. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bwp\+\_\+size} & Indicates the BWP size. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return the PRB indices relative to the lowest PRB of the BWP. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00169\ \{}
\DoxyCodeLine{00170\ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector<uint16\_t,\ MAX\_RB>}}\ result(bwp\_size);}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper_ae45061a694614cb1fe59eff1d5399aff}{is\_interleaved}}())\ \{}
\DoxyCodeLine{00172\ \ \ \ \ vrb\_to\_prb\_mapper\_get\_non\_interleaved\_prb(result,\ coreset\_start);}
\DoxyCodeLine{00173\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00174\ \ \ \ \ vrb\_to\_prb\_mapper\_get\_interleaved\_prb(}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ result,\ coreset\_start,\ nof\_bundles,\ first\_bundle\_size,\ last\_bundle\_size,\ other\_bundle\_size);}
\DoxyCodeLine{00176\ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00179\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_a02d89a247ca59d6b263bc36950cb5b8a}\label{classsrsran_1_1vrb__to__prb__mapper_a02d89a247ca59d6b263bc36950cb5b8a} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!get\_coreset\_start@{get\_coreset\_start}}
\index{get\_coreset\_start@{get\_coreset\_start}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{get\_coreset\_start()}{get\_coreset\_start()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classunsigned}{unsigned}} srsran\+::vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::get\+\_\+coreset\+\_\+start (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Gets the CORESET start VRB index. 

VRB index of the lowest-\/numbered RB in the CORESET used for the DCI transmission.

\begin{DoxyReturn}{Returns}
A VRB index if the PDSCH transmission is scheduled by a DCI in a common SS. Otherwise, 0. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00141\ \{\ \textcolor{keywordflow}{return}\ coreset\_start;\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_ae45061a694614cb1fe59eff1d5399aff}\label{classsrsran_1_1vrb__to__prb__mapper_ae45061a694614cb1fe59eff1d5399aff} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!is\_interleaved@{is\_interleaved}}
\index{is\_interleaved@{is\_interleaved}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{is\_interleaved()}{is\_interleaved()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::is\+\_\+interleaved (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Checks whether the resource allocation is interleaved. 

The resource allocation is interleaved if the number of bundles is not zero.

\begin{DoxyReturn}{Returns}
True if the resource allocation is interleaved. Otherwise, False. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00134\ \{\ \textcolor{keywordflow}{return}\ nof\_bundles\ !=\ 0;\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1vrb__to__prb__mapper_a70de9d159495c3b0b6807b30cd18dde2}\label{classsrsran_1_1vrb__to__prb__mapper_a70de9d159495c3b0b6807b30cd18dde2} 
\index{srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}!operator==@{operator==}}
\index{operator==@{operator==}!srsran::vrb\_to\_prb\_mapper@{srsran::vrb\_to\_prb\_mapper}}
\doxysubsubsection{\texorpdfstring{operator==()}{operator==()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::vrb\+\_\+to\+\_\+prb\+\_\+mapper\+::operator== (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1vrb__to__prb__mapper}{vrb\+\_\+to\+\_\+prb\+\_\+mapper}} \&}]{other }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Equal comparison between two VRB-\/to-\/\+PRB mappers. 

Two mappers are considered equal if their CORESET start, number of bundles and RB bundle sizes are equal. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00153\ \ \ \{}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordflow}{return}\ (coreset\_start\ ==\ \mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.coreset\_start)\ \&\&\ (nof\_bundles\ ==\ \mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.nof\_bundles)\ \&\&}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ (first\_bundle\_size\ ==\ \mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.first\_bundle\_size)\ \&\&\ (last\_bundle\_size\ ==\ \mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.last\_bundle\_size)\ \&\&}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ (other\_bundle\_size\ ==\ \mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.other\_bundle\_size);}
\DoxyCodeLine{00157\ \ \ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/srsran/phy/upper/vrb\+\_\+to\+\_\+prb\+\_\+mapper.\+h\item 
lib/phy/upper/vrb\+\_\+to\+\_\+prb\+\_\+mapper.\+cpp\end{DoxyCompactItemize}
