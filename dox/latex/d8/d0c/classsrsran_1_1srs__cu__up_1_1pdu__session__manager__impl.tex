\doxysection{srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl}{}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl}\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}


Inheritance diagram for srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{d9/d8f/classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{d8/d9c/classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a7de63da94a6c3c2ffd20711b3a7e4b74}{pdu\+\_\+session\+\_\+manager\+\_\+impl}} (ue\+\_\+index\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\+\_\+index\+\_\+}}, std\+::map$<$ \mbox{\hyperlink{namespacesrsran_a861f1531e77730335ec8e75c4b2eec2e}{five\+\_\+qi\+\_\+t}}, \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__qos__config}{srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+qos\+\_\+config}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{qos\+\_\+cfg\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1security_1_1sec__as__config}{security\+::sec\+\_\+as\+\_\+config}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{security\+\_\+info\+\_\+}}, \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config}{network\+\_\+interface\+\_\+config}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{net\+\_\+config\+\_\+}}, \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1n3__interface__config}{n3\+\_\+interface\+\_\+config}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n3\+\_\+config\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{cu\+\_\+up\+\_\+ue\+\_\+logger}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1unique__timer}{unique\+\_\+timer}} \&ue\+\_\+inactivity\+\_\+timer, \mbox{\hyperlink{classsrsran_1_1timer__factory}{timer\+\_\+factory}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timers\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1f1u__cu__up__gateway}{f1u\+\_\+cu\+\_\+up\+\_\+gateway}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\+\_\+gw\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1gtpu__teid__pool}{gtpu\+\_\+teid\+\_\+pool}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\+\_\+teid\+\_\+allocator\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1gtpu__tunnel__tx__upper__layer__notifier}{gtpu\+\_\+tunnel\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{gtpu\+\_\+tx\+\_\+notifier\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1gtpu__demux__ctrl}{gtpu\+\_\+demux\+\_\+ctrl}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{gtpu\+\_\+rx\+\_\+demux\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1dlt__pcap}{dlt\+\_\+pcap}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{gtpu\+\_\+pcap\+\_\+}})
\item 
\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__setup__result}{pdu\+\_\+session\+\_\+setup\+\_\+result}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_abfd69ad11d95578a2dcb8f5cb29c2918}{setup\+\_\+pdu\+\_\+session}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1e1ap__pdu__session__res__to__setup__item}{e1ap\+\_\+pdu\+\_\+session\+\_\+res\+\_\+to\+\_\+setup\+\_\+item}} \&session) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__modification__result}{pdu\+\_\+session\+\_\+modification\+\_\+result}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_ab0f9fd736787b753bf6f04c3e1b3a85d}{modify\+\_\+pdu\+\_\+session}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1e1ap__pdu__session__res__to__modify__item}{e1ap\+\_\+pdu\+\_\+session\+\_\+res\+\_\+to\+\_\+modify\+\_\+item}} \&session, \mbox{\hyperlink{classbool}{bool}} new\+\_\+ul\+\_\+tnl\+\_\+info\+\_\+required) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a340ab9a26ee6779bd78fe338f172880a}{remove\+\_\+pdu\+\_\+session}} (\mbox{\hyperlink{namespacesrsran_aa153c2df57d799e6d4161dd881ad4df2}{pdu\+\_\+session\+\_\+id\+\_\+t}} pdu\+\_\+session\+\_\+id) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
size\+\_\+t \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_ac3c77b4f0a9e9f5f0a0882c28fcb172e}{get\+\_\+nof\+\_\+pdu\+\_\+sessions}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
\mbox{\hyperlink{classsrsran_1_1strong__type}{gtpu\+\_\+teid\+\_\+t}} \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a20f9ae4a7210aa08a5e95a392935830a}{allocate\+\_\+local\+\_\+teid}} (\mbox{\hyperlink{namespacesrsran_aa153c2df57d799e6d4161dd881ad4df2}{pdu\+\_\+session\+\_\+id\+\_\+t}} pdu\+\_\+session\+\_\+id)
\begin{DoxyCompactList}\small\item\em Function used to allocate a local NG-\/U TEID This function allocates a new TEID based on the UE id, and PDU session ID. The allocation should look like this, \texorpdfstring{$\vert$}{|}X X X X \texorpdfstring{$\vert$}{|} 0..3 \texorpdfstring{$\vert$}{|}U U P P \texorpdfstring{$\vert$}{|} 4..7 where X is reserved, U are the bytes for UE id and P is the byte for PDU session Id. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a7de63da94a6c3c2ffd20711b3a7e4b74}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a7de63da94a6c3c2ffd20711b3a7e4b74} 
\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}!pdu\_session\_manager\_impl@{pdu\_session\_manager\_impl}}
\index{pdu\_session\_manager\_impl@{pdu\_session\_manager\_impl}!srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{pdu\_session\_manager\_impl()}{pdu\_session\_manager\_impl()}}
{\footnotesize\ttfamily pdu\+\_\+session\+\_\+manager\+\_\+impl\+::pdu\+\_\+session\+\_\+manager\+\_\+impl (\begin{DoxyParamCaption}\item[{ue\+\_\+index\+\_\+t}]{ue\+\_\+index\+\_\+,  }\item[{std\+::map$<$ \mbox{\hyperlink{namespacesrsran_a861f1531e77730335ec8e75c4b2eec2e}{five\+\_\+qi\+\_\+t}}, \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1cu__up__qos__config}{srs\+\_\+cu\+\_\+up\+::cu\+\_\+up\+\_\+qos\+\_\+config}} $>$}]{qos\+\_\+cfg\+\_\+,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1security_1_1sec__as__config}{security\+::sec\+\_\+as\+\_\+config}} \&}]{security\+\_\+info\+\_\+,  }\item[{\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config}{network\+\_\+interface\+\_\+config}} \&}]{net\+\_\+config\+\_\+,  }\item[{\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1n3__interface__config}{n3\+\_\+interface\+\_\+config}} \&}]{n3\+\_\+config\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1prefixed__logger}{cu\+\_\+up\+\_\+ue\+\_\+logger}} \&}]{logger\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1unique__timer}{unique\+\_\+timer}} \&}]{ue\+\_\+inactivity\+\_\+timer,  }\item[{\mbox{\hyperlink{classsrsran_1_1timer__factory}{timer\+\_\+factory}}}]{timers\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1f1u__cu__up__gateway}{f1u\+\_\+cu\+\_\+up\+\_\+gateway}} \&}]{f1u\+\_\+gw\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1gtpu__teid__pool}{gtpu\+\_\+teid\+\_\+pool}} \&}]{f1u\+\_\+teid\+\_\+allocator\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1gtpu__tunnel__tx__upper__layer__notifier}{gtpu\+\_\+tunnel\+\_\+tx\+\_\+upper\+\_\+layer\+\_\+notifier}} \&}]{gtpu\+\_\+tx\+\_\+notifier\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1gtpu__demux__ctrl}{gtpu\+\_\+demux\+\_\+ctrl}} \&}]{gtpu\+\_\+rx\+\_\+demux\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1dlt__pcap}{dlt\+\_\+pcap}} \&}]{gtpu\+\_\+pcap\+\_\+ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00049\ \ \ ue\_index(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_index\_}}),}
\DoxyCodeLine{00050\ \ \ qos\_cfg(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{qos\_cfg\_}})),}
\DoxyCodeLine{00051\ \ \ security\_info(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{security\_info\_}}),}
\DoxyCodeLine{00052\ \ \ net\_config(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{net\_config\_}}),}
\DoxyCodeLine{00053\ \ \ n3\_config(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n3\_config\_}}),}
\DoxyCodeLine{00054\ \ \ logger(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\_}}),}
\DoxyCodeLine{00055\ \ \ ue\_inactivity\_timer(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_inactivity\_timer\_}}),}
\DoxyCodeLine{00056\ \ \ timers(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timers\_}}),}
\DoxyCodeLine{00057\ \ \ gtpu\_tx\_notifier(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{gtpu\_tx\_notifier\_}}),}
\DoxyCodeLine{00058\ \ \ f1u\_teid\_allocator(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_teid\_allocator\_}}),}
\DoxyCodeLine{00059\ \ \ gtpu\_rx\_demux(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{gtpu\_rx\_demux\_}}),}
\DoxyCodeLine{00060\ \ \ gtpu\_pcap(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{gtpu\_pcap\_}}),}
\DoxyCodeLine{00061\ \ \ f1u\_gw(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_gw\_}})}
\DoxyCodeLine{00062\ \{}
\DoxyCodeLine{00063\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a20f9ae4a7210aa08a5e95a392935830a}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a20f9ae4a7210aa08a5e95a392935830a} 
\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}!allocate\_local\_teid@{allocate\_local\_teid}}
\index{allocate\_local\_teid@{allocate\_local\_teid}!srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{allocate\_local\_teid()}{allocate\_local\_teid()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1strong__type}{gtpu\+\_\+teid\+\_\+t}} pdu\+\_\+session\+\_\+manager\+\_\+impl\+::allocate\+\_\+local\+\_\+teid (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_aa153c2df57d799e6d4161dd881ad4df2}{pdu\+\_\+session\+\_\+id\+\_\+t}}}]{pdu\+\_\+session\+\_\+id }\end{DoxyParamCaption})}



Function used to allocate a local NG-\/U TEID This function allocates a new TEID based on the UE id, and PDU session ID. The allocation should look like this, \texorpdfstring{$\vert$}{|}X X X X \texorpdfstring{$\vert$}{|} 0..3 \texorpdfstring{$\vert$}{|}U U P P \texorpdfstring{$\vert$}{|} 4..7 where X is reserved, U are the bytes for UE id and P is the byte for PDU session Id. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00498\ \{}
\DoxyCodeLine{00499\ \ \ \textcolor{comment}{//\ Local\ TEID\ is\ the\ concatenation\ of\ the\ unique\ UE\ index\ and\ the\ PDU\ session\ ID}}
\DoxyCodeLine{00500\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ local\_teid\ =\ ue\_index;}
\DoxyCodeLine{00501\ \ \ local\_teid\ <<=\ 8U;}
\DoxyCodeLine{00502\ \ \ local\_teid\ |=\ \mbox{\hyperlink{namespacesrsran_a32e059b1e9034758c27b5f5772845f72}{pdu\_session\_id\_to\_uint}}(pdu\_session\_id);}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1strong__type}{gtpu\_teid\_t}}\{local\_teid\};}
\DoxyCodeLine{00504\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_ac3c77b4f0a9e9f5f0a0882c28fcb172e}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_ac3c77b4f0a9e9f5f0a0882c28fcb172e} 
\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}!get\_nof\_pdu\_sessions@{get\_nof\_pdu\_sessions}}
\index{get\_nof\_pdu\_sessions@{get\_nof\_pdu\_sessions}!srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{get\_nof\_pdu\_sessions()}{get\_nof\_pdu\_sessions()}}
{\footnotesize\ttfamily size\+\_\+t pdu\+\_\+session\+\_\+manager\+\_\+impl\+::get\+\_\+nof\+\_\+pdu\+\_\+sessions (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__ctrl}{srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+ctrl}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00493\ \{}
\DoxyCodeLine{00494\ \ \ \textcolor{keywordflow}{return}\ pdu\_sessions.size();}
\DoxyCodeLine{00495\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_ab0f9fd736787b753bf6f04c3e1b3a85d}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_ab0f9fd736787b753bf6f04c3e1b3a85d} 
\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}!modify\_pdu\_session@{modify\_pdu\_session}}
\index{modify\_pdu\_session@{modify\_pdu\_session}!srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{modify\_pdu\_session()}{modify\_pdu\_session()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__modification__result}{pdu\+\_\+session\+\_\+modification\+\_\+result}} pdu\+\_\+session\+\_\+manager\+\_\+impl\+::modify\+\_\+pdu\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1e1ap__pdu__session__res__to__modify__item}{e1ap\+\_\+pdu\+\_\+session\+\_\+res\+\_\+to\+\_\+modify\+\_\+item}} \&}]{session,  }\item[{\mbox{\hyperlink{classbool}{bool}}}]{new\+\_\+ul\+\_\+tnl\+\_\+info\+\_\+required }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__ctrl}{srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+ctrl}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00319\ \{}
\DoxyCodeLine{00320\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__modification__result}{pdu\_session\_modification\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00321\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.success\ \ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00322\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.pdu\_session\_id\ =\ session.pdu\_session\_id;}
\DoxyCodeLine{00323\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.cause\ \ \ \ \ \ \ \ \ \ =\ cause\_radio\_network\_t::unspecified;}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{keywordflow}{if}\ (pdu\_sessions.find(session.pdu\_session\_id)\ ==\ pdu\_sessions.end())\ \{}
\DoxyCodeLine{00326\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}PDU\ Session\ \{\}\ doesn't\ exists"{}},\ session.pdu\_session\_id);}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00328\ \ \ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}\ =\ pdu\_sessions.at(session.pdu\_session\_id);}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \textcolor{comment}{//\ >\ DRB\ To\ Setup\ List}}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_setup}}\ :\ session.drb\_to\_setup\_list\_ng\_ran)\ \{}
\DoxyCodeLine{00334\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1drb__setup__result}{drb\_setup\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}\ =\ handle\_drb\_to\_setup\_item(*\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_setup}});}
\DoxyCodeLine{00335\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.drb\_setup\_results.push\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}});}
\DoxyCodeLine{00336\ \ \ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \textcolor{comment}{//\ >\ DRB\ To\ Modify\ List}}
\DoxyCodeLine{00339\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}\ :\ session.drb\_to\_modify\_list\_ng\_ran)\ \{}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{comment}{//\ prepare\ DRB\ modification\ result}}
\DoxyCodeLine{00341\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1drb__setup__result}{drb\_setup\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}\ =\ \{\};}
\DoxyCodeLine{00342\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}.success\ \ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}.cause\ \ \ \ \ \ \ \ \ \ \ \ =\ cause\_radio\_network\_t::unspecified;}
\DoxyCodeLine{00344\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}.drb\_id\ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.drb\_id;}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{comment}{//\ find\ DRB\ in\ PDU\ session}}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}\ =\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>drbs.find(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.drb\_id);}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}\ ==\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>drbs.end())\ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ logger.log\_warning(\textcolor{stringliteral}{"{}Cannot\ modify\ \{\}\ not\ found\ in\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.drb\_id,\ session.pdu\_session\_id);}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.drb\_setup\_results.push\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}});}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00352\ \ \ \ \ \}}
\DoxyCodeLine{00353\ \ \ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.drb\_id\ ==\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>drb\_id,}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Query\ for\ \{\}\ in\ \{\}\ provided\ \{\}"{}},}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.drb\_id,}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ session.pdu\_session\_id,}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>drb\_id);}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keyword}{auto}\&\ drb\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second;}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_tnl\_info\_required}})\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ f1u\_teid\_allocator.release\_teid(drb-\/>f1u\_ul\_teid))\ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Could\ not\ free\ old\ ul\_teid=\{\}"{}},\ drb-\/>f1u\_ul\_teid);}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{comment}{//\ Allocate\ new\ UL\ TEID\ for\ DRB}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{expected<gtpu\_teid\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}}\ =\ f1u\_teid\_allocator.request\_teid();}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}}.has\_value())\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Could\ not\ allocate\ ul\_teid"{}});}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ drb-\/>f1u\_ul\_teid\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}}.value();}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ UL\ UP\ TNL\ address.}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1up__transport__layer__info}{up\_transport\_layer\_info}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}};}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}}.tp\_address.\mbox{\hyperlink{classsrsran_1_1transport__layer__address_ab9c376f97637dcab75ee6dcf8c238fac}{from\_string}}(net\_config.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_a6d990384dd42314035267c9b21c8efe1}{f1u\_bind\_addr}});}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}}.gtp\_teid\ =\ drb-\/>f1u\_ul\_teid;}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \textcolor{comment}{//\ create\ new\ F1-\/U\ and\ connect\ it.\ This\ will\ automatically\ disconnect\ the\ old\ F1-\/U.}}
\DoxyCodeLine{00379\ \ \ \ \ \ \ drb-\/>f1u\ =\ f1u\_gw.create\_cu\_bearer(}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ ue\_index,\ drb-\/>drb\_id,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}},\ drb-\/>f1u\_to\_pdcp\_adapter,\ drb-\/>f1u\_to\_pdcp\_adapter,\ timers);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>pdcp\_to\_f1u\_adapter.disconnect\_f1u();}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}.gtp\_tunnel\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}};}
\DoxyCodeLine{00384\ \ \ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{comment}{//\ F1-\/U\ apply\ modification}}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.dl\_up\_params.empty())\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1up__transport__layer__info}{up\_transport\_layer\_info}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}};}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}}.tp\_address.\mbox{\hyperlink{classsrsran_1_1transport__layer__address_ab9c376f97637dcab75ee6dcf8c238fac}{from\_string}}(net\_config.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_a6d990384dd42314035267c9b21c8efe1}{f1u\_bind\_addr}});}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}}.gtp\_teid\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>f1u\_ul\_teid;}
\DoxyCodeLine{00391\ \ \ \ \ \ \ f1u\_gw.attach\_dl\_teid(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.dl\_up\_params[0].up\_tnl\_info);}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>pdcp\_to\_f1u\_adapter.connect\_f1u(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>f1u-\/>get\_tx\_sdu\_handler());}
\DoxyCodeLine{00394\ \ \ \ \ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{comment}{//\ Apply\ re-\/establishment\ at\ PDCP}}
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.pdcp\_cfg.has\_value()\ \&\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.pdcp\_cfg-\/>pdcp\_reest.has\_value())\ \{}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{security::sec\_128\_as\_config}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_128}}\ =\ security::truncate\_config(security\_info);}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \textcolor{comment}{//\ reestablish\ tx\ and\ configure\ tx\ security}}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_tx\_ctrl}}\ =\ drb-\/>pdcp-\/>get\_tx\_upper\_control\_interface();}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_tx\_ctrl}}.reestablish(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_128}});}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_tx\_ctrl}}.set\_integrity\_protection(\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>security\_ind.integrity\_protection\_ind\ ==}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ integrity\_protection\_indication\_t::not\_needed}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ security::integrity\_enabled::off}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ security::integrity\_enabled::on);}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_tx\_ctrl}}.set\_ciphering(\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>security\_ind.confidentiality\_protection\_ind\ ==}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ confidentiality\_protection\_indication\_t::not\_needed}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ security::ciphering\_enabled::off}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ security::ciphering\_enabled::on);}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \textcolor{comment}{//\ reestablish\ rx\ and\ configure\ rx\ security}}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_rx\_ctrl}}\ =\ drb-\/>pdcp-\/>get\_rx\_upper\_control\_interface();}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_rx\_ctrl}}.reestablish(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_128}});}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_rx\_ctrl}}.set\_integrity\_protection(\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>security\_ind.integrity\_protection\_ind\ ==}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ integrity\_protection\_indication\_t::not\_needed}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ security::integrity\_enabled::off}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ security::integrity\_enabled::on);}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdcp\_rx\_ctrl}}.set\_ciphering(\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>security\_ind.confidentiality\_protection\_ind\ ==}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ confidentiality\_protection\_indication\_t::not\_needed}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ security::ciphering\_enabled::off}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ security::ciphering\_enabled::on);}
\DoxyCodeLine{00422\ \ \ \ \ \}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Modified\ \{\}.\ \{\}\ f1u\_teid=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.drb\_id,\ session.pdu\_session\_id,\ drb-\/>f1u\_ul\_teid);}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{comment}{//\ Apply\ QoS\ flows}}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{qos\_flow\_info}}\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_mod}}.flow\_map\_info)\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ logger.log\_warning(\textcolor{stringliteral}{"{}Unsupported\ modification\ of\ QoS\ flow\ for\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{qos\_flow\_info}}.qos\_flow\_id);}
\DoxyCodeLine{00430\ \ \ \ \ \}}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{comment}{//\ Add\ result}}
\DoxyCodeLine{00433\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}.success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00434\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.drb\_modification\_results.push\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}});}
\DoxyCodeLine{00435\ \ \ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \textcolor{comment}{//\ >\ DRB\ To\ Remove\ List}}
\DoxyCodeLine{00438\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}}\ :\ session.drb\_to\_rem\_list\_ng\_ran)\ \{}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{comment}{//\ unmap\ all\ QFI\ that\ use\ this\ DRB}}
\DoxyCodeLine{00440\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>sdap-\/>remove\_mapping(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}});}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{comment}{//\ find\ DRB\ in\ PDU\ session}}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}\ =\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>drbs.find(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}});}
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}\ ==\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>drbs.end())\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ logger.log\_warning(\textcolor{stringliteral}{"{}Cannot\ remove\ \{\}.\ DRB\ not\ found\ in\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}},\ session.pdu\_session\_id);}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ \ \ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}}\ ==\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>drb\_id,}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Query\ for\ \{\}\ in\ \{\}\ provided\ different\ drb\_id=\{\}"{}},}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}},}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ session.pdu\_session\_id,}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>drb\_id);}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{comment}{//\ remove\ DRB\ (this\ will\ automatically\ disconnect\ from\ F1-\/U\ gateway)}}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ f1u\_teid\_allocator.release\_teid(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}}-\/>second-\/>f1u\_ul\_teid))\ \{}
\DoxyCodeLine{00456\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}\{\}\ drb\_id=\{\}\ could\ not\ free\ ul\_teid=\{\}"{}},\ session.pdu\_session\_id,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}});}
\DoxyCodeLine{00457\ \ \ \ \ \}}
\DoxyCodeLine{00458\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>drbs.erase(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_iter}});}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Removed\ \{\}\ for\ \{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_rem}},\ session.pdu\_session\_id);}
\DoxyCodeLine{00461\ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00464\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00465\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a340ab9a26ee6779bd78fe338f172880a}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a340ab9a26ee6779bd78fe338f172880a} 
\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}!remove\_pdu\_session@{remove\_pdu\_session}}
\index{remove\_pdu\_session@{remove\_pdu\_session}!srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{remove\_pdu\_session()}{remove\_pdu\_session()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdu\+\_\+session\+\_\+manager\+\_\+impl\+::remove\+\_\+pdu\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_aa153c2df57d799e6d4161dd881ad4df2}{pdu\+\_\+session\+\_\+id\+\_\+t}}}]{pdu\+\_\+session\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__ctrl}{srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+ctrl}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00468\ \{}
\DoxyCodeLine{00469\ \ \ \textcolor{keywordflow}{if}\ (pdu\_sessions.find(pdu\_session\_id)\ ==\ pdu\_sessions.end())\ \{}
\DoxyCodeLine{00470\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}PDU\ session\ \{\}\ not\ found"{}},\ pdu\_session\_id);}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00472\ \ \ \}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \textcolor{comment}{//\ Disconnect\ all\ UL\ tunnels\ for\ this\ PDU\ session.}}
\DoxyCodeLine{00475\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}\ =\ pdu\_sessions.at(pdu\_session\_id);}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ drb\ :\ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session}{pdu\_session}}-\/>drbs)\ \{}
\DoxyCodeLine{00477\ \ \ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}Disconnecting\ CU\ bearer\ with\ UL-\/TEID=\{\}"{}},\ drb.second-\/>f1u\_ul\_teid);}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1up__transport__layer__info}{up\_transport\_layer\_info}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}};}
\DoxyCodeLine{00479\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}}.tp\_address.\mbox{\hyperlink{classsrsran_1_1transport__layer__address_ab9c376f97637dcab75ee6dcf8c238fac}{from\_string}}(net\_config.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_a6d990384dd42314035267c9b21c8efe1}{f1u\_bind\_addr}});}
\DoxyCodeLine{00480\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}}.gtp\_teid\ =\ drb.second-\/>f1u\_ul\_teid;}
\DoxyCodeLine{00481\ \ \ \ \ f1u\_gw.disconnect\_cu\_bearer(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{f1u\_ul\_tunnel\_addr}});}
\DoxyCodeLine{00482\ \ \ \ \ \textcolor{keywordflow}{if}\ (f1u\_teid\_allocator.release\_teid(drb.second-\/>f1u\_ul\_teid))\ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ logger.log\_error(}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\{\}\ could\ not\ remove\ ul\_teid\ at\ session\ termination.\ ul\_teid=\{\}"{}},\ pdu\_session\_id,\ drb.second-\/>f1u\_ul\_teid);}
\DoxyCodeLine{00485\ \ \ \ \ \}}
\DoxyCodeLine{00486\ \ \ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ pdu\_sessions.erase(pdu\_session\_id);}
\DoxyCodeLine{00489\ \ \ logger.log\_info(\textcolor{stringliteral}{"{}Removing\ PDU\ session\ with\ \{\}"{}},\ pdu\_session\_id);}
\DoxyCodeLine{00490\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_abfd69ad11d95578a2dcb8f5cb29c2918}\label{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_abfd69ad11d95578a2dcb8f5cb29c2918} 
\index{srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}!setup\_pdu\_session@{setup\_pdu\_session}}
\index{setup\_pdu\_session@{setup\_pdu\_session}!srsran::srs\_cu\_up::pdu\_session\_manager\_impl@{srsran::srs\_cu\_up::pdu\_session\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{setup\_pdu\_session()}{setup\_pdu\_session()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__setup__result}{pdu\+\_\+session\+\_\+setup\+\_\+result}} pdu\+\_\+session\+\_\+manager\+\_\+impl\+::setup\+\_\+pdu\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1e1ap__pdu__session__res__to__setup__item}{e1ap\+\_\+pdu\+\_\+session\+\_\+res\+\_\+to\+\_\+setup\+\_\+item}} \&}]{session }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__ctrl}{srsran\+::srs\+\_\+cu\+\_\+up\+::pdu\+\_\+session\+\_\+manager\+\_\+ctrl}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00221\ \{}
\DoxyCodeLine{00222\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1pdu__session__setup__result}{pdu\_session\_setup\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}\ =\ \{\};}
\DoxyCodeLine{00223\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.success\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00224\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.pdu\_session\_id\ \ \ \ \ \ \ \ \ \ \ =\ session.pdu\_session\_id;}
\DoxyCodeLine{00225\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.cause\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ cause\_radio\_network\_t::unspecified;}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{if}\ (pdu\_sessions.find(session.pdu\_session\_id)\ !=\ pdu\_sessions.end())\ \{}
\DoxyCodeLine{00228\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}PDU\ Session\ with\ \{\}\ already\ exists"{}},\ session.pdu\_session\_id);}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00230\ \ \ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \textcolor{keywordflow}{if}\ (pdu\_sessions.size()\ >=\ MAX\_NUM\_PDU\_SESSIONS\_PER\_UE)\ \{}
\DoxyCodeLine{00233\ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}PDU\ Session\ for\ \{\}\ cannot\ be\ created.\ Max\ number\ of\ PDU\ sessions\ reached"{}},}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ session.pdu\_session\_id);}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00236\ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ pdu\_sessions.emplace(session.pdu\_session\_id,\ std::make\_unique<pdu\_session>(session,\ gtpu\_rx\_demux));}
\DoxyCodeLine{00239\ \ \ std::unique\_ptr<pdu\_session>\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}\ \ \ \ =\ pdu\_sessions.at(session.pdu\_session\_id);}
\DoxyCodeLine{00240\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ul\_tunnel\_info\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>ul\_tunnel\_info;}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \textcolor{comment}{//\ Get\ uplink\ transport\ address}}
\DoxyCodeLine{00243\ \ \ logger.log\_debug(\textcolor{stringliteral}{"{}PDU\ session\ uplink\ tunnel\ info:\ \{\}\ teid=\{\}\ addr=\{\}"{}},}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ session.pdu\_session\_id,}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ul\_tunnel\_info.gtp\_teid.value(),}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ul\_tunnel\_info.tp\_address);}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \textcolor{comment}{//\ Allocate\ local\ TEID}}
\DoxyCodeLine{00249\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>local\_teid\ =\ \mbox{\hyperlink{classsrsran_1_1srs__cu__up_1_1pdu__session__manager__impl_a20f9ae4a7210aa08a5e95a392935830a}{allocate\_local\_teid}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>pdu\_session\_id);}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \mbox{\hyperlink{structsrsran_1_1up__transport__layer__info}{up\_transport\_layer\_info}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n3\_dl\_tunnel\_addr}};}
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n3\_dl\_tunnel\_addr}}.tp\_address.\mbox{\hyperlink{classsrsran_1_1transport__layer__address_ab9c376f97637dcab75ee6dcf8c238fac}{from\_string}}(net\_config.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_ad265e95392f83decf5bb4a1faa485cba}{n3\_bind\_addr}});}
\DoxyCodeLine{00253\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n3\_dl\_tunnel\_addr}}.gtp\_teid\ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>local\_teid;}
\DoxyCodeLine{00254\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.gtp\_tunnel\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{n3\_dl\_tunnel\_addr}};}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{comment}{//\ Create\ SDAP\ entity}}
\DoxyCodeLine{00257\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1sdap__entity__creation__message}{sdap\_entity\_creation\_message}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdap\_msg}}\ =\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ ue\_index,\ session.pdu\_session\_id,\ ue\_inactivity\_timer,\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>sdap\_to\_gtpu\_adapter\};}
\DoxyCodeLine{00259\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>sdap\ =\ create\_sdap(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sdap\_msg}});}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \textcolor{comment}{//\ Create\ GTPU\ entity}}
\DoxyCodeLine{00262\ \ \ \mbox{\hyperlink{structsrsran_1_1gtpu__tunnel__ngu__creation__message}{gtpu\_tunnel\_ngu\_creation\_message}}\ msg\ =\ \{\};}
\DoxyCodeLine{00263\ \ \ msg.ue\_index\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ue\_index;}
\DoxyCodeLine{00264\ \ \ msg.cfg.tx.peer\_teid\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a5275852c5dfe9b8b517ac9f4989cff7d}{int\_to\_gtpu\_teid}}(ul\_tunnel\_info.gtp\_teid.value());}
\DoxyCodeLine{00265\ \ \ msg.cfg.tx.peer\_addr\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ ul\_tunnel\_info.tp\_address.to\_string();}
\DoxyCodeLine{00266\ \ \ msg.cfg.tx.peer\_port\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ net\_config.\mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1network__interface__config_add2e12b2726834bd16946741e6f9982b}{upf\_port}};}
\DoxyCodeLine{00267\ \ \ msg.cfg.rx.local\_teid\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>local\_teid;}
\DoxyCodeLine{00268\ \ \ msg.cfg.rx.t\_reordering\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ n3\_config.gtpu\_reordering\_timer;}
\DoxyCodeLine{00269\ \ \ msg.rx\_lower\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>gtpu\_to\_sdap\_adapter;}
\DoxyCodeLine{00270\ \ \ msg.tx\_upper\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \&gtpu\_tx\_notifier;}
\DoxyCodeLine{00271\ \ \ msg.gtpu\_pcap\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \&gtpu\_pcap;}
\DoxyCodeLine{00272\ \ \ msg.timers\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ timers;}
\DoxyCodeLine{00273\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>gtpu\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_aae08d0402d9ae1409269532a5b864f48}{create\_gtpu\_tunnel\_ngu}}(msg);}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \textcolor{comment}{//\ Connect\ adapters}}
\DoxyCodeLine{00276\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>sdap\_to\_gtpu\_adapter.connect\_gtpu(*\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>gtpu-\/>get\_tx\_lower\_layer\_interface());}
\DoxyCodeLine{00277\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>gtpu\_to\_sdap\_adapter.connect\_sdap(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>sdap-\/>get\_sdap\_tx\_sdu\_handler());}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \textcolor{comment}{//\ Register\ tunnel\ at\ demux}}
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{if}\ (!gtpu\_rx\_demux.\mbox{\hyperlink{classsrsran_1_1gtpu__demux__ctrl_ab1a8fe7dd6571f829ba587d94202ef63}{add\_tunnel}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>local\_teid,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>gtpu-\/>get\_rx\_upper\_layer\_interface()))\ \{}
\DoxyCodeLine{00281\ \ \ \ \ logger.log\_error(}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PDU\ Session\ \{\}\ cannot\ be\ created.\ TEID\ \{\}\ already\ exists"{}},\ session.pdu\_session\_id,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}}-\/>local\_teid);}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00284\ \ \ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \textcolor{comment}{//\ Handle\ DRB\ setup}}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1e1ap__drb__to__setup__item__ng__ran}{e1ap\_drb\_to\_setup\_item\_ng\_ran}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_setup}}\ :\ session.drb\_to\_setup\_list\_ng\_ran)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1srs__cu__up_1_1drb__setup__result}{drb\_setup\_result}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}}\ =\ handle\_drb\_to\_setup\_item(*\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{new\_session}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_to\_setup}});}
\DoxyCodeLine{00289\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.drb\_setup\_results.push\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{drb\_result}});}
\DoxyCodeLine{00290\ \ \ \}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \textcolor{comment}{//\ Ref:\ TS\ 38.463\ Sec.\ 8.3.1.2:}}
\DoxyCodeLine{00293\ \ \ \textcolor{comment}{//\ For\ each\ PDU\ session\ for\ which\ the\ Security\ Indication\ IE\ is\ included\ in\ the\ PDU\ Session\ Resource\ To\ Setup\ List\ IE}}
\DoxyCodeLine{00294\ \ \ \textcolor{comment}{//\ of\ the\ BEARER\ CONTEXT\ SETUP\ REQUEST\ message,\ and\ the\ Integrity\ Protection\ Indication\ IE\ or\ Confidentiality}}
\DoxyCodeLine{00295\ \ \ \textcolor{comment}{//\ Protection\ Indication\ IE\ is\ set\ to\ "{}preferred"{},\ then\ the\ gNB-\/CU-\/UP\ should,\ if\ supported,\ perform\ user\ plane}}
\DoxyCodeLine{00296\ \ \ \textcolor{comment}{//\ integrity\ protection\ or\ ciphering,\ respectively,\ for\ the\ concerned\ PDU\ session\ and\ shall\ notify\ whether\ it}}
\DoxyCodeLine{00297\ \ \ \textcolor{comment}{//\ performed\ the\ user\ plane\ integrity\ protection\ or\ ciphering\ by\ including\ the\ Integrity\ Protection\ Result\ IE\ or}}
\DoxyCodeLine{00298\ \ \ \textcolor{comment}{//\ Confidentiality\ Protection\ Result\ IE,\ respectively,\ in\ the\ PDU\ Session\ Resource\ Setup\ List\ IE\ of\ the\ BEARER\ CONTEXT}}
\DoxyCodeLine{00299\ \ \ \textcolor{comment}{//\ SETUP\ RESPONSE\ message.}}
\DoxyCodeLine{00300\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a1457adcc871374605b251b4de2e772de}{security\_result\_required}}(session.security\_ind))\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.security\_result\ =\ \mbox{\hyperlink{structsrsran_1_1security__result__t}{security\_result\_t}}\{\};}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_res}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.security\_result.value();}
\DoxyCodeLine{00303\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_res}}.integrity\_protection\_result\ =}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ session.security\_ind.integrity\_protection\_ind\ ==\ integrity\_protection\_indication\_t::not\_needed}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ ?\ integrity\_protection\_result\_t::not\_performed}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ :\ integrity\_protection\_result\_t::performed;}
\DoxyCodeLine{00307\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_res}}.confidentiality\_protection\_result\ =}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ session.security\_ind.confidentiality\_protection\_ind\ ==\ confidentiality\_protection\_indication\_t::not\_needed}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ ?\ confidentiality\_protection\_result\_t::not\_performed}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ :\ confidentiality\_protection\_result\_t::performed;}
\DoxyCodeLine{00311\ \ \ \}}
\DoxyCodeLine{00312\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}}.success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pdu\_session\_result}};}
\DoxyCodeLine{00314\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/cu\+\_\+up/pdu\+\_\+session\+\_\+manager\+\_\+impl.\+h\item 
lib/cu\+\_\+up/pdu\+\_\+session\+\_\+manager\+\_\+impl.\+cpp\end{DoxyCompactItemize}
