\doxysection{srsran\+::task\+\_\+worker\+\_\+pool\texorpdfstring{$<$}{<} Queue\+Policies \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{classsrsran_1_1task__worker__pool}{}\label{classsrsran_1_1task__worker__pool}\index{srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}}


Simple pool of task workers/threads. The workers share the same queue of task and do not perform work-\/stealing.  




{\ttfamily \#include $<$task\+\_\+worker\+\_\+pool.\+h$>$}



Inheritance diagram for srsran\+::task\+\_\+worker\+\_\+pool\texorpdfstring{$<$}{<} Queue\+Policies \texorpdfstring{$>$}{>}\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{de/d56/classsrsran_1_1task__worker__pool__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::task\+\_\+worker\+\_\+pool\texorpdfstring{$<$}{<} Queue\+Policies \texorpdfstring{$>$}{>}\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/dd8/classsrsran_1_1task__worker__pool__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{typename}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Queue\+Sizes}} $>$ }\\\mbox{\hyperlink{classsrsran_1_1task__worker__pool_a4d1345a9af95daddd569120f29726e40}{task\+\_\+worker\+\_\+pool}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\+\_\+workers\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Queue\+Sizes}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{queue\+\_\+sizes}}, std\+::string \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{worker\+\_\+pool\+\_\+name}}, std\+::chrono\+::microseconds wait\+\_\+sleep\+\_\+time=std\+::chrono\+::microseconds\{100\}, \mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority}{os\+\_\+thread\+\_\+realtime\+\_\+priority}} prio=\mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority_af2cf72da038c74badffd988ce6a08e46}{os\+\_\+thread\+\_\+realtime\+\_\+priority\+::no\+\_\+realtime}}(), \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1os__sched__affinity__bitmask}{os\+\_\+sched\+\_\+affinity\+\_\+bitmask}} $>$ cpu\+\_\+masks=\{\})
\begin{DoxyCompactList}\small\item\em Creates a task worker pool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1task__worker__pool_aef62e53b76bc00b46167a620be3e98fe}{stop}} ()
\begin{DoxyCompactList}\small\item\em Stop task worker pool, if running. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1task__worker__pool_a26935bb457ac2f54966f2797b49d9542}{nof\+\_\+pending\+\_\+tasks}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Number of tasks currently enqueued. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1task__worker__pool_a40264d4e39b9df2d1fd8cd55fb72fc1c}{wait\+\_\+pending\+\_\+tasks}} ()
\begin{DoxyCompactList}\small\item\em Wait for all the currently enqueued tasks to complete. If more tasks get enqueued after this function call those tasks are not accounted for in the waiting. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{srsran\+::detail\+::base\+\_\+worker\+\_\+pool}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool_a62c2192382132df84b26c31c3ac06952}{base\+\_\+worker\+\_\+pool}} (\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\+\_\+workers\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::string \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{worker\+\_\+pool\+\_\+name}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::function$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}}()$>$ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{run\+\_\+tasks\+\_\+job}}, \mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority}{os\+\_\+thread\+\_\+realtime\+\_\+priority}} prio=\mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority_af2cf72da038c74badffd988ce6a08e46}{os\+\_\+thread\+\_\+realtime\+\_\+priority\+::no\+\_\+realtime}}(), \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1os__sched__affinity__bitmask}{os\+\_\+sched\+\_\+affinity\+\_\+bitmask}} $>$ cpu\+\_\+masks=\{\})
\item 
{\bfseries base\+\_\+worker\+\_\+pool} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{base\+\_\+worker\+\_\+pool}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
{\bfseries base\+\_\+worker\+\_\+pool} (\mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{base\+\_\+worker\+\_\+pool}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{base\+\_\+worker\+\_\+pool}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{base\+\_\+worker\+\_\+pool}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{base\+\_\+worker\+\_\+pool}} \& {\bfseries operator=} (\mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{base\+\_\+worker\+\_\+pool}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classchar}{char}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool_af1b4a19374e74617208c321dfd5d45e9}{name}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Name given to the pool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool_acfd715e518133fdeca2bb40c9ae6b129}{nof\+\_\+workers}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Number of workers that compose the worker pool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool_a5cf84d9fa36017e95693400624138414}{is\+\_\+in\+\_\+thread\+\_\+pool}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Determines whether the caller is inside the pool. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Public Attributes inherited from \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool}{srsran\+::detail\+::base\+\_\+worker\+\_\+pool}}}
\begin{DoxyCompactItemize}
\item 
std\+::string {\bfseries pool\+\_\+name}
\item 
std\+::vector$<$ \mbox{\hyperlink{classsrsran_1_1unique__thread}{unique\+\_\+thread}} $>$ {\bfseries worker\+\_\+threads}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$concurrent\+\_\+queue\+\_\+policy... Queue\+Policies$>$\newline
class srsran\+::task\+\_\+worker\+\_\+pool$<$ Queue\+Policies $>$}
Simple pool of task workers/threads. The workers share the same queue of task and do not perform work-\/stealing. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1task__worker__pool_a4d1345a9af95daddd569120f29726e40}\label{classsrsran_1_1task__worker__pool_a4d1345a9af95daddd569120f29726e40} 
\index{srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}!task\_worker\_pool@{task\_worker\_pool}}
\index{task\_worker\_pool@{task\_worker\_pool}!srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}}
\doxysubsubsection{\texorpdfstring{task\_worker\_pool()}{task\_worker\_pool()}}
{\footnotesize\ttfamily template$<$concurrent\+\_\+queue\+\_\+policy... Queue\+Policies$>$ \\
template$<$\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{typename}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Queue\+Sizes}} $>$ \\
\mbox{\hyperlink{classsrsran_1_1task__worker__pool}{srsran\+::task\+\_\+worker\+\_\+pool}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Queue\+Policies}} $>$\+::task\+\_\+worker\+\_\+pool (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{nof\+\_\+workers\+\_\+,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Queue\+Sizes}} \&}]{queue\+\_\+sizes,  }\item[{std\+::string}]{worker\+\_\+pool\+\_\+name,  }\item[{std\+::chrono\+::microseconds}]{wait\+\_\+sleep\+\_\+time = {\ttfamily std\+:\+:chrono\+:\+:microseconds\{100\}},  }\item[{\mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority}{os\+\_\+thread\+\_\+realtime\+\_\+priority}}}]{prio = {\ttfamily \mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority_af2cf72da038c74badffd988ce6a08e46}{os\+\_\+thread\+\_\+realtime\+\_\+priority\+::no\+\_\+realtime}}()},  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1os__sched__affinity__bitmask}{os\+\_\+sched\+\_\+affinity\+\_\+bitmask}} $>$}]{cpu\+\_\+masks = {\ttfamily \{\}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Creates a task worker pool. 


\begin{DoxyParams}{Parameters}
{\em nof\+\_\+workers} & Number of workers of the worker pool. \\
\hline
{\em queue\+\_\+size} & Size of the task queue. \\
\hline
{\em pool\+\_\+name} & String with the name for the worker pool. Individual workers of the pool will be assigned the name "{}$<$pool\+\_\+name$>$\#$<$worker index$>$"{}. E.\+g. for pool\+\_\+name="{}\+Pool"{}, the second worker will be called "{}\+Pool\#1"{}. \\
\hline
{\em prio} & Workers realtime thread priority. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{100\},}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\_thread\_realtime\_priority\ \ \ \ \ \ \ \ \ \ \ prio\ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classsrsran_1_1os__thread__realtime__priority_af2cf72da038c74badffd988ce6a08e46}{os\_thread\_realtime\_priority::no\_realtime}}(),}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{span<const\ os\_sched\_affinity\_bitmask>}}\ cpu\_masks\ \ \ \ \ \ \ =\ \{\})\ :}
\DoxyCodeLine{00178\ \ \ \ \ queue\_type(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{queue\_sizes}},\ wait\_sleep\_time),}
\DoxyCodeLine{00179\ \ \ \ \ pool\_type(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_workers\_}},\ std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{worker\_pool\_name}}),\ create\_pop\_loop\_task(),\ prio,\ cpu\_masks)}
\DoxyCodeLine{00180\ \ \ \{}
\DoxyCodeLine{00181\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1task__worker__pool_aef7db3acf245c2070211a983531e73ae}\label{classsrsran_1_1task__worker__pool_aef7db3acf245c2070211a983531e73ae} 
\index{srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}!````~task\_worker\_pool@{\texorpdfstring{$\sim$}{\string~}task\_worker\_pool}}
\index{````~task\_worker\_pool@{\texorpdfstring{$\sim$}{\string~}task\_worker\_pool}!srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}task\_worker\_pool()}{\string~task\_worker\_pool()}}
{\footnotesize\ttfamily template$<$concurrent\+\_\+queue\+\_\+policy... Queue\+Policies$>$ \\
task\+\_\+worker\+\_\+pool\+::\texorpdfstring{$\sim$}{\string~}task\+\_\+worker\+\_\+pool (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00065\ \{}
\DoxyCodeLine{00066\ \ \ \mbox{\hyperlink{classsrsran_1_1task__worker__pool_aef62e53b76bc00b46167a620be3e98fe}{stop}}();}
\DoxyCodeLine{00067\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1task__worker__pool_a26935bb457ac2f54966f2797b49d9542}\label{classsrsran_1_1task__worker__pool_a26935bb457ac2f54966f2797b49d9542} 
\index{srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}!nof\_pending\_tasks@{nof\_pending\_tasks}}
\index{nof\_pending\_tasks@{nof\_pending\_tasks}!srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}}
\doxysubsubsection{\texorpdfstring{nof\_pending\_tasks()}{nof\_pending\_tasks()}}
{\footnotesize\ttfamily template$<$concurrent\+\_\+queue\+\_\+policy... Queue\+Policies$>$ \\
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1task__worker__pool}{srsran\+::task\+\_\+worker\+\_\+pool}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Queue\+Policies}} $>$\+::nof\+\_\+pending\+\_\+tasks (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Number of tasks currently enqueued. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \{\ \textcolor{keywordflow}{return}\ this-\/>pending\_tasks.size();\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1task__worker__pool_aef62e53b76bc00b46167a620be3e98fe}\label{classsrsran_1_1task__worker__pool_aef62e53b76bc00b46167a620be3e98fe} 
\index{srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}!stop@{stop}}
\index{stop@{stop}!srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}}
\doxysubsubsection{\texorpdfstring{stop()}{stop()}}
{\footnotesize\ttfamily template$<$concurrent\+\_\+queue\+\_\+policy... Queue\+Policies$>$ \\
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} task\+\_\+worker\+\_\+pool\+::stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Stop task worker pool, if running. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \{}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordtype}{unsigned}\ count\ =\ 0;}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classsrsran_1_1unique__thread}{unique\_thread}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{w}}\ :\ worker\_threads)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{w}}.running())\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ this-\/>pending\_tasks.request\_stop();}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{w}}.join();}
\DoxyCodeLine{00077\ \ \ \ \ \ \ this-\/>logger.info(\textcolor{stringliteral}{"{}Task\ worker\ \(\backslash\)"{}\{\}\(\backslash\)"{}\ finished."{}},\ worker\_threads[count].get\_name());}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ count++;}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1task__worker__pool_a40264d4e39b9df2d1fd8cd55fb72fc1c}\label{classsrsran_1_1task__worker__pool_a40264d4e39b9df2d1fd8cd55fb72fc1c} 
\index{srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}!wait\_pending\_tasks@{wait\_pending\_tasks}}
\index{wait\_pending\_tasks@{wait\_pending\_tasks}!srsran::task\_worker\_pool$<$ QueuePolicies $>$@{srsran::task\_worker\_pool$<$ QueuePolicies $>$}}
\doxysubsubsection{\texorpdfstring{wait\_pending\_tasks()}{wait\_pending\_tasks()}}
{\footnotesize\ttfamily template$<$concurrent\+\_\+queue\+\_\+policy... Queue\+Policies$>$ \\
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} task\+\_\+worker\+\_\+pool\+::wait\+\_\+pending\+\_\+tasks (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Wait for all the currently enqueued tasks to complete. If more tasks get enqueued after this function call those tasks are not accounted for in the waiting. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00097\ \{}
\DoxyCodeLine{00098\ \ \ std::mutex\ \ \ \ \ \ \ \ \ \ \ \ \ \ mutex;}
\DoxyCodeLine{00099\ \ \ std::condition\_variable\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_all\_sync}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_caller\_return}};}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ Check\ if\ there\ are\ workers\ still\ running.}}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{workers\_running}}\ =\ 0;}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ \mbox{\hyperlink{classsrsran_1_1detail_1_1base__worker__pool_acfd715e518133fdeca2bb40c9ae6b129}{nof\_workers}}();\ ++i)\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{if}\ (worker\_threads[i].running())\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{workers\_running}}++;}
\DoxyCodeLine{00106\ \ \ \ \ \}}
\DoxyCodeLine{00107\ \ \ \}}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{workers\_running}}\ ==\ 0)\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ If\ no\ worker\ is\ running,\ return\ immediately.}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00111\ \ \ \}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \textcolor{comment}{//\ This\ will\ block\ all\ workers\ until\ all\ of\ them\ are\ running\ the\ enqueued\ task.}}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{count\_workers\_not\_sync}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{workers\_running}};}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{counter\_caller}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{workers\_running}};}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{workers\_running}};\ ++i)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ push\_blocking\_prio\_queue\_helper(}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ this-\/>pending\_tasks,\ [\&mutex,\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_all\_sync}},\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_caller\_return}},\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{count\_workers\_not\_sync}},\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{counter\_caller}}]()\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ std::unique\_lock<std::mutex>\ lock(mutex);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Sync\ all\ workers.\ Only\ when\ all\ workers\ are\ in\ sync,\ we\ can\ carry\ on.}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{count\_workers\_not\_sync}}-\/-\/;}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{count\_workers\_not\_sync}}\ >\ 0)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_all\_sync}}.wait(lock,\ [\&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{count\_workers\_not\_sync}}]()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{count\_workers\_not\_sync}}\ ==\ 0;\ \});}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_all\_sync}}.notify\_all();}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ all\ workers\ passed\ the\ condition\ variable,\ we\ can\ notify\ the\ caller.}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/-\/\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{counter\_caller}}\ ==\ 0)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_caller\_return}}.notify\_one();}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00134\ \ \ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \textcolor{comment}{//\ Caller\ blocks\ waiting\ for\ all\ workers\ to\ sync.}}
\DoxyCodeLine{00137\ \ \ std::unique\_lock<std::mutex>\ lock(mutex);}
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cvar\_caller\_return}}.wait(lock,\ [\&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{counter\_caller}}]()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{counter\_caller}}\ ==\ 0;\ \});}
\DoxyCodeLine{00139\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/srsran/support/executors/task\+\_\+worker\+\_\+pool.\+h\item 
lib/support/executors/task\+\_\+worker\+\_\+pool.\+cpp\end{DoxyCompactItemize}
