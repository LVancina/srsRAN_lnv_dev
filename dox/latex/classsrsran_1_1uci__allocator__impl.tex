\doxysection{srsran\+::uci\+\_\+allocator\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1uci__allocator__impl}{}\label{classsrsran_1_1uci__allocator__impl}\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}


Implementation of \doxylink{classsrsran_1_1uci__allocator}{uci\+\_\+allocator} interface.  




{\ttfamily \#include $<$uci\+\_\+allocator\+\_\+impl.\+h$>$}

Inheritance diagram for srsran\+::uci\+\_\+allocator\+\_\+impl\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classsrsran_1_1uci__allocator__impl}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classsrsran_1_1uci__allocator__impl_a016335457f6dd1ad6e81c03f0e603d91}\label{classsrsran_1_1uci__allocator__impl_a016335457f6dd1ad6e81c03f0e603d91} 
{\bfseries uci\+\_\+allocator\+\_\+impl} (\mbox{\hyperlink{classsrsran_1_1pucch__allocator}{pucch\+\_\+allocator}} \&pucch\+\_\+alloc\+\_\+)
\item 
void \mbox{\hyperlink{classsrsran_1_1uci__allocator__impl_a84eb829ee60066ebf2e38f13386e45c8}{slot\+\_\+indication}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} sl\+\_\+tx) override
\begin{DoxyCompactList}\small\item\em Reset the internal counter of the allocated PDSCHs to be acknowledged per slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ \mbox{\hyperlink{structsrsran_1_1uci__allocation}{uci\+\_\+allocation}} $>$ \mbox{\hyperlink{classsrsran_1_1uci__allocator__impl_acd2cfbdf8a259b7a56d61acd258dabc2}{alloc\+\_\+uci\+\_\+harq\+\_\+ue}} (\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&res\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg, unsigned k0, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const uint8\+\_\+t $>$ k1\+\_\+list, const \mbox{\hyperlink{structsrsran_1_1pdcch__dl__information}{pdcch\+\_\+dl\+\_\+information}} \texorpdfstring{$\ast$}{*}fallback\+\_\+dci\+\_\+info=nullptr) override
\item 
void \mbox{\hyperlink{classsrsran_1_1uci__allocator__impl_a4fddfb180ae008720176729b6d33e862}{multiplex\+\_\+uci\+\_\+on\+\_\+pusch}} (\mbox{\hyperlink{structsrsran_1_1ul__sched__info}{ul\+\_\+sched\+\_\+info}} \&pusch\+\_\+grant, \mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&slot\+\_\+alloc, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti) override
\item 
void \mbox{\hyperlink{classsrsran_1_1uci__allocator__impl_adc49dd1f1e934b61b239929608850414}{uci\+\_\+allocate\+\_\+sr\+\_\+opportunity}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&slot\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg) override
\item 
void \mbox{\hyperlink{classsrsran_1_1uci__allocator__impl_a8822e6aa48eadc564e20f040e34e21dd}{uci\+\_\+allocate\+\_\+csi\+\_\+opportunity}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&slot\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg) override
\item 
uint8\+\_\+t \mbox{\hyperlink{classsrsran_1_1uci__allocator__impl_a16dcd0eedda8fe1a34f419b1bec7c2f6}{get\+\_\+scheduled\+\_\+pdsch\+\_\+counter\+\_\+in\+\_\+ue\+\_\+uci}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&slot\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti) override
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of \doxylink{classsrsran_1_1uci__allocator}{uci\+\_\+allocator} interface. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1uci__allocator__impl_acd2cfbdf8a259b7a56d61acd258dabc2}\label{classsrsran_1_1uci__allocator__impl_acd2cfbdf8a259b7a56d61acd258dabc2} 
\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}!alloc\_uci\_harq\_ue@{alloc\_uci\_harq\_ue}}
\index{alloc\_uci\_harq\_ue@{alloc\_uci\_harq\_ue}!srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{alloc\_uci\_harq\_ue()}{alloc\_uci\_harq\_ue()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ \mbox{\hyperlink{structsrsran_1_1uci__allocation}{uci\+\_\+allocation}} $>$ uci\+\_\+allocator\+\_\+impl\+::alloc\+\_\+uci\+\_\+harq\+\_\+ue (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&}]{res\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg,  }\item[{unsigned}]{k0,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ const uint8\+\_\+t $>$}]{k1\+\_\+list,  }\item[{const \mbox{\hyperlink{structsrsran_1_1pdcch__dl__information}{pdcch\+\_\+dl\+\_\+information}} \texorpdfstring{$\ast$}{*}}]{fallback\+\_\+dci\+\_\+info = {\ttfamily nullptr} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocate the common PUCCH resource for HARQ-\/\+ACK for a given UE. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em res\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. For the fallback mode case, this configuration is used to determine whether the slot coincides with a CSI report opportunity; in which case, the allocation of the UCI on common PUCCH resources will be skipped. \\
\hline
\mbox{\texttt{ in}}  & {\em k0} & k0 value, or delay (in slots) of PDSCH slot vs the corresponding PDCCH slot. \\
\hline
\mbox{\texttt{ in}}  & {\em k1\+\_\+list} & List of k1 candidates configured for UE. \\
\hline
\mbox{\texttt{ in}}  & {\em fallback\+\_\+dci\+\_\+info} & pointer to the information with DL DCI, used for scheduling the UCI on common PUCCH resources. If this is not {\ttfamily nullptr}, it triggers the UCI scheduling using common PUCCH resources; else, UCI will be scheduled either on dedicated PUCCH resources or on PUSCH. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1uci__allocator_a674277651ca609ca8e827986589305a3}{srsran\+::uci\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1uci__allocator__impl_a16dcd0eedda8fe1a34f419b1bec7c2f6}\label{classsrsran_1_1uci__allocator__impl_a16dcd0eedda8fe1a34f419b1bec7c2f6} 
\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}!get\_scheduled\_pdsch\_counter\_in\_ue\_uci@{get\_scheduled\_pdsch\_counter\_in\_ue\_uci}}
\index{get\_scheduled\_pdsch\_counter\_in\_ue\_uci@{get\_scheduled\_pdsch\_counter\_in\_ue\_uci}!srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{get\_scheduled\_pdsch\_counter\_in\_ue\_uci()}{get\_scheduled\_pdsch\_counter\_in\_ue\_uci()}}
{\footnotesize\ttfamily uint8\+\_\+t uci\+\_\+allocator\+\_\+impl\+::get\+\_\+scheduled\+\_\+pdsch\+\_\+counter\+\_\+in\+\_\+ue\+\_\+uci (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Get the number of PDSCHs currently scheduled for a given UE UCI. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & C-\/\+RNTI of the UE. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns number of PDSCHs scheduled if UCI allocation if found, 0 otherwise. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1uci__allocator_a9c7a7c379c79a8815d14d4a0daa17435}{srsran\+::uci\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1uci__allocator__impl_a4fddfb180ae008720176729b6d33e862}\label{classsrsran_1_1uci__allocator__impl_a4fddfb180ae008720176729b6d33e862} 
\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}!multiplex\_uci\_on\_pusch@{multiplex\_uci\_on\_pusch}}
\index{multiplex\_uci\_on\_pusch@{multiplex\_uci\_on\_pusch}!srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{multiplex\_uci\_on\_pusch()}{multiplex\_uci\_on\_pusch()}}
{\footnotesize\ttfamily void uci\+\_\+allocator\+\_\+impl\+::multiplex\+\_\+uci\+\_\+on\+\_\+pusch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1ul__sched__info}{ul\+\_\+sched\+\_\+info}} \&}]{pusch\+\_\+grant,  }\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Multiplexes the UCI on PUSCH, by removing the UCI on the PUCCH (if present) and adding it to the PUSCH. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em pusch\+\_\+grant} & struct with PUSCH PDU where UCI need to be allocated. \\
\hline
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & C-\/\+RNTI of the UE. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1uci__allocator_a7dc8ff45c9cfad1a418ce24f2c06d1ff}{srsran\+::uci\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1uci__allocator__impl_a84eb829ee60066ebf2e38f13386e45c8}\label{classsrsran_1_1uci__allocator__impl_a84eb829ee60066ebf2e38f13386e45c8} 
\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}!slot\_indication@{slot\_indication}}
\index{slot\_indication@{slot\_indication}!srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{slot\_indication()}{slot\_indication()}}
{\footnotesize\ttfamily void uci\+\_\+allocator\+\_\+impl\+::slot\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl\+\_\+tx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reset the internal counter of the allocated PDSCHs to be acknowledged per slot. 



Implements \mbox{\hyperlink{classsrsran_1_1uci__allocator_afd4f1ff81475ddc02a6af42623a98e60}{srsran\+::uci\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1uci__allocator__impl_a8822e6aa48eadc564e20f040e34e21dd}\label{classsrsran_1_1uci__allocator__impl_a8822e6aa48eadc564e20f040e34e21dd} 
\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}!uci\_allocate\_csi\_opportunity@{uci\_allocate\_csi\_opportunity}}
\index{uci\_allocate\_csi\_opportunity@{uci\_allocate\_csi\_opportunity}!srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{uci\_allocate\_csi\_opportunity()}{uci\_allocate\_csi\_opportunity()}}
{\footnotesize\ttfamily void uci\+\_\+allocator\+\_\+impl\+::uci\+\_\+allocate\+\_\+csi\+\_\+opportunity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocates the CSI opportunities for a given UE. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & C-\/\+RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1uci__allocator_a0f84d2218d19858514d4c0ae3617006f}{srsran\+::uci\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1uci__allocator__impl_adc49dd1f1e934b61b239929608850414}\label{classsrsran_1_1uci__allocator__impl_adc49dd1f1e934b61b239929608850414} 
\index{srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}!uci\_allocate\_sr\_opportunity@{uci\_allocate\_sr\_opportunity}}
\index{uci\_allocate\_sr\_opportunity@{uci\_allocate\_sr\_opportunity}!srsran::uci\_allocator\_impl@{srsran::uci\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{uci\_allocate\_sr\_opportunity()}{uci\_allocate\_sr\_opportunity()}}
{\footnotesize\ttfamily void uci\+\_\+allocator\+\_\+impl\+::uci\+\_\+allocate\+\_\+sr\+\_\+opportunity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocates the SR opportunities for a given UE. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & C-\/\+RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1uci__allocator_a8988a7267faed735f86e43ddc04c70e8}{srsran\+::uci\+\_\+allocator}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/uci\+\_\+scheduling/uci\+\_\+allocator\+\_\+impl.\+h\item 
lib/scheduler/uci\+\_\+scheduling/uci\+\_\+allocator\+\_\+impl.\+cpp\end{DoxyCompactItemize}
