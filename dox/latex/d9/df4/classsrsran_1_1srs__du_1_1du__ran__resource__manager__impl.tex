\doxysection{srsran\+::srs\+\_\+du\+::du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}\index{srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}}


Inheritance diagram for srsran\+::srs\+\_\+du\+::du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{d1/dad/classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::srs\+\_\+du\+::du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{dc/d9f/classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_acda32ec6ec495e8435c418f97f271910}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1du__cell__config}{du\+\_\+cell\+\_\+config}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\+\_\+cfg\+\_\+list\+\_\+}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1scheduler__expert__config}{scheduler\+\_\+expert\+\_\+config}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scheduler\+\_\+cfg}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::map$<$ srb\+\_\+id\+\_\+t, \mbox{\hyperlink{structsrsran_1_1du__srb__config}{du\+\_\+srb\+\_\+config}} $>$ \&srbs, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::map$<$ \mbox{\hyperlink{namespacesrsran_a861f1531e77730335ec8e75c4b2eec2e}{five\+\_\+qi\+\_\+t}}, \mbox{\hyperlink{structsrsran_1_1du__qos__config}{du\+\_\+qos\+\_\+config}} $>$ \&qos)
\item 
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_adfee043272a1c9d1160a1a0f35dae266}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_adfee043272a1c9d1160a1a0f35dae266} 
{\bfseries du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl} (\mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a5b7eb082e90bcb83836ce33ec1fbd594}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a5b7eb082e90bcb83836ce33ec1fbd594} 
{\bfseries du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_acac6a1f20762298d80f8195fd4500f60}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_acac6a1f20762298d80f8195fd4500f60} 
\mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} \& {\bfseries operator=} (\mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a412dffeff1a96a8c441b1343f53e3a58}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a412dffeff1a96a8c441b1343f53e3a58} 
\mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl}{du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\item 
\mbox{\hyperlink{classsrsran_1_1srs__du_1_1ue__ran__resource__configurator}{ue\+\_\+ran\+\_\+resource\+\_\+configurator}} \mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a62b878e0f0eeb58885e2d1a4d527aaea}{create\+\_\+ue\+\_\+resource\+\_\+configurator}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}} pcell\+\_\+index) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Create a new UE resource allocation config object. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1srs__du_1_1du__ue__resource__update__response}{du\+\_\+ue\+\_\+resource\+\_\+update\+\_\+response}} \mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a8b0e464b27b9603b8d21851d6b76dd94}{update\+\_\+context}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index, \mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}} pcell\+\_\+idx, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__du_1_1f1ap__ue__context__update__request}{f1ap\+\_\+ue\+\_\+context\+\_\+update\+\_\+request}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\+\_\+req}})
\begin{DoxyCompactList}\small\item\em Updates a UE\textquotesingle{}s cell configuration context based on the F1 UE Context Update request. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a5402c828fd4b763244b489a325c9d767}{deallocate\+\_\+context}} (\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}} ue\+\_\+index)
\begin{DoxyCompactList}\small\item\em Deallocates the RAN resources taken by the UE, so that they can be used by future UEs. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_acda32ec6ec495e8435c418f97f271910}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_acda32ec6ec495e8435c418f97f271910} 
\index{srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}!du\_ran\_resource\_manager\_impl@{du\_ran\_resource\_manager\_impl}}
\index{du\_ran\_resource\_manager\_impl@{du\_ran\_resource\_manager\_impl}!srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{du\_ran\_resource\_manager\_impl()}{du\_ran\_resource\_manager\_impl()}}
{\footnotesize\ttfamily du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl\+::du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1du__cell__config}{du\+\_\+cell\+\_\+config}} $>$}]{cell\+\_\+cfg\+\_\+list\+\_\+,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1scheduler__expert__config}{scheduler\+\_\+expert\+\_\+config}} \&}]{scheduler\+\_\+cfg,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::map$<$ srb\+\_\+id\+\_\+t, \mbox{\hyperlink{structsrsran_1_1du__srb__config}{du\+\_\+srb\+\_\+config}} $>$ \&}]{srbs,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::map$<$ \mbox{\hyperlink{namespacesrsran_a861f1531e77730335ec8e75c4b2eec2e}{five\+\_\+qi\+\_\+t}}, \mbox{\hyperlink{structsrsran_1_1du__qos__config}{du\+\_\+qos\+\_\+config}} $>$ \&}]{qos }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00082\ \ \ cell\_cfg\_list(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_cfg\_list\_}}),}
\DoxyCodeLine{00083\ \ \ sched\_cfg(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scheduler\_cfg}}),}
\DoxyCodeLine{00084\ \ \ srb\_config(srbs\_),}
\DoxyCodeLine{00085\ \ \ qos\_config(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{qos\_}}),}
\DoxyCodeLine{00086\ \ \ logger(srslog::fetch\_basic\_logger(\textcolor{stringliteral}{"{}DU-\/MNG"{}})),}
\DoxyCodeLine{00087\ \ \ pucch\_res\_mng(cell\_cfg\_list,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scheduler\_cfg}}.ue.max\_pucchs\_per\_slot)}
\DoxyCodeLine{00088\ \{}
\DoxyCodeLine{00089\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a62b878e0f0eeb58885e2d1a4d527aaea}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a62b878e0f0eeb58885e2d1a4d527aaea} 
\index{srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}!create\_ue\_resource\_configurator@{create\_ue\_resource\_configurator}}
\index{create\_ue\_resource\_configurator@{create\_ue\_resource\_configurator}!srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{create\_ue\_resource\_configurator()}{create\_ue\_resource\_configurator()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1srs__du_1_1ue__ran__resource__configurator}{ue\+\_\+ran\+\_\+resource\+\_\+configurator}} du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl\+::create\+\_\+ue\+\_\+resource\+\_\+configurator (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}}}]{pcell\+\_\+index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Create a new UE resource allocation config object. 



Implements \mbox{\hyperlink{classsrsran_1_1srs__du_1_1du__ran__resource__manager_aef49ed481e6d809305e29a7abe082045}{srsran\+::srs\+\_\+du\+::du\+\_\+ran\+\_\+resource\+\_\+manager}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00093\ \{}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{if}\ (ue\_res\_pool.contains(ue\_index))\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1srs__du_1_1ue__ran__resource__configurator}{ue\_ran\_resource\_configurator}}\{std::unique\_ptr<du\_ue\_ran\_resource\_updater\_impl>\{\textcolor{keyword}{nullptr}\},}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::string(\textcolor{stringliteral}{"{}Double\ allocation\ of\ same\ not\ supported"{}})\};}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ \ \ ue\_res\_pool.\mbox{\hyperlink{classsrsran_1_1slotted__array_acda4b221c7a9c1007a22571e63bc011f}{emplace}}(ue\_index);}
\DoxyCodeLine{00099\ \ \ \textcolor{keyword}{auto}\&\ mcg\ =\ ue\_res\_pool[ue\_index].cg\_cfg;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ UE\ initialized\ PCell.}}
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{error\_type<std::string>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{err}}\ =\ allocate\_cell\_resources(ue\_index,\ pcell\_index,\ SERVING\_CELL\_PCELL\_IDX);}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{err}}.is\_error())\ \{}
\DoxyCodeLine{00104\ \ \ \ \ ue\_res\_pool.\mbox{\hyperlink{classsrsran_1_1slotted__array_a695ef685e019be3e504ccf03686b4fe0}{erase}}(ue\_index);}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1srs__du_1_1ue__ran__resource__configurator}{ue\_ran\_resource\_configurator}}\{std::unique\_ptr<du\_ue\_ran\_resource\_updater\_impl>\{\textcolor{keyword}{nullptr}\},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{err}}.error()\};}
\DoxyCodeLine{00106\ \ \ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsrsran_1_1srs__du_1_1ue__ran__resource__configurator}{ue\_ran\_resource\_configurator}}\{std::make\_unique<du\_ue\_ran\_resource\_updater\_impl>(\&mcg,\ *\textcolor{keyword}{this},\ ue\_index)\};}
\DoxyCodeLine{00109\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a5402c828fd4b763244b489a325c9d767}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a5402c828fd4b763244b489a325c9d767} 
\index{srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}!deallocate\_context@{deallocate\_context}}
\index{deallocate\_context@{deallocate\_context}!srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{deallocate\_context()}{deallocate\_context()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl\+::deallocate\+\_\+context (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index }\end{DoxyParamCaption})}



Deallocates the RAN resources taken by the UE, so that they can be used by future UEs. 


\begin{DoxyParams}{Parameters}
{\em ue\+\_\+index} & Id of the UE whose context is being deallocated. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00224\ \{}
\DoxyCodeLine{00225\ \ \ srsran\_assert(ue\_res\_pool.contains(ue\_index),\ \textcolor{stringliteral}{"{}This\ function\ should\ only\ be\ called\ for\ an\ already\ allocated\ UE"{}});}
\DoxyCodeLine{00226\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1cell__group__config}{cell\_group\_config}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}\ =\ ue\_res\_pool[ue\_index].cg\_cfg;}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ sc\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ deallocate\_cell\_resources(ue\_index,\ sc.serv\_cell\_idx);}
\DoxyCodeLine{00230\ \ \ \}}
\DoxyCodeLine{00231\ \ \ ue\_res\_pool.\mbox{\hyperlink{classsrsran_1_1slotted__array_a695ef685e019be3e504ccf03686b4fe0}{erase}}(ue\_index);}
\DoxyCodeLine{00232\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a8b0e464b27b9603b8d21851d6b76dd94}\label{classsrsran_1_1srs__du_1_1du__ran__resource__manager__impl_a8b0e464b27b9603b8d21851d6b76dd94} 
\index{srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}!update\_context@{update\_context}}
\index{update\_context@{update\_context}!srsran::srs\_du::du\_ran\_resource\_manager\_impl@{srsran::srs\_du::du\_ran\_resource\_manager\_impl}}
\doxysubsubsection{\texorpdfstring{update\_context()}{update\_context()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1srs__du_1_1du__ue__resource__update__response}{du\+\_\+ue\+\_\+resource\+\_\+update\+\_\+response}} du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl\+::update\+\_\+context (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\+\_\+ue\+\_\+index\+\_\+t}}}]{ue\+\_\+index,  }\item[{\mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}}}]{pcell\+\_\+idx,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1srs__du_1_1f1ap__ue__context__update__request}{f1ap\+\_\+ue\+\_\+context\+\_\+update\+\_\+request}} \&}]{upd\+\_\+req }\end{DoxyParamCaption})}



Updates a UE\textquotesingle{}s cell configuration context based on the F1 UE Context Update request. 

UE Context updates may include the addition of new bearers, reservation of PUCCH Resources for Scheduling Requests or CSI, etc. 
\begin{DoxyParams}{Parameters}
{\em ue\+\_\+index} & Id of the UE whose context is being updated. \\
\hline
{\em pcell\+\_\+idx} & DU Cell Id of the UE\textquotesingle{}s PCell. \\
\hline
{\em upd\+\_\+req} & UE Context Update Request received by the F1\+AP-\/\+DU from the CU. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Result of the context update. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00115\ \{}
\DoxyCodeLine{00116\ \ \ srsran\_assert(ue\_res\_pool.contains(ue\_index),\ \textcolor{stringliteral}{"{}This\ function\ should\ only\ be\ called\ for\ an\ already\ allocated\ UE"{}});}
\DoxyCodeLine{00117\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1cell__group__config}{cell\_group\_config}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}\ =\ ue\_res\_pool[ue\_index].cg\_cfg;}
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1du__ue__resource__update__response}{du\_ue\_resource\_update\_response}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{comment}{//\ >\ Deallocate\ resources\ for\ previously\ configured\ cells\ that\ have\ now\ been\ removed\ or\ changed.}}
\DoxyCodeLine{00121\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells.contains(0)\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells[0].serv\_cell\_cfg.cell\_index\ !=\ pcell\_idx)\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//\ >>\ PCell\ changed.\ Deallocate\ PCell\ resources.}}
\DoxyCodeLine{00123\ \ \ \ \ deallocate\_cell\_resources(ue\_index,\ SERVING\_CELL\_PCELL\_IDX);}
\DoxyCodeLine{00124\ \ \ \}}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespacesrsran_a0e38faee3cd11ebe7e627b932e62d901}{serv\_cell\_index\_t}}\ scell\_idx\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\_req}}.scells\_to\_rem)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{//\ >>\ SCells\ to\ be\ removed.\ Deallocate\ them.}}
\DoxyCodeLine{00127\ \ \ \ \ deallocate\_cell\_resources(ue\_index,\ scell\_idx);}
\DoxyCodeLine{00128\ \ \ \}}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1f1ap__scell__to__setup}{f1ap\_scell\_to\_setup}}\&\ scell\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\_req}}.scells\_to\_setup)\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ >>\ If\ SCells\ to\ be\ modified\ changed\ DU\ Cell\ Index.}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells.contains(scell.serv\_cell\_index)\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells[scell.serv\_cell\_index].serv\_cell\_cfg.cell\_index\ !=\ scell.cell\_index)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ deallocate\_cell\_resources(ue\_index,\ scell.serv\_cell\_index);}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{comment}{//\ >\ Deallocate\ removed\ SRBs\ /\ DRBs.}}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{for}\ (drb\_id\_t\ drb\_id\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\_req}}.drbs\_to\_rem)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{auto}\ it\ =\ std::find\_if(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.begin(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.end(),\ [drb\_id](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1rlc__bearer__config}{rlc\_bearer\_config}}\&\ b)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ return\ b.drb\_id\ ==\ drb\_id;}
\DoxyCodeLine{00141\ \ \ \ \ \});}
\DoxyCodeLine{00142\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.erase(it);}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{comment}{//\ >\ Allocate\ new\ or\ modified\ bearers.}}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{for}\ (srb\_id\_t\ srb\_id\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\_req}}.srbs\_to\_setup)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ >>\ New\ or\ Modified\ SRB.}}
\DoxyCodeLine{00148\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a9fb768b4a14baadb9295634bcaf010bc}{lcid\_t}}\ lcid\ =\ \mbox{\hyperlink{namespacesrsran_aee36e9fff1d8753f935b45128aea2b5e}{srb\_id\_to\_lcid}}(srb\_id);}
\DoxyCodeLine{00149\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.emplace\_back();}
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().lcid\ =\ lcid;}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{srb\_it}}\ =\ srb\_config.find(srb\_id);}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{srb\_it}}\ !=\ srb\_config.end())\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().rlc\_cfg\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{srb\_it}}-\/>second.rlc;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().mac\_cfg\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{srb\_it}}-\/>second.mac;}
\DoxyCodeLine{00156\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().rlc\_cfg\ =\ \mbox{\hyperlink{namespacesrsran_a4d0a3726898cfc48c68577bb2ae6adf4}{make\_default\_srb\_rlc\_config}}();}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().mac\_cfg\ =\ \mbox{\hyperlink{namespacesrsran_ad7c2c69553e836c535002dd29180c487}{make\_default\_srb\_mac\_lc\_config}}(lcid);}
\DoxyCodeLine{00159\ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \}}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1f1ap__drb__to__setup}{f1ap\_drb\_to\_setup}}\&\ drb\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\_req}}.drbs\_to\_setup)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{//\ >>\ New\ or\ Modified\ DRB.}}
\DoxyCodeLine{00163\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a9fb768b4a14baadb9295634bcaf010bc}{lcid\_t}}\ lcid;}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{if}\ (drb.lcid.has\_value())\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{comment}{//\ >>\ CU-\/assigned\ LCID.}}
\DoxyCodeLine{00166\ \ \ \ \ \ \ lcid\ =\ *drb.lcid;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::any\_of(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.begin(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.end(),\ [\&drb](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ item)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ return\ *drb.lcid\ ==\ item.lcid;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \}))\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Failed\ to\ allocate\ \{\}.\ Cause:\ Specified\ lcid=\{\}\ already\ exists"{}},\ drb.drb\_id,\ lcid);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}}.failed\_drbs.push\_back(drb.drb\_id);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \textcolor{comment}{//\ >>\ Allocate\ LCID\ if\ not\ specified\ by\ F1AP.}}
\DoxyCodeLine{00176\ \ \ \ \ \ \ lcid\ =\ find\_empty\_lcid(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers);}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lcid\ >\ LCID\_MAX\_DRB)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Failed\ to\ allocate\ \{\}.\ Cause:\ No\ available\ LCIDs"{}},\ drb.drb\_id);}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}}.failed\_drbs.push\_back(drb.drb\_id);}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{//\ >>\ Get\ RLC\ config\ from\ 5QI}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{if}\ (qos\_config.find(drb.five\_qi)\ ==\ qos\_config.end())\ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Failed\ to\ allocate\ \{\}.\ Cause:\ No\ \{\}\ configured"{}},\ drb.drb\_id,\ drb.five\_qi);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}}.failed\_drbs.push\_back(drb.drb\_id);}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00189\ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Getting\ RLC\ and\ MAC\ config\ for\ \{\}\ from\ \{\}"{}},\ drb.drb\_id,\ drb.five\_qi);}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1du__qos__config}{du\_qos\_config}}\&\ qos\ =\ qos\_config.at(drb.five\_qi);}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.emplace\_back();}
\DoxyCodeLine{00194\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().lcid\ \ \ \ =\ lcid;}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().drb\_id\ \ =\ drb.drb\_id;}
\DoxyCodeLine{00196\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().rlc\_cfg\ =\ qos.rlc;}
\DoxyCodeLine{00197\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.back().mac\_cfg\ =\ qos.mac;}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ \ \ \textcolor{comment}{//\ >>\ Sort\ by\ LCID.}}
\DoxyCodeLine{00200\ \ \ std::sort(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.begin(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.rlc\_bearers.end(),\ [](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lhs}},\ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rhs}})\ \{}
\DoxyCodeLine{00201\ \ \ \ \ return\ lhs.lcid\ <\ rhs.lcid;}
\DoxyCodeLine{00202\ \ \ \});}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \textcolor{comment}{//\ >\ Allocate\ resources\ for\ new\ or\ modified\ cells.}}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells.contains(0)\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_mcg}}.cells[0].serv\_cell\_cfg.cell\_index\ !=\ pcell\_idx)\ \{}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{//\ >>\ PCell\ changed.\ Allocate\ new\ PCell\ resources.}}
\DoxyCodeLine{00207\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1expected}{error\_type<std::string>}}\ outcome\ =\ allocate\_cell\_resources(ue\_index,\ pcell\_idx,\ SERVING\_CELL\_PCELL\_IDX);}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{if}\ (outcome.is\_error())\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}}.procedure\_error\ =\ outcome;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}};}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \}}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1srs__du_1_1f1ap__scell__to__setup}{f1ap\_scell\_to\_setup}}\&\ sc\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upd\_req}}.scells\_to\_setup)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{comment}{//\ >>\ SCells\ Added/Modified.\ Allocate\ new\ SCell\ resources.}}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{if}\ (allocate\_cell\_resources(ue\_index,\ sc.cell\_index,\ sc.serv\_cell\_index).is\_error())\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}}.failed\_scells.push\_back(sc.serv\_cell\_index);}
\DoxyCodeLine{00217\ \ \ \ \ \}}
\DoxyCodeLine{00218\ \ \ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{resp}};}
\DoxyCodeLine{00221\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/du\+\_\+manager/ran\+\_\+resource\+\_\+management/du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl.\+h\item 
lib/du\+\_\+manager/ran\+\_\+resource\+\_\+management/du\+\_\+ran\+\_\+resource\+\_\+manager\+\_\+impl.\+cpp\end{DoxyCompactItemize}
