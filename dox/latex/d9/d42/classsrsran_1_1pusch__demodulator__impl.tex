\doxysection{srsran\+::pusch\+\_\+demodulator\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1pusch__demodulator__impl}{}\label{classsrsran_1_1pusch__demodulator__impl}\index{srsran::pusch\_demodulator\_impl@{srsran::pusch\_demodulator\_impl}}


PUSCH demodulator implementation.  




{\ttfamily \#include $<$pusch\+\_\+demodulator\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::pusch\+\_\+demodulator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{dc/d65/classsrsran_1_1pusch__demodulator__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::pusch\+\_\+demodulator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{da/d18/classsrsran_1_1pusch__demodulator__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1pusch__demodulator__impl_ae6da95fbf53307356f69447236263644}{pusch\+\_\+demodulator\+\_\+impl}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1channel__equalizer}{channel\+\_\+equalizer}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{equalizer\+\_\+}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1demodulation__mapper}{demodulation\+\_\+mapper}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demapper\+\_\+}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1evm__calculator}{evm\+\_\+calculator}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\+\_\+calc\+\_\+}}, std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator}{pseudo\+\_\+random\+\_\+generator}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{descrambler\+\_\+}}, \mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{compute\+\_\+post\+\_\+eq\+\_\+sinr\+\_\+}})
\begin{DoxyCompactList}\small\item\em Constructor\+: sets up internal components and acquires their ownership. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pusch__demodulator__impl_ae08511160b83699f3290babdf26d3987}{demodulate}} (\mbox{\hyperlink{classsrsran_1_1pusch__codeword__buffer}{pusch\+\_\+codeword\+\_\+buffer}} \&data, \mbox{\hyperlink{classsrsran_1_1pusch__demodulator__notifier}{pusch\+\_\+demodulator\+\_\+notifier}} \&notifier, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1resource__grid__reader}{resource\+\_\+grid\+\_\+reader}} \&grid, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1channel__estimate}{channel\+\_\+estimate}} \&estimates, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pusch__demodulator_1_1configuration}{configuration}} \&config) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Demodulates a PUSCH transmission. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pusch__demodulator}{srsran\+::pusch\+\_\+demodulator}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}pusch\+\_\+demodulator} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
PUSCH demodulator implementation. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1pusch__demodulator__impl_ae6da95fbf53307356f69447236263644}\label{classsrsran_1_1pusch__demodulator__impl_ae6da95fbf53307356f69447236263644} 
\index{srsran::pusch\_demodulator\_impl@{srsran::pusch\_demodulator\_impl}!pusch\_demodulator\_impl@{pusch\_demodulator\_impl}}
\index{pusch\_demodulator\_impl@{pusch\_demodulator\_impl}!srsran::pusch\_demodulator\_impl@{srsran::pusch\_demodulator\_impl}}
\doxysubsubsection{\texorpdfstring{pusch\_demodulator\_impl()}{pusch\_demodulator\_impl()}}
{\footnotesize\ttfamily srsran\+::pusch\+\_\+demodulator\+\_\+impl\+::pusch\+\_\+demodulator\+\_\+impl (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1channel__equalizer}{channel\+\_\+equalizer}} $>$}]{equalizer\+\_\+,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1demodulation__mapper}{demodulation\+\_\+mapper}} $>$}]{demapper\+\_\+,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1evm__calculator}{evm\+\_\+calculator}} $>$}]{evm\+\_\+calc\+\_\+,  }\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator}{pseudo\+\_\+random\+\_\+generator}} $>$}]{descrambler\+\_\+,  }\item[{\mbox{\hyperlink{classbool}{bool}}}]{compute\+\_\+post\+\_\+eq\+\_\+sinr\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor\+: sets up internal components and acquires their ownership. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00048\ \ \ \ \ equalizer(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{equalizer\_}})),}
\DoxyCodeLine{00049\ \ \ \ \ demapper(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{demapper\_}})),}
\DoxyCodeLine{00050\ \ \ \ \ evm\_calc(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_calc\_}})),}
\DoxyCodeLine{00051\ \ \ \ \ descrambler(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{descrambler\_}})),}
\DoxyCodeLine{00052\ \ \ \ \ ch\_re(\{MAX\_BLOCK\_SIZE,\ 1\}),}
\DoxyCodeLine{00053\ \ \ \ \ eq\_re(\{MAX\_BLOCK\_SIZE,\ 1\}),}
\DoxyCodeLine{00054\ \ \ \ \ eq\_noise\_vars(\{MAX\_BLOCK\_SIZE,\ 1\}),}
\DoxyCodeLine{00055\ \ \ \ \ ch\_estimates(\{MAX\_BLOCK\_SIZE,\ 1,\ 1\}),}
\DoxyCodeLine{00056\ \ \ \ \ compute\_post\_eq\_sinr(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{compute\_post\_eq\_sinr\_}})}
\DoxyCodeLine{00057\ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ srsran\_assert(equalizer,\ \textcolor{stringliteral}{"{}Invalid\ pointer\ to\ channel\_equalizer\ object."{}});}
\DoxyCodeLine{00059\ \ \ \ \ srsran\_assert(demapper,\ \textcolor{stringliteral}{"{}Invalid\ pointer\ to\ demodulation\_mapper\ object."{}});}
\DoxyCodeLine{00060\ \ \ \ \ srsran\_assert(descrambler,\ \textcolor{stringliteral}{"{}Invalid\ pointer\ to\ pseudo\_random\_generator\ object."{}});}
\DoxyCodeLine{00061\ \ \ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{d9/d42/classsrsran_1_1pusch__demodulator__impl_ae6da95fbf53307356f69447236263644_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{d9/d42/classsrsran_1_1pusch__demodulator__impl_ae6da95fbf53307356f69447236263644_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1pusch__demodulator__impl_ae08511160b83699f3290babdf26d3987}\label{classsrsran_1_1pusch__demodulator__impl_ae08511160b83699f3290babdf26d3987} 
\index{srsran::pusch\_demodulator\_impl@{srsran::pusch\_demodulator\_impl}!demodulate@{demodulate}}
\index{demodulate@{demodulate}!srsran::pusch\_demodulator\_impl@{srsran::pusch\_demodulator\_impl}}
\doxysubsubsection{\texorpdfstring{demodulate()}{demodulate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pusch\+\_\+demodulator\+\_\+impl\+::demodulate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1pusch__codeword__buffer}{pusch\+\_\+codeword\+\_\+buffer}} \&}]{codeword\+\_\+buffer,  }\item[{\mbox{\hyperlink{classsrsran_1_1pusch__demodulator__notifier}{pusch\+\_\+demodulator\+\_\+notifier}} \&}]{notifier,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1resource__grid__reader}{resource\+\_\+grid\+\_\+reader}} \&}]{grid,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1channel__estimate}{channel\+\_\+estimate}} \&}]{estimates,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pusch__demodulator_1_1configuration}{configuration}} \&}]{config }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Demodulates a PUSCH transmission. 

Computes log-\/likelihood ratios from channel samples by reversing all the operations described in TS38.\+211 Section 6.\+3.\+1.

\begin{DoxyRemark}{Remarks}

\begin{DoxyItemize}
\item The size of {\ttfamily data} determines the codeword size in soft bits.
\item The total number of LLR must be consistent with the number of RE allocated to the transmission.
\end{DoxyItemize}
\end{DoxyRemark}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em codeword\+\_\+buffer} & Codeword buffer. \\
\hline
\mbox{\texttt{ in}}  & {\em notifier} & Demodulation statistics notifier. \\
\hline
\mbox{\texttt{ in}}  & {\em grid} & Resource grid for the current slot. \\
\hline
\mbox{\texttt{ in}}  & {\em estimates} & Channel estimates for the REs allocated to the PUSCH transmission. \\
\hline
\mbox{\texttt{ in}}  & {\em config} & Configuration parameters. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pusch__demodulator_afafb9bb556d8858b86138d82e233a209}{srsran\+::pusch\+\_\+demodulator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00134\ \{}
\DoxyCodeLine{00135\ \ \ \textcolor{comment}{//\ Number\ of\ receive\ antenna\ ports.}}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_rx\_ports\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(config.rx\_ports.size());}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \textcolor{comment}{//\ Initialise\ sequence.}}
\DoxyCodeLine{00139\ \ \ \textcolor{keywordtype}{unsigned}\ c\_init\ =\ config.rnti\ *\ \mbox{\hyperlink{namespacesrsran_a643a31fe220053ca684e67ba6c6aadf2}{pow2}}(15)\ +\ config.n\_id;}
\DoxyCodeLine{00140\ \ \ descrambler-\/>init(c\_init);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{comment}{//\ Prepare\ PRB\ active\ RE\ mask.}}
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{classsrsran_1_1re__prb__mask}{re\_prb\_mask}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{active\_re\_per\_prb}}\ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\string~re\_prb\_mask}}();}
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{classsrsran_1_1re__prb__mask}{re\_prb\_mask}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{active\_re\_per\_prb\_dmrs}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\string~config}}.dmrs\_config\_type.get\_dmrs\_prb\_mask(config.nof\_cdm\_groups\_without\_data);}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \textcolor{comment}{//\ Prepare\ RE\ mask.}}
\DoxyCodeLine{00147\ \ \ re\_symbol\_mask\_type\ re\_mask\ \ \ \ \ \ =\ config.rb\_mask.kronecker\_product<NRE>(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{active\_re\_per\_prb}});}
\DoxyCodeLine{00148\ \ \ re\_symbol\_mask\_type\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{re\_mask\_dmrs}}\ =\ config.rb\_mask.kronecker\_product<NRE>(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{active\_re\_per\_prb\_dmrs}});}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ bits\ per\ RE\ and\ port.}}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_bits\_per\_re\ =\ config.nof\_tx\_layers\ *\ \mbox{\hyperlink{namespacesrsran_af78ee928d6d8a3d8ff6bbc753f50c44e}{get\_bits\_per\_symbol}}(config.modulation);}
\DoxyCodeLine{00152\ \ \ srsran\_assert(nof\_bits\_per\_re\ >\ 0,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ combination\ of\ transmit\ layers\ (i.e.,\ \{\})\ and\ modulation\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.nof\_tx\_layers,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a5fa5b607b51bce906141a06d7ecdebbf}{to\_string}}(config.modulation));}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ Stats\ accumulators.}}
\DoxyCodeLine{00158\ \ \ \mbox{\hyperlink{structsrsran_1_1pusch__demodulator__notifier_1_1demodulation__stats}{pusch\_demodulator\_notifier::demodulation\_stats}}\ stats;}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_symbol\_count}}\ \ \ \ \ =\ 0;}
\DoxyCodeLine{00160\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sinr\_softbit\_count}}\ \ \ =\ 0;}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{noise\_var\_accumulate}}\ =\ 0.0;}
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{float}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_accumulate}}\ \ \ \ \ \ \ =\ 0.0;}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ =\ config.start\_symbol\_index,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_end}}\ =\ config.start\_symbol\_index\ +\ config.nof\_symbols;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_end}};}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}})\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{comment}{//\ Select\ RE\ mask\ for\ the\ symbol.}}
\DoxyCodeLine{00168\ \ \ \ \ re\_symbol\_mask\_type\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}\ =\ config.dmrs\_symb\_pos.test(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}})\ ?\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{re\_mask\_dmrs}}\ :\ re\_mask;}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{comment}{//\ Skip\ symbol\ if\ it\ does\ not\ contain\ data.}}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}.none())\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ Process\ subcarriers\ in\ groups.}}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}.find\_lowest(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc\_end}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}.find\_highest()\ +\ 1;}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc\_end}};)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ remainder\ number\ of\ subcarriers\ to\ process\ for\ the\ current\ OFDM\ symbol.}}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc\_end}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}};}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{comment}{//\ Limit\ number\ of\ RE\ to\ the\ maximum\ block\ size.}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}}\ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}},\ MAX\_BLOCK\_SIZE\ /\ nof\_bits\_per\_re);}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ a\ view\ of\ the\ codeword\ buffer\ destination.}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<log\_likelihood\_ratio>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_block}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_buffer}}.get\_next\_block\_view(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}}\ *\ nof\_bits\_per\_re);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ codeword\ is\ empty,\ skip\ the\ rest\ of\ the\ symbol.}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_block}}.empty())\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_remainder\_re}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}.slice(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}.size()).count();}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_remainder\_re}}\ ==\ 0,\ \textcolor{stringliteral}{"{}There\ are\ \{\}\ remaining\ RE."{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_remainder\_re}});}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \textcolor{comment}{//\ Limit\ block\ size\ if\ the\ codeword\ block\ is\ smaller.}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_block}}.size()\ \%\ nof\_bits\_per\_re\ ==\ 0,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ codeword\ block\ size\ (i.e.,\ \{\})\ must\ be\ multiple\ of\ the\ number\ of\ bits\ per\ RE\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_block}}.size(),}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nof\_bits\_per\_re);}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}}\ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}},\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_block}}.size())\ /\ nof\_bits\_per\_re);}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ mask\ for\ the\ block.}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ re\_symbol\_mask\_type\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_re\_mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_re\_mask}}.\mbox{\hyperlink{classsrsran_1_1bounded__bitset_afe1a0207f2e64504dfe8df1d6d7c163b}{slice}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}});}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{comment}{//\ Number\ of\ data\ Resource\ Elements\ in\ a\ slot\ for\ a\ single\ Rx\ port.}}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}}\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_re\_mask}}.count());}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ block\ if\ no\ data.}}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}}\ ==\ 0)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}};}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \textcolor{comment}{//\ Resize\ equalizer\ input\ buffers.}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ ch\_re.\mbox{\hyperlink{classsrsran_1_1dynamic__tensor_ae3e54a1f77b2ec66b9bd75ca28ad87df}{resize}}(\{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}},\ nof\_rx\_ports\});}
\DoxyCodeLine{00215\ \ \ \ \ \ \ ch\_estimates.\mbox{\hyperlink{classsrsran_1_1dynamic__tensor_ae3e54a1f77b2ec66b9bd75ca28ad87df}{resize}}(\{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}},\ nof\_rx\_ports,\ config.nof\_tx\_layers\});}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \textcolor{comment}{//\ Resize\ equalizer\ output\ buffers.}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ eq\_re.\mbox{\hyperlink{classsrsran_1_1dynamic__tensor_ae3e54a1f77b2ec66b9bd75ca28ad87df}{resize}}(\{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}},\ config.nof\_tx\_layers\});}
\DoxyCodeLine{00219\ \ \ \ \ \ \ eq\_noise\_vars.\mbox{\hyperlink{classsrsran_1_1dynamic__tensor_ae3e54a1f77b2ec66b9bd75ca28ad87df}{resize}}(\{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}},\ config.nof\_tx\_layers\});}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ the\ data\ symbols\ and\ channel\ estimates\ from\ the\ resource\ grid.}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ get\_ch\_data\_re(ch\_re,\ grid,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_re\_mask}},\ config.rx\_ports);}
\DoxyCodeLine{00223\ \ \ \ \ \ \ get\_ch\_data\_estimates(ch\_estimates,\ estimates,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{block\_re\_mask}},\ config.rx\_ports);}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \ \ \textcolor{comment}{//\ Increment\ subcarrier\ count.}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_subc}};}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ the\ Rx\ port\ noise\ variances\ from\ the\ channel\ estimation.}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}}\ !=\ nof\_rx\_ports;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}})\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ noise\_var\_estimates[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}}]\ =\ estimates.get\_noise\_variance(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}},\ 0);}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{comment}{//\ Equalize\ channels\ and,\ for\ each\ Tx\ layer,\ combine\ contribution\ from\ all\ Rx\ antenna\ ports.}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ equalizer-\/>equalize(}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ eq\_re,\ eq\_noise\_vars,\ ch\_re,\ ch\_estimates,\ \mbox{\hyperlink{classsrsran_1_1span}{span<float>}}(noise\_var\_estimates).first(nof\_rx\_ports),\ 1.0F);}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \ \ \ \ \textcolor{comment}{//\ Estimate\ post\ equalization\ Signal-\/to-\/Interference-\/plus-\/Noise\ Ratio.}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (compute\_post\_eq\_sinr)\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ float>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{all\_eq\_noise\_vars}}\ =\ eq\_noise\_vars.\mbox{\hyperlink{classsrsran_1_1dynamic__tensor_a622e571cf6fa34e33e87741bb96edb53}{get\_data}}();}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{noise\_var\_accumulate}}\ +=\ std::accumulate(}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{all\_eq\_noise\_vars}}.begin(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{all\_eq\_noise\_vars}}.end(),\ 0.0F,\ [\&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sinr\_softbit\_count}}](\textcolor{keywordtype}{float}\ sum,\ \textcolor{keywordtype}{float}\ in)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Exclude\ outliers\ with\ infinite\ variance.\ This\ makes\ sure\ that\ handling\ of\ the\ DC\ carrier\ does\ not\ skew}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ SINR\ results.}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ (std::isinf(in))\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ sum;}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sinr\_softbit\_count}};}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ sum\ +\ in;}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ now,\ layer\ demapping\ is\ not\ implemented.}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ srsran\_assert(config.nof\_tx\_layers\ ==\ 1,\ \textcolor{stringliteral}{"{}Only\ a\ single\ transmit\ layer\ is\ supported."{}});}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ equalized\ resource\ elements\ and\ noise\ variances\ for\ a\ single\ transmit\ layer.}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ cf\_t>}}\ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_re\_flat}}\ \ \ =\ eq\_re.\mbox{\hyperlink{classsrsran_1_1tensor_aa4379387498edc2307a09f6a60b85c8a}{get\_view}}(\{0\});}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ float>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_vars\_flat}}\ =\ eq\_noise\_vars.\mbox{\hyperlink{classsrsran_1_1tensor_aa4379387498edc2307a09f6a60b85c8a}{get\_view}}(\{0\});}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ codeword\ buffer.}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_softbits}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_port}}\ *\ nof\_bits\_per\_re;}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<log\_likelihood\_ratio>}}\ codeword\ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_block}}.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_softbits}});}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \ \ \ \ \textcolor{comment}{//\ Build\ LLRs\ from\ channel\ symbols.}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ demapper-\/>demodulate\_soft(codeword,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_re\_flat}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_vars\_flat}},\ config.modulation);}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ EVM\ only\ if\ it\ is\ available.}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (evm\_calc)\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_evm}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_re\_flat}}.size();}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_accumulate}}\ +=\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_evm}})\ *\ evm\_calc-\/>calculate(codeword,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_re\_flat}},\ config.modulation);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_symbol\_count}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_re\_evm}};}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ and\ notify\ statistics.}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc}}\ ==\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_subc\_end}})\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sinr\_softbit\_count}}\ !=\ 0)\ \&\&\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{noise\_var\_accumulate}}\ >\ 0.0))\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mean\_noise\_var}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{noise\_var\_accumulate}}\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sinr\_softbit\_count}});}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ stats.\mbox{\hyperlink{structsrsran_1_1pusch__demodulator__notifier_1_1demodulation__stats_a2dd9dff0a68c6113291bf860a6f1dd6f}{sinr\_dB}}.\mbox{\hyperlink{classsrsran_1_1optional_ace23a99aaa630fa921abca90844f8bb3}{emplace}}(-\/\mbox{\hyperlink{namespacesrsran_a5756a255042b67673f46c371665d04ec}{convert\_power\_to\_dB}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mean\_noise\_var}}));}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ stats.\mbox{\hyperlink{structsrsran_1_1pusch__demodulator__notifier_1_1demodulation__stats_a2dd9dff0a68c6113291bf860a6f1dd6f}{sinr\_dB}}.\mbox{\hyperlink{classsrsran_1_1optional_ace23a99aaa630fa921abca90844f8bb3}{emplace}}(std::numeric\_limits<float>::infinity());}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_symbol\_count}}\ !=\ 0)\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ stats.\mbox{\hyperlink{structsrsran_1_1pusch__demodulator__notifier_1_1demodulation__stats_abc5b5688315a639c87af81e1c21d288d}{evm}}.\mbox{\hyperlink{classsrsran_1_1optional_ace23a99aaa630fa921abca90844f8bb3}{emplace}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_accumulate}}\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{evm\_symbol\_count}}));}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ notifier.\mbox{\hyperlink{classsrsran_1_1pusch__demodulator__notifier_a48503389508b2adf449afa6479ab85ab}{on\_provisional\_stats}}(stats);}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \ \ \ \ \textcolor{comment}{//\ Generate\ scrambling\ sequence.}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1static__bit__buffer}{static\_bit\_buffer<MAX\_BLOCK\_SIZE>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scrambling\_seq}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_block\_softbits}});}
\DoxyCodeLine{00290\ \ \ \ \ \ \ descrambler-\/>generate(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scrambling\_seq}});}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \textcolor{comment}{//\ Revert\ scrambling.}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ revert\_scrambling(codeword,\ codeword,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scrambling\_seq}});}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ a\ new\ processed\ block.}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_buffer}}.on\_new\_block(codeword,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{scrambling\_seq}});}
\DoxyCodeLine{00297\ \ \ \ \ \}}
\DoxyCodeLine{00298\ \ \ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ notifier.\mbox{\hyperlink{classsrsran_1_1pusch__demodulator__notifier_add652a0187a90a1fcb2eb1f3f750d7d3}{on\_end\_stats}}(stats);}
\DoxyCodeLine{00301\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{codeword\_buffer}}.on\_end\_codeword();}
\DoxyCodeLine{00302\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d9/d42/classsrsran_1_1pusch__demodulator__impl_ae08511160b83699f3290babdf26d3987_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/upper/channel\+\_\+processors/pusch/\mbox{\hyperlink{pusch__demodulator__impl_8h}{pusch\+\_\+demodulator\+\_\+impl.\+h}}\item 
lib/phy/upper/channel\+\_\+processors/pusch/\mbox{\hyperlink{pusch__demodulator__impl_8cpp}{pusch\+\_\+demodulator\+\_\+impl.\+cpp}}\end{DoxyCompactItemize}
