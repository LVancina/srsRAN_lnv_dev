\doxysection{srsran\+::ue\+\_\+event\+\_\+manager Class Reference}
\hypertarget{classsrsran_1_1ue__event__manager}{}\label{classsrsran_1_1ue__event__manager}\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}


Class used to manage events that arrive to the scheduler and are directed at UEs. This class acts as a facade for several of the \doxylink{classsrsran_1_1ue__scheduler}{ue\+\_\+scheduler} subcomponents, managing the asynchronous configuration of the UEs and logging in a thread-\/safe manner.  




{\ttfamily \#include $<$ue\+\_\+event\+\_\+manager.\+h$>$}



Inheritance diagram for srsran\+::ue\+\_\+event\+\_\+manager\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/d87/classsrsran_1_1ue__event__manager__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::ue\+\_\+event\+\_\+manager\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d2a/classsrsran_1_1ue__event__manager__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1ue__event__manager_a3a831a9ec49b7f0ed60bf644b9504055}{ue\+\_\+event\+\_\+manager}} (\mbox{\hyperlink{classsrsran_1_1ue__repository}{ue\+\_\+repository}} \&ue\+\_\+db, \mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler}{scheduler\+\_\+metrics\+\_\+handler}} \&metrics\+\_\+handler, \mbox{\hyperlink{classsrsran_1_1scheduler__event__logger}{scheduler\+\_\+event\+\_\+logger}} \&ev\+\_\+logger)
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_a8b3f5a9cadf9de9bbe4879f3e93c1628}{add\+\_\+cell}} (\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\+\_\+res\+\_\+grid}}, \mbox{\hyperlink{classsrsran_1_1ue__srb0__scheduler}{ue\+\_\+srb0\+\_\+scheduler}} \&srb0\+\_\+sched)
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_ae89da97b3f0697fa6285caeffe09157a}{handle\+\_\+ue\+\_\+creation}} (\mbox{\hyperlink{classsrsran_1_1ue__config__update__event}{ue\+\_\+config\+\_\+update\+\_\+event}} ev) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em UE Add/\+Mod/\+Remove interface. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_ab5181d7a5cb934986ddb726406727835}{handle\+\_\+ue\+\_\+reconfiguration}} (\mbox{\hyperlink{classsrsran_1_1ue__config__update__event}{ue\+\_\+config\+\_\+update\+\_\+event}} ev) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Reconfigure an existing UE instance. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_aebbe4409e64400cc7cc061ba390e0fe3}{handle\+\_\+ue\+\_\+deletion}} (\mbox{\hyperlink{classsrsran_1_1ue__config__delete__event}{ue\+\_\+config\+\_\+delete\+\_\+event}} ev) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Reconfigure an existing UE instance. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_a86f3c92f1cbf15119333841f98348144}{handle\+\_\+ul\+\_\+bsr\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__bsr__indication__message}{ul\+\_\+bsr\+\_\+indication\+\_\+message}} \&bsr) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Scheduler feedback handler interface. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_a409507544faf4190afdf74f87a8388c0}{handle\+\_\+crc\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__crc__indication}{ul\+\_\+crc\+\_\+indication}} \&crc) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_af1a9704a636f666d27009c063ac49736}{handle\+\_\+uci\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1uci__indication}{uci\+\_\+indication}} \&uci) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_a6b86cf20d7e6e51aaba037ff17ed52b5}{handle\+\_\+dl\+\_\+mac\+\_\+ce\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__mac__ce__indication}{dl\+\_\+mac\+\_\+ce\+\_\+indication}} \&ce) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Command scheduling of DL MAC CE for a given UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_ab40ea6616a5a1c6526b61fb226a92338}{handle\+\_\+ul\+\_\+phr\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__phr__indication__message}{ul\+\_\+phr\+\_\+indication\+\_\+message}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\+\_\+ind}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Handles PHR indication sent by MAC. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_ac6c4bf62319cbd0eb07e8c3cc7392983}{handle\+\_\+dl\+\_\+buffer\+\_\+state\+\_\+indication}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__buffer__state__indication__message}{dl\+\_\+buffer\+\_\+state\+\_\+indication\+\_\+message}} \&bs) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Scheduler DL buffer state indication handler interface. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_a56aeafb054f1e479e5d8b006992d455f}{handle\+\_\+error\+\_\+indication}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} sl\+\_\+tx, \mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}} cell\+\_\+index, \mbox{\hyperlink{structsrsran_1_1scheduler__slot__handler_1_1error__outcome}{scheduler\+\_\+slot\+\_\+handler\+::error\+\_\+outcome}} event)
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ue__event__manager_a8086d93a08ad2471d45d8f6e069a8988}{run}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sl}}, \mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}} cell\+\_\+index)
\begin{DoxyCompactList}\small\item\em Process events for a given slot and cell index. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class used to manage events that arrive to the scheduler and are directed at UEs. This class acts as a facade for several of the \doxylink{classsrsran_1_1ue__scheduler}{ue\+\_\+scheduler} subcomponents, managing the asynchronous configuration of the UEs and logging in a thread-\/safe manner. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1ue__event__manager_a3a831a9ec49b7f0ed60bf644b9504055}\label{classsrsran_1_1ue__event__manager_a3a831a9ec49b7f0ed60bf644b9504055} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!ue\_event\_manager@{ue\_event\_manager}}
\index{ue\_event\_manager@{ue\_event\_manager}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{ue\_event\_manager()}{ue\_event\_manager()}}
{\footnotesize\ttfamily ue\+\_\+event\+\_\+manager\+::ue\+\_\+event\+\_\+manager (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1ue__repository}{ue\+\_\+repository}} \&}]{ue\+\_\+db,  }\item[{\mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler}{scheduler\+\_\+metrics\+\_\+handler}} \&}]{metrics\+\_\+handler,  }\item[{\mbox{\hyperlink{classsrsran_1_1scheduler__event__logger}{scheduler\+\_\+event\+\_\+logger}} \&}]{ev\+\_\+logger }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00123\ \ \ ue\_db(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_db\_}}),}
\DoxyCodeLine{00124\ \ \ metrics\_handler(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{metrics\_handler\_}}),}
\DoxyCodeLine{00125\ \ \ ev\_logger(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ev\_logger\_}}),}
\DoxyCodeLine{00126\ \ \ logger(srslog::fetch\_basic\_logger(\textcolor{stringliteral}{"{}SCHED"{}})),}
\DoxyCodeLine{00127\ \ \ dl\_bo\_mng(std::make\_unique<ue\_dl\_buffer\_occupancy\_manager>(*\textcolor{keyword}{this}))}
\DoxyCodeLine{00128\ \{}
\DoxyCodeLine{00129\ \ \ common\_events.reserve(INITIAL\_COMMON\_EVENT\_LIST\_SIZE);}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ cell\ :\ cell\_specific\_events)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ cell.reserve(INITIAL\_CELL\_EVENT\_LIST\_SIZE);}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_a4992cc99f0ba135cc7e2a6f695bb6f73}\label{classsrsran_1_1ue__event__manager_a4992cc99f0ba135cc7e2a6f695bb6f73} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!````~ue\_event\_manager@{\texorpdfstring{$\sim$}{\string~}ue\_event\_manager}}
\index{````~ue\_event\_manager@{\texorpdfstring{$\sim$}{\string~}ue\_event\_manager}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}ue\_event\_manager()}{\string~ue\_event\_manager()}}
{\footnotesize\ttfamily ue\+\_\+event\+\_\+manager\+::\texorpdfstring{$\sim$}{\string~}ue\+\_\+event\+\_\+manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00135\ \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1ue__event__manager_a8b3f5a9cadf9de9bbe4879f3e93c1628}\label{classsrsran_1_1ue__event__manager_a8b3f5a9cadf9de9bbe4879f3e93c1628} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!add\_cell@{add\_cell}}
\index{add\_cell@{add\_cell}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{add\_cell()}{add\_cell()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::add\+\_\+cell (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&}]{cell\+\_\+res\+\_\+grid,  }\item[{\mbox{\hyperlink{classsrsran_1_1ue__srb0__scheduler}{ue\+\_\+srb0\+\_\+scheduler}} \&}]{srb0\+\_\+sched }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00619\ \{}
\DoxyCodeLine{00620\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\_cell\_index\_t}}\ cell\_index\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_res\_grid}}.cell\_index();}
\DoxyCodeLine{00621\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ cell\_exists(cell\_index),\ \textcolor{stringliteral}{"{}Overwriting\ cell\ configurations\ not\ supported"{}});}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ du\_cells[cell\_index].cfg\ \ \ \ \ \ \ \ =\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_res\_grid}}.cfg;}
\DoxyCodeLine{00624\ \ \ du\_cells[cell\_index].res\_grid\ \ \ =\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_res\_grid}};}
\DoxyCodeLine{00625\ \ \ du\_cells[cell\_index].srb0\_sched\ =\ \&srb0\_sched;}
\DoxyCodeLine{00626\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_a409507544faf4190afdf74f87a8388c0}\label{classsrsran_1_1ue__event__manager_a409507544faf4190afdf74f87a8388c0} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_crc\_indication@{handle\_crc\_indication}}
\index{handle\_crc\_indication@{handle\_crc\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_crc\_indication()}{handle\_crc\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+crc\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__crc__indication}{ul\+\_\+crc\+\_\+indication}} \&}]{crc }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1scheduler__feedback__handler}{srsran\+::scheduler\+\_\+feedback\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00259\ \{}
\DoxyCodeLine{00260\ \ \ srsran\_assert(cell\_exists(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_ind}}.cell\_index),\ \textcolor{stringliteral}{"{}Invalid\ cell\ index"{}});}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_ind}}.crcs.size();\ ++i)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ cell\_specific\_events[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_ind}}.cell\_index].emplace(}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_ind}}.crcs[i].ue\_index,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ [\textcolor{keyword}{this},\ sl\_rx\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_ind}}.sl\_rx,\ crc\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{crc\_ind}}.crcs[i]](\mbox{\hyperlink{classsrsran_1_1ue__cell}{ue\_cell}}\&\ ue\_cc)\ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ const\ int\ tbs\ =\ ue\_cc.handle\_crc\_pdu(sl\_rx,\ crc);}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ if\ (tbs\ <\ 0)\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ return;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Log\ event.}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ ev\_logger.enqueue(\mbox{\hyperlink{structsrsran_1_1scheduler__event__logger_1_1crc__event}{scheduler\_event\_logger::crc\_event}}\{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ crc.ue\_index,\ crc.rnti,\ ue\_cc.cell\_index,\ sl\_rx,\ crc.harq\_id,\ crc.tb\_crc\_success,\ crc.ul\_sinr\_metric\});}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ metrics\ handler.}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ metrics\_handler.\mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a0755c662b8f2268fbdee06923b302459}{handle\_crc\_indication}}(crc,\ \mbox{\hyperlink{classsrsran_1_1units_1_1bytes}{units::bytes}}\{(\mbox{\hyperlink{classunsigned}{unsigned}})tbs\});}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ Timing\ Advance\ Offset.}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (crc.tb\_crc\_success\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ crc.time\_advance\_offset.has\_value()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ crc.ul\_sinr\_metric.has\_value())\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ ue\_db[ue\_cc.ue\_index].handle\_ul\_n\_ta\_update\_indication(}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_cc.cell\_index,\ crc.ul\_sinr\_metric.value(),\ crc.time\_advance\_offset.value());}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}CRC"{}},}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{keyword}{true});}
\DoxyCodeLine{00286\ \ \ \}}
\DoxyCodeLine{00287\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_ac6c4bf62319cbd0eb07e8c3cc7392983}\label{classsrsran_1_1ue__event__manager_ac6c4bf62319cbd0eb07e8c3cc7392983} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_dl\_buffer\_state\_indication@{handle\_dl\_buffer\_state\_indication}}
\index{handle\_dl\_buffer\_state\_indication@{handle\_dl\_buffer\_state\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_dl\_buffer\_state\_indication()}{handle\_dl\_buffer\_state\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+dl\+\_\+buffer\+\_\+state\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__buffer__state__indication__message}{dl\+\_\+buffer\+\_\+state\+\_\+indication\+\_\+message}} \&}]{bs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Scheduler DL buffer state indication handler interface. 



Implements \mbox{\hyperlink{classsrsran_1_1scheduler__dl__buffer__state__indication__handler_ab33c261eb56963dd3e6dbe8e136a09ae}{srsran\+::scheduler\+\_\+dl\+\_\+buffer\+\_\+state\+\_\+indication\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00435\ \{}
\DoxyCodeLine{00436\ \ \ dl\_bo\_mng-\/>handle\_dl\_buffer\_state\_indication(bs);}
\DoxyCodeLine{00437\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_a6b86cf20d7e6e51aaba037ff17ed52b5}\label{classsrsran_1_1ue__event__manager_a6b86cf20d7e6e51aaba037ff17ed52b5} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_dl\_mac\_ce\_indication@{handle\_dl\_mac\_ce\_indication}}
\index{handle\_dl\_mac\_ce\_indication@{handle\_dl\_mac\_ce\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_dl\_mac\_ce\_indication()}{handle\_dl\_mac\_ce\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+dl\+\_\+mac\+\_\+ce\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1dl__mac__ce__indication}{dl\+\_\+mac\+\_\+ce\+\_\+indication}} \&}]{mac\+\_\+ce }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Command scheduling of DL MAC CE for a given UE. 


\begin{DoxyParams}{Parameters}
{\em mac\+\_\+ce} & DL MAC CE to be scheduled. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1scheduler__feedback__handler_a244c01bad813835fdd3c732f5d92d7be}{srsran\+::scheduler\+\_\+feedback\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00421\ \{}
\DoxyCodeLine{00422\ \ \ common\_events.emplace(ce.ue\_index,\ [\textcolor{keyword}{this},\ ce]()\ \{}
\DoxyCodeLine{00423\ \ \ \ \ if\ (not\ ue\_db.contains(ce.ue\_index))\ \{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ log\_invalid\_ue\_index(ce.ue\_index,\ \textcolor{stringliteral}{"{}DL\ MAC\ CE"{}});}
\DoxyCodeLine{00425\ \ \ \ \ \ \ return;}
\DoxyCodeLine{00426\ \ \ \ \ \}}
\DoxyCodeLine{00427\ \ \ \ \ ue\_db[ce.ue\_index].handle\_dl\_mac\_ce\_indication(ce);}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{comment}{//\ Log\ event.}}
\DoxyCodeLine{00430\ \ \ \ \ ev\_logger.enqueue(ce);}
\DoxyCodeLine{00431\ \ \ \});}
\DoxyCodeLine{00432\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_a56aeafb054f1e479e5d8b006992d455f}\label{classsrsran_1_1ue__event__manager_a56aeafb054f1e479e5d8b006992d455f} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_error\_indication@{handle\_error\_indication}}
\index{handle\_error\_indication@{handle\_error\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_error\_indication()}{handle\_error\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+error\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl\+\_\+tx,  }\item[{\mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}}}]{cell\+\_\+index,  }\item[{\mbox{\hyperlink{structsrsran_1_1scheduler__slot__handler_1_1error__outcome}{scheduler\+\_\+slot\+\_\+handler\+::error\+\_\+outcome}}}]{event }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00504\ \{}
\DoxyCodeLine{00505\ \ \ common\_events.emplace(INVALID\_DU\_UE\_INDEX,\ [\textcolor{keyword}{this},\ sl\_tx,\ cell\_index,\ event]()\ \{}
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{comment}{//\ Handle\ Error\ Indication.}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\_slot\_resource\_allocator}}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prev\_slot\_result}}\ =\ du\_cells[cell\_index].res\_grid-\/>get\_history(sl\_tx);}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prev\_slot\_result}}\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}cell=\{\},\ slot=\{\}:\ Discarding\ error\ indication.\ Cause:\ Scheduler\ results\ associated\ with\ the\ slot\ "{}}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}of\ the\ error\ indication\ have\ already\ been\ erased"{}},}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cell\_index,}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sl\_tx);}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00515\ \ \ \ \ \}}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{comment}{//\ In\ case\ DL\ PDCCHs\ were\ skipped,\ there\ will\ be\ the\ following\ consequences:}}
\DoxyCodeLine{00518\ \ \ \ \ \textcolor{comment}{//\ -\/\ The\ UE\ will\ not\ decode\ the\ PDSCH\ and\ will\ not\ send\ the\ respective\ UCI.}}
\DoxyCodeLine{00519\ \ \ \ \ \textcolor{comment}{//\ -\/\ The\ UE\ won't\ update\ the\ HARQ\ NDI,\ if\ new\ HARQ\ TB.}}
\DoxyCodeLine{00520\ \ \ \ \ \textcolor{comment}{//\ -\/\ The\ UCI\ indication\ coming\ later\ from\ the\ lower\ layers\ will\ likely\ contain\ a\ HARQ-\/ACK=DTX.}}
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{comment}{//\ In\ case\ UL\ PDCCHs\ were\ skipped,\ there\ will\ be\ the\ following\ consequences:}}
\DoxyCodeLine{00522\ \ \ \ \ \textcolor{comment}{//\ -\/\ The\ UE\ will\ not\ decode\ the\ PUSCH.}}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{comment}{//\ -\/\ The\ UE\ won't\ update\ the\ HARQ\ NDI,\ if\ new\ HARQ\ TB.}}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{comment}{//\ -\/\ The\ CRC\ indication\ coming\ from\ the\ lower\ layers\ will\ likely\ be\ CRC=KO.}}
\DoxyCodeLine{00525\ \ \ \ \ \textcolor{comment}{//\ -\/\ Any\ UCI\ in\ the\ respective\ PUSCH\ will\ be\ likely\ reported\ as\ HARQ-\/ACK=DTX.}}
\DoxyCodeLine{00526\ \ \ \ \ \textcolor{comment}{//\ In\ neither\ of\ the\ cases,\ the\ HARQs\ will\ timeout,\ because\ we\ did\ not\ lose\ the\ UCI/CRC\ indications\ in\ the\ lower}}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{comment}{//\ layers.\ We\ do\ not\ need\ to\ cancel\ associated\ PUSCH\ grant\ (in\ UL\ PDCCH\ case)\ because\ it\ is\ important\ that}}
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{comment}{//\ the\ PUSCH\ "{}new\_data"{}\ flag\ reaches\ the\ lower\ layers,\ telling\ them\ whether\ the\ UL\ HARQ\ buffer\ needs\ to\ be\ reset\ or}}
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{comment}{//\ not.\ Cancelling\ HARQ\ retransmissions\ is\ dangerous\ as\ it\ increases\ the\ chances\ of\ NDI\ ambiguity.}}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{comment}{//\ In\ case\ of\ PDSCH\ grants\ being\ discarded,\ there\ will\ be\ the\ following\ consequences:}}
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{comment}{//\ -\/\ If\ the\ PDCCH\ was\ not\ discarded,the\ UE\ will\ fail\ to\ decode\ the\ PDSCH\ and\ will\ send\ an\ HARQ-\/ACK=NACK.\ The}}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{comment}{//\ scheduler\ will\ retransmit\ the\ respective\ DL\ HARQ.\ No\ actions\ required.}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{comment}{//\ In\ case\ of\ PUCCH\ and\ PUSCH\ grants\ being\ discarded.}}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{keywordflow}{if}\ (event.pusch\_and\_pucch\_discarded)\ \{}
\DoxyCodeLine{00537\ \ \ \ \ \ \ handle\_discarded\_pusch(*prev\_slot\_result,\ ue\_db);}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ \ \ \ \ handle\_discarded\_pucch(*prev\_slot\_result,\ ue\_db);}
\DoxyCodeLine{00540\ \ \ \ \ \}}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{comment}{//\ Log\ event.}}
\DoxyCodeLine{00543\ \ \ \ \ ev\_logger.enqueue(\mbox{\hyperlink{structsrsran_1_1scheduler__event__logger_1_1error__indication__event}{scheduler\_event\_logger::error\_indication\_event}}\{sl\_tx,\ event\});}
\DoxyCodeLine{00544\ \ \ \});}
\DoxyCodeLine{00545\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_af1a9704a636f666d27009c063ac49736}\label{classsrsran_1_1ue__event__manager_af1a9704a636f666d27009c063ac49736} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_uci\_indication@{handle\_uci\_indication}}
\index{handle\_uci\_indication@{handle\_uci\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_uci\_indication()}{handle\_uci\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+uci\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1uci__indication}{uci\+\_\+indication}} \&}]{uci }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsrsran_1_1scheduler__feedback__handler}{srsran\+::scheduler\+\_\+feedback\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00327\ \{}
\DoxyCodeLine{00328\ \ \ srsran\_sanity\_check(cell\_exists(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ind}}.cell\_index),\ \textcolor{stringliteral}{"{}Invalid\ cell\ index"{}});}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ind}}.ucis.size();\ ++i)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1uci__indication_1_1uci__pdu}{uci\_indication::uci\_pdu}}\&\ uci\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ind}}.ucis[i];}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ cell\_specific\_events[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ind}}.cell\_index].emplace(}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ uci.ue\_index,}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ [\textcolor{keyword}{this},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uci\_sl}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ind}}.slot\_rx,\ uci\_pdu\ =\ uci.pdu](\mbox{\hyperlink{classsrsran_1_1ue__cell}{ue\_cell}}\&\ ue\_cc)\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ if\ (variant\_holds\_alternative<uci\_indication::uci\_pdu::uci\_pucch\_f0\_or\_f1\_pdu>(uci\_pdu))\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ const\ auto\&\ pdu\ =\ variant\_get<uci\_indication::uci\_pdu::uci\_pucch\_f0\_or\_f1\_pdu>(uci\_pdu);}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ DL\ HARQ\ ACKs.}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ if\ (not\ pdu.harqs.empty())\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ handle\_harq\_ind(ue\_cc,\ uci\_sl,\ pdu.harqs,\ pdu.ul\_sinr);}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ SRs.}}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ if\ (pdu.sr\_detected)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Handle\ SR\ indication.}}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_db[ue\_cc.ue\_index].handle\_sr\_indication();}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Log\ SR\ event.}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ev\_logger.enqueue(scheduler\_event\_logger::sr\_event\{ue\_cc.ue\_index,\ ue\_cc.rnti()\});}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Report\ the\ PUCCH\ SINR\ metric.}}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ metrics\_handler.handle\_pucch\_sinr(ue\_cc.ue\_index,\ pdu.ul\_sinr);}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool\ is\_uci\_valid\ =\ not\ pdu.harqs.empty()\ or\ pdu.sr\_detected;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ Timing\ Advance\ Offset.}}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ if\ (is\_uci\_valid\ and\ pdu.time\_advance\_offset.has\_value()\ and\ pdu.ul\_sinr.has\_value())\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_db[ue\_cc.ue\_index].handle\_ul\_n\_ta\_update\_indication(}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_cc.cell\_index,\ pdu.ul\_sinr.value(),\ pdu.time\_advance\_offset.value());}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ if\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{variant\_holds\_alternative<uci\_indication::uci\_pdu::uci\_pusch\_pdu>}}(uci\_pdu))\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{variant\_get<uci\_indication::uci\_pdu::uci\_pusch\_pdu>}}(uci\_pdu);}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ DL\ HARQ\ ACKs.}}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ pdu.harqs.empty())\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ handle\_harq\_ind(ue\_cc,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uci\_sl}},\ pdu.harqs,\ \mbox{\hyperlink{namespacesrsran_a2e817fa4d4a8084eb1746ee8d1440679}{nullopt}});}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ CSI.}}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pdu.csi.has\_value())\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ handle\_csi(ue\_cc,\ *pdu.csi);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{variant\_holds\_alternative<uci\_indication::uci\_pdu::uci\_pucch\_f2\_or\_f3\_or\_f4\_pdu>}}(uci\_pdu))\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pdu\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{variant\_get<uci\_indication::uci\_pdu::uci\_pucch\_f2\_or\_f3\_or\_f4\_pdu>}}(uci\_pdu);}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ DL\ HARQ\ ACKs.}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ pdu.harqs.empty())\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ handle\_harq\_ind(ue\_cc,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uci\_sl}},\ pdu.harqs,\ pdu.ul\_sinr);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ SRs.}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_bit\_position\_with\_1\_sr\_bit}}\ =\ 0;}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ pdu.sr\_info.empty()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ pdu.sr\_info.test(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_bit\_position\_with\_1\_sr\_bit}}))\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Handle\ SR\ indication.}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_db[ue\_cc.ue\_index].handle\_sr\_indication();}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Log\ SR\ event.}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ev\_logger.enqueue(\mbox{\hyperlink{structsrsran_1_1scheduler__event__logger_1_1sr__event}{scheduler\_event\_logger::sr\_event}}\{ue\_cc.ue\_index,\ ue\_cc.rnti()\});}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ CSI.}}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pdu.csi.has\_value())\ \{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ handle\_csi(ue\_cc,\ *pdu.csi);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Report\ the\ PUCCH\ metric\ to\ the\ scheduler.}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ metrics\_handler.\mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a6e4f25d8ec9c5136211a605d524480ef}{handle\_pucch\_sinr}}(ue\_cc.ue\_index,\ pdu.ul\_sinr);}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_uci\_valid}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ pdu.harqs.empty()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ pdu.sr\_info.empty()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ pdu.sr\_info.test(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_bit\_position\_with\_1\_sr\_bit}}))\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pdu.csi.has\_value();}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ Timing\ Advance\ Offset.}}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_uci\_valid}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ pdu.time\_advance\_offset.has\_value()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ pdu.ul\_sinr.has\_value())\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_db[ue\_cc.ue\_index].handle\_ul\_n\_ta\_update\_indication(}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ue\_cc.cell\_index,\ pdu.ul\_sinr.value(),\ pdu.time\_advance\_offset.value());}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}UCI"{}},}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note:\ We\ do\ not\ warn\ if\ the\ UE\ is\ not\ found,\ because\ there\ is\ this\ transient\ period\ when\ the\ UE}}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ about\ to\ receive\ and\ process\ the\ RRC\ Release,\ but\ it\ is\ still\ sending\ CSI\ or\ SR\ in\ the\ PUCCH.\ If\ we\ stop}}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ PUCCH\ scheduling\ for\ the\ UE\ about\ to\ be\ released,\ we\ could\ risk\ interference\ between\ UEs\ in\ the\ PUCCH.}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keyword}{false});}
\DoxyCodeLine{00417\ \ \ \}}
\DoxyCodeLine{00418\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_ae89da97b3f0697fa6285caeffe09157a}\label{classsrsran_1_1ue__event__manager_ae89da97b3f0697fa6285caeffe09157a} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_ue\_creation@{handle\_ue\_creation}}
\index{handle\_ue\_creation@{handle\_ue\_creation}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_ue\_creation()}{handle\_ue\_creation()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+ue\+\_\+creation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1ue__config__update__event}{ue\+\_\+config\+\_\+update\+\_\+event}}}]{ev }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



UE Add/\+Mod/\+Remove interface. 



Implements \mbox{\hyperlink{classsrsran_1_1sched__ue__configuration__handler_a8791881c0f2df65f0cfa634c1746422a}{srsran\+::sched\+\_\+ue\+\_\+configuration\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138\ \{}
\DoxyCodeLine{00139\ \ \ \textcolor{comment}{//\ Create\ UE\ object\ outside\ the\ scheduler\ slot\ indication\ handler\ to\ minimize\ latency.}}
\DoxyCodeLine{00140\ \ \ std::unique\_ptr<ue>\ u\ =\ std::make\_unique<ue>(\mbox{\hyperlink{structsrsran_1_1ue__creation__command}{ue\_creation\_command}}\{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ ev.next\_config(),\ ev.get\_fallback\_command().\mbox{\hyperlink{classsrsran_1_1optional_a2f160539a76c3f4dd0b50b339b81202e}{has\_value}}()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}\ ev.get\_fallback\_command().value(),\ metrics\_handler\});}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ Defer\ UE\ object\ addition\ to\ ue\ list\ to\ the\ slot\ indication\ handler.}}
\DoxyCodeLine{00144\ \ \ common\_events.emplace(INVALID\_DU\_UE\_INDEX,\ [\textcolor{keyword}{this},\ u\ =\ std::move(u),\ ev\ =\ std::move(ev)]()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordflow}{if}\ (ue\_db.\mbox{\hyperlink{classsrsran_1_1ue__repository_a8d4b4805828ab1b0375fa323b73c3d6c}{contains}}(u-\/>ue\_index))\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}ue=\{\}\ rnti=\{\}:\ Discarding\ UE\ creation.\ Cause:\ A\ UE\ with\ the\ same\ index\ already\ exists"{}},}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u-\/>ue\_index,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u-\/>crnti);}
\DoxyCodeLine{00149\ \ \ \ \ \ \ ev.abort();}
\DoxyCodeLine{00150\ \ \ \ \ \ \ return;}
\DoxyCodeLine{00151\ \ \ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ Insert\ UE\ in\ UE\ repository.}}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\_ue\_index\_t}}\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ueidx}}\ \ \ \ \ \ \ =\ u-\/>ue\_index;}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\_t}}\ \ \ \ \ \ \ \ \ \ rnti\ \ \ \ \ \ \ \ =\ u-\/>crnti;}
\DoxyCodeLine{00156\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\_cell\_index\_t}}\ pcell\_index\ =\ u-\/>get\_pcell().cell\_index;}
\DoxyCodeLine{00157\ \ \ \ \ ue\_db.\mbox{\hyperlink{classsrsran_1_1ue__repository_ace9030f7d1957a751d741be57e325a74}{add\_ue}}(std::move(u));}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{comment}{//\ Log\ Event.}}
\DoxyCodeLine{00160\ \ \ \ \ ev\_logger.enqueue(\mbox{\hyperlink{structsrsran_1_1scheduler__event__logger_1_1ue__creation__event}{scheduler\_event\_logger::ue\_creation\_event}}\{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ueidx}},\ rnti,\ pcell\_index\});}
\DoxyCodeLine{00161\ \ \ \});}
\DoxyCodeLine{00162\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_aebbe4409e64400cc7cc061ba390e0fe3}\label{classsrsran_1_1ue__event__manager_aebbe4409e64400cc7cc061ba390e0fe3} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_ue\_deletion@{handle\_ue\_deletion}}
\index{handle\_ue\_deletion@{handle\_ue\_deletion}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_ue\_deletion()}{handle\_ue\_deletion()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+ue\+\_\+deletion (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1ue__config__delete__event}{ue\+\_\+config\+\_\+delete\+\_\+event}}}]{ev }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reconfigure an existing UE instance. 



Implements \mbox{\hyperlink{classsrsran_1_1sched__ue__configuration__handler_ae3e64d59ca2d1987180a4c407b712027}{srsran\+::sched\+\_\+ue\+\_\+configuration\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00184\ \{}
\DoxyCodeLine{00185\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\_ue\_index\_t}}\ ue\_index\ =\ ev.ue\_index();}
\DoxyCodeLine{00186\ \ \ common\_events.emplace(ue\_index,\ [\textcolor{keyword}{this},\ ev\ =\ std::move(ev)]()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\_ue\_index\_t}}\ ue\_idx\ =\ ev.ue\_index();}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ ue\_db.\mbox{\hyperlink{classsrsran_1_1ue__repository_a8d4b4805828ab1b0375fa323b73c3d6c}{contains}}(ue\_idx))\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Received\ request\ to\ delete\ ue=\{\}\ that\ does\ not\ exist"{}},\ ue\_idx);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ return;}
\DoxyCodeLine{00191\ \ \ \ \ \}}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\_t}}\ rnti\ =\ ue\_db[ue\_idx].crnti;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{comment}{//\ Scheduler\ UE\ removal\ from\ repository.}}
\DoxyCodeLine{00195\ \ \ \ \ ue\_db.\mbox{\hyperlink{classsrsran_1_1ue__repository_a1597db37f0f883b1c604ce7acf2f9713}{schedule\_ue\_rem}}(std::move(ev));}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{//\ Log\ UE\ removal\ event.}}
\DoxyCodeLine{00198\ \ \ \ \ ev\_logger.enqueue(\mbox{\hyperlink{structsrsran_1_1sched__ue__delete__message}{sched\_ue\_delete\_message}}\{ue\_idx,\ rnti\});}
\DoxyCodeLine{00199\ \ \ \});}
\DoxyCodeLine{00200\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_ab5181d7a5cb934986ddb726406727835}\label{classsrsran_1_1ue__event__manager_ab5181d7a5cb934986ddb726406727835} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_ue\_reconfiguration@{handle\_ue\_reconfiguration}}
\index{handle\_ue\_reconfiguration@{handle\_ue\_reconfiguration}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_ue\_reconfiguration()}{handle\_ue\_reconfiguration()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+ue\+\_\+reconfiguration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1ue__config__update__event}{ue\+\_\+config\+\_\+update\+\_\+event}}}]{ev }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reconfigure an existing UE instance. 



Implements \mbox{\hyperlink{classsrsran_1_1sched__ue__configuration__handler_a798fcde164362476cff04cf62b7c32d4}{srsran\+::sched\+\_\+ue\+\_\+configuration\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00165\ \{}
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\_ue\_index\_t}}\ ue\_index\ =\ ev.get\_ue\_index();}
\DoxyCodeLine{00167\ \ \ common\_events.emplace(ue\_index,\ [\textcolor{keyword}{this},\ ev\ =\ std::move(ev)]()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a511ed22603607d4a784c0f1807648b47}{du\_ue\_index\_t}}\ ue\_idx\ =\ ev.get\_ue\_index();}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ ue\_db.\mbox{\hyperlink{classsrsran_1_1ue__repository_a8d4b4805828ab1b0375fa323b73c3d6c}{contains}}(ue\_idx))\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ log\_invalid\_ue\_index(ue\_idx,\ \textcolor{stringliteral}{"{}UE\ Reconfig\ Request"{}});}
\DoxyCodeLine{00171\ \ \ \ \ \ \ ev.abort();}
\DoxyCodeLine{00172\ \ \ \ \ \ \ return;}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ Configure\ existing\ UE.}}
\DoxyCodeLine{00176\ \ \ \ \ ue\_db[ue\_idx].handle\_reconfiguration\_request(\mbox{\hyperlink{structsrsran_1_1ue__reconf__command}{ue\_reconf\_command}}\{ev.next\_config()\});}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{comment}{//\ Log\ event.}}
\DoxyCodeLine{00179\ \ \ \ \ ev\_logger.enqueue(\mbox{\hyperlink{structsrsran_1_1scheduler__event__logger_1_1ue__reconf__event}{scheduler\_event\_logger::ue\_reconf\_event}}\{ue\_idx,\ ue\_db[ue\_idx].crnti\});}
\DoxyCodeLine{00180\ \ \ \});}
\DoxyCodeLine{00181\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_a86f3c92f1cbf15119333841f98348144}\label{classsrsran_1_1ue__event__manager_a86f3c92f1cbf15119333841f98348144} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_ul\_bsr\_indication@{handle\_ul\_bsr\_indication}}
\index{handle\_ul\_bsr\_indication@{handle\_ul\_bsr\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_ul\_bsr\_indication()}{handle\_ul\_bsr\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+ul\+\_\+bsr\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__bsr__indication__message}{ul\+\_\+bsr\+\_\+indication\+\_\+message}} \&}]{bsr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Scheduler feedback handler interface. 



Implements \mbox{\hyperlink{classsrsran_1_1scheduler__feedback__handler}{srsran\+::scheduler\+\_\+feedback\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00203\ \{}
\DoxyCodeLine{00204\ \ \ srsran\_sanity\_check(cell\_exists(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.cell\_index),\ \textcolor{stringliteral}{"{}Invalid\ cell\ index"{}});}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ common\_events.emplace(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.ue\_index,\ [\textcolor{keyword}{this},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}]()\ \{}
\DoxyCodeLine{00207\ \ \ \ \ if\ (not\ ue\_db.contains(bsr\_ind.ue\_index))\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ log\_invalid\_ue\_index(bsr\_ind.ue\_index,\ \textcolor{stringliteral}{"{}BSR"{}});}
\DoxyCodeLine{00209\ \ \ \ \ \ \ return;}
\DoxyCodeLine{00210\ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keyword}{auto}\&\ u\ =\ ue\_db[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.ue\_index];}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{comment}{//\ Handle\ event.}}
\DoxyCodeLine{00213\ \ \ \ \ u.handle\_bsr\_indication(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}});}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{comment}{//\ Log\ event.}}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{if}\ (ev\_logger.enabled())\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1scheduler__event__logger_1_1bsr__event}{scheduler\_event\_logger::bsr\_event}}\ \textcolor{keyword}{event}\{\};}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \textcolor{keyword}{event}.ue\_index\ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.ue\_index;}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{keyword}{event}.rnti\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.crnti;}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \textcolor{keyword}{event}.type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.type;}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \textcolor{keyword}{event}.reported\_lcgs\ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}}.reported\_lcgs;}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{keyword}{event}.tot\_ul\_pending\_bytes\ =\ \mbox{\hyperlink{classsrsran_1_1units_1_1bytes}{units::bytes}}\{u.pending\_ul\_newtx\_bytes()\};}
\DoxyCodeLine{00223\ \ \ \ \ \ \ ev\_logger.enqueue(event);}
\DoxyCodeLine{00224\ \ \ \ \ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{comment}{//\ Notify\ metrics\ handler.}}
\DoxyCodeLine{00227\ \ \ \ \ metrics\_handler.\mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_ae145075dfaf3f5ea6f7f4d0988935ab6}{handle\_ul\_bsr\_indication}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bsr\_ind}});}
\DoxyCodeLine{00228\ \ \ \});}
\DoxyCodeLine{00229\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_ab40ea6616a5a1c6526b61fb226a92338}\label{classsrsran_1_1ue__event__manager_ab40ea6616a5a1c6526b61fb226a92338} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!handle\_ul\_phr\_indication@{handle\_ul\_phr\_indication}}
\index{handle\_ul\_phr\_indication@{handle\_ul\_phr\_indication}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{handle\_ul\_phr\_indication()}{handle\_ul\_phr\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::handle\+\_\+ul\+\_\+phr\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ul__phr__indication__message}{ul\+\_\+phr\+\_\+indication\+\_\+message}} \&}]{phr\+\_\+ind }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Handles PHR indication sent by MAC. 


\begin{DoxyParams}{Parameters}
{\em phr} & PHR indication message sent by MAC. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1scheduler__feedback__handler_ab8a975f69bce94dd82672ed40b7a590e}{srsran\+::scheduler\+\_\+feedback\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00232\ \{}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1cell__ph__report}{cell\_ph\_report}}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.phr.get\_phr())\ \{}
\DoxyCodeLine{00234\ \ \ \ \ srsran\_sanity\_check(cell\_exists(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}.serv\_cell\_id),\ \textcolor{stringliteral}{"{}Invalid\ serving\ cell\ index=\{\}"{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}.serv\_cell\_id);}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ cell\_specific\_events[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}.serv\_cell\_id].emplace(}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.ue\_index,}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ [\textcolor{keyword}{this},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}](\mbox{\hyperlink{classsrsran_1_1ue__cell}{ue\_cell}}\&\ ue\_cc)\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ ue\_cc.channel\_state\_manager().handle\_phr(cell\_phr);}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Log\ event.}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ scheduler\_event\_logger::phr\_event\ event\{\};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.ue\_index\ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.ue\_index;}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.rnti\ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}}.rnti;}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.cell\_index\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}.serv\_cell\_id;}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.ph\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}.ph;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.p\_cmax\ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cell\_phr}}.p\_cmax;}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ ev\_logger.enqueue(event);}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ metrics\ handler.}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ metrics\_handler.\mbox{\hyperlink{classsrsran_1_1scheduler__metrics__handler_a775ca5759c1bbed03fbf9fb47d725733}{handle\_ul\_phr\_indication}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{phr\_ind}});}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}UL\ PHR"{}},}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{keyword}{true});}
\DoxyCodeLine{00255\ \ \ \}}
\DoxyCodeLine{00256\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ue__event__manager_a8086d93a08ad2471d45d8f6e069a8988}\label{classsrsran_1_1ue__event__manager_a8086d93a08ad2471d45d8f6e069a8988} 
\index{srsran::ue\_event\_manager@{srsran::ue\_event\_manager}!run@{run}}
\index{run@{run}!srsran::ue\_event\_manager@{srsran::ue\_event\_manager}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ue\+\_\+event\+\_\+manager\+::run (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl,  }\item[{\mbox{\hyperlink{namespacesrsran_a5b995a7b11715f3042e18281c21991ff}{du\+\_\+cell\+\_\+index\+\_\+t}}}]{cell\+\_\+index }\end{DoxyParamCaption})}



Process events for a given slot and cell index. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00608\ \{}
\DoxyCodeLine{00609\ \ \ srsran\_sanity\_check(cell\_exists(cell\_index),\ \textcolor{stringliteral}{"{}Invalid\ cell\ index\ \{\}"{}},\ cell\_index);}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \ \ \textcolor{comment}{//\ Process\ common\ events.}}
\DoxyCodeLine{00612\ \ \ process\_common(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sl}},\ cell\_index);}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \textcolor{comment}{//\ Process\ carrier\ specific\ events.}}
\DoxyCodeLine{00615\ \ \ process\_cell\_specific(cell\_index);}
\DoxyCodeLine{00616\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/ue\+\_\+scheduling/ue\+\_\+event\+\_\+manager.\+h\item 
lib/scheduler/ue\+\_\+scheduling/ue\+\_\+event\+\_\+manager.\+cpp\end{DoxyCompactItemize}
