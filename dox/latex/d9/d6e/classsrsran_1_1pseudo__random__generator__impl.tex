\doxysection{srsran\+::pseudo\+\_\+random\+\_\+generator\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1pseudo__random__generator__impl}{}\label{classsrsran_1_1pseudo__random__generator__impl}\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}


SSE-\/optimized implementation of the pseudo-\/random generator.  




{\ttfamily \#include $<$pseudo\+\_\+random\+\_\+generator\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::pseudo\+\_\+random\+\_\+generator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{d8/d64/classsrsran_1_1pseudo__random__generator__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::pseudo\+\_\+random\+\_\+generator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{d6/d66/classsrsran_1_1pseudo__random__generator__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_aafee43f2d25d0a66596b338bf4202c7c}\label{classsrsran_1_1pseudo__random__generator__impl_aafee43f2d25d0a66596b338bf4202c7c} 
{\bfseries pseudo\+\_\+random\+\_\+generator\+\_\+impl} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a98de4e3f0fd3f38fc88e711b0bf5ce38}{init}} (\mbox{\hyperlink{classunsigned}{unsigned}} c\+\_\+init) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Initializes the pseudo-\/random generator with the given seed. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a8930064bb345d3d62ad215cbe67345be}{init}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pseudo__random__generator_1_1state__s}{state\+\_\+s}} \&c\+\_\+init) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Initializes the pseudo-\/random generator at the given state. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1pseudo__random__generator_1_1state__s}{state\+\_\+s}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a86c0f58194ea40a1da9a89b1fb09c420}{get\+\_\+state}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Returns the current state of the pseudo-\/random generator. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a18467fd029acc4f602c10f95f74ca1cb}{advance}} (\mbox{\hyperlink{classunsigned}{unsigned}} count) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Advances the pseudo-\/random generator state without generating sequence bits or applying any mask. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a55dae3981b82acb581f146725be9ff1c}{apply\+\_\+xor}} (\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&out, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&in) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em XOR-\/applies the generated sequence to a packed bit buffer. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a22df93687ffa937e77b5cdbaf88443e2}{apply\+\_\+xor}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ out, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$ in) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em XOR-\/applies the generated sequence to an unpacked bit buffer. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a9b86d8909b11e1f9415a59e362e79751}{apply\+\_\+xor}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classsrsran_1_1log__likelihood__ratio}{log\+\_\+likelihood\+\_\+ratio}} $>$ out, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1log__likelihood__ratio}{log\+\_\+likelihood\+\_\+ratio}} $>$ in) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em XOR-\/applies the generated sequence to a buffer of log-\/likelihood ratios. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_a4356bdf499771da291e982f9dbffce06}{generate}} (\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&data) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Generates a bit pseudo-\/random sequence. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__impl_ab342c0fa23bc900d75e7c49290df8818}{generate}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classfloat}{float}} $>$ buffer, \mbox{\hyperlink{classfloat}{float}} value) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Generates a floating-\/point pseudo-\/random sequence with the given amplitude. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator}{srsran\+::pseudo\+\_\+random\+\_\+generator}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}pseudo\+\_\+random\+\_\+generator} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_a4c1c914cd4aee85233757e7f99176d87}{generate}} (\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}} $>$ buffer, \mbox{\hyperlink{classfloat}{float}} value)
\begin{DoxyCompactList}\small\item\em Generates a complex floating-\/point pseudo-\/random sequence with the given amplitude. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
SSE-\/optimized implementation of the pseudo-\/random generator. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a18467fd029acc4f602c10f95f74ca1cb}\label{classsrsran_1_1pseudo__random__generator__impl_a18467fd029acc4f602c10f95f74ca1cb} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!advance@{advance}}
\index{advance@{advance}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{advance()}{advance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::advance (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{count }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Advances the pseudo-\/random generator state without generating sequence bits or applying any mask. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em count} & Number of state advance steps (corresponds to the number of sequence bits that would be generated by the same state advance). \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_a44e6256edb70a72aa16280b4138afebe}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \{}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordflow}{while}\ (count\ !=\ 0)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{comment}{//\ Ceil\ the\ number\ of\ steps\ to\ advance\ to\ the\ maximum\ number\ of\ steps.}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ n\ =\ std::min(pseudo\_random\_state\_fast\_advance\_max\_steps,\ count);}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{//\ Advance\ sequence\ states.}}
\DoxyCodeLine{00077\ \ \ \ \ fast\_advance.advance(x1,\ x2,\ n);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{//\ Decrement\ count.}}
\DoxyCodeLine{00080\ \ \ \ \ count\ -\/=\ n;}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a55dae3981b82acb581f146725be9ff1c}\label{classsrsran_1_1pseudo__random__generator__impl_a55dae3981b82acb581f146725be9ff1c} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!apply\_xor@{apply\_xor}}
\index{apply\_xor@{apply\_xor}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{apply\_xor()}{apply\_xor()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::apply\+\_\+xor (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{out,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{in }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



XOR-\/applies the generated sequence to a packed bit buffer. 

The generated sequence is used to scramble (bit-\/wise XOR each element) the input sequence. Both input and output sequences are represented in unpacked format (each entry corresponds to 1 bit).


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em out} & Output data sequence. \\
\hline
\mbox{\texttt{ in}}  & {\em in} & Input data sequence. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Input and output sequences should have the same length. 

This method modifies the internal state of the pseudo-\/random generator. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_ad681c9a896d23900599745b3efcd33b0}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00249\ \{}
\DoxyCodeLine{00250\ \ \ srsran\_assert(in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ ==\ out.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Input\ size\ (i.e.,\ \{\})\ and\ output\ size\ (i.e.,\ \{\})\ must\ be\ equal."{}},}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}(),}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}());}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \textcolor{comment}{//\ Number\ of\ bits\ per\ processing\ word.}}
\DoxyCodeLine{00256\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}}\ =\ 8;}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \textcolor{comment}{//\ Calculate\ the\ maximum\ number\ of\ simultaneous\ words\ to\ process.}}
\DoxyCodeLine{00259\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}}\ =\ 64\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}};}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \textcolor{comment}{//\ Calculate\ the\ maximum\ number\ of\ simultaneous\ bits\ to\ process.}}
\DoxyCodeLine{00262\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}};}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \textcolor{comment}{//\ Create\ sequence\ with\ the\ current\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00265\ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence}{pseudo\_random\_generator\_sequence}}\ sequence(x1,\ x2);}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \textcolor{comment}{//\ Processes\ batches\ of\ words.}}
\DoxyCodeLine{00268\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}\ =\ 0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte\_end}}\ =\ (in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}};\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte\_end}};}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}\ +=\ 8)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ uint64\_t\ c\ =\ sequence.step64();}
\DoxyCodeLine{00271\ \ \ \ \ c\ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_builtin\_bswap64}}(c);}
\DoxyCodeLine{00272\ \ \ \ \ uint64\_t\ temp;}
\DoxyCodeLine{00273\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{memcpy}}(\&temp,\ \&in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}()[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}],\ 8);}
\DoxyCodeLine{00274\ \ \ \ \ temp\ \string^=\ c;}
\DoxyCodeLine{00275\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{memcpy}}(\&out.\mbox{\hyperlink{classsrsran_1_1bit__buffer_abe4140b787ae23537082f998f43aad45}{get\_buffer}}()[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}],\ \&temp,\ 8);}
\DoxyCodeLine{00276\ \ \ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \textcolor{comment}{//\ Process\ spare\ bits\ in\ a\ batch\ of\ the\ remainder\ bits.}}
\DoxyCodeLine{00279\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ \ \ \ \ =\ (in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};}
\DoxyCodeLine{00280\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ =\ in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a1fb9f58eca152546267cb24e18f9b6f0}{size}}()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}};}
\DoxyCodeLine{00281\ \ \ \textcolor{keywordtype}{unsigned}\ count\ \ \ \ \ =\ 0;}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ !=\ 0)\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}}\ \ \ \ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}},\ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence_ac1b0b854c5a1ce42a68011fb839d8a76}{pseudo\_random\_generator\_sequence::get\_max\_step\_size}}());}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{reminder\_size}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}};}
\DoxyCodeLine{00285\ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ \ \ \ \ \ \ \ \ \ \ \ \ =\ sequence.step(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}});}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{comment}{//\ Process\ bits.}}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}}\ !=\ 0)\ \{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ per\ byte\ basis,\ ceiling\ at\ the\ remainder.}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}}\ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}});}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ =\ in.\mbox{\hyperlink{classsrsran_1_1bit__buffer_ab4650aa5eccca52eea8a7cb4d14702a7}{extract}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}});}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{comment}{//\ Shift\ to\ align\ the\ reversed\ sequence\ LSB\ with\ the\ remainder\ bits.}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{right\_shift}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}};}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ output\ byte.}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{output\_word}}\ =}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_word}}\ \string^\ ((\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classuint8__t}{uint8\_t}}\textcolor{keyword}{>}((c\ >>\ (24u\ -\/\ (count\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}})))\ \&\ 0xff))\ >>\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{right\_shift}});}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \textcolor{comment}{//\ Insert\ the\ output\ byte.}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ out.\mbox{\hyperlink{classsrsran_1_1bit__buffer_a6a4cc3c118ab69642f23eaed6aa6868c}{insert}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{output\_word}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}});}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \ \ \textcolor{comment}{//\ Advance\ bit\ index.}}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \ \ \textcolor{comment}{//\ Decrement\ remainder.}}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}}\ -\/=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}};}
\DoxyCodeLine{00309\ \ \ \ \ \ \ ++count;}
\DoxyCodeLine{00310\ \ \ \ \ \}}
\DoxyCodeLine{00311\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ -\/=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{reminder\_size}};}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ \ \ \textcolor{comment}{//\ Update\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00314\ \ \ x1\ =\ sequence.get\_x1();}
\DoxyCodeLine{00315\ \ \ x2\ =\ sequence.get\_x2();}
\DoxyCodeLine{00316\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a9b86d8909b11e1f9415a59e362e79751}\label{classsrsran_1_1pseudo__random__generator__impl_a9b86d8909b11e1f9415a59e362e79751} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!apply\_xor@{apply\_xor}}
\index{apply\_xor@{apply\_xor}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{apply\_xor()}{apply\_xor()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::apply\+\_\+xor (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classsrsran_1_1log__likelihood__ratio}{log\+\_\+likelihood\+\_\+ratio}} $>$}]{out,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1log__likelihood__ratio}{log\+\_\+likelihood\+\_\+ratio}} $>$}]{in }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



XOR-\/applies the generated sequence to a buffer of log-\/likelihood ratios. 

The generated sequence is used to scramble (bit-\/wise XOR each element) the input sequence of soft bits. \begin{DoxyNote}{Note}
Here, the XOR operation between a log-\/likelihood ratio $\ell$ and a (pseudo-\/random) bit $b$ returns $\ell$ if $b = 0$ and $-\ell$ if $b = 1$.
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em out} & Ouput data sequence. \\
\hline
\mbox{\texttt{ in}}  & {\em in} & Input data sequence. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Input and output sequences should have the same length. 

This method modifies the internal state of the pseudo-\/random generator. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_abf45d82d803309c4bcbc44d66fa0efc9}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00424\ \{}
\DoxyCodeLine{00425\ \ \ srsran\_assert(in.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ ==\ out.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Input\ size\ (i.e.,\ \{\})\ and\ output\ size\ (i.e.,\ \{\})\ must\ be\ equal."{}},}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \textcolor{keywordtype}{unsigned}\ i\ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00431\ \ \ \textcolor{keywordtype}{unsigned}\ length\ =\ in.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}();}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \textcolor{comment}{//\ Number\ of\ bits\ that\ can\ be\ processed\ with\ a\ SIMD\ register.}}
\DoxyCodeLine{00434\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}}\ =\ 16;}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \textcolor{comment}{//\ Calculate\ maximum\ number\ of\ SIMD\ words\ that\ can\ be\ generated\ in\ parallel.}}
\DoxyCodeLine{00437\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_word\_step}}\ =}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence_ac1b0b854c5a1ce42a68011fb839d8a76}{pseudo\_random\_generator\_sequence::get\_max\_step\_size}}()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}};}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ bits\ for\ sequence\ step.}}
\DoxyCodeLine{00441\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_word\_step}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}};}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \textcolor{comment}{//\ Create\ sequence\ with\ the\ current\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00444\ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence}{pseudo\_random\_generator\_sequence}}\ sequence(x1,\ x2);}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_end}}\ =\ (length\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_end}};\ i\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ \{}
\DoxyCodeLine{00447\ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ =\ sequence.step<\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}>();}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ j\ =\ 0;}
\DoxyCodeLine{00450\ \textcolor{preprocessor}{\#ifdef\ \_\_SSE3\_\_}}
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ j\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}})\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \textcolor{comment}{//\ Preloads\ bits\ of\ interest\ in\ the\ 16\ LSB.}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi32}}(c);}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_shuffle\_epi8}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_setr\_epi8}}(3,\ 3,\ 3,\ 3,\ 3,\ 3,\ 3,\ 3,\ 2,\ 2,\ 2,\ 2,\ 2,\ 2,\ 2,\ 2));}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \textcolor{comment}{//\ Masks\ each\ bit.}}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_and\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set\_epi64x}}(0x102040810204080,\ 0x102040810204080));}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ non\ zero\ mask.}}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_cmpeq\_epi8}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set\_epi64x}}(0x102040810204080,\ 0x102040810204080));}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ input.}}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_loadu\_si128}}((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}*)(\&in[i\ +\ j]));}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \ \ \ \ \textcolor{comment}{//\ Negate.}}
\DoxyCodeLine{00466\ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_xor\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ v);}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ one.}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_and\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi8}}(1));}
\DoxyCodeLine{00470\ \ \ \ \ \ \ v\ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_add\_epi8}}(v,\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}});}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_storeu\_si128}}((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}*)(\&out[i\ +\ j]),\ v);}
\DoxyCodeLine{00473\ \ \ \ \ \}}
\DoxyCodeLine{00474\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_SSE3\_\_}}
\DoxyCodeLine{00475\ \textcolor{preprocessor}{\#ifdef\ \_\_aarch64\_\_}}
\DoxyCodeLine{00476\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ j\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}})\ \{}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \textcolor{comment}{//\ Preloads\ bits\ of\ interest\ in\ the\ 16\ LSB.}}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint32x2\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{c\_dup\_u32}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdup\_n\_u32}}(c);}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint8x16\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcombine\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdup\_lane\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpret\_u8\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{c\_dup\_u32}}),\ 3),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdup\_lane\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpret\_u8\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{c\_dup\_u32}}),\ 2));}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ bit\ masks.}}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks}}[8]\ =\ \{0x80,\ 0x40,\ 0x20,\ 0x10,\ 0x08,\ 0x04,\ 0x02,\ 0x01\};}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint8x16\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcombine\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcreate\_u8}}(*(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint64\_t*\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks}}))),}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcreate\_u8}}(*(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint64\_t*\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks}}))));}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \textcolor{comment}{//\ Mask\ each\ bit.}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vandq\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks\_u8}});}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ non\ zero\ mask.}}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vceqq\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks\_u8}});}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ input.}}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{int8x16\_t}}\ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vld1q\_s8}}(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }int8\_t*\textcolor{keyword}{>}(\&in[i\ +\ j]));}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \ \ \ \ \textcolor{comment}{//\ Negate.}}
\DoxyCodeLine{00496\ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{veorq\_s8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpretq\_s8\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}),\ v);}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ one.}}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{int8x16\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{one\_s8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vandq\_s8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpretq\_s8\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdupq\_n\_s8}}(1));}
\DoxyCodeLine{00500\ \ \ \ \ \ \ v\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vaddq\_s8}}(v,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{one\_s8}});}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ result.}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vst1q\_s8}}(\textcolor{keyword}{reinterpret\_cast<}int8\_t*\textcolor{keyword}{>}(\&out[i\ +\ j]),\ v);}
\DoxyCodeLine{00504\ \ \ \ \ \}}
\DoxyCodeLine{00505\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_aarch64\_\_}}
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ ++j)\ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ out[i\ +\ j]\ =\ in[i\ +\ j].to\_value\_type()\ *\ ((c\ <<\ j\ \&\ 0x80000000)\ ?\ -\/1\ :\ +1);}
\DoxyCodeLine{00508\ \ \ \ \ \}}
\DoxyCodeLine{00509\ \ \ \}}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \textcolor{comment}{//\ Apply\ remainder\ bits.}}
\DoxyCodeLine{00512\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ =\ length\ -\/\ i;}
\DoxyCodeLine{00513\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ \ \ \ \ \ \ \ \ =\ sequence.step(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}});}
\DoxyCodeLine{00514\ \ \ \textcolor{keywordflow}{for}\ (;\ i\ !=\ length;\ ++i)\ \{}
\DoxyCodeLine{00515\ \ \ \ \ out[i]\ =\ in[i].to\_value\_type()\ *\ (c\ \&\ 0x80000000\ ?\ -\/1\ :\ 1);}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ c\ =\ c\ <<\ 1;}
\DoxyCodeLine{00518\ \ \ \}}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \textcolor{comment}{//\ Update\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00521\ \ \ x1\ =\ sequence.get\_x1();}
\DoxyCodeLine{00522\ \ \ x2\ =\ sequence.get\_x2();}
\DoxyCodeLine{00523\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a22df93687ffa937e77b5cdbaf88443e2}\label{classsrsran_1_1pseudo__random__generator__impl_a22df93687ffa937e77b5cdbaf88443e2} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!apply\_xor@{apply\_xor}}
\index{apply\_xor@{apply\_xor}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{apply\_xor()}{apply\_xor()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::apply\+\_\+xor (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{out,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classuint8__t}{uint8\+\_\+t}} $>$}]{in }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



XOR-\/applies the generated sequence to an unpacked bit buffer. 

The generated sequence is used to scramble (bit-\/wise XOR each element) the input sequence. Both input and output sequence are represented in unpacked format (each entry corresponds to 1 bit).


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em out} & Output data sequence. \\
\hline
\mbox{\texttt{ in}}  & {\em in} & Input data sequence. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Input and output sequences should have the same length. 

This method modifies the internal state of the pseudo-\/random generator. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_a371f549d67b1378bc787434e97177a11}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00319\ \{}
\DoxyCodeLine{00320\ \ \ srsran\_assert(in.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ ==\ out.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Input\ size\ (i.e.,\ \{\})\ and\ output\ size\ (i.e.,\ \{\})\ must\ be\ equal."{}},}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}());}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{comment}{//\ Number\ of\ bits\ that\ can\ be\ processed\ with\ a\ SIMD\ register.}}
\DoxyCodeLine{00326\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}}\ =\ 16;}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \textcolor{comment}{//\ Calculate\ maximum\ number\ of\ SIMD\ words\ that\ can\ be\ generated\ in\ parallel.}}
\DoxyCodeLine{00329\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_word\_step}}\ =}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence_ac1b0b854c5a1ce42a68011fb839d8a76}{pseudo\_random\_generator\_sequence::get\_max\_step\_size}}()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}};}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ bits\ for\ sequence\ step.}}
\DoxyCodeLine{00333\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_word\_step}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}};}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \textcolor{comment}{//\ Create\ sequence\ with\ the\ current\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00336\ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence}{pseudo\_random\_generator\_sequence}}\ sequence(x1,\ x2);}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \textcolor{keywordtype}{unsigned}\ i\ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00339\ \ \ \textcolor{keywordtype}{unsigned}\ length\ =\ in.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}();}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_end}}\ =\ (length\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_end}};\ i\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ \{}
\DoxyCodeLine{00342\ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ =\ sequence.step<\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}>();}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ j\ =\ 0;}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{\#ifdef\ \_\_SSE3\_\_}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ j\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}})\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \textcolor{comment}{//\ Preloads\ bits\ of\ interest\ in\ the\ 16\ LSB}}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi32}}(c);}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_shuffle\_epi8}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_setr\_epi8}}(3,\ 3,\ 3,\ 3,\ 3,\ 3,\ 3,\ 3,\ 2,\ 2,\ 2,\ 2,\ 2,\ 2,\ 2,\ 2));}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \ \ \textcolor{comment}{//\ Masks\ each\ bit.}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_and\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set\_epi64x}}(0x102040810204080,\ 0x102040810204080));}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ non\ zero\ mask.}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_cmpeq\_epi8}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set\_epi64x}}(0x102040810204080,\ 0x102040810204080));}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{comment}{//\ Reduce\ to\ 1s\ and\ 0s.}}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_and\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi8}}(1));}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ input.}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_loadu\_si128}}((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}*)(\&in[i\ +\ j]));}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ XOR.}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_xor\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ v);}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ output.}}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_storeu\_si128}}((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}*)(\&out[i\ +\ j]),\ v);}
\DoxyCodeLine{00368\ \ \ \ \ \}}
\DoxyCodeLine{00369\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_SSE3\_\_}}
\DoxyCodeLine{00370\ \textcolor{preprocessor}{\#ifdef\ \_\_aarch64\_\_}}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ j\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}})\ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{comment}{//\ Preloads\ bits\ of\ interest\ in\ the\ 16\ LSB.}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint32x2\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{c\_dup\_u32}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdup\_n\_u32}}(c);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint8x16\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcombine\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdup\_lane\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpret\_u8\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{c\_dup\_u32}}),\ 3),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdup\_lane\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpret\_u8\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{c\_dup\_u32}}),\ 2));}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ bit\ masks.}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks}}[8]\ =\ \{0x80,\ 0x40,\ 0x20,\ 0x10,\ 0x08,\ 0x04,\ 0x02,\ 0x01\};}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint8x16\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcombine\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcreate\_u8}}(*(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint64\_t*\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks}}))),}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcreate\_u8}}(*(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }uint64\_t*\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks}}))));}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \textcolor{comment}{//\ Mask\ each\ bit.}}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vandq\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks\_u8}});}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ non\ zero\ mask.}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vceqq\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit\_masks\_u8}});}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \ \ \textcolor{comment}{//\ Reduce\ to\ 1s\ and\ 0s.}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vandq\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdupq\_n\_u8}}(1));}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ input.}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint8x16\_t}}\ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vld1q\_u8}}(\&in[i\ +\ j]);}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ XOR.}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{veorq\_u8}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u8}},\ v);}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ output.}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vst1q\_u8}}(\&out[i\ +\ j],\ v);}
\DoxyCodeLine{00398\ \ \ \ \ \}}
\DoxyCodeLine{00399\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_aarch64\_\_}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Apply\ mask\ to\ remainder\ bits.}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ ++j)\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}}\ =\ (c\ \&\ (1U\ <<\ 31U))\ !=\ 0;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ out[i\ +\ j]\ \ \ =\ in[i\ +\ j]\ \string^\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}};}
\DoxyCodeLine{00405\ \ \ \ \ \ \ c\ \ \ \ \ \ \ \ \ \ \ \ =\ c\ <<\ 1U;}
\DoxyCodeLine{00406\ \ \ \ \ \}}
\DoxyCodeLine{00407\ \ \ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \textcolor{comment}{//\ Apply\ remainder\ bits.}}
\DoxyCodeLine{00410\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ =\ length\ -\/\ i;}
\DoxyCodeLine{00411\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ \ \ \ \ \ \ \ \ =\ sequence.step(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}});}
\DoxyCodeLine{00412\ \ \ \textcolor{keywordflow}{for}\ (;\ i\ !=\ length;\ ++i)\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}}\ =\ (c\ \&\ (1U\ <<\ 31U))\ !=\ 0;}
\DoxyCodeLine{00414\ \ \ \ \ out[i]\ \ \ \ \ \ \ =\ in[i]\ \string^\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{bit}};}
\DoxyCodeLine{00415\ \ \ \ \ c\ \ \ \ \ \ \ \ \ \ \ \ =\ c\ <<\ 1U;}
\DoxyCodeLine{00416\ \ \ \}}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \textcolor{comment}{//\ Update\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00419\ \ \ x1\ =\ sequence.get\_x1();}
\DoxyCodeLine{00420\ \ \ x2\ =\ sequence.get\_x2();}
\DoxyCodeLine{00421\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a4356bdf499771da291e982f9dbffce06}\label{classsrsran_1_1pseudo__random__generator__impl_a4356bdf499771da291e982f9dbffce06} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!generate@{generate}}
\index{generate@{generate}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{generate()}{generate()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::generate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1bit__buffer}{bit\+\_\+buffer}} \&}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Generates a bit pseudo-\/random sequence. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em data} & Output sequence. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_a73db4620e1308e1b3e7490350341a17c}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00085\ \{}
\DoxyCodeLine{00086\ \ \ \textcolor{comment}{//\ Number\ of\ bits\ per\ processing\ word.}}
\DoxyCodeLine{00087\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}}\ =\ 8;}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ Calculate\ the\ maximum\ number\ of\ simultaneous\ words\ to\ process.}}
\DoxyCodeLine{00090\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}}\ =\ 64\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \textcolor{comment}{//\ Calculate\ the\ maximum\ number\ of\ simultaneous\ bits\ to\ process.}}
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}};}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \textcolor{comment}{//\ Create\ sequence\ with\ the\ current\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence}{pseudo\_random\_generator\_sequence}}\ sequence(x1,\ x2);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{comment}{//\ Processes\ batches\ of\ 64\ bits\ in\ parallel.}}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}\ =\ 0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte\_end}}\ =\ (data.size()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}};\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte\_end}};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}}\ +=\ 8)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ uint64\_t\ c\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ sequence.step64();}
\DoxyCodeLine{00102\ \ \ \ \ c\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_builtin\_bswap64}}(c);}
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<uint8\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{output\_chunk}}\ =\ data.get\_buffer().subspan(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_byte}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}});}
\DoxyCodeLine{00104\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{memcpy}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{output\_chunk}}.data(),\ \&c,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bytes\_step}});}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \textcolor{comment}{//\ Process\ spare\ bits\ in\ a\ batch\ of\ the\ remainder\ bits.}}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ \ \ \ \ =\ (data.size()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ =\ data.size()\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}};}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{unsigned}\ count\ \ \ \ \ =\ 0;}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ !=\ 0)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}}\ \ \ \ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}},\ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence_ac1b0b854c5a1ce42a68011fb839d8a76}{pseudo\_random\_generator\_sequence::get\_max\_step\_size}}());}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{reminder\_size}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}};}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ \ \ \ \ \ \ \ \ \ \ \ \ =\ sequence.step(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}});}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}}\ !=\ 0)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \textcolor{comment}{//\ Process\ per\ byte\ basis,\ ceiling\ at\ the\ remainder.}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}}\ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}});}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \textcolor{comment}{//\ Mask\ the\ LSB\ of\ the\ sequence.}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_lsb\_ones<uint32\_t>}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}});}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{comment}{//\ Shift\ to\ align\ the\ reversed\ sequence\ LSB\ with\ the\ remainder\ bits.}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{right\_shift}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ output\ byte.}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \mbox{\hyperlink{classuint8__t}{uint8\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{output\_word}}\ =\ ((c\ >>\ (24u\ -\/\ (count\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_byte}})))\ \&\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}})\ >>\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{right\_shift}};}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{comment}{//\ Insert\ the\ output\ byte.}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ data.insert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{output\_word}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}});}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \textcolor{comment}{//\ Advance\ bit\ index.}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_bit}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}};}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \ \ \textcolor{comment}{//\ Decrement\ remainder.}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{batch\_size}}\ -\/=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{word\_size}};}
\DoxyCodeLine{00137\ \ \ \ \ \ \ ++count;}
\DoxyCodeLine{00138\ \ \ \ \ \}}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ -\/=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{reminder\_size}};}
\DoxyCodeLine{00140\ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ x1\ =\ sequence.get\_x1();}
\DoxyCodeLine{00143\ \ \ x2\ =\ sequence.get\_x2();}
\DoxyCodeLine{00144\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_ab342c0fa23bc900d75e7c49290df8818}\label{classsrsran_1_1pseudo__random__generator__impl_ab342c0fa23bc900d75e7c49290df8818} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!generate@{generate}}
\index{generate@{generate}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{generate()}{generate()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::generate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{classfloat}{float}} $>$}]{buffer,  }\item[{\mbox{\hyperlink{classfloat}{float}}}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Generates a floating-\/point pseudo-\/random sequence with the given amplitude. 

The elements of the generated sequence will have the form $\pm a$, where $a$ denotes the amplitude.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em buffer} & Output sequence. \\
\hline
\mbox{\texttt{ in}}  & {\em value} & Sequence amplitude. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
The sequence length is inferred from the size of the output container. 

This method modifies the internal state of the pseudo-\/random generator. 
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_ae94037e4d13040e4ae80a7e0b53f1cea}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00155\ \{}
\DoxyCodeLine{00156\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ i\ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00157\ \ \ \textcolor{keywordtype}{unsigned}\ length\ =\ out.size();}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \textcolor{comment}{//\ Number\ of\ bits\ that\ can\ be\ processed\ with\ a\ SIMD\ register.}}
\DoxyCodeLine{00160\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}}\ =\ 4;}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \textcolor{comment}{//\ Calculate\ maximum\ number\ of\ SIMD\ words\ that\ can\ be\ generated\ in\ parallel.}}
\DoxyCodeLine{00163\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_word\_step}}\ =}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence_ac1b0b854c5a1ce42a68011fb839d8a76}{pseudo\_random\_generator\_sequence::get\_max\_step\_size}}()\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}};}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \textcolor{comment}{//\ Calculate\ the\ number\ of\ bits\ for\ sequence\ step.}}
\DoxyCodeLine{00167\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_word\_step}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}};}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ Create\ sequence\ with\ the\ current\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00170\ \ \ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator__sequence}{pseudo\_random\_generator\_sequence}}\ sequence(x1,\ x2);}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{comment}{//\ Process\ in\ batches\ of\ max\_nof\_bits\_step\ bits.}}
\DoxyCodeLine{00173\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_end}}\ =\ (length\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ i\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_end}};\ i\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}})\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ =\ sequence.step<\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}}>();}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ j\ =\ 0;}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\#ifdef\ \_\_SSE3\_\_}}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ j\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}})\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \textcolor{comment}{//\ Preloads\ bits\ of\ interest\ in\ the\ 4\ MSB.}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi32}}(c\ <<\ j);}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{comment}{//\ Masks\ each\ bit.}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_and\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_setr\_epi32}}(0x80000000,\ 0x40000000,\ 0x20000000,\ 0x10000000));}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ non\ zero\ mask.}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ offset\ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi32}}(0x80000000);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_add\_epi32}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ offset);}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{adjusted\_zero}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_add\_epi32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_epi32}}(0),\ offset);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_cmpgt\_epi32}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{adjusted\_zero}});}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \ \ \textcolor{comment}{//\ And\ with\ MSB.}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_and\_si128}}(\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128i}})\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_ps}}(-\/0.0F));}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ input.}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128}}\ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_set1\_ps}}(value);}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \ \ \textcolor{comment}{//\ Loads\ input\ and\ perform\ sign\ XOR.}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_xor\_ps}}((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_\_m128}})\mbox{\hyperlink{namespacesrsran_ad24c439c1013fdd70334019fc3d1d1fbaf2ce11ebf110993621bedd8e747d7b1b}{mask}},\ v);}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{\_mm\_storeu\_ps}}(\&out[i\ +\ j],\ v);}
\DoxyCodeLine{00201\ \ \ \ \ \}}
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_SSE3\_\_}}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\#ifdef\ \_\_aarch64\_\_}}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ j\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_bits\_per\_simd}})\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \textcolor{comment}{//\ Preloads\ bits\ of\ interest\ in\ the\ 4\ MSB.}}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint32x4\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdupq\_n\_u32}}(c\ <<\ j);}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{comment}{//\ Masks\ each\ bit.}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{uint32x4\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tmp\_mask}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcombine\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcreate\_u32}}(0x4000000080000000UL),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcreate\_u32}}(0x1000000020000000UL));}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vandq\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tmp\_mask}});}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ non\ zero\ mask.}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vcgtq\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdupq\_n\_u32}}(0));}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \textcolor{comment}{//\ And\ with\ MSB.}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vandq\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpretq\_u32\_f32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdupq\_n\_f32}}(-\/0.0F)));}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ input.}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{float32x4\_t}}\ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vdupq\_n\_f32}}(value);}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{comment}{//\ Loads\ input\ and\ perform\ sign\ XOR.}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpretq\_f32\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{veorq\_u32}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mask\_u32}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vreinterpretq\_u32\_f32}}(v)));}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{vst1q\_f32}}(\&out[i\ +\ j],\ v);}
\DoxyCodeLine{00226\ \ \ \ \ \}}
\DoxyCodeLine{00227\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_aarch64\_\_}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{comment}{//\ Finish\ the\ parallel\ bits\ with\ generic\ code.}}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ j\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{max\_nof\_bits\_step}};\ ++j)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ FLOAT\_U32\_XOR(out[i\ +\ j],\ value,\ (c\ <<\ j)\ \&\ 0x80000000);}
\DoxyCodeLine{00232\ \ \ \ \ \}}
\DoxyCodeLine{00233\ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}}\ =\ length\ -\/\ i;}
\DoxyCodeLine{00236\ \ \ \mbox{\hyperlink{classuint32__t}{uint32\_t}}\ c\ \ \ \ \ \ \ \ \ =\ sequence.step(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{remainder}});}
\DoxyCodeLine{00237\ \ \ \textcolor{keywordflow}{for}\ (;\ i\ !=\ length;\ ++i)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ FLOAT\_U32\_XOR(out[i],\ value,\ c\ \&\ 0x80000000);}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ c\ =\ c\ <<\ 1U;}
\DoxyCodeLine{00241\ \ \ \}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \textcolor{comment}{//\ Update\ x1\ and\ x2\ states.}}
\DoxyCodeLine{00244\ \ \ x1\ =\ sequence.get\_x1();}
\DoxyCodeLine{00245\ \ \ x2\ =\ sequence.get\_x2();}
\DoxyCodeLine{00246\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a86c0f58194ea40a1da9a89b1fb09c420}\label{classsrsran_1_1pseudo__random__generator__impl_a86c0f58194ea40a1da9a89b1fb09c420} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!get\_state@{get\_state}}
\index{get\_state@{get\_state}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{get\_state()}{get\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1pseudo__random__generator_1_1state__s}{pseudo\+\_\+random\+\_\+generator\+::state\+\_\+s}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::get\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Returns the current state of the pseudo-\/random generator. 



Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_ab9d3af5c13480307023178a8368b145d}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00526\ \{}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{return}\ \{x1,\ x2\};}
\DoxyCodeLine{00528\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a8930064bb345d3d62ad215cbe67345be}\label{classsrsran_1_1pseudo__random__generator__impl_a8930064bb345d3d62ad215cbe67345be} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!init@{init}}
\index{init@{init}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{init()}{init()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pseudo__random__generator_1_1state__s}{state\+\_\+s}} \&}]{state }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Initializes the pseudo-\/random generator at the given state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em state} & Generator internal state description. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_a825fe1a367cf3de447665daf4313e2c2}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00065\ \{}
\DoxyCodeLine{00066\ \ \ x1\ =\ state.x1;}
\DoxyCodeLine{00067\ \ \ x2\ =\ state.x2;}
\DoxyCodeLine{00068\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pseudo__random__generator__impl_a98de4e3f0fd3f38fc88e711b0bf5ce38}\label{classsrsran_1_1pseudo__random__generator__impl_a98de4e3f0fd3f38fc88e711b0bf5ce38} 
\index{srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}!init@{init}}
\index{init@{init}!srsran::pseudo\_random\_generator\_impl@{srsran::pseudo\_random\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{init()}{init()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pseudo\+\_\+random\+\_\+generator\+\_\+impl\+::init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{c\+\_\+init }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Initializes the pseudo-\/random generator with the given seed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c\+\_\+init} & Initialization seed (parameter $c_{\textup{init}}$ in TS38.\+211 Section 5.\+2.\+1). \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator_a6ba8ae8647c1965f021af233c800172c}{srsran\+::pseudo\+\_\+random\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00059\ \{}
\DoxyCodeLine{00060\ \ \ x1\ =\ x1\_init.\mbox{\hyperlink{classsrsran_1_1pseudo__random__initializer__x1_a43d5c020a7d77eff44d63a5e0cfc0b1c}{get\_reverse}}();}
\DoxyCodeLine{00061\ \ \ x2\ =\ x2\_init.\mbox{\hyperlink{classsrsran_1_1pseudo__random__initializer__x2_a8d4c73db7b0a1857b06164fccb34f55d}{get\_reverse}}(c\_init);}
\DoxyCodeLine{00062\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/upper/sequence\+\_\+generators/\mbox{\hyperlink{pseudo__random__generator__impl_8h}{pseudo\+\_\+random\+\_\+generator\+\_\+impl.\+h}}\item 
lib/phy/upper/sequence\+\_\+generators/pseudo\+\_\+random\+\_\+generator\+\_\+impl.\+cpp\end{DoxyCompactItemize}
