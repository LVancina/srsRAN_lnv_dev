\doxysection{srsran\+::ru\+\_\+dummy\+\_\+sector Class Reference}
\hypertarget{classsrsran_1_1ru__dummy__sector}{}\label{classsrsran_1_1ru__dummy__sector}\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}


Implements a RU dummy sector.  




{\ttfamily \#include $<$ru\+\_\+dummy\+\_\+sector.\+h$>$}



Inheritance diagram for srsran\+::ru\+\_\+dummy\+\_\+sector\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d3/daa/classsrsran_1_1ru__dummy__sector__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::ru\+\_\+dummy\+\_\+sector\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{db/dab/classsrsran_1_1ru__dummy__sector__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1ru__dummy__sector_a7a6a8625b94de187e0dad65232ddb848}{ru\+\_\+dummy\+\_\+sector}} (\mbox{\hyperlink{classunsigned}{unsigned}} sector\+\_\+id, \mbox{\hyperlink{classunsigned}{unsigned}} rx\+\_\+rg\+\_\+nof\+\_\+prb, \mbox{\hyperlink{classunsigned}{unsigned}} rx\+\_\+rg\+\_\+nof\+\_\+ports, \mbox{\hyperlink{classunsigned}{unsigned}} rx\+\_\+prach\+\_\+nof\+\_\+ports, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\+\_\+data\+\_\+margin\+\_\+}}, \mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__rx__symbol__notifier}{ru\+\_\+uplink\+\_\+plane\+\_\+rx\+\_\+symbol\+\_\+notifier}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\+\_\+notifier\+\_\+}})
\begin{DoxyCompactList}\small\item\em Creates a dummy RU sector. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1ru__dummy__sector_afbc07720e3e2860c0b42762c7ebf3a7e}{ru\+\_\+dummy\+\_\+sector}} (\mbox{\hyperlink{classsrsran_1_1ru__dummy__sector}{ru\+\_\+dummy\+\_\+sector}} \&\&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{noexcept}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ru__dummy__sector_a5b283e2e149218081231abc1e9884648}{handle\+\_\+dl\+\_\+data}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1resource__grid__context}{resource\+\_\+grid\+\_\+context}} \&context, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1resource__grid__reader}{resource\+\_\+grid\+\_\+reader}} \&grid) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Handles the given downlink data to be transmitted. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ru__dummy__sector_a3d77833ddf1cd0dd73de5f42b4e78936}{handle\+\_\+prach\+\_\+occasion}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1prach__buffer__context}{prach\+\_\+buffer\+\_\+context}} \&context, \mbox{\hyperlink{classsrsran_1_1prach__buffer}{prach\+\_\+buffer}} \&buffer) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Requests the Radio Unit to capture a PRACH window. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ru__dummy__sector_a2a78fc4927acf453f61ba2da5ae2ffd5}{handle\+\_\+new\+\_\+uplink\+\_\+slot}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1resource__grid__context}{resource\+\_\+grid\+\_\+context}} \&context, \mbox{\hyperlink{classsrsran_1_1resource__grid}{resource\+\_\+grid}} \&grid) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Requests the Radio Unit to provide an uplink slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ru__dummy__sector_afd6ee857803c3783992b17867d293631}{new\+\_\+slot\+\_\+boundary}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}})
\begin{DoxyCompactList}\small\item\em Notifies a new slot boundary. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__handler}{srsran\+::ru\+\_\+uplink\+\_\+plane\+\_\+handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}ru\+\_\+uplink\+\_\+plane\+\_\+handler} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1ru__downlink__plane__handler}{srsran\+::ru\+\_\+downlink\+\_\+plane\+\_\+handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}ru\+\_\+downlink\+\_\+plane\+\_\+handler} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implements a RU dummy sector. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1ru__dummy__sector_a7a6a8625b94de187e0dad65232ddb848}\label{classsrsran_1_1ru__dummy__sector_a7a6a8625b94de187e0dad65232ddb848} 
\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}!ru\_dummy\_sector@{ru\_dummy\_sector}}
\index{ru\_dummy\_sector@{ru\_dummy\_sector}!srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}
\doxysubsubsection{\texorpdfstring{ru\_dummy\_sector()}{ru\_dummy\_sector()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily srsran\+::ru\+\_\+dummy\+\_\+sector\+::ru\+\_\+dummy\+\_\+sector (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{sector\+\_\+id,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{rx\+\_\+rg\+\_\+nof\+\_\+prb,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{rx\+\_\+rg\+\_\+nof\+\_\+ports,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{rx\+\_\+prach\+\_\+nof\+\_\+ports,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{dl\+\_\+data\+\_\+margin\+\_\+,  }\item[{\mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \&}]{logger\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__rx__symbol__notifier}{ru\+\_\+uplink\+\_\+plane\+\_\+rx\+\_\+symbol\+\_\+notifier}} \&}]{symbol\+\_\+notifier\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Creates a dummy RU sector. 


\begin{DoxyParams}{Parameters}
{\em sector\+\_\+id} & Sector identifier. \\
\hline
{\em rx\+\_\+rg\+\_\+nof\+\_\+prb} & Receive resource grid number of PRB. \\
\hline
{\em rx\+\_\+rg\+\_\+nof\+\_\+ports} & Receive resource grid number of ports. \\
\hline
{\em rx\+\_\+prach\+\_\+nof\+\_\+ports} & Receive PRACH buffer number of ports. \\
\hline
{\em dl\+\_\+data\+\_\+margin\+\_\+} & Downlink data handling margin. \\
\hline
{\em logger\+\_\+} & Internal logger, used for notifying real-\/time failures. \\
\hline
{\em symbol\+\_\+notifier\+\_\+} & Receive symbol notifier. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00060\ \ \ \ \ logger(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\_}}),}
\DoxyCodeLine{00061\ \ \ \ \ symbol\_notifier(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{symbol\_notifier\_}}),}
\DoxyCodeLine{00062\ \ \ \ \ rx\_symbols\_resource\_grid(sector\_id,\ rx\_rg\_nof\_prb\ *\ NRE,\ MAX\_NSYMB\_PER\_SLOT,\ rx\_rg\_nof\_ports),}
\DoxyCodeLine{00063\ \ \ \ \ rx\_symbols\_prach\_buffer(sector\_id,\ rx\_prach\_nof\_ports),}
\DoxyCodeLine{00064\ \ \ \ \ dl\_data\_margin(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dl\_data\_margin\_}})}
\DoxyCodeLine{00065\ \ \ \{}
\DoxyCodeLine{00066\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ru__dummy__sector_afbc07720e3e2860c0b42762c7ebf3a7e}\label{classsrsran_1_1ru__dummy__sector_afbc07720e3e2860c0b42762c7ebf3a7e} 
\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}!ru\_dummy\_sector@{ru\_dummy\_sector}}
\index{ru\_dummy\_sector@{ru\_dummy\_sector}!srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}
\doxysubsubsection{\texorpdfstring{ru\_dummy\_sector()}{ru\_dummy\_sector()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily srsran\+::ru\+\_\+dummy\+\_\+sector\+::ru\+\_\+dummy\+\_\+sector (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1ru__dummy__sector}{ru\+\_\+dummy\+\_\+sector}} \&\&}]{other }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00069\ \ \ \ \ logger(\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.logger),}
\DoxyCodeLine{00070\ \ \ \ \ symbol\_notifier(\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.symbol\_notifier),}
\DoxyCodeLine{00071\ \ \ \ \ rx\_symbols\_resource\_grid(std::move(\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.rx\_symbols\_resource\_grid)),}
\DoxyCodeLine{00072\ \ \ \ \ rx\_symbols\_prach\_buffer(std::move(\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.rx\_symbols\_prach\_buffer)),}
\DoxyCodeLine{00073\ \ \ \ \ dl\_data\_margin(\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}}.dl\_data\_margin)}
\DoxyCodeLine{00074\ \ \ \{}
\DoxyCodeLine{00075\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1ru__dummy__sector_a5b283e2e149218081231abc1e9884648}\label{classsrsran_1_1ru__dummy__sector_a5b283e2e149218081231abc1e9884648} 
\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}!handle\_dl\_data@{handle\_dl\_data}}
\index{handle\_dl\_data@{handle\_dl\_data}!srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}
\doxysubsubsection{\texorpdfstring{handle\_dl\_data()}{handle\_dl\_data()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::ru\+\_\+dummy\+\_\+sector\+::handle\+\_\+dl\+\_\+data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1resource__grid__context}{resource\+\_\+grid\+\_\+context}} \&}]{context,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1resource__grid__reader}{resource\+\_\+grid\+\_\+reader}} \&}]{grid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Handles the given downlink data to be transmitted. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em context} & Resource grid context. \\
\hline
\mbox{\texttt{ in}}  & {\em grid} & Downlink data to transmit. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1ru__downlink__plane__handler_a556d51769869850c966cf6e493d768f1}{srsran\+::ru\+\_\+downlink\+\_\+plane\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00079\ \ \ \{}
\DoxyCodeLine{00080\ \ \ \ \ std::lock\_guard<std::mutex>\ lock(dl\_request\_mutex);}
\DoxyCodeLine{00081\ \ \ \ \ resource\_grid\_context\ \ \ \ \ \ \ prev\_context\ =\ std::exchange(dl\_request[context.slot.system\_slot()],\ context);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ If\ the\ previous\ slot\ is\ valid,\ it\ is\ a\ late.}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordflow}{if}\ (prev\_context.slot.valid())\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Real-\/time\ failure\ in\ RU:\ received\ late\ DL\ request\ from\ slot\ \{\}\ in\ sector\ \{\}."{}},}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_context.slot,}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_context.sector);}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ru__dummy__sector_a2a78fc4927acf453f61ba2da5ae2ffd5}\label{classsrsran_1_1ru__dummy__sector_a2a78fc4927acf453f61ba2da5ae2ffd5} 
\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}!handle\_new\_uplink\_slot@{handle\_new\_uplink\_slot}}
\index{handle\_new\_uplink\_slot@{handle\_new\_uplink\_slot}!srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}
\doxysubsubsection{\texorpdfstring{handle\_new\_uplink\_slot()}{handle\_new\_uplink\_slot()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::ru\+\_\+dummy\+\_\+sector\+::handle\+\_\+new\+\_\+uplink\+\_\+slot (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1resource__grid__context}{resource\+\_\+grid\+\_\+context}} \&}]{context,  }\item[{\mbox{\hyperlink{classsrsran_1_1resource__grid}{resource\+\_\+grid}} \&}]{grid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Requests the Radio Unit to provide an uplink slot. 

The Radio Unit must process the slot described by {\ttfamily context} and notify the demodulation per symbol basis of the requested slot.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em context} & Resource grid context. \\
\hline
\mbox{\texttt{ in}}  & {\em buffer} & Resource grid to store the processed slot. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__handler_a770a042785fb042fe94973210bf9acee}{srsran\+::ru\+\_\+uplink\+\_\+plane\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00109\ \ \ \{}
\DoxyCodeLine{00110\ \ \ \ \ std::lock\_guard<std::mutex>\ lock(ul\_request\_mutex);}
\DoxyCodeLine{00111\ \ \ \ \ resource\_grid\_context\ \ \ \ \ \ \ prev\_context\ =\ std::exchange(ul\_request[context.slot.system\_slot()],\ context);}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ Detect\ if\ there\ is\ an\ unhandled\ request\ from\ a\ different\ slot.}}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordflow}{if}\ (prev\_context.slot.valid())\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ logger.warning(context.slot.sfn(),}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context.slot.slot\_index(),}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Real-\/time\ failure\ in\ RU:\ received\ late\ UL\ request\ from\ slot\ \{\}\ in\ sector\ \{\}."{}},}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_context.slot,}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_context.sector);}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ru__dummy__sector_a3d77833ddf1cd0dd73de5f42b4e78936}\label{classsrsran_1_1ru__dummy__sector_a3d77833ddf1cd0dd73de5f42b4e78936} 
\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}!handle\_prach\_occasion@{handle\_prach\_occasion}}
\index{handle\_prach\_occasion@{handle\_prach\_occasion}!srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}
\doxysubsubsection{\texorpdfstring{handle\_prach\_occasion()}{handle\_prach\_occasion()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::ru\+\_\+dummy\+\_\+sector\+::handle\+\_\+prach\+\_\+occasion (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1prach__buffer__context}{prach\+\_\+buffer\+\_\+context}} \&}]{context,  }\item[{\mbox{\hyperlink{classsrsran_1_1prach__buffer}{prach\+\_\+buffer}} \&}]{buffer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Requests the Radio Unit to capture a PRACH window. 

The Radio Unit must capture a PHY window identified by {\ttfamily context}. The capture must start at slot {\ttfamily context.\+slot} and symbol {\ttfamily context.\+start\+\_\+symbol}. The capture must finish once {\ttfamily buffer.\+is\+\_\+full()} returns true.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em context} & PRACH window context. \\
\hline
\mbox{\texttt{ in}}  & {\em buffer} & PRACH buffer used to write the PRACH window. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__handler_a7cb70413945cb5e434715ada76199b67}{srsran\+::ru\+\_\+uplink\+\_\+plane\+\_\+handler}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00093\ \ \ \{}
\DoxyCodeLine{00094\ \ \ \ \ std::lock\_guard<std::mutex>\ lock(prach\_request\_mutex);}
\DoxyCodeLine{00095\ \ \ \ \ prach\_buffer\_context\ \ \ \ \ \ \ \ prev\_context\ =\ std::exchange(prach\_request[context.slot.system\_slot()],\ context);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{comment}{//\ Detect\ if\ there\ is\ an\ unhandled\ request\ from\ a\ different\ slot.}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{if}\ (prev\_context.slot.valid())\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ logger.warning(context.slot.sfn(),}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context.slot.slot\_index(),}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Real-\/time\ failure\ in\ RU:\ received\ late\ PRACH\ request\ from\ slot\ \{\}\ in\ sector\ \{\}."{}},}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_context.slot,}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_context.sector);}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1ru__dummy__sector_afd6ee857803c3783992b17867d293631}\label{classsrsran_1_1ru__dummy__sector_afd6ee857803c3783992b17867d293631} 
\index{srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}!new\_slot\_boundary@{new\_slot\_boundary}}
\index{new\_slot\_boundary@{new\_slot\_boundary}!srsran::ru\_dummy\_sector@{srsran::ru\_dummy\_sector}}
\doxysubsubsection{\texorpdfstring{new\_slot\_boundary()}{new\_slot\_boundary()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::ru\+\_\+dummy\+\_\+sector\+::new\+\_\+slot\+\_\+boundary (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Notifies a new slot boundary. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00125\ \ \ \{}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{//\ Process\ DL\ request\ for\ this\ slot.}}
\DoxyCodeLine{00127\ \ \ \ \ slot\_point\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_dl\_slot}}\ =\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ +\ dl\_data\_margin;}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ resource\_grid\_context\ context\ =\ \{slot\_point(),\ 0\};}
\DoxyCodeLine{00130\ \ \ \ \ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ lock(dl\_request\_mutex);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ context\ =\ std::exchange(dl\_request[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_dl\_slot}}.system\_slot()],\ context);}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ Notify\ with\ a\ warning\ message\ if\ the\ DL\ previous\ saved\ context\ do\ not\ match\ with\ the\ current\ slot.}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{if}\ (context.slot.valid()\ \&\&\ (context.slot\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_dl\_slot}}))\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ logger.warning(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_dl\_slot}}.sfn(),}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{current\_dl\_slot}}.slot\_index(),}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Real-\/time\ failure\ in\ RU:\ detected\ late\ DL\ request\ from\ slot\ \{\}\ in\ sector\ \{\}."{}},}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context.slot,}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ context.sector);}
\DoxyCodeLine{00142\ \ \ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ Process\ UL\ request\ for\ this\ slot.}}
\DoxyCodeLine{00145\ \ \ \ \ resource\_grid\_context\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}\ =\ \{slot\_point(),\ 0\};}
\DoxyCodeLine{00146\ \ \ \ \ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ lock(ul\_request\_mutex);}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}\ =\ std::exchange(ul\_request[\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.system\_slot()],\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}});}
\DoxyCodeLine{00149\ \ \ \ \ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ UL\ context\ from\ the\ request\ list\ is\ valid.}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}.slot.valid())\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}.slot\ ==\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}})\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Prepare\ receive\ symbol\ context.}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ ru\_uplink\_rx\_symbol\_context\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_context}};}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_context}}.slot\ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}.slot;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_context}}.sector\ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}.sector;}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_context}}.symbol\_id\ =\ MAX\_NSYMB\_PER\_SLOT\ -\/\ 1;}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ received\ resource\ grid.}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ symbol\_notifier.\mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__rx__symbol__notifier_a5d0a301427cad2acaa50fd0539892358}{on\_new\_uplink\_symbol}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rx\_context}},\ rx\_symbols\_resource\_grid);}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ with\ a\ warning\ message\ if\ the\ UL\ previous\ saved\ context\ do\ not\ match\ with\ the\ current\ slot.}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ logger.warning(\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.sfn(),}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.slot\_index(),}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Real-\/time\ failure\ in\ RU:\ detected\ late\ UL\ request\ from\ slot\ \{\}\ in\ sector\ \{\}."{}},}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}.slot,}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ul\_context}}.sector);}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{comment}{//\ Process\ PRACH\ request\ for\ this\ slot.}}
\DoxyCodeLine{00173\ \ \ \ \ prach\_buffer\_context\ prach\_context\{\};}
\DoxyCodeLine{00174\ \ \ \ \ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ lock(prach\_request\_mutex);}
\DoxyCodeLine{00176\ \ \ \ \ \ \ prach\_context\ =\ std::exchange(prach\_request[\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.system\_slot()],\ prach\_context);}
\DoxyCodeLine{00177\ \ \ \ \ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ UL\ context\ from\ the\ request\ list\ is\ valid.}}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (prach\_context.slot.valid())\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (prach\_context.slot\ ==\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}})\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ received\ PRACH\ buffer.}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ symbol\_notifier.\mbox{\hyperlink{classsrsran_1_1ru__uplink__plane__rx__symbol__notifier_a1c2942eaf078868ecfa84fe1f8f2ea2c}{on\_new\_prach\_window\_data}}(prach\_context,\ rx\_symbols\_prach\_buffer.\mbox{\hyperlink{classsrsran_1_1ru__dummy__rx__prach__buffer_a7c3a29b6ee6f46fc1b27e72ab5dd2942}{get\_buffer}}(prach\_context));}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Notify\ with\ a\ warning\ message\ if\ the\ UL\ previous\ saved\ context\ do\ not\ match\ with\ the\ current\ slot.}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ logger.warning(\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.sfn(),}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.slot\_index(),}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Real-\/time\ failure\ in\ RU:\ detected\ late\ PRACH\ request\ from\ slot\ \{\}\ in\ sector\ \{\}."{}},}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prach\_context.slot,}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prach\_context.sector);}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
lib/ru/dummy/ru\+\_\+dummy\+\_\+sector.\+h\end{DoxyCompactItemize}
