\doxysection{srsran\+::channel\+\_\+equalizer\+\_\+zf\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1channel__equalizer__zf__impl}{}\label{classsrsran_1_1channel__equalizer__zf__impl}\index{srsran::channel\_equalizer\_zf\_impl@{srsran::channel\_equalizer\_zf\_impl}}


Channel equalizer implementation using the Zero Forcing algorithm.  




{\ttfamily \#include $<$channel\+\_\+equalizer\+\_\+zf\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::channel\+\_\+equalizer\+\_\+zf\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{da/d84/classsrsran_1_1channel__equalizer__zf__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::channel\+\_\+equalizer\+\_\+zf\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{d5/d8b/classsrsran_1_1channel__equalizer__zf__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classsrsran_1_1channel__equalizer__zf__impl_acc1359f63b70bcd37b7d3f6eaa72542f}\label{classsrsran_1_1channel__equalizer__zf__impl_acc1359f63b70bcd37b7d3f6eaa72542f} 
{\bfseries channel\+\_\+equalizer\+\_\+zf\+\_\+impl} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer__zf__impl_a66d914f46ffe5c9a87224e8fe50a3ec2}{equalize}} (\mbox{\hyperlink{classsrsran_1_1channel__equalizer_a8cc48fec6fc9f7a66dddb6ee28a1877d}{re\+\_\+list}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\+\_\+symbols}}, \mbox{\hyperlink{classsrsran_1_1channel__equalizer_aab4cb02bf7122f472f5289c9a04f6682}{noise\+\_\+var\+\_\+list}} \&eq\+\_\+noise\+\_\+vars, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a8cc48fec6fc9f7a66dddb6ee28a1877d}{re\+\_\+list}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ch\+\_\+symbols}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a5e91212f922cae4bfd9de3d22f0e79a1}{ch\+\_\+est\+\_\+list}} \&ch\+\_\+estimates, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classfloat}{float}} $>$ noise\+\_\+var\+\_\+estimates, \mbox{\hyperlink{classfloat}{float}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\+\_\+scaling}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Equalizes the MIMO channel and combines Tx--Rx paths. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1channel__equalizer}{srsran\+::channel\+\_\+equalizer}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}channel\+\_\+equalizer} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Public Types inherited from \mbox{\hyperlink{classsrsran_1_1channel__equalizer}{srsran\+::channel\+\_\+equalizer}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{using}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a8cc48fec6fc9f7a66dddb6ee28a1877d}{re\+\_\+list}} = \mbox{\hyperlink{classsrsran_1_1tensor}{tensor}}$<$std\+::underlying\+\_\+type\+\_\+t$<$re\+\_\+dims$>$(re\+\_\+dims\+::nof\+\_\+dims), \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}}, re\+\_\+dims$>$
\begin{DoxyCompactList}\small\item\em Container for input and output Resource Elements. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{using}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_aab4cb02bf7122f472f5289c9a04f6682}{noise\+\_\+var\+\_\+list}} = \mbox{\hyperlink{classsrsran_1_1tensor}{tensor}}$<$std\+::underlying\+\_\+type\+\_\+t$<$re\+\_\+dims$>$(re\+\_\+dims\+::nof\+\_\+dims), \mbox{\hyperlink{classfloat}{float}}, re\+\_\+dims$>$
\begin{DoxyCompactList}\small\item\em Container for the post-\/equalization noise variances. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{using}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a5e91212f922cae4bfd9de3d22f0e79a1}{ch\+\_\+est\+\_\+list}} = \mbox{\hyperlink{classsrsran_1_1tensor}{tensor}}$<$std\+::underlying\+\_\+type\+\_\+t$<$ch\+\_\+dims$>$(ch\+\_\+dims\+::nof\+\_\+dims), \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}}, ch\+\_\+dims$>$
\begin{DoxyCompactList}\small\item\em Container for the channel estimates. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Channel equalizer implementation using the Zero Forcing algorithm. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1channel__equalizer__zf__impl_a66d914f46ffe5c9a87224e8fe50a3ec2}\label{classsrsran_1_1channel__equalizer__zf__impl_a66d914f46ffe5c9a87224e8fe50a3ec2} 
\index{srsran::channel\_equalizer\_zf\_impl@{srsran::channel\_equalizer\_zf\_impl}!equalize@{equalize}}
\index{equalize@{equalize}!srsran::channel\_equalizer\_zf\_impl@{srsran::channel\_equalizer\_zf\_impl}}
\doxysubsubsection{\texorpdfstring{equalize()}{equalize()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} channel\+\_\+equalizer\+\_\+zf\+\_\+impl\+::equalize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1channel__equalizer_a8cc48fec6fc9f7a66dddb6ee28a1877d}{re\+\_\+list}} \&}]{eq\+\_\+symbols,  }\item[{\mbox{\hyperlink{classsrsran_1_1channel__equalizer_aab4cb02bf7122f472f5289c9a04f6682}{noise\+\_\+var\+\_\+list}} \&}]{eq\+\_\+noise\+\_\+vars,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a8cc48fec6fc9f7a66dddb6ee28a1877d}{re\+\_\+list}} \&}]{ch\+\_\+symbols,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a5e91212f922cae4bfd9de3d22f0e79a1}{ch\+\_\+est\+\_\+list}} \&}]{ch\+\_\+estimates,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classfloat}{float}} $>$}]{noise\+\_\+var\+\_\+estimates,  }\item[{\mbox{\hyperlink{classfloat}{float}}}]{tx\+\_\+scaling }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Equalizes the MIMO channel and combines Tx--Rx paths. 

For each transmit layer, the contributions of all receive ports are combined with weights obtained from the estimated channel coefficients. The variance of the point-\/to-\/point equivalent noise perturbing each modulated symbol is also estimated.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em eq\+\_\+symbols} & Equalized modulation symbols, organized by transmission layer. \\
\hline
\mbox{\texttt{ out}}  & {\em eq\+\_\+noise\+\_\+vars} & Post-\/equalization noise variances, organized by transmission layer. \\
\hline
\mbox{\texttt{ in}}  & {\em ch\+\_\+symbols} & Channel symbols, i.\+e., complex samples organized by receive port. \\
\hline
\mbox{\texttt{ in}}  & {\em ch\+\_\+estimates} & Channel estimation coefficients, indexed by receive port and transmission layer. \\
\hline
\mbox{\texttt{ in}}  & {\em noise\+\_\+var\+\_\+estimates} & Noise variance estimation for each receive port. \\
\hline
\mbox{\texttt{ in}}  & {\em tx\+\_\+scaling} & Transmission gain scaling factor. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
The sizes of {\ttfamily eq\+\_\+symbols}, {\ttfamily eq\+\_\+noise\+\_\+vars}, {\ttfamily ch\+\_\+symbols} and {\ttfamily noise\+\_\+var\+\_\+estimates} must be consistent with the {\ttfamily ch\+\_\+estimates} channel dimensions. 
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
If, for a given transmitted RE, the combined channel across all paths results in a non-\/normal value (zero, infinity or NaN), the corresponding equalized modulation RE and equalized noise variance will be set to zero and infinity, respectively. 

If the {\ttfamily noise\+\_\+var\+\_\+estimates} noise variances have ill-\/formed values (zero, negative, infinity or NaN), the corresponding equalized modulation REs and equalized noise variances will be set to zero and infinity, respectively. 
\end{DoxyWarning}


Implements \mbox{\hyperlink{classsrsran_1_1channel__equalizer_a8294321aa0a17e5f536963749a54210d}{srsran\+::channel\+\_\+equalizer}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00133\ \{}
\DoxyCodeLine{00134\ \ \ \textcolor{comment}{//\ Make\ sure\ that\ the\ input\ and\ output\ symbol\ lists\ and\ channel\ estimate\ dimensions\ are\ valid.}}
\DoxyCodeLine{00135\ \ \ assert\_sizes(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_symbols}},\ eq\_noise\_vars,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ch\_symbols}},\ ch\_estimates,\ noise\_var\_estimates);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_scaling}}\ >\ 0,\ \textcolor{stringliteral}{"{}Tx\ scaling\ factor\ must\ be\ positive."{}});}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{comment}{//\ Channel\ dimensions.}}
\DoxyCodeLine{00140\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_rx\_ports\ \ =\ ch\_estimates.get\_dimension\_size(ch\_est\_list::dims::rx\_port);}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_tx\_layers\ =\ ch\_estimates.get\_dimension\_size(ch\_est\_list::dims::tx\_layer);}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ Compute\ the\ average\ noise\ variance.}}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordtype}{float}\ noise\_var\ =\ 0.0F;}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_rx\_port}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_rx\_port}}\ !=\ nof\_rx\_ports;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_rx\_port}})\ \{}
\DoxyCodeLine{00146\ \ \ \ \ noise\_var\ +=\ noise\_var\_estimates[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_rx\_port}}];}
\DoxyCodeLine{00147\ \ \ \}}
\DoxyCodeLine{00148\ \ \ noise\_var\ /=\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(nof\_rx\_ports);}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//\ Single\ transmit\ layer\ and\ any\ number\ of\ receive\ ports.}}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{if}\ (nof\_tx\_layers\ ==\ 1)\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{equalize\_zf\_single\_tx\_layer<MAX\_PORTS>}}(}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ nof\_rx\_ports,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_symbols}},\ eq\_noise\_vars,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ch\_symbols}},\ ch\_estimates,\ noise\_var,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_scaling}});}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00155\ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ Simplified\ case\ of\ two\ transmit\ layers\ and\ two\ receive\ ports.}}
\DoxyCodeLine{00158\ \ \ \textcolor{keywordflow}{if}\ ((nof\_rx\_ports\ ==\ 2)\ \&\&\ (nof\_tx\_layers\ ==\ 2))\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a150430ba9056f60a69f2cb29b0280e71}{equalize\_zf\_2x2}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{eq\_symbols}},\ eq\_noise\_vars,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ch\_symbols}},\ ch\_estimates,\ noise\_var,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{tx\_scaling}});}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00161\ \ \ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ srsran\_assertion\_failure(\textcolor{stringliteral}{"{}Invalid\ channel\ spatial\ topology:\ \{\}\ Rx\ ports,\ \{\}\ Tx\ layers."{}},}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ch\_estimates.get\_dimension\_size(ch\_est\_list::dims::rx\_port),}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ch\_estimates.get\_dimension\_size(ch\_est\_list::dims::tx\_layer));}
\DoxyCodeLine{00166\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/upper/equalization/\mbox{\hyperlink{channel__equalizer__zf__impl_8h}{channel\+\_\+equalizer\+\_\+zf\+\_\+impl.\+h}}\item 
lib/phy/upper/equalization/\mbox{\hyperlink{channel__equalizer__zf__impl_8cpp}{channel\+\_\+equalizer\+\_\+zf\+\_\+impl.\+cpp}}\end{DoxyCompactItemize}
