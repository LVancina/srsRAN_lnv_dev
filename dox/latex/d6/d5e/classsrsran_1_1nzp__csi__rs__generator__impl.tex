\doxysection{srsran\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1nzp__csi__rs__generator__impl}{}\label{classsrsran_1_1nzp__csi__rs__generator__impl}\index{srsran::nzp\_csi\_rs\_generator\_impl@{srsran::nzp\_csi\_rs\_generator\_impl}}


Defines a NZP-\/\+CSI-\/\+RS signal generator.  




{\ttfamily \#include $<$nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{de/db5/classsrsran_1_1nzp__csi__rs__generator__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{d3/d12/classsrsran_1_1nzp__csi__rs__generator__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1nzp__csi__rs__generator__impl_a0061061e85762824f384501a76f9aa82}{nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator}{pseudo\+\_\+random\+\_\+generator}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prg\+\_\+}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1nzp__csi__rs__generator__impl_ad9b67ae58a49aa0c65a1b0e53b084dbf}{map}} (\mbox{\hyperlink{classsrsran_1_1resource__grid__mapper}{resource\+\_\+grid\+\_\+mapper}} \&mapper, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1nzp__csi__rs__generator_1_1config__t}{config\+\_\+t}} \&config) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Generates and maps the NZP-\/\+CSI-\/\+RS, according to TS 38.\+211, Section 7.\+4.\+1.\+5. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1nzp__csi__rs__generator}{srsran\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}nzp\+\_\+csi\+\_\+rs\+\_\+generator} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Defines a NZP-\/\+CSI-\/\+RS signal generator. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1nzp__csi__rs__generator__impl_a0061061e85762824f384501a76f9aa82}\label{classsrsran_1_1nzp__csi__rs__generator__impl_a0061061e85762824f384501a76f9aa82} 
\index{srsran::nzp\_csi\_rs\_generator\_impl@{srsran::nzp\_csi\_rs\_generator\_impl}!nzp\_csi\_rs\_generator\_impl@{nzp\_csi\_rs\_generator\_impl}}
\index{nzp\_csi\_rs\_generator\_impl@{nzp\_csi\_rs\_generator\_impl}!srsran::nzp\_csi\_rs\_generator\_impl@{srsran::nzp\_csi\_rs\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{nzp\_csi\_rs\_generator\_impl()}{nzp\_csi\_rs\_generator\_impl()}}
{\footnotesize\ttfamily srsran\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classsrsran_1_1pseudo__random__generator}{pseudo\+\_\+random\+\_\+generator}} $>$}]{prg\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ prg(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prg\_}}))}
\DoxyCodeLine{00104\ \ \ \{}
\DoxyCodeLine{00105\ \ \ \ \ srsran\_assert(prg,\ \textcolor{stringliteral}{"{}Invalid\ pseudo\ random\ generator."{}});}
\DoxyCodeLine{00106\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1nzp__csi__rs__generator__impl_ad9b67ae58a49aa0c65a1b0e53b084dbf}\label{classsrsran_1_1nzp__csi__rs__generator__impl_ad9b67ae58a49aa0c65a1b0e53b084dbf} 
\index{srsran::nzp\_csi\_rs\_generator\_impl@{srsran::nzp\_csi\_rs\_generator\_impl}!map@{map}}
\index{map@{map}!srsran::nzp\_csi\_rs\_generator\_impl@{srsran::nzp\_csi\_rs\_generator\_impl}}
\doxysubsubsection{\texorpdfstring{map()}{map()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl\+::map (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1resource__grid__mapper}{resource\+\_\+grid\+\_\+mapper}} \&}]{mapper,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1nzp__csi__rs__generator_1_1config__t}{config\+\_\+t}} \&}]{config }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Generates and maps the NZP-\/\+CSI-\/\+RS, according to TS 38.\+211, Section 7.\+4.\+1.\+5. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em mapper} & Resource grid mapper. \\
\hline
\mbox{\texttt{ in}}  & {\em config} & Required configuration to generate and map the signal. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1nzp__csi__rs__generator_ac4de484602f99d7a61fe92947057e945}{srsran\+::nzp\+\_\+csi\+\_\+rs\+\_\+generator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00175\ \{}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordtype}{unsigned}\ nof\_ports\ =\ csi\_rs::get\_nof\_csi\_rs\_ports(config.csi\_rs\_mapping\_table\_row);}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ srsran\_assert(nof\_ports\ ==\ config.precoding.get\_nof\_ports(),}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}CSI-\/RS\ number\ of\ ports,\ i.e.,\ \{\},\ does\ not\ match\ the\ precoding\ number\ of\ ports,\ i.e.,\ \{\}."{}},}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nof\_ports,}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.precoding.get\_nof\_ports());}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ srsran\_assert(nof\_ports\ ==\ config.precoding.get\_nof\_layers(),}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}CSI-\/RS\ precoding\ number\ of\ ports,\ i.e.,\ \{\}\ and\ number\ of\ layers,\ i.e.,\ \{\},\ must\ be\ equal."{}},}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nof\_ports,}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.precoding.get\_nof\_layers());}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \mbox{\hyperlink{classsrsran_1_1interval}{interval<unsigned,\ false>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{l0\_range}}(0,\ \mbox{\hyperlink{namespacesrsran_aa1d2bd5d3008afda19c0949d241a73f7}{get\_nsymb\_per\_slot}}(config.cp));}
\DoxyCodeLine{00189\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{l0\_range}}.contains(config.symbol\_l0),}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}CSI-\/RS\ Mapping:\ l\_0,\ i.e.,\ \{\}\ outside\ the\ valid\ range,\ i.e.,\ \{\}."{}},}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.symbol\_l0,}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{l0\_range}});}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{comment}{//\ Generate\ the\ grid\ allocations\ patterns\ for\ each\ port.}}
\DoxyCodeLine{00195\ \ \ \mbox{\hyperlink{structsrsran_1_1csi__rs__pattern__configuration}{csi\_rs\_pattern\_configuration}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}};}
\DoxyCodeLine{00196\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.\mbox{\hyperlink{structsrsran_1_1csi__rs__pattern__configuration_aeb115d781b6b7279720bac8b49fe0486}{start\_rb}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ config.start\_rb;}
\DoxyCodeLine{00197\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.nof\_rb\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ config.nof\_rb;}
\DoxyCodeLine{00198\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.csi\_rs\_mapping\_table\_row\ =\ config.csi\_rs\_mapping\_table\_row;}
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.freq\_allocation\_ref\_idx\ \ =\ config.freq\_allocation\_ref\_idx;}
\DoxyCodeLine{00200\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.symbol\_l0\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ config.symbol\_l0;}
\DoxyCodeLine{00201\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.symbol\_l1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ config.symbol\_l1;}
\DoxyCodeLine{00202\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.cdm\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ config.cdm;}
\DoxyCodeLine{00203\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}}.freq\_density\ \ \ \ \ \ \ \ \ \ \ \ \ =\ config.freq\_density;}
\DoxyCodeLine{00204\ \ \ \mbox{\hyperlink{structsrsran_1_1csi__rs__pattern}{csi\_rs\_pattern}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pattern\_all\_port}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_ac375dcb85db3a7c9bd8c91b406ddfeb4}{get\_csi\_rs\_pattern}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{mapping\_config}});}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \textcolor{comment}{//\ Calculate\ the\ CSI-\/RS\ sequence\ length\ for\ each\ OFDM\ symbol.}}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}}\ =\ get\_seq\_len(config);}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{comment}{//\ Determine\ the\ number\ of\ symbols\ in\ the\ CDM\ group.}}
\DoxyCodeLine{00210\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}}\ =\ get\_cdm\_group\_size(config.cdm);}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \textcolor{comment}{//\ Calculate\ number\ of\ CDM\ groups.}}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_cdm\_groups}}\ =\ nof\_ports\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}};}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \textcolor{comment}{//\ Iterate\ each\ CDM\ group.}}
\DoxyCodeLine{00216\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_group}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_group}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nof\_cdm\_groups}};\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_group}})\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{comment}{//\ Use\ the\ corresponding\ RE\ pattern.}}
\DoxyCodeLine{00218\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1re__pattern}{re\_pattern}}\ pattern\ =\ get\_re\_pattern\_port(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pattern\_all\_port}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_group}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}});}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{comment}{//\ Count\ the\ number\ of\ OFDM\ symbols.}}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ nof\_symbols\ =\ pattern.\mbox{\hyperlink{structsrsran_1_1re__pattern_adb611adea4c54a4ad5c0ddbcc593cd99}{symbols}}.\mbox{\hyperlink{classsrsran_1_1bounded__bitset_a69381df20e59db2de0af0ed8085ac955}{count}}();}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{comment}{//\ Prepare\ data.}}
\DoxyCodeLine{00224\ \ \ \ \ data.\mbox{\hyperlink{classsrsran_1_1static__re__buffer_ad3ed004b724ca236afb3d3efa7c69439}{resize}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}}\ *\ nof\_symbols);}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{comment}{//\ Prepare\ precoding\ configuration\ for\ the\ CDM\ group.}}
\DoxyCodeLine{00227\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1precoding__configuration}{precoding\_configuration}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_precoding}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}},\ nof\_ports,\ 1,\ MAX\_RB);}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{comment}{//\ Prepare\ base\ sequence\ for\ each\ symbol\ within\ the\ slot.}}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot}}\ =\ 0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot\_end}}\ =\ \mbox{\hyperlink{namespacesrsran_aa1d2bd5d3008afda19c0949d241a73f7}{get\_nsymb\_per\_slot}}(config.cp),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_cdm}}\ =\ 0;}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot\_end}};}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot}})\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ symbol\ if\ not\ used.}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!pattern.\mbox{\hyperlink{structsrsran_1_1re__pattern_adb611adea4c54a4ad5c0ddbcc593cd99}{symbols}}.\mbox{\hyperlink{classsrsran_1_1bounded__bitset_a53b1498a7820972edb5b9c8db2fc94db}{test}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot}}))\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ view\ of\ the\ sequence\ destination.}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<cf\_t>}}\ sequence\ =\ data.\mbox{\hyperlink{classsrsran_1_1static__re__buffer_a900371c4bb36aa06ee04505357c1dae6}{get\_slice}}(0).\mbox{\hyperlink{classsrsran_1_1span_ac5f02596fcb6e8f430a3e11e47a6d7e8}{subspan}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_cdm}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}});}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \textcolor{comment}{//\ Generate\ the\ generic\ sequence.}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ generate\_sequence(sequence,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_slot}},\ config);}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \ \ \textcolor{comment}{//\ Increment\ the\ CDM\ group\ symbol\ counter.}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol\_cdm}};}
\DoxyCodeLine{00246\ \ \ \ \ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{comment}{//\ Iterate\ each\ port\ within\ the\ CDM\ group}}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}};\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}})\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ absolute\ port\ identifier.}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port\_layer}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_group}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_size}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}};}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ all\ the\ CDM\ group\ shares\ the\ same\ pattern.}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ srsran\_assert(pattern\ ==\ get\_re\_pattern\_port(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pattern\_all\_port}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port\_layer}}),}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}All\ ports\ within\ a\ CDM\ group\ must\ have\ the\ same\ pattern."{}});}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ the\ port\ coefficients\ for\ the\ CDM\ port.}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}}\ =\ 0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port\_end}}\ =\ nof\_ports;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port\_end}};\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}})\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg}}\ =\ 0,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg\_end}}\ =\ config.precoding.get\_nof\_prg();\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg\_end}};\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg}})\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Extract\ the\ coefficient\ for\ mapping\ the\ NZP-\/CSI-\/RS\ to\ the\ port.}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\_t}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{coefficient}}\ =\ config.precoding.get\_coefficient(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port\_layer}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg}});}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ coefficient\ in\ the\ CDM\ group\ precoding.}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_precoding}}.set\_coefficient(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{coefficient}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_port}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_prg}});}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ CDM\ weights\ for\ first\ port\ of\ the\ CDM\ group.}}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}}\ ==\ 0)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ CDM\ weights\ for\ each\ symbol.}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ !=\ nof\_symbols;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}})\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ view\ of\ the\ base\ sequence.}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{base\_sequence}}\ =\ data.\mbox{\hyperlink{classsrsran_1_1static__re__buffer_a900371c4bb36aa06ee04505357c1dae6}{get\_slice}}(0).\mbox{\hyperlink{classsrsran_1_1span_ac5f02596fcb6e8f430a3e11e47a6d7e8}{subspan}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}});}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ view\ of\ the\ sequence.}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<cf\_t>}}\ sequence\ =\ data.\mbox{\hyperlink{classsrsran_1_1static__re__buffer_a900371c4bb36aa06ee04505357c1dae6}{get\_slice}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}}).\mbox{\hyperlink{classsrsran_1_1span_ac5f02596fcb6e8f430a3e11e47a6d7e8}{subspan}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{seq\_len}});}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ the\ CDM\ sequence.}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ apply\_cdm(sequence,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{base\_sequence}},\ config.cdm,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_cdm\_port}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}});}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ mapper.\mbox{\hyperlink{classsrsran_1_1resource__grid__mapper_a9fc1909c95b969acdd14de808d4cb0c2}{map}}(data,\ pattern,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cdm\_group\_precoding}});}
\DoxyCodeLine{00287\ \ \ \}}
\DoxyCodeLine{00288\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/upper/signal\+\_\+processors/nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl.\+h\item 
lib/phy/upper/signal\+\_\+processors/nzp\+\_\+csi\+\_\+rs\+\_\+generator\+\_\+impl.\+cpp\end{DoxyCompactItemize}
