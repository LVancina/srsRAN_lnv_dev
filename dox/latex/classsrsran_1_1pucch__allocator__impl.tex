\doxysection{srsran\+::pucch\+\_\+allocator\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1pucch__allocator__impl}{}\label{classsrsran_1_1pucch__allocator__impl}\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}


Implementation of the PUCCH allocator interface.  




{\ttfamily \#include $<$pucch\+\_\+allocator\+\_\+impl.\+h$>$}

Inheritance diagram for srsran\+::pucch\+\_\+allocator\+\_\+impl\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classsrsran_1_1pucch__allocator__impl}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classsrsran_1_1pucch__allocator__impl_a86ef92b6a8786d956edfbcfe5f55aea3}\label{classsrsran_1_1pucch__allocator__impl_a86ef92b6a8786d956edfbcfe5f55aea3} 
{\bfseries pucch\+\_\+allocator\+\_\+impl} (const \mbox{\hyperlink{classsrsran_1_1cell__configuration}{cell\+\_\+configuration}} \&cell\+\_\+cfg\+\_\+, unsigned max\+\_\+pucchs\+\_\+per\+\_\+slot, unsigned max\+\_\+ul\+\_\+grants\+\_\+per\+\_\+slot\+\_\+)
\item 
void \mbox{\hyperlink{classsrsran_1_1pucch__allocator__impl_a28afae114a35aaba7930a38598c46c3f}{slot\+\_\+indication}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} sl\+\_\+tx) override
\begin{DoxyCompactList}\small\item\em Updates the internal \doxylink{classsrsran_1_1slot__point}{slot\+\_\+point} and tracking of PUCCH resource usage; and resets the PUCCH common allocation grid. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ unsigned $>$ \mbox{\hyperlink{classsrsran_1_1pucch__allocator__impl_a74663837422d0ac62894b89cb40faef3}{alloc\+\_\+common\+\_\+pucch\+\_\+harq\+\_\+ack\+\_\+ue}} (\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&res\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} tcrnti, unsigned k0, unsigned k1, const \mbox{\hyperlink{structsrsran_1_1pdcch__dl__information}{pdcch\+\_\+dl\+\_\+information}} \&dci\+\_\+info) override
\item 
\mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ unsigned $>$ \mbox{\hyperlink{classsrsran_1_1pucch__allocator__impl_a6fae0845bff2c61358fda211f2027f47}{alloc\+\_\+ded\+\_\+pucch\+\_\+harq\+\_\+ack\+\_\+ue}} (\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&res\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg, unsigned k0, unsigned k1) override
\item 
void \mbox{\hyperlink{classsrsran_1_1pucch__allocator__impl_a46d030a6ee2e11fb68bc409bda34a83b}{pucch\+\_\+allocate\+\_\+sr\+\_\+opportunity}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&slot\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg) override
\item 
void \mbox{\hyperlink{classsrsran_1_1pucch__allocator__impl_ab45b45d5e5dea4ce06c8aa310065989a}{pucch\+\_\+allocate\+\_\+csi\+\_\+opportunity}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&pucch\+\_\+slot\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg, unsigned csi\+\_\+part1\+\_\+nof\+\_\+bits) override
\item 
\mbox{\hyperlink{structsrsran_1_1pucch__uci__bits}{pucch\+\_\+uci\+\_\+bits}} \mbox{\hyperlink{classsrsran_1_1pucch__allocator__impl_a92265d35e1cd584bde9d48d7cb9998d3}{remove\+\_\+ue\+\_\+uci\+\_\+from\+\_\+pucch}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&slot\+\_\+alloc, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg) override
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of the PUCCH allocator interface. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1pucch__allocator__impl_a74663837422d0ac62894b89cb40faef3}\label{classsrsran_1_1pucch__allocator__impl_a74663837422d0ac62894b89cb40faef3} 
\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}!alloc\_common\_pucch\_harq\_ack\_ue@{alloc\_common\_pucch\_harq\_ack\_ue}}
\index{alloc\_common\_pucch\_harq\_ack\_ue@{alloc\_common\_pucch\_harq\_ack\_ue}!srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{alloc\_common\_pucch\_harq\_ack\_ue()}{alloc\_common\_pucch\_harq\_ack\_ue()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ unsigned $>$ pucch\+\_\+allocator\+\_\+impl\+::alloc\+\_\+common\+\_\+pucch\+\_\+harq\+\_\+ack\+\_\+ue (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&}]{res\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{tcrnti,  }\item[{unsigned}]{k0,  }\item[{unsigned}]{k1,  }\item[{const \mbox{\hyperlink{structsrsran_1_1pdcch__dl__information}{pdcch\+\_\+dl\+\_\+information}} \&}]{dci\+\_\+info }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocate the common PUCCH resource for HARQ-\/\+ACK for a given UE. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em tcrnti} & temporary RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em k0} & k0 value, or delay (in slots) of PDSCH slot vs the corresponding PDCCH slot. \\
\hline
\mbox{\texttt{ in}}  & {\em k1} & delay in slots of the UE\textquotesingle{}s PUCCH HARQ-\/\+ACK report with respect to the PDSCH. \\
\hline
\mbox{\texttt{ in}}  & {\em dci\+\_\+info} & information with DL DCI, needed for HARQ-\/(N)-\/ACK scheduling info. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The PUCCH resource indicator, if the allocation is successful; a {\ttfamily nullopt} otherwise. 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
{\ttfamily pucch\+\_\+res\+\_\+indicator}, or $\Delta_{PRI}$, is the {\itshape PUCCH resource indicator\texorpdfstring{$<$}{<}{\itshape } \texorpdfstring{$>$}{>} field for DCI 1\+\_\+0 and 1\+\_\+1 as per TS 38.\+213, Section 9.\+2.\+1. It indicates the UE which PUCCH resource should be used for HACK-\/(N)ACK reporting. }
\end{DoxyRemark}


Implements \mbox{\hyperlink{classsrsran_1_1pucch__allocator_a34b8be1ccd48883f10507cfff3b64fff}{srsran\+::pucch\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1pucch__allocator__impl_a6fae0845bff2c61358fda211f2027f47}\label{classsrsran_1_1pucch__allocator__impl_a6fae0845bff2c61358fda211f2027f47} 
\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}!alloc\_ded\_pucch\_harq\_ack\_ue@{alloc\_ded\_pucch\_harq\_ack\_ue}}
\index{alloc\_ded\_pucch\_harq\_ack\_ue@{alloc\_ded\_pucch\_harq\_ack\_ue}!srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{alloc\_ded\_pucch\_harq\_ack\_ue()}{alloc\_ded\_pucch\_harq\_ack\_ue()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsrsran_1_1optional}{optional}}$<$ unsigned $>$ pucch\+\_\+allocator\+\_\+impl\+::alloc\+\_\+ded\+\_\+pucch\+\_\+harq\+\_\+ack\+\_\+ue (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__resource__allocator}{cell\+\_\+resource\+\_\+allocator}} \&}]{res\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg,  }\item[{unsigned}]{k0,  }\item[{unsigned}]{k1 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocate a PUCCH HARQ-\/\+ACK grant for a given UE using dedicated resources.

\begin{DoxyRemark}{Remarks}
This function does not check whether there are PUSCH grants allocated for the same UE. The check needs to be performed by the caller.
\end{DoxyRemark}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em res\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. \\
\hline
\mbox{\texttt{ in}}  & {\em k0} & k0 value, or delay (in slots) of PDSCH slot vs the corresponding PDCCH slot. \\
\hline
\mbox{\texttt{ in}}  & {\em k1} & delay in slots of the UE\textquotesingle{}s PUCCH HARQ-\/\+ACK report with respect to the PDSCH. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The PUCCH resource indicator, if the allocation is successful; a {\ttfamily nullopt} otherwise. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1pucch__allocator_a882a0e32658d80eb8835b062cc520835}{srsran\+::pucch\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1pucch__allocator__impl_ab45b45d5e5dea4ce06c8aa310065989a}\label{classsrsran_1_1pucch__allocator__impl_ab45b45d5e5dea4ce06c8aa310065989a} 
\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}!pucch\_allocate\_csi\_opportunity@{pucch\_allocate\_csi\_opportunity}}
\index{pucch\_allocate\_csi\_opportunity@{pucch\_allocate\_csi\_opportunity}!srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{pucch\_allocate\_csi\_opportunity()}{pucch\_allocate\_csi\_opportunity()}}
{\footnotesize\ttfamily void pucch\+\_\+allocator\+\_\+impl\+::pucch\+\_\+allocate\+\_\+csi\+\_\+opportunity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{pucch\+\_\+slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg,  }\item[{unsigned}]{csi\+\_\+part1\+\_\+nof\+\_\+bits }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocate the PUCCH grant for a UE\textquotesingle{}s CSI opportunity. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & C-\/\+RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. \\
\hline
\mbox{\texttt{ in}}  & {\em csi\+\_\+part1\+\_\+nof\+\_\+bits} & Number of CSI Part 1 bits that need to be reported. \\
\hline
\mbox{\texttt{ in}}  & {\em is\+\_\+fallback\+\_\+mode} & Indicates whether the UE is in fallback mode. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pucch__allocator_aaac1e5eeb05f561f15cba9f4e00fd2cd}{srsran\+::pucch\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1pucch__allocator__impl_a46d030a6ee2e11fb68bc409bda34a83b}\label{classsrsran_1_1pucch__allocator__impl_a46d030a6ee2e11fb68bc409bda34a83b} 
\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}!pucch\_allocate\_sr\_opportunity@{pucch\_allocate\_sr\_opportunity}}
\index{pucch\_allocate\_sr\_opportunity@{pucch\_allocate\_sr\_opportunity}!srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{pucch\_allocate\_sr\_opportunity()}{pucch\_allocate\_sr\_opportunity()}}
{\footnotesize\ttfamily void pucch\+\_\+allocator\+\_\+impl\+::pucch\+\_\+allocate\+\_\+sr\+\_\+opportunity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{pucch\+\_\+slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Allocate the PUCCH resource for a UE\textquotesingle{}s SR opportunity. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & C-\/\+RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em ue\+\_\+cell\+\_\+cfg} & user configuration. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1pucch__allocator_a756012774ab9d566cd8231211c769df9}{srsran\+::pucch\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1pucch__allocator__impl_a92265d35e1cd584bde9d48d7cb9998d3}\label{classsrsran_1_1pucch__allocator__impl_a92265d35e1cd584bde9d48d7cb9998d3} 
\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}!remove\_ue\_uci\_from\_pucch@{remove\_ue\_uci\_from\_pucch}}
\index{remove\_ue\_uci\_from\_pucch@{remove\_ue\_uci\_from\_pucch}!srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{remove\_ue\_uci\_from\_pucch()}{remove\_ue\_uci\_from\_pucch()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1pucch__uci__bits}{pucch\+\_\+uci\+\_\+bits}} pucch\+\_\+allocator\+\_\+impl\+::remove\+\_\+ue\+\_\+uci\+\_\+from\+\_\+pucch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{const \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Remove UCI allocations on PUCCH for a given UE. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em slot\+\_\+alloc} & struct with scheduling results. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & RNTI of the UE. \\
\hline
\mbox{\texttt{ in}}  & {\em pucch\+\_\+cfg} & User\textquotesingle{}s PUCCH configuration. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
struct with the number of HARQ-\/\+ACK and CSI info bits from the removed PUCCH grants. If there was no PUCCH to be removed, return 0 for both HARQ-\/\+ACK and CSI info bits. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classsrsran_1_1pucch__allocator_ac72002185e4401aa842da529b8aa8e3c}{srsran\+::pucch\+\_\+allocator}}.

\Hypertarget{classsrsran_1_1pucch__allocator__impl_a28afae114a35aaba7930a38598c46c3f}\label{classsrsran_1_1pucch__allocator__impl_a28afae114a35aaba7930a38598c46c3f} 
\index{srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}!slot\_indication@{slot\_indication}}
\index{slot\_indication@{slot\_indication}!srsran::pucch\_allocator\_impl@{srsran::pucch\_allocator\_impl}}
\doxysubsubsection{\texorpdfstring{slot\_indication()}{slot\_indication()}}
{\footnotesize\ttfamily void pucch\+\_\+allocator\+\_\+impl\+::slot\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl\+\_\+tx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Updates the internal \doxylink{classsrsran_1_1slot__point}{slot\+\_\+point} and tracking of PUCCH resource usage; and resets the PUCCH common allocation grid. 



Implements \mbox{\hyperlink{classsrsran_1_1pucch__allocator_abd5e232603ce43d7b29d445dc9c7f90e}{srsran\+::pucch\+\_\+allocator}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/pucch\+\_\+scheduling/pucch\+\_\+allocator\+\_\+impl.\+h\item 
lib/scheduler/pucch\+\_\+scheduling/pucch\+\_\+allocator\+\_\+impl.\+cpp\end{DoxyCompactItemize}
