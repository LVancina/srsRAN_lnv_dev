\doxysection{uci\+\_\+part2\+\_\+size\+\_\+description.\+h}
\hypertarget{uci__part2__size__description_8h_source}{}\label{uci__part2__size__description_8h_source}\index{include/srsran/ran/uci/uci\_part2\_size\_description.h@{include/srsran/ran/uci/uci\_part2\_size\_description.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ 2021-\/2024\ Software\ Radio\ Systems\ Limited}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ This\ file\ is\ part\ of\ srsRAN.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ srsRAN\ is\ free\ software:\ you\ can\ redistribute\ it\ and/or\ modify}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ it\ under\ the\ terms\ of\ the\ GNU\ Affero\ General\ Public\ License\ as}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ published\ by\ the\ Free\ Software\ Foundation,\ either\ version\ 3\ of}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ the\ License,\ or\ (at\ your\ option)\ any\ later\ version.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ srsRAN\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ GNU\ Affero\ General\ Public\ License\ for\ more\ details.}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ A\ copy\ of\ the\ GNU\ Affero\ General\ Public\ License\ can\ be\ found\ in}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ the\ LICENSE\ file\ in\ the\ top-\/level\ directory\ of\ this\ distribution}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ and\ at\ http://www.gnu.org/licenses/.}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{pragma}\ \textcolor{preprocessor}{once}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include}\ \textcolor{preprocessor}{"{}srsran/adt/static\_vector.h"{}}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{namespace}\ \mbox{\hyperlink{namespacesrsran}{srsran}}\ \{}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{comment}{///\ Collects\ the\ parameters\ that\ describe\ the\ UCI\ Part\ 1\ correspondence\ to\ Part\ 2\ sizes.}}
\DoxyCodeLine{00029\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description}{uci\_part2\_size\_description}}\ \{}
\DoxyCodeLine{00030\ \ \ \textcolor{comment}{///\ Maximum\ number\ of\ parameters.}}
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_af1df4b490b67273cc94d51aa6ee4a340}{max\_nof\_parameters}}\ =\ 2;}
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{///\ Maximum\ number\ of\ Part\ 2\ entries.}}
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_a03d04d51cb0003a0403412125c4cbd60}{max\_nof\_entries}}\ =\ 2;}
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{///\ Maximum\ number\ of\ aggregated\ bits\ per\ entry.}}
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_acb805b31d7fd45ec079ac8bc00629f71}{max\_nof\_entry\_bits}}\ =\ 4;}
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{///\ Maximum\ number\ of\ Part\ 2\ sizes\ per\ entry.}}
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_a6444249e205c0a6f55382ded44ead0b0}{max\_size\_table}}\ =\ 1U\ <<\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_acb805b31d7fd45ec079ac8bc00629f71}{max\_nof\_entry\_bits}};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ uci\_part2\_size\_description()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \textcolor{comment}{///\ \(\backslash\)brief\ Creates\ a\ fixed-\/size\ UCI\ Part\ 2.}}
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{///}}
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{///\ A\ UCI\ Part\ 1\ correspondence\ to\ UCI\ Part\ 2\ size\ that\ has\ one\ possible\ size\ independently\ of\ the\ UCI\ Part\ 1}}
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{///\ contents.}}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_a40c91c294cc3f6f6a39b0fc436c9d581}{uci\_part2\_size\_description}}(\textcolor{keywordtype}{unsigned}\ fixed\_size)}
\DoxyCodeLine{00046\ \ \ \{}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ Clear\ entries\ if\ no\ UCI\ Part\ 2\ payload.}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{if}\ (fixed\_size\ ==\ 0)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ entries.clear();}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00051\ \ \ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ Create\ new\ size\ entry.}}
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1entry}{entry}}\&\ e\ =\ entries.emplace\_back();}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ Create\ zero\ bit\ width\ parameter.}}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter}{parameter}}\&\ p\ =\ e.parameters.emplace\_back();}
\DoxyCodeLine{00058\ \ \ \ \ p\mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter_aa71aaca1e17243dfbba0bedeff7db32e}{.}}\mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter_aa71aaca1e17243dfbba0bedeff7db32e}{width}}\ \ \ \ \ \ =\ 0;}
\DoxyCodeLine{00059\ \ \ \ \ p\mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter_a80e7c530c3a8cf6a1957a7a7aba8cb72}{.}}\mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter_a80e7c530c3a8cf6a1957a7a7aba8cb72}{offset}}\ \ \ \ \ =\ 0;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ Add\ size\ to\ table.}}
\DoxyCodeLine{00062\ \ \ \ \ e.map.emplace\_back(fixed\_size);}
\DoxyCodeLine{00063\ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \textcolor{comment}{///\ Collects\ parameter\ attributes.}}
\DoxyCodeLine{00066\ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter}{parameter}}\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{///\ Bit\ offset\ of\ the\ parameter\ from\ the\ beginning\ of\ the\ Part\ 1.}}
\DoxyCodeLine{00068\ \ \ \ \ uint16\_t\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter_a80e7c530c3a8cf6a1957a7a7aba8cb72}{offset}};}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{comment}{///\ CSI\ Part\ 1\ parameter\ bit\ width.}}
\DoxyCodeLine{00070\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter_aa71aaca1e17243dfbba0bedeff7db32e}{width}};}
\DoxyCodeLine{00071\ \ \ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{///\ Collects\ the\ parameters\ to\ determine\ a\ single\ CSI\ Part\ 2\ report.}}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1entry}{entry}}\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{///\ \(\backslash\)brief\ Part\ 1\ parameters\ that\ influence\ the\ size\ of\ this\ part\ 2.}}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{///\ \(\backslash\)remark\ The\ total\ accumulated\ width\ of\ the\ parameters\ must\ not\ exceed\ \(\backslash\)ref\ max\_nof\_entry\_bits\ bits.}}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector}}<\mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1parameter}{parameter}},\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_af1df4b490b67273cc94d51aa6ee4a340}{max\_nof\_parameters}}>\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1entry_ab22583fc41ac3e36694a8ac9d8ba70c8}{parameters}};}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{///\ \(\backslash\)brief\ Maps\ the\ concatenation\ of\ the\ parameters\ to\ Part\ 2\ size\ in\ bits.}}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector}}<uint16\_t,\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_a6444249e205c0a6f55382ded44ead0b0}{max\_size\_table}}>\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1entry_a51dbf93b5cc5a4286f71a0512316b3ff}{map}};}
\DoxyCodeLine{00080\ \ \ \};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{///\ CSI\ Part\ 2\ entries.}}
\DoxyCodeLine{00083\ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector}}<\mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_1_1entry}{entry}},\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_a03d04d51cb0003a0403412125c4cbd60}{max\_nof\_entries}}>\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_a736ffdaea48a4a70301e067314b0ab8d}{entries}};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{comment}{///\ Checks\ if\ the\ UCI\ part\ 2\ size\ description\ is\ consistent\ with\ the\ CSI\ Part\ 1\ reports\ sizes.}}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structsrsran_1_1uci__part2__size__description_ac1cfe2d5bb023f2845a239a30bb52af8}{is\_valid}}(\textcolor{keywordtype}{unsigned}\ uci\_part1\_nof\_bits)\ \textcolor{keyword}{const}}
\DoxyCodeLine{00087\ \ \ \{}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ For\ each\ entry...}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ entry\_\ :\ entries)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ param\_size\ =\ 0;}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ parameter...}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ param\ :\ entry\_.parameters)\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Accumulate\ the\ parameter\ width.}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ param\_size\ +=\ param.width;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ parameter\ offset\ and\ width\ does\ not\ exceed\ the\ size\ of\ CSI\ Part\ 1.}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((param.width\ +\ param.offset)\ >=\ uci\_part1\_nof\_bits)\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ entry\ table\ size\ corresponds\ to\ the\ number\ of\ bits.}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (1U\ <<\ param\_size\ !=\ entry\_.map.size())\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ The\ description\ must\ be\ valid\ if\ reached\ here.}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00111\ \ \ \}}
\DoxyCodeLine{00112\ \};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \}\ \textcolor{comment}{//\ namespace\ srsran}}

\end{DoxyCode}
