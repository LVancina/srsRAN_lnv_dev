\doxysection{rigtorp\+::mpmc\+::Queue\texorpdfstring{$<$}{<} T, Allocator \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{classrigtorp_1_1mpmc_1_1Queue}{}\label{classrigtorp_1_1mpmc_1_1Queue}\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}


Collaboration diagram for rigtorp\+::mpmc\+::Queue\texorpdfstring{$<$}{<} T, Allocator \texorpdfstring{$>$}{>}\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{d1/d89/classrigtorp_1_1mpmc_1_1Queue__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_ac6dbef7b0828fbdadd5a1e0e294c5fc0}{Queue}} (const size\+\_\+t capacity, const Allocator \&allocator=Allocator())
\item 
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a9ba18dd937eba59e9db5f55880fdf1a8}\label{classrigtorp_1_1mpmc_1_1Queue_a9ba18dd937eba59e9db5f55880fdf1a8} 
{\bfseries Queue} (const \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{Queue}} \&)=delete
\item 
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a00314cabb3571dc658c94a581ff54323}\label{classrigtorp_1_1mpmc_1_1Queue_a00314cabb3571dc658c94a581ff54323} 
\mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{Queue}} \& {\bfseries operator=} (const \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{Queue}} \&)=delete
\item 
{\footnotesize template$<$typename... Args$>$ }\\void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_aa17e3ed60085f7b3749774ab5dfd9dc0}{emplace}} (Args \&\&...args) noexcept
\item 
{\footnotesize template$<$typename... Args$>$ }\\\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_ab9e87623785d1bbbd14146c896398180}{try\+\_\+emplace}} (Args \&\&...args) noexcept
\item 
void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a62dbc934dc540dc92cfad643d1f14b44}{push}} (const T \&v) noexcept
\item 
{\footnotesize template$<$typename P , typename  = typename std\+::enable\+\_\+if$<$                std\+::is\+\_\+nothrow\+\_\+constructible$<$\+T, P \&\&$>$\+::value$>$\+::type$>$ }\\void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_aae0f912f254e284290701855e77c67c2}{push}} (P \&\&v) noexcept
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_acab484c2f7bd2ee52f14b0b5c7237176}{try\+\_\+push}} (const T \&v) noexcept
\item 
{\footnotesize template$<$typename P , typename  = typename std\+::enable\+\_\+if$<$                std\+::is\+\_\+nothrow\+\_\+constructible$<$\+T, P \&\&$>$\+::value$>$\+::type$>$ }\\\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a6475d4a693b48e6950a64d1e8e1df3b3}{try\+\_\+push}} (P \&\&v) noexcept
\item 
void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a1cd83c243a912bddd837a35b3fe82606}{pop}} (T \&v) noexcept
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_aa87e90cf0ff85092b7a86b2481e7b6b8}{try\+\_\+pop}} (T \&v) noexcept
\item 
ptrdiff\+\_\+t \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a455949764266793f72855b812b19d4a6}{size}} () const noexcept
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a75d00c5933bc67796b33dc9b916cdb91}{empty}} () const noexcept
\item 
size\+\_\+t \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a5364b8e5fa365af2e6978fe2413f8d50}{capacity}} () const noexcept
\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_ac6dbef7b0828fbdadd5a1e0e294c5fc0}\label{classrigtorp_1_1mpmc_1_1Queue_ac6dbef7b0828fbdadd5a1e0e294c5fc0} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!Queue@{Queue}}
\index{Queue@{Queue}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{Queue()}{Queue()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
\mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::\+Queue (\begin{DoxyParamCaption}\item[{const size\+\_\+t}]{capacity,  }\item[{const Allocator \&}]{allocator = {\ttfamily Allocator()} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00124\ \ \ \ \ \ \ :\ capacity\_(capacity),\ allocator\_(allocator),\ head\_(0),\ tail\_(0)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{if}\ (capacity\_\ <\ 1)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}capacity\ <\ 1"{}});}
\DoxyCodeLine{00127\ \ \ \ \ \}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{//\ Allocate\ one\ extra\ slot\ to\ prevent\ false\ sharing\ on\ the\ last\ slot}}
\DoxyCodeLine{00129\ \ \ \ \ slots\_\ =\ allocator\_.allocate(capacity\_\ +\ 1);}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ Allocators\ are\ not\ required\ to\ honor\ alignment\ for\ over-\/aligned\ types}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{comment}{//\ (see\ http://eel.is/c++draft/allocator.requirements\#10)\ so\ we\ verify}}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ alignment\ here}}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(slots\_)\ \%\ \textcolor{keyword}{alignof}(Slot<T>)\ !=\ 0)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ allocator\_.deallocate(slots\_,\ capacity\_\ +\ 1);}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::bad\_alloc();}
\DoxyCodeLine{00136\ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ capacity\_;\ ++i)\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \textcolor{keyword}{new}\ (\&slots\_[i])\ Slot<T>();}
\DoxyCodeLine{00139\ \ \ \ \ \}}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{static\_assert}(}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keyword}{alignof}(Slot<T>)\ ==\ hardwareInterferenceSize,}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Slot\ must\ be\ aligned\ to\ cache\ line\ boundary\ to\ prevent\ false\ sharing"{}});}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(Slot<T>)\ \%\ hardwareInterferenceSize\ ==\ 0,}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Slot\ size\ must\ be\ a\ multiple\ of\ cache\ line\ size\ to\ prevent\ "{}}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}false\ sharing\ between\ adjacent\ slots"{}});}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(Queue)\ \%\ hardwareInterferenceSize\ ==\ 0,}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Queue\ size\ must\ be\ a\ multiple\ of\ cache\ line\ size\ to\ "{}}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}prevent\ false\ sharing\ between\ adjacent\ queues"{}});}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keyword}{static\_assert}(}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ offsetof(Queue,\ tail\_)\ -\/\ offsetof(Queue,\ head\_)\ ==}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::ptrdiff\_t\textcolor{keyword}{>}(hardwareInterferenceSize),}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}head\ and\ tail\ must\ be\ a\ cache\ line\ apart\ to\ prevent\ false\ sharing"{}});}
\DoxyCodeLine{00153\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_ad9c17585b594148fdee9256d0980b910}\label{classrigtorp_1_1mpmc_1_1Queue_ad9c17585b594148fdee9256d0980b910} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!````~Queue@{\texorpdfstring{$\sim$}{\string~}Queue}}
\index{````~Queue@{\texorpdfstring{$\sim$}{\string~}Queue}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}Queue()}{\string~Queue()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
\mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{Queue}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ capacity\_;\ ++i)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ slots\_[i].\string~Slot();}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ \ \ \ \ allocator\_.deallocate(slots\_,\ capacity\_\ +\ 1);}
\DoxyCodeLine{00160\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a5364b8e5fa365af2e6978fe2413f8d50}\label{classrigtorp_1_1mpmc_1_1Queue_a5364b8e5fa365af2e6978fe2413f8d50} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!capacity@{capacity}}
\index{capacity@{capacity}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{capacity()}{capacity()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
size\+\_\+t \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::capacity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00271\ \{\ \textcolor{keywordflow}{return}\ capacity\_;\ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_aa17e3ed60085f7b3749774ab5dfd9dc0}\label{classrigtorp_1_1mpmc_1_1Queue_aa17e3ed60085f7b3749774ab5dfd9dc0} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!emplace@{emplace}}
\index{emplace@{emplace}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{emplace()}{emplace()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
template$<$typename... Args$>$ \\
void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::emplace (\begin{DoxyParamCaption}\item[{Args \&\&...}]{args }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_nothrow\_constructible<T,\ Args\ \&\&...>::value,}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}T\ must\ be\ nothrow\ constructible\ with\ Args\&\&..."{}});}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ head\ =\ head\_.fetch\_add(1);}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keyword}{auto}\ \&\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ =\ slots\_[idx(head)];}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{while}\ (turn(head)\ *\ 2\ !=\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.load(std::memory\_order\_acquire))}
\DoxyCodeLine{00172\ \ \ \ \ \ \ ;}
\DoxyCodeLine{00173\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.construct(std::forward<Args>(args)...);}
\DoxyCodeLine{00174\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.store(turn(head)\ *\ 2\ +\ 1,\ std::memory\_order\_release);}
\DoxyCodeLine{00175\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a75d00c5933bc67796b33dc9b916cdb91}\label{classrigtorp_1_1mpmc_1_1Queue_a75d00c5933bc67796b33dc9b916cdb91} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!empty@{empty}}
\index{empty@{empty}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{empty()}{empty()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::empty (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Returns true if the queue is empty. Since this is a concurrent queue this is only a best effort guess until all reader and writer threads have been joined. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00269\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue_a455949764266793f72855b812b19d4a6}{size}}()\ <=\ 0;\ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a1cd83c243a912bddd837a35b3fe82606}\label{classrigtorp_1_1mpmc_1_1Queue_a1cd83c243a912bddd837a35b3fe82606} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!pop@{pop}}
\index{pop@{pop}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{pop()}{pop()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::pop (\begin{DoxyParamCaption}\item[{T \&}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ tail\ =\ tail\_.fetch\_add(1);}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keyword}{auto}\ \&\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ =\ slots\_[idx(tail)];}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordflow}{while}\ (turn(tail)\ *\ 2\ +\ 1\ !=\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.load(std::memory\_order\_acquire))}
\DoxyCodeLine{00229\ \ \ \ \ \ \ ;}
\DoxyCodeLine{00230\ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.move();}
\DoxyCodeLine{00231\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.destroy();}
\DoxyCodeLine{00232\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.store(turn(tail)\ *\ 2\ +\ 2,\ std::memory\_order\_release);}
\DoxyCodeLine{00233\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a62dbc934dc540dc92cfad643d1f14b44}\label{classrigtorp_1_1mpmc_1_1Queue_a62dbc934dc540dc92cfad643d1f14b44} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!push@{push}}
\index{push@{push}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{push()}{push()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::push (\begin{DoxyParamCaption}\item[{const T \&}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_nothrow\_copy\_constructible<T>::value,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}T\ must\ be\ nothrow\ copy\ constructible"{}});}
\DoxyCodeLine{00202\ \ \ \ \ emplace(v);}
\DoxyCodeLine{00203\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_aae0f912f254e284290701855e77c67c2}\label{classrigtorp_1_1mpmc_1_1Queue_aae0f912f254e284290701855e77c67c2} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!push@{push}}
\index{push@{push}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{push()}{push()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
template$<$typename P , typename  = typename std\+::enable\+\_\+if$<$                std\+::is\+\_\+nothrow\+\_\+constructible$<$\+T, P \&\&$>$\+::value$>$\+::type$>$ \\
void \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::push (\begin{DoxyParamCaption}\item[{P \&\&}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ emplace(std::forward<P>(v));}
\DoxyCodeLine{00210\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a455949764266793f72855b812b19d4a6}\label{classrigtorp_1_1mpmc_1_1Queue_a455949764266793f72855b812b19d4a6} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!size@{size}}
\index{size@{size}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{size()}{size()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
ptrdiff\+\_\+t \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Returns the number of elements in the queue. The size can be negative when the queue is empty and there is at least one reader waiting. Since this is a concurrent queue the size is only a best effort guess until all reader and writer threads have been joined. 
\begin{DoxyCode}{0}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{comment}{//\ TODO:\ How\ can\ we\ deal\ with\ wrapped\ queue\ on\ 32bit?}}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}ptrdiff\_t\textcolor{keyword}{>}(head\_.load(std::memory\_order\_relaxed)\ -\/}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tail\_.load(std::memory\_order\_relaxed));}
\DoxyCodeLine{00264\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_ab9e87623785d1bbbd14146c896398180}\label{classrigtorp_1_1mpmc_1_1Queue_ab9e87623785d1bbbd14146c896398180} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!try\_emplace@{try\_emplace}}
\index{try\_emplace@{try\_emplace}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{try\_emplace()}{try\_emplace()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
template$<$typename... Args$>$ \\
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::try\+\_\+emplace (\begin{DoxyParamCaption}\item[{Args \&\&...}]{args }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_nothrow\_constructible<T,\ Args\ \&\&...>::value,}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}T\ must\ be\ nothrow\ constructible\ with\ Args\&\&..."{}});}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keyword}{auto}\ head\ =\ head\_.load(std::memory\_order\_acquire);}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ =\ slots\_[idx(head)];}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (turn(head)\ *\ 2\ ==\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.load(std::memory\_order\_acquire))\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (head\_.compare\_exchange\_strong(head,\ head\ +\ 1))\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.construct(std::forward<Args>(args)...);}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.store(turn(head)\ *\ 2\ +\ 1,\ std::memory\_order\_release);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ prevHead\ =\ head;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ head\ =\ head\_.load(std::memory\_order\_acquire);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (head\ ==\ prevHead)\ \{}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00196\ \ \ \ \ \}}
\DoxyCodeLine{00197\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_aa87e90cf0ff85092b7a86b2481e7b6b8}\label{classrigtorp_1_1mpmc_1_1Queue_aa87e90cf0ff85092b7a86b2481e7b6b8} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!try\_pop@{try\_pop}}
\index{try\_pop@{try\_pop}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{try\_pop()}{try\_pop()}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::try\+\_\+pop (\begin{DoxyParamCaption}\item[{T \&}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keyword}{auto}\ tail\ =\ tail\_.load(std::memory\_order\_acquire);}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \&\mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}\ =\ slots\_[idx(tail)];}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (turn(tail)\ *\ 2\ +\ 1\ ==\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.load(std::memory\_order\_acquire))\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tail\_.compare\_exchange\_strong(tail,\ tail\ +\ 1))\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.move();}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.destroy();}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8}{slot}}.turn.store(turn(tail)\ *\ 2\ +\ 2,\ std::memory\_order\_release);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ prevTail\ =\ tail;}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ tail\ =\ tail\_.load(std::memory\_order\_acquire);}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tail\ ==\ prevTail)\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00253\ \ \ \ \ \}}
\DoxyCodeLine{00254\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_acab484c2f7bd2ee52f14b0b5c7237176}\label{classrigtorp_1_1mpmc_1_1Queue_acab484c2f7bd2ee52f14b0b5c7237176} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!try\_push@{try\_push}}
\index{try\_push@{try\_push}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{try\_push()}{try\_push()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::try\+\_\+push (\begin{DoxyParamCaption}\item[{const T \&}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_nothrow\_copy\_constructible<T>::value,}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}T\ must\ be\ nothrow\ copy\ constructible"{}});}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{return}\ try\_emplace(v);}
\DoxyCodeLine{00216\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classrigtorp_1_1mpmc_1_1Queue_a6475d4a693b48e6950a64d1e8e1df3b3}\label{classrigtorp_1_1mpmc_1_1Queue_a6475d4a693b48e6950a64d1e8e1df3b3} 
\index{rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}!try\_push@{try\_push}}
\index{try\_push@{try\_push}!rigtorp::mpmc::Queue$<$ T, Allocator $>$@{rigtorp::mpmc::Queue$<$ T, Allocator $>$}}
\doxysubsubsection{\texorpdfstring{try\_push()}{try\_push()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T , typename Allocator  = Aligned\+Allocator$<$\+Slot$<$\+T$>$$>$$>$ \\
template$<$typename P , typename  = typename std\+::enable\+\_\+if$<$                std\+::is\+\_\+nothrow\+\_\+constructible$<$\+T, P \&\&$>$\+::value$>$\+::type$>$ \\
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classrigtorp_1_1mpmc_1_1Queue}{rigtorp\+::mpmc\+::\+Queue}}$<$ T, Allocator $>$\+::try\+\_\+push (\begin{DoxyParamCaption}\item[{P \&\&}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordflow}{return}\ try\_emplace(std::forward<P>(v));}
\DoxyCodeLine{00223\ \ \ \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
external/rigtorp/MPMCQueue.\+h\end{DoxyCompactItemize}
