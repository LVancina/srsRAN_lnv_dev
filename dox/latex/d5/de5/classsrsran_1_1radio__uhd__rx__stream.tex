\doxysection{srsran\+::radio\+\_\+uhd\+\_\+rx\+\_\+stream Class Reference}
\hypertarget{classsrsran_1_1radio__uhd__rx__stream}{}\label{classsrsran_1_1radio__uhd__rx__stream}\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}


Implements a gateway receiver based on UHD receive stream.  




{\ttfamily \#include $<$radio\+\_\+uhd\+\_\+rx\+\_\+stream.\+h$>$}



Inheritance diagram for srsran\+::radio\+\_\+uhd\+\_\+rx\+\_\+stream\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d3/d3e/classsrsran_1_1radio__uhd__rx__stream__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::radio\+\_\+uhd\+\_\+rx\+\_\+stream\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dc/d17/classsrsran_1_1radio__uhd__rx__stream__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description}{stream\+\_\+description}}
\begin{DoxyCompactList}\small\item\em Describes the necessary parameters to create an UHD transmit stream. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1radio__uhd__rx__stream_aca19749a06798b1a6067c1b1882fe39a}{radio\+\_\+uhd\+\_\+rx\+\_\+stream}} (uhd\+::usrp\+::multi\+\_\+usrp\+::sptr \&usrp, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description}{stream\+\_\+description}} \&description, \mbox{\hyperlink{classsrsran_1_1radio__notification__handler}{radio\+\_\+notification\+\_\+handler}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\+\_\+}})
\begin{DoxyCompactList}\small\item\em Constructs a receive UHD stream. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1radio__uhd__rx__stream_a549f75a1eb36ef92da670e98cd20cb0a}{start}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} uhd\+::time\+\_\+spec\+\_\+t \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{time\+\_\+spec}})
\begin{DoxyCompactList}\small\item\em Starts the stream reception. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{classsrsran_1_1radio__uhd__rx__stream_a4384a6fd84beab82e7c9a5429a7a723b}{get\+\_\+buffer\+\_\+size}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\begin{DoxyCompactList}\small\item\em Gets the optimal transmitter buffer size. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1baseband__gateway__receiver_1_1metadata}{metadata}} \mbox{\hyperlink{classsrsran_1_1radio__uhd__rx__stream_a15c3e6db191b70f325f549b1a6b1c769}{receive}} (\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer}{baseband\+\_\+gateway\+\_\+buffer\+\_\+writer}} \&data) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Receives a number of baseband samples. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1radio__uhd__rx__stream_a82c9e149a00ff49f1b552f6a893f62d6}{stop}} ()
\begin{DoxyCompactList}\small\item\em Stops the reception stream. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1radio__uhd__rx__stream_ad32dc3140529e7c09e88131fe0204c0f}{wait\+\_\+stop}} ()
\begin{DoxyCompactList}\small\item\em Wait until radio is notify\+\_\+stop. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1uhd__exception__handler}{srsran\+::uhd\+\_\+exception\+\_\+handler}}}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{typename}} S , typename... Args$>$ }\\\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1uhd__exception__handler_a8f6f77cc15719b76196b3466f446be7c}{on\+\_\+error}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} S \&format\+\_\+str, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{Args}} \&\&... args)
\item 
{\footnotesize template$<$\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{typename}} F $>$ }\\\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1uhd__exception__handler_ac3e01af04c1c394cb27d1150cfa7e492}{safe\+\_\+execution}} (F task)
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1uhd__exception__handler_a3660e50d52ecd1fa3d426a805030a646}{is\+\_\+successful}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} std\+::string \& \mbox{\hyperlink{classsrsran_1_1uhd__exception__handler_a9d9c51ab907c347c37e0d339fe9e88d2}{get\+\_\+error\+\_\+message}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{srsran\+::baseband\+\_\+gateway\+\_\+base}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}baseband\+\_\+gateway\+\_\+base} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Provides default destructor. \end{DoxyCompactList}\item 
{\bfseries baseband\+\_\+gateway\+\_\+base} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{baseband\+\_\+gateway\+\_\+base}} \&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}})=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\begin{DoxyCompactList}\small\item\em Forbid copy constructor. \end{DoxyCompactList}\item 
{\bfseries baseband\+\_\+gateway\+\_\+base} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{baseband\+\_\+gateway\+\_\+base}} \&\&\mbox{\hyperlink{namespacesrsran_aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf}{other}})=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\begin{DoxyCompactList}\small\item\em Forbid move constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{baseband\+\_\+gateway\+\_\+base}} \& {\bfseries operator=} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{baseband\+\_\+gateway\+\_\+base}} \&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\begin{DoxyCompactList}\small\item\em Forbid copy assigment operator. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{baseband\+\_\+gateway\+\_\+base}} \& {\bfseries operator=} (\mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{baseband\+\_\+gateway\+\_\+base}} \&\&)=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{delete}}
\begin{DoxyCompactList}\small\item\em Forbid move assigment operator. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1baseband__gateway__base}{srsran\+::baseband\+\_\+gateway\+\_\+base}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries baseband\+\_\+gateway\+\_\+base} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Allow default constructor for child. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implements a gateway receiver based on UHD receive stream. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1radio__uhd__rx__stream_aca19749a06798b1a6067c1b1882fe39a}\label{classsrsran_1_1radio__uhd__rx__stream_aca19749a06798b1a6067c1b1882fe39a} 
\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}!radio\_uhd\_rx\_stream@{radio\_uhd\_rx\_stream}}
\index{radio\_uhd\_rx\_stream@{radio\_uhd\_rx\_stream}!srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}
\doxysubsubsection{\texorpdfstring{radio\_uhd\_rx\_stream()}{radio\_uhd\_rx\_stream()}}
{\footnotesize\ttfamily radio\+\_\+uhd\+\_\+rx\+\_\+stream\+::radio\+\_\+uhd\+\_\+rx\+\_\+stream (\begin{DoxyParamCaption}\item[{uhd\+::usrp\+::multi\+\_\+usrp\+::sptr \&}]{usrp,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1radio__uhd__rx__stream_1_1stream__description}{stream\+\_\+description}} \&}]{description,  }\item[{\mbox{\hyperlink{classsrsran_1_1radio__notification__handler}{radio\+\_\+notification\+\_\+handler}} \&}]{notifier\+\_\+ }\end{DoxyParamCaption})}



Constructs a receive UHD stream. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em usrp} & Provides the USRP context. \\
\hline
\mbox{\texttt{ in}}  & {\em description} & Provides the stream configuration parameters. \\
\hline
\mbox{\texttt{ in}}  & {\em notifier\+\_\+} & Provides the radio event notification handler. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00063\ \ \ id(description.id),\ srate\_Hz(description.srate\_Hz),\ notifier(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{notifier\_}})}
\DoxyCodeLine{00064\ \{}
\DoxyCodeLine{00065\ \ \ srsran\_assert(std::isnormal(srate\_Hz)\ \&\&\ (srate\_Hz\ >\ 0.0),\ \textcolor{stringliteral}{"{}Invalid\ sampling\ rate\ \{\}."{}},\ srate\_Hz);}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ Build\ stream\ arguments.}}
\DoxyCodeLine{00068\ \ \ uhd::stream\_args\_t\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}\ =\ \{\};}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}.cpu\_format\ \ \ \ \ \ \ \ \ =\ \textcolor{stringliteral}{"{}fc32"{}};}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{switch}\ (description.otw\_format)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{case}\ radio\_configuration::over\_the\_wire\_format::DEFAULT:}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordflow}{case}\ radio\_configuration::over\_the\_wire\_format::SC16:}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}.otw\_format\ =\ \textcolor{stringliteral}{"{}sc16"{}};}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{case}\ radio\_configuration::over\_the\_wire\_format::SC12:}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}.otw\_format\ =\ \textcolor{stringliteral}{"{}sc12"{}};}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{case}\ radio\_configuration::over\_the\_wire\_format::SC8:}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}.otw\_format\ =\ \textcolor{stringliteral}{"{}sc8"{}};}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}.args\ \ \ \ \ =\ description.args;}
\DoxyCodeLine{00083\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}.channels\ =\ description.ports;}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ (!safe\_execution([\textcolor{keyword}{this},\ usrp,\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}}]()\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ stream\ \ \ \ \ \ \ \ \ \ =\ usrp-\/>get\_rx\_stream(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_args}});}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ max\_packet\_size\ =\ stream-\/>get\_max\_num\_samps();}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ nof\_channels\ \ \ \ =\ stream-\/>get\_num\_channels();}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \}))\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ state\ =\ states::SUCCESSFUL\_INIT;}
\DoxyCodeLine{00094\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1radio__uhd__rx__stream_a4384a6fd84beab82e7c9a5429a7a723b}\label{classsrsran_1_1radio__uhd__rx__stream_a4384a6fd84beab82e7c9a5429a7a723b} 
\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}!get\_buffer\_size@{get\_buffer\_size}}
\index{get\_buffer\_size@{get\_buffer\_size}!srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}
\doxysubsubsection{\texorpdfstring{get\_buffer\_size()}{get\_buffer\_size()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classunsigned}{unsigned}} radio\+\_\+uhd\+\_\+rx\+\_\+stream\+::get\+\_\+buffer\+\_\+size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Gets the optimal transmitter buffer size. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00217\ \{}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{return}\ max\_packet\_size;}
\DoxyCodeLine{00219\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__uhd__rx__stream_a15c3e6db191b70f325f549b1a6b1c769}\label{classsrsran_1_1radio__uhd__rx__stream_a15c3e6db191b70f325f549b1a6b1c769} 
\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}!receive@{receive}}
\index{receive@{receive}!srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}
\doxysubsubsection{\texorpdfstring{receive()}{receive()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1baseband__gateway__receiver_1_1metadata}{baseband\+\_\+gateway\+\_\+receiver\+::metadata}} radio\+\_\+uhd\+\_\+rx\+\_\+stream\+::receive (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1baseband__gateway__buffer__writer}{baseband\+\_\+gateway\+\_\+buffer\+\_\+writer}} \&}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Receives a number of baseband samples. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em data} & Buffer of baseband samples. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Receiver metadata. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
The {\ttfamily data} buffer provides the number of samples to receive through baseband\+\_\+gateway\+\_\+buffer\+::get\+\_\+nof\+\_\+samples. 

The {\ttfamily data} buffer must have the same number of channels as the stream. 
\end{DoxyNote}


Implements \mbox{\hyperlink{classsrsran_1_1baseband__gateway__receiver_ae33340ac20a0c4f1d2a1fe1042f49ea1}{srsran\+::baseband\+\_\+gateway\+\_\+receiver}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00122\ \{}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{structsrsran_1_1baseband__gateway__receiver_1_1metadata}{baseband\_gateway\_receiver::metadata}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}}\ =\ \{\};}
\DoxyCodeLine{00124\ \ \ uhd::rx\_metadata\_t\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}};}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nsamples}}\ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{buffs}}[0].size();}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples\_total}}\ \ \ =\ 0;}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timeout\_trial\_count}}\ =\ 0;}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \textcolor{comment}{//\ Receive\ stream\ in\ multiple\ blocks.}}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples\_total}}\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{nsamples}})\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples}}\ =\ 0;}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{if}\ (!receive\_block(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{buffs}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples\_total}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}}))\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ failed\ receiving\ packet.\ \%s.\(\backslash\)n"{}},\ get\_error\_message().c\_str());}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\};}
\DoxyCodeLine{00135\ \ \ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ Save\ timespec\ for\ first\ block\ only\ if\ the\ last\ timestamp\ is\ unknown.}}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples\_total}}\ ==\ 0)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}}.ts\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}}.time\_spec.to\_ticks(srate\_Hz);}
\DoxyCodeLine{00140\ \ \ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ Increase\ the\ total\ amount\ of\ received\ samples.}}
\DoxyCodeLine{00143\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples\_total}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rxd\_samples}};}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ Prepare\ notification\ event.}}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1radio__notification__handler_1_1event__description}{radio\_notification\_handler::event\_description}}\ \textcolor{keyword}{event}\ =\ \{\};}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keyword}{event}.\mbox{\hyperlink{structsrsran_1_1radio__notification__handler_1_1event__description_a3f49f91a7ca868389088332fd4a16386}{stream\_id}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ id;}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{event}.channel\_id\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classsrsran_1_1radio__notification__handler_a8afbb07c418abcb0cf1237fae5a52a4a}{radio\_notification\_handler::UNKNOWN\_ID}};}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keyword}{event}.source\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classsrsran_1_1radio__notification__handler_1_1event__source_a7f23df937678f1d803ac52f8af7d91b3a19ac844f8ed52b085914d124bc2c6975}{radio\_notification\_handler::event\_source::RECEIVE}};}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keyword}{event}.type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{classsrsran_1_1radio__notification__handler_1_1event__type_ada92c8b313b55717e4f4f4be58a1ab58a48b372a0a9a6468db79fc00d005207a6}{radio\_notification\_handler::event\_type::UNDEFINED}};}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{comment}{//\ Handle\ error.}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}}.error\_code)\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_TIMEOUT:}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timeout\_trial\_count}};}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{timeout\_trial\_count}}\ >=\ 10)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ exceeded\ maximum\ number\ of\ timed\ out\ transmissions.\(\backslash\)n"{}});}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}};}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_NONE:}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignored.}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_LATE\_COMMAND:}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.type\ =\ \mbox{\hyperlink{classsrsran_1_1radio__notification__handler_1_1event__type_ada92c8b313b55717e4f4f4be58a1ab58a6648a01a7ae6ecf549b9d1813b49c791}{radio\_notification\_handler::event\_type::LATE}};}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_OVERFLOW:}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keyword}{event}.type\ =\ \mbox{\hyperlink{classsrsran_1_1radio__notification__handler_1_1event__type_ada92c8b313b55717e4f4f4be58a1ab58ad7d3af42b7de04e518d134ab00aea959}{radio\_notification\_handler::event\_type::OVERFLOW}};}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_BROKEN\_CHAIN:}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_ALIGNMENT:}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ uhd::rx\_metadata\_t::ERROR\_CODE\_BAD\_PACKET:}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ unhandled\ error\ in\ Rx\ metadata\ \%s."{}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{md}}.strerror().c\_str());}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}};}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//\ Notify\ if\ the\ event\ type\ was\ set.}}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordflow}{if}\ (event.type\ !=\ \mbox{\hyperlink{classsrsran_1_1radio__notification__handler_1_1event__type_ada92c8b313b55717e4f4f4be58a1ab58a48b372a0a9a6468db79fc00d005207a6}{radio\_notification\_handler::event\_type::UNDEFINED}})\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ notifier.\mbox{\hyperlink{classsrsran_1_1radio__notification__handler_a8b4a990b42877a8054ac67c85543c541}{on\_radio\_rt\_event}}(event);}
\DoxyCodeLine{00180\ \ \ \ \ \}}
\DoxyCodeLine{00181\ \ \ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//\ If\ it\ reaches\ here,\ there\ is\ no\ error.}}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ret}};}
\DoxyCodeLine{00185\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__uhd__rx__stream_a549f75a1eb36ef92da670e98cd20cb0a}\label{classsrsran_1_1radio__uhd__rx__stream_a549f75a1eb36ef92da670e98cd20cb0a} 
\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}!start@{start}}
\index{start@{start}!srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}
\doxysubsubsection{\texorpdfstring{start()}{start()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} radio\+\_\+uhd\+\_\+rx\+\_\+stream\+::start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} uhd\+::time\+\_\+spec\+\_\+t \&}]{time\+\_\+spec }\end{DoxyParamCaption})}



Starts the stream reception. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em time\+\_\+spec} & Indicates the start time of the stream. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if no exception is caught. Otherwise false. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00097\ \{}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{if}\ (state\ !=\ states::SUCCESSFUL\_INIT)\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00100\ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ Protect\ the\ UHD\ Tx\ stream\ against\ concurrent\ access.}}
\DoxyCodeLine{00103\ \ \ std::unique\_lock<std::mutex>\ lock(stream\_mutex);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{if}\ (!safe\_execution([\textcolor{keyword}{this},\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{time\_spec}}]()\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ uhd::stream\_cmd\_t\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}}(uhd::stream\_cmd\_t::STREAM\_MODE\_START\_CONTINUOUS);}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}}.time\_spec\ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{time\_spec}};}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}}.stream\_now\ =\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{time\_spec}}.get\_real\_secs()\ ==\ uhd::time\_spec\_t());}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ stream-\/>issue\_stream\_cmd(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}});}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \}))\ \{}
\DoxyCodeLine{00112\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ failed\ to\ start\ receive\ stream\ \%d.\ \%s."{}},\ \textcolor{keywordtype}{id},\ get\_error\_message().c\_str());}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{comment}{//\ Transition\ to\ streaming\ state.}}
\DoxyCodeLine{00116\ \ \ state\ =\ states::STREAMING;}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00119\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__uhd__rx__stream_a82c9e149a00ff49f1b552f6a893f62d6}\label{classsrsran_1_1radio__uhd__rx__stream_a82c9e149a00ff49f1b552f6a893f62d6} 
\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}!stop@{stop}}
\index{stop@{stop}!srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}
\doxysubsubsection{\texorpdfstring{stop()}{stop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} radio\+\_\+uhd\+\_\+rx\+\_\+stream\+::stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Stops the reception stream. 

\begin{DoxyReturn}{Returns}
True if no exception is caught. Otherwise false. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \{}
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ Transition\ state\ to\ stop\ before\ locking\ to\ prevent\ real\ time\ priority\ thread\ owning\ the\ lock\ constantly.}}
\DoxyCodeLine{00190\ \ \ state\ =\ states::STOP;}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \textcolor{comment}{//\ Protect\ the\ UHD\ Tx\ stream\ against\ concurrent\ access.}}
\DoxyCodeLine{00193\ \ \ std::unique\_lock<std::mutex>\ lock(stream\_mutex);}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \textcolor{comment}{//\ Try\ to\ stop\ the\ stream.}}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordflow}{if}\ (!safe\_execution([\textcolor{keyword}{this}]()\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ uhd::stream\_cmd\_t\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}}(uhd::stream\_cmd\_t::STREAM\_MODE\_STOP\_CONTINUOUS);}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}}.time\_spec\ \ =\ uhd::time\_spec\_t();}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}}.stream\_now\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ stream-\/>issue\_stream\_cmd(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{stream\_cmd}});}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \}))\ \{}
\DoxyCodeLine{00203\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ failed\ to\ stop\ stream\ \%d.\ \%s."{}},\ \textcolor{keywordtype}{id},\ get\_error\_message().c\_str());}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00205\ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00208\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1radio__uhd__rx__stream_ad32dc3140529e7c09e88131fe0204c0f}\label{classsrsran_1_1radio__uhd__rx__stream_ad32dc3140529e7c09e88131fe0204c0f} 
\index{srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}!wait\_stop@{wait\_stop}}
\index{wait\_stop@{wait\_stop}!srsran::radio\_uhd\_rx\_stream@{srsran::radio\_uhd\_rx\_stream}}
\doxysubsubsection{\texorpdfstring{wait\_stop()}{wait\_stop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} radio\+\_\+uhd\+\_\+rx\+\_\+stream\+::wait\+\_\+stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Wait until radio is notify\+\_\+stop. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00211\ \{}
\DoxyCodeLine{00212\ \ \ \textcolor{comment}{//\ nothing\ to\ wait\ here}}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00214\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/radio/uhd/radio\+\_\+uhd\+\_\+rx\+\_\+stream.\+h\item 
lib/radio/uhd/radio\+\_\+uhd\+\_\+rx\+\_\+stream.\+cpp\end{DoxyCompactItemize}
