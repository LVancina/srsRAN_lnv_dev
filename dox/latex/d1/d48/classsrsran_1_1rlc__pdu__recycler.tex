\doxysection{srsran\+::rlc\+\_\+pdu\+\_\+recycler Class Reference}
\hypertarget{classsrsran_1_1rlc__pdu__recycler}{}\label{classsrsran_1_1rlc__pdu__recycler}\index{srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}}


Recycling bin for discarded PDUs that shall be deleted by a different executor off a real-\/time critical path. This class is intended to offload the time-\/consumping deletion of thousands \doxylink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer} objects of ACK\textquotesingle{}ed PDUs from tx\+\_\+window upon reception of the RLC AM status report, which is handled by the pcell\+\_\+executor in a real-\/time critical path.  




{\ttfamily \#include $<$rlc\+\_\+pdu\+\_\+recycler.\+h$>$}



Collaboration diagram for srsran\+::rlc\+\_\+pdu\+\_\+recycler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{d6/dc1/classsrsran_1_1rlc__pdu__recycler__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1rlc__pdu__recycler_ad5bb6c0719004fdbfc6db15098890e7a}{rlc\+\_\+pdu\+\_\+recycler}} (size\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rlc\+\_\+window\+\_\+size}}, \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{rlc\+\_\+bearer\+\_\+logger}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\+\_\+}})
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1rlc__pdu__recycler_a5d99dc985af289a9ceffa98c4478f241}{add\+\_\+discarded\+\_\+pdu}} (\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} pdu)
\begin{DoxyCompactList}\small\item\em Adds a discarded PDU to the recycler which shall be deleted later by another executor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1rlc__pdu__recycler_ab2b5ce56b95c5d68c00d03f7d9d8ace7}{clear\+\_\+by\+\_\+executor}} (\mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&executor)
\begin{DoxyCompactList}\small\item\em Delegates the deletion of all stored PDUs to the given \doxylink{classsrsran_1_1task__executor}{task\+\_\+executor}. \end{DoxyCompactList}\item 
std\+::array$<$ std\+::vector$<$ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} $>$, 3 $>$ \& \mbox{\hyperlink{classsrsran_1_1rlc__pdu__recycler_a7ea1a3179b4cfa41d6e2e2878c996833}{get\+\_\+recycle\+\_\+bins}} ()
\begin{DoxyCompactList}\small\item\em For unit-\/testing only\+: Expose inner recycle bins. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Recycling bin for discarded PDUs that shall be deleted by a different executor off a real-\/time critical path. This class is intended to offload the time-\/consumping deletion of thousands \doxylink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer} objects of ACK\textquotesingle{}ed PDUs from tx\+\_\+window upon reception of the RLC AM status report, which is handled by the pcell\+\_\+executor in a real-\/time critical path. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1rlc__pdu__recycler_ad5bb6c0719004fdbfc6db15098890e7a}\label{classsrsran_1_1rlc__pdu__recycler_ad5bb6c0719004fdbfc6db15098890e7a} 
\index{srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}!rlc\_pdu\_recycler@{rlc\_pdu\_recycler}}
\index{rlc\_pdu\_recycler@{rlc\_pdu\_recycler}!srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}}
\doxysubsubsection{\texorpdfstring{rlc\_pdu\_recycler()}{rlc\_pdu\_recycler()}}
{\footnotesize\ttfamily srsran\+::rlc\+\_\+pdu\+\_\+recycler\+::rlc\+\_\+pdu\+\_\+recycler (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{rlc\+\_\+window\+\_\+size,  }\item[{\mbox{\hyperlink{classsrsran_1_1prefixed__logger}{rlc\+\_\+bearer\+\_\+logger}} \&}]{logger\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ logger(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{logger\_}})}
\DoxyCodeLine{00040\ \ \ \{}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordflow}{for}\ (std::vector<byte\_buffer>\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{recycle\_bin}}\ :\ recycle\_bins)\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{recycle\_bin}}.reserve(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{rlc\_window\_size}});}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1rlc__pdu__recycler_a5d99dc985af289a9ceffa98c4478f241}\label{classsrsran_1_1rlc__pdu__recycler_a5d99dc985af289a9ceffa98c4478f241} 
\index{srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}!add\_discarded\_pdu@{add\_discarded\_pdu}}
\index{add\_discarded\_pdu@{add\_discarded\_pdu}!srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}}
\doxysubsubsection{\texorpdfstring{add\_discarded\_pdu()}{add\_discarded\_pdu()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} srsran\+::rlc\+\_\+pdu\+\_\+recycler\+::add\+\_\+discarded\+\_\+pdu (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}}}]{pdu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Adds a discarded PDU to the recycler which shall be deleted later by another executor. 


\begin{DoxyParams}{Parameters}
{\em pdu} & The PDU that shall be deleted later \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the PDU was queued for later deletion; False if the PDU was deleted on the spot due to full queue. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00050\ \ \ \{}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordflow}{if}\ (recycle\_bin\_to\_fill-\/>size()\ >=\ recycle\_bin\_to\_fill-\/>capacity())\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{comment}{//\ recycle\ bin\ is\ full;\ delete\ the\ PDUs\ upon\ return}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ \ \ \ \ recycle\_bin\_to\_fill-\/>push\_back(std::move(pdu));}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00057\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1rlc__pdu__recycler_ab2b5ce56b95c5d68c00d03f7d9d8ace7}\label{classsrsran_1_1rlc__pdu__recycler_ab2b5ce56b95c5d68c00d03f7d9d8ace7} 
\index{srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}!clear\_by\_executor@{clear\_by\_executor}}
\index{clear\_by\_executor@{clear\_by\_executor}!srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}}
\doxysubsubsection{\texorpdfstring{clear\_by\_executor()}{clear\_by\_executor()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} srsran\+::rlc\+\_\+pdu\+\_\+recycler\+::clear\+\_\+by\+\_\+executor (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1task__executor}{task\+\_\+executor}} \&}]{executor }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Delegates the deletion of all stored PDUs to the given \doxylink{classsrsran_1_1task__executor}{task\+\_\+executor}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00061\ \ \ \{}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ Swap\ recycle\ bins\ under\ a\ lock}}
\DoxyCodeLine{00063\ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{recycle\_bin\_swap\_lock}}(recycle\_bin\_swap\_mutex);}
\DoxyCodeLine{00065\ \ \ \ \ \ \ std::swap(recycle\_bin\_to\_fill,\ recycle\_bin\_to\_swap);}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ Redirect\ recycling\ of\ unused\ byte\_buffers\ to\ ue\_executor}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{handle\_func}}\ =\ [\textcolor{keyword}{this}]()\ \textcolor{keyword}{mutable}\ \{\ clear();\ \};}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ executor.execute(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{handle\_func}})))\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ logger.log\_error(\textcolor{stringliteral}{"{}Failed\ to\ delegate\ deletion\ of\ PDUs\ to\ given\ executor."{}});}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1rlc__pdu__recycler_a7ea1a3179b4cfa41d6e2e2878c996833}\label{classsrsran_1_1rlc__pdu__recycler_a7ea1a3179b4cfa41d6e2e2878c996833} 
\index{srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}!get\_recycle\_bins@{get\_recycle\_bins}}
\index{get\_recycle\_bins@{get\_recycle\_bins}!srsran::rlc\_pdu\_recycler@{srsran::rlc\_pdu\_recycler}}
\doxysubsubsection{\texorpdfstring{get\_recycle\_bins()}{get\_recycle\_bins()}}
{\footnotesize\ttfamily std\+::array$<$ std\+::vector$<$ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\+\_\+buffer}} $>$, 3 $>$ \& srsran\+::rlc\+\_\+pdu\+\_\+recycler\+::get\+\_\+recycle\+\_\+bins (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



For unit-\/testing only\+: Expose inner recycle bins. 

\begin{DoxyReturn}{Returns}
Reference to inner recycle bins for testing purposes 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00076\ \{\ \textcolor{keywordflow}{return}\ recycle\_bins;\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
lib/rlc/rlc\+\_\+pdu\+\_\+recycler.\+h\end{DoxyCompactItemize}
