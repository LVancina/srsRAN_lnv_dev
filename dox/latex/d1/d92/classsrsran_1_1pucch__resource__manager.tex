\doxysection{srsran\+::pucch\+\_\+resource\+\_\+manager Class Reference}
\hypertarget{classsrsran_1_1pucch__resource__manager}{}\label{classsrsran_1_1pucch__resource__manager}\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}


Class that manages the cell allocation of PUCCH resources across UEs. The correct functioning of \doxylink{classsrsran_1_1pucch__resource__manager}{pucch\+\_\+resource\+\_\+manager} is based on the following assumptions\+: (i) Each UE has max 8 PUCCH F1 and max 8 PUCCH F2 dedicated to HARQ-\/\+ACK reporting. (ii) Each UE has max 1 SR-\/dedicated PUCCH F1 resource and max 1 CSI-\/dedicated PUCCH F2 resource. (iii) The cell PUCCH resource list can have max 128 PUCCH resource, including all formats; at cell level, there is no constraint on how many resource must be F1, F2, or for SR or for CSI. (vi) UEs can have different PUCCH resource lists; however the PUCCH resource ID is unique with the cell. This implies that if two UEs have the same PUCCH resource within their lists, their PUCCH resource ID must be the same. (v) Indexing of the PUCCH F1 and PUCCH F2 resources for HARQ-\/\+ACK reporting must be contiguous within the F1 group and with F2 group. However, the last PUCCH F1 group resource\textquotesingle{}s and the first PUCCH F2 group resource\textquotesingle{}s indices need not be contiguous. E.\+g., PUCCH F1 indices (for HARQ-\/\+ACK reporting) = \{0, ..., 7\}, and PUCCH F2 indices (for HARQ-\/\+ACK reporting) = \{10, ..., 17\}.  




{\ttfamily \#include $<$pucch\+\_\+resource\+\_\+manager.\+h$>$}



Collaboration diagram for srsran\+::pucch\+\_\+resource\+\_\+manager\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{dc/d15/classsrsran_1_1pucch__resource__manager__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a81a16bc8a6f73d1d6877b6ef2b973e25}{slot\+\_\+indication}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+tx)
\begin{DoxyCompactList}\small\item\em Reset all resources to "{}unused"{}. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a12c33ef146bb86101981b4d644e3bf6d}{is\+\_\+common\+\_\+resource\+\_\+available}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sl}}, size\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r\+\_\+pucch}})
\begin{DoxyCompactList}\small\item\em Returns true if the common PUCCH resource indexed by r\+\_\+pucch is available at the given slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_ae60b313b4eb6150af00a3302134a6567}{reserve\+\_\+common\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sl}}, size\+\_\+t \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r\+\_\+pucch}})
\begin{DoxyCompactList}\small\item\em Set the common PUCCH resource indexed by r\+\_\+pucch at the given slot as currently "{}not available"{}. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\+\_\+harq\+\_\+resource\+\_\+alloc\+\_\+record}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_acc21904f68185add3248e3b223025cda}{reserve\+\_\+next\+\_\+f1\+\_\+harq\+\_\+res\+\_\+available}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the next PUCCH resource available to be used for HARQ-\/\+ACK (format 1). \end{DoxyCompactList}\item 
\mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\+\_\+harq\+\_\+resource\+\_\+alloc\+\_\+record}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_af451820441803f58f45ec6d90b265f51}{reserve\+\_\+next\+\_\+f2\+\_\+harq\+\_\+res\+\_\+available}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the next PUCCH format 2 resource available to be used for HARQ-\/\+ACK. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a516af5de56b8abb7e9a015fee28cf28a}{reserve\+\_\+specific\+\_\+format2\+\_\+res}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\+\_\+indicator}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns a specific PUCCH format 2 resource (identified by the res. indicator) to be used for HARQ-\/\+ACK. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_ae44246e38b2ff1e41fa94c4546384f0c}{reserve\+\_\+csi\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the specific PUCCH format 2 resource config to be used for CSI, if available. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a59b1a37f315491278aa7aad2c290a8c5}{reserve\+\_\+sr\+\_\+res\+\_\+available}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+sr}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the specific PUCCH format 1 resource config to be used for SR, if available. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_acfcd84de6b5b859c51c68d219a8a4098}{release\+\_\+harq\+\_\+f1\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Release PUCCH (format 1) resource from being allocated to a given UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a9f4da9b7594802e4c1c66248f2bdd88a}{release\+\_\+harq\+\_\+f2\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Release PUCCH (format 2) resource from being allocated to a given UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a15b5a050479f5e214eba5caa2592b2c3}{release\+\_\+sr\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+sr}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Release PUCCH (format 1) resource used for SR from being allocated to a given UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_abf167b75a5c55bf75860448daf6a4920}{release\+\_\+csi\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+sr}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Release PUCCH (format 2) resource used for CSI from being allocated to a given UE. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_afeffc4fb86b8d3d528a23cd0aa202617}{fetch\+\_\+f1\+\_\+pucch\+\_\+res\+\_\+indic}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+tx, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the PUCCH resource indicator (format 1) of the resource used for a given RNTI at a given slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classint}{int}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_ae4219490f4e5ceddf8bcd4389026fc63}{fetch\+\_\+f2\+\_\+pucch\+\_\+res\+\_\+indic}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+tx, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the PUCCH resource indicator (format 2) of the resource used for a given RNTI at a given slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\+\_\+harq\+\_\+resource\+\_\+alloc\+\_\+record}} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a53136d8c1533a7be826aac73d5aa9ea4}{fetch\+\_\+allocated\+\_\+f2\+\_\+harq\+\_\+resource}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+harq}}, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&pucch\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Fetches the configuration of the PUCCH Format 2 resource used for HARQ previously allocated to a given RNTI for a given slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classsrsran_1_1pucch__resource__manager_a874091c3cadec6e8a2bafa444faf69cb}{fetch\+\_\+csi\+\_\+pucch\+\_\+res\+\_\+config}} (\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}} slot\+\_\+tx, \mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}} crnti, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&ue\+\_\+cell\+\_\+cfg)
\begin{DoxyCompactList}\small\item\em Returns the configuration of the PUCCH resource used for CSI (format 2) for a given RNTI at a given slot. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class that manages the cell allocation of PUCCH resources across UEs. The correct functioning of \doxylink{classsrsran_1_1pucch__resource__manager}{pucch\+\_\+resource\+\_\+manager} is based on the following assumptions\+: (i) Each UE has max 8 PUCCH F1 and max 8 PUCCH F2 dedicated to HARQ-\/\+ACK reporting. (ii) Each UE has max 1 SR-\/dedicated PUCCH F1 resource and max 1 CSI-\/dedicated PUCCH F2 resource. (iii) The cell PUCCH resource list can have max 128 PUCCH resource, including all formats; at cell level, there is no constraint on how many resource must be F1, F2, or for SR or for CSI. (vi) UEs can have different PUCCH resource lists; however the PUCCH resource ID is unique with the cell. This implies that if two UEs have the same PUCCH resource within their lists, their PUCCH resource ID must be the same. (v) Indexing of the PUCCH F1 and PUCCH F2 resources for HARQ-\/\+ACK reporting must be contiguous within the F1 group and with F2 group. However, the last PUCCH F1 group resource\textquotesingle{}s and the first PUCCH F2 group resource\textquotesingle{}s indices need not be contiguous. E.\+g., PUCCH F1 indices (for HARQ-\/\+ACK reporting) = \{0, ..., 7\}, and PUCCH F2 indices (for HARQ-\/\+ACK reporting) = \{10, ..., 17\}. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a966f3fb64ede88c09bd4fbdcc9cf8a02}\label{classsrsran_1_1pucch__resource__manager_a966f3fb64ede88c09bd4fbdcc9cf8a02} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!pucch\_resource\_manager@{pucch\_resource\_manager}}
\index{pucch\_resource\_manager@{pucch\_resource\_manager}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{pucch\_resource\_manager()}{pucch\_resource\_manager()}}
{\footnotesize\ttfamily pucch\+\_\+resource\+\_\+manager\+::pucch\+\_\+resource\+\_\+manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00058\ \{}
\DoxyCodeLine{00059\ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{reset\_slot\_record}}\ =\ [](rnti\_pucch\_res\_id\_slot\_record\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}})\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_rec}}\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}.ues\_using\_pucch\_res)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_rec}}.rnti\ \ \ \ \ \ \ \ \ \ \ =\ rnti\_t::INVALID\_RNTI;}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_rec}}.resource\_usage\ =\ pucch\_resource\_usage::NOT\_USED;}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ res\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}.used\_common\_resources)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ std::for\_each(resource\_slots.begin(),\ resource\_slots.end(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{reset\_slot\_record}});}
\DoxyCodeLine{00070\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a53136d8c1533a7be826aac73d5aa9ea4}\label{classsrsran_1_1pucch__resource__manager_a53136d8c1533a7be826aac73d5aa9ea4} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!fetch\_allocated\_f2\_harq\_resource@{fetch\_allocated\_f2\_harq\_resource}}
\index{fetch\_allocated\_f2\_harq\_resource@{fetch\_allocated\_f2\_harq\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{fetch\_allocated\_f2\_harq\_resource()}{fetch\_allocated\_f2\_harq\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\+\_\+harq\+\_\+resource\+\_\+alloc\+\_\+record}} pucch\+\_\+resource\+\_\+manager\+::fetch\+\_\+allocated\+\_\+f2\+\_\+harq\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Fetches the configuration of the PUCCH Format 2 resource used for HARQ previously allocated to a given RNTI for a given slot. 

\begin{DoxyReturn}{Returns}
If the resource is found, it returns (i) the pointer to the configuration and (ii) the PUCCH resource indicator corresponding to the PUCCH resource that previously allocated to the UE. Else, the pointer passed will be {\ttfamily nullptr}, whereas the PUCCH resource indicator is to be ignored. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00299\ \{}
\DoxyCodeLine{00300\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}}\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ too\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \textcolor{comment}{//\ Get\ resource\ list\ of\ wanted\ slot.}}
\DoxyCodeLine{00304\ \ \ rnti\_pucch\_res\_id\_slot\_record\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}\ =\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}});}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_res\_array}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}.ues\_using\_pucch\_res;}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ Get\ the\ span\ over\ the\ array\ of\ resources\ for\ the\ specific\ UE.}}
\DoxyCodeLine{00309\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq}}\ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a1e889b531c4701a39575f0525c65bbd5}{pucch\_res\_set}}[PUCCH\_HARQ\_F2\_RES\_SET\_ID].pucch\_res\_id\_list;}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_first\_res\_id}}\ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq}}.front().cell\_res\_id;}
\DoxyCodeLine{00311\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_first\_res\_id}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq}}.size()\ <=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_res\_array}}.size(),}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Indexing\ of\ PUCCH\ resource\ set\ exceeds\ the\ size\ of\ the\ cell\ resource\ array"{}});}
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<resource\_tracker>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_ue\_res\_array}}(\&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_res\_array}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_first\_res\_id}}],\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq}}.size());}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \textcolor{comment}{//\ Check\ first\ if\ the\ target\ PUCCH\ resource\ (given\ the\ CRNTI\ and\ usage)\ exists\ within\ the\ resource\ tracker.}}
\DoxyCodeLine{00316\ \ \ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_ue\_resource}}\ =\ std::find\_if(}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_ue\_res\_array}}.begin(),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_ue\_res\_array}}.end(),\ [\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_rnti}}\ =\ crnti](\textcolor{keyword}{const}\ resource\_tracker\&\ res)\ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ return\ res.rnti\ ==\ target\_rnti\ and\ res.resource\_usage\ ==\ pucch\_resource\_usage::HARQ\_F2;}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \});}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pucch\_res\_list\ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a39a1ae64711a584a0d36f088bfc7b379}{pucch\_res\_list}};}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \textcolor{comment}{//\ If\ the\ resource\ is\ found,\ get\ the\ resource\ indicator\ and\ the\ configuration\ from\ the\ PUCCH\ resource\ list.}}
\DoxyCodeLine{00324\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_ue\_resource}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_ue\_res\_array}}.end()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_ue\_resource}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_ue\_res\_array}}.begin())\ <}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a1e889b531c4701a39575f0525c65bbd5}{pucch\_res\_set}}[PUCCH\_HARQ\_F2\_RES\_SET\_ID].pucch\_res\_id\_list.size())\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ PUCCH\ resource\ indicator\ from\ the\ available\ resource\ position\ within\ the\ span.}}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ pucch\_res\_indicator\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_ue\_resource}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_ue\_res\_array}}.begin());}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ indicator\ and\ the\ PUCCH\ resource\ set.}}
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_res\_idx\_from\_list}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq}}[pucch\_res\_indicator].cell\_res\_id;}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{comment}{//\ Search\ for\ the\ PUCCH\ resource\ with\ the\ correct\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ list.}}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ =\ std::find\_if(}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ pucch\_res\_list.begin(),\ pucch\_res\_list.end(),\ [\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_res\_idx\_from\_list}}](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\_resource}}\&\ res)\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ return\ res.res\_id.cell\_res\_id\ ==\ pucch\_res\_idx\_from\_list;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\_harq\_resource\_alloc\_record}}\{.\mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record_aaadc9a461359f88dd82616f9b69c5141}{pucch\_res}}\ =\ \&(*res\_cfg),\ .pucch\_res\_indicator\ =\ pucch\_res\_indicator\};}
\DoxyCodeLine{00339\ \ \ \}}
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\_harq\_resource\_alloc\_record}}\{.\mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record_aaadc9a461359f88dd82616f9b69c5141}{pucch\_res}}\ =\ \textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00341\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a874091c3cadec6e8a2bafa444faf69cb}\label{classsrsran_1_1pucch__resource__manager_a874091c3cadec6e8a2bafa444faf69cb} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!fetch\_csi\_pucch\_res\_config@{fetch\_csi\_pucch\_res\_config}}
\index{fetch\_csi\_pucch\_res\_config@{fetch\_csi\_pucch\_res\_config}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{fetch\_csi\_pucch\_res\_config()}{fetch\_csi\_pucch\_res\_config()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} pucch\+\_\+resource\+\_\+manager\+::fetch\+\_\+csi\+\_\+pucch\+\_\+res\+\_\+config (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+tx,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})}



Returns the configuration of the PUCCH resource used for CSI (format 2) for a given RNTI at a given slot. 

\begin{DoxyReturn}{Returns}
Pointer to the resource configuration used allocated to the UE; if UE is not found, returns {\ttfamily nullptr}. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00346\ \{}
\DoxyCodeLine{00347\ \ \ srsran\_sanity\_check(slot\_tx\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ to\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ rnti\_pucch\_res\_id\_slot\_record\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}\ =\ get\_slot\_resource\_counter(slot\_tx);}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx\_int}}\ =\ get\_pucch\_res\_idx\_for\_csi(ue\_cell\_cfg);}
\DoxyCodeLine{00353\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx\_int}}\ <\ 0)\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00355\ \ \ \}}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx\_int}});}
\DoxyCodeLine{00358\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].rnti\ !=\ crnti)\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00360\ \ \ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pucch\_res\_list\ =}
\DoxyCodeLine{00363\ \ \ \ \ \ \ ue\_cell\_cfg.cfg\_dedicated().\mbox{\hyperlink{structsrsran_1_1serving__cell__config_a2fe7ab17cda5bafb76bcabb1e526e556}{ul\_config}}.value().init\_ul\_bwp.pucch\_cfg.value().pucch\_res\_list;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \textcolor{comment}{//\ Search\ for\ the\ PUCCH\ resource\ with\ the\ correct\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ list.}}
\DoxyCodeLine{00366\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ =}
\DoxyCodeLine{00367\ \ \ \ \ \ \ std::find\_if(pucch\_res\_list.begin(),\ pucch\_res\_list.end(),\ [\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\_resource}}\&\ res)\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ return\ res.res\_id.cell\_res\_id\ ==\ csi\_pucch\_res\_idx;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \});}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \textcolor{comment}{//\ If\ the\ PUCCH\ res\ with\ correct\ ID\ is\ found,\ then\ return\ it\ to\ the\ user.}}
\DoxyCodeLine{00372\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ !=\ pucch\_res\_list.end())\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{return}\ \&(*res\_cfg);}
\DoxyCodeLine{00374\ \ \ \}}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00377\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_afeffc4fb86b8d3d528a23cd0aa202617}\label{classsrsran_1_1pucch__resource__manager_afeffc4fb86b8d3d528a23cd0aa202617} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!fetch\_f1\_pucch\_res\_indic@{fetch\_f1\_pucch\_res\_indic}}
\index{fetch\_f1\_pucch\_res\_indic@{fetch\_f1\_pucch\_res\_indic}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{fetch\_f1\_pucch\_res\_indic()}{fetch\_f1\_pucch\_res\_indic()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} pucch\+\_\+resource\+\_\+manager\+::fetch\+\_\+f1\+\_\+pucch\+\_\+res\+\_\+indic (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+tx,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Returns the PUCCH resource indicator (format 1) of the resource used for a given RNTI at a given slot. 

\begin{DoxyReturn}{Returns}
PUCCH resource indicator of the resource used allocated to the UE; if UE is not found, returns -\/1. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00286\ \{}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{return}\ fetch\_pucch\_res\_indic(slot\_tx,\ crnti,\ pucch\_cfg,\ pucch\_format::FORMAT\_1);}
\DoxyCodeLine{00288\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_ae4219490f4e5ceddf8bcd4389026fc63}\label{classsrsran_1_1pucch__resource__manager_ae4219490f4e5ceddf8bcd4389026fc63} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!fetch\_f2\_pucch\_res\_indic@{fetch\_f2\_pucch\_res\_indic}}
\index{fetch\_f2\_pucch\_res\_indic@{fetch\_f2\_pucch\_res\_indic}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{fetch\_f2\_pucch\_res\_indic()}{fetch\_f2\_pucch\_res\_indic()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classint}{int}} pucch\+\_\+resource\+\_\+manager\+::fetch\+\_\+f2\+\_\+pucch\+\_\+res\+\_\+indic (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+tx,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Returns the PUCCH resource indicator (format 2) of the resource used for a given RNTI at a given slot. 

\begin{DoxyReturn}{Returns}
PUCCH resource indicator of the resource used allocated to the UE; if UE is not found, returns -\/1. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00291\ \{}
\DoxyCodeLine{00292\ \ \ \textcolor{keywordflow}{return}\ fetch\_pucch\_res\_indic(slot\_tx,\ crnti,\ pucch\_cfg,\ pucch\_format::FORMAT\_2);}
\DoxyCodeLine{00293\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a12c33ef146bb86101981b4d644e3bf6d}\label{classsrsran_1_1pucch__resource__manager_a12c33ef146bb86101981b4d644e3bf6d} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!is\_common\_resource\_available@{is\_common\_resource\_available}}
\index{is\_common\_resource\_available@{is\_common\_resource\_available}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{is\_common\_resource\_available()}{is\_common\_resource\_available()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pucch\+\_\+resource\+\_\+manager\+::is\+\_\+common\+\_\+resource\+\_\+available (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl,  }\item[{size\+\_\+t}]{r\+\_\+pucch }\end{DoxyParamCaption})}



Returns true if the common PUCCH resource indexed by r\+\_\+pucch is available at the given slot. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00092\ \{}
\DoxyCodeLine{00093\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r\_pucch}}\ <\ 16,\ \textcolor{stringliteral}{"{}r\_PUCCH\ must\ be\ less\ than\ 16"{}});}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sl}}).used\_common\_resources[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r\_pucch}}];}
\DoxyCodeLine{00095\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_abf167b75a5c55bf75860448daf6a4920}\label{classsrsran_1_1pucch__resource__manager_abf167b75a5c55bf75860448daf6a4920} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!release\_csi\_resource@{release\_csi\_resource}}
\index{release\_csi\_resource@{release\_csi\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{release\_csi\_resource()}{release\_csi\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pucch\+\_\+resource\+\_\+manager\+::release\+\_\+csi\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+sr,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})}



Release PUCCH (format 2) resource used for CSI from being allocated to a given UE. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em slot\+\_\+harq} & slot for which the PUCCH resource was scheduled. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & UE from which the resource needs to be released. \\
\hline
\mbox{\texttt{ in}}  & {\em pucch\+\_\+cfg} & UE\textquotesingle{}s PUCCH config. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the resource for the UE was found in the allocation records for the given slot. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00265\ \{}
\DoxyCodeLine{00266\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_sr}}\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ to\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}\ =\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_sr}});}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \textcolor{comment}{//\ We\ assume\ each\ UE\ only\ has\ 1\ CSI\ Resource\ Config\ configured.}}
\DoxyCodeLine{00272\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}\ =\ get\_pucch\_res\_idx\_for\_csi(ue\_cell\_cfg);}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}\ <\ 0)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00275\ \ \ \}}
\DoxyCodeLine{00276\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].rnti\ !=\ crnti)\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].rnti\ \ \ \ \ \ \ \ \ \ \ =\ rnti\_t::INVALID\_RNTI;}
\DoxyCodeLine{00281\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].resource\_usage\ =\ pucch\_resource\_usage::NOT\_USED;}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00283\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_acfcd84de6b5b859c51c68d219a8a4098}\label{classsrsran_1_1pucch__resource__manager_acfcd84de6b5b859c51c68d219a8a4098} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!release\_harq\_f1\_resource@{release\_harq\_f1\_resource}}
\index{release\_harq\_f1\_resource@{release\_harq\_f1\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{release\_harq\_f1\_resource()}{release\_harq\_f1\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pucch\+\_\+resource\+\_\+manager\+::release\+\_\+harq\+\_\+f1\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Release PUCCH (format 1) resource from being allocated to a given UE. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em slot\+\_\+harq} & slot for which the PUCCH resource was scheduled. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & UE from which the resource needs to be released. \\
\hline
\mbox{\texttt{ in}}  & {\em pucch\+\_\+cfg} & UE\textquotesingle{}s PUCCH config. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the resource for the UE was found in the allocation records for the given slot. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00233\ \{}
\DoxyCodeLine{00234\ \ \ \textcolor{keywordflow}{return}\ release\_harq\_resource(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}},\ crnti,\ pucch\_cfg,\ pucch\_format::FORMAT\_1);}
\DoxyCodeLine{00235\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a9f4da9b7594802e4c1c66248f2bdd88a}\label{classsrsran_1_1pucch__resource__manager_a9f4da9b7594802e4c1c66248f2bdd88a} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!release\_harq\_f2\_resource@{release\_harq\_f2\_resource}}
\index{release\_harq\_f2\_resource@{release\_harq\_f2\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{release\_harq\_f2\_resource()}{release\_harq\_f2\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pucch\+\_\+resource\+\_\+manager\+::release\+\_\+harq\+\_\+f2\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Release PUCCH (format 2) resource from being allocated to a given UE. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em slot\+\_\+harq} & slot for which the PUCCH resource was scheduled. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & UE from which the resource needs to be released. \\
\hline
\mbox{\texttt{ in}}  & {\em pucch\+\_\+cfg} & UE\textquotesingle{}s PUCCH config. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the resource for the UE was found in the allocation records for the given slot. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00238\ \{}
\DoxyCodeLine{00239\ \ \ \textcolor{keywordflow}{return}\ release\_harq\_resource(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}},\ crnti,\ pucch\_cfg,\ pucch\_format::FORMAT\_2);}
\DoxyCodeLine{00240\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a15b5a050479f5e214eba5caa2592b2c3}\label{classsrsran_1_1pucch__resource__manager_a15b5a050479f5e214eba5caa2592b2c3} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!release\_sr\_resource@{release\_sr\_resource}}
\index{release\_sr\_resource@{release\_sr\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{release\_sr\_resource()}{release\_sr\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pucch\+\_\+resource\+\_\+manager\+::release\+\_\+sr\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+sr,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Release PUCCH (format 1) resource used for SR from being allocated to a given UE. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em slot\+\_\+harq} & slot for which the PUCCH resource was scheduled. \\
\hline
\mbox{\texttt{ in}}  & {\em crnti} & UE from which the resource needs to be released. \\
\hline
\mbox{\texttt{ in}}  & {\em pucch\+\_\+cfg} & UE\textquotesingle{}s PUCCH config. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the resource for the UE was found in the allocation records for the given slot. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00243\ \{}
\DoxyCodeLine{00244\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_sr}}\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ to\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00246\ \ \ srsran\_sanity\_check(pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a9cd322ac5ec3ab428121e1a82f81d0cf}{sr\_res\_list}}.size()\ ==\ 1,\ \textcolor{stringliteral}{"{}UE\ SR\ resource\ list\ must\ have\ size\ 1."{}});}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}\ =\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_sr}});}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \textcolor{comment}{//\ We\ assume\ each\ UE\ only\ has\ 1\ SR\ Resource\ Config\ configured.}}
\DoxyCodeLine{00251\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}\ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a9cd322ac5ec3ab428121e1a82f81d0cf}{sr\_res\_list}}[0].pucch\_res\_id.cell\_res\_id;}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}].rnti\ !=\ crnti)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00255\ \ \ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}].rnti\ \ \ \ \ \ \ \ \ \ \ =\ rnti\_t::INVALID\_RNTI;}
\DoxyCodeLine{00258\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}].resource\_usage\ =\ pucch\_resource\_usage::NOT\_USED;}
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00260\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_ae60b313b4eb6150af00a3302134a6567}\label{classsrsran_1_1pucch__resource__manager_ae60b313b4eb6150af00a3302134a6567} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!reserve\_common\_resource@{reserve\_common\_resource}}
\index{reserve\_common\_resource@{reserve\_common\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{reserve\_common\_resource()}{reserve\_common\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pucch\+\_\+resource\+\_\+manager\+::reserve\+\_\+common\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{sl,  }\item[{size\+\_\+t}]{r\+\_\+pucch }\end{DoxyParamCaption})}



Set the common PUCCH resource indexed by r\+\_\+pucch at the given slot as currently "{}not available"{}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00098\ \{}
\DoxyCodeLine{00099\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r\_pucch}}\ <\ 16,\ \textcolor{stringliteral}{"{}r\_PUCCH\ must\ be\ less\ than\ 16"{}});}
\DoxyCodeLine{00100\ \ \ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sl}}).used\_common\_resources[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{r\_pucch}}]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00101\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_ae44246e38b2ff1e41fa94c4546384f0c}\label{classsrsran_1_1pucch__resource__manager_ae44246e38b2ff1e41fa94c4546384f0c} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!reserve\_csi\_resource@{reserve\_csi\_resource}}
\index{reserve\_csi\_resource@{reserve\_csi\_resource}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{reserve\_csi\_resource()}{reserve\_csi\_resource()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} pucch\+\_\+resource\+\_\+manager\+::reserve\+\_\+csi\+\_\+resource (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{classsrsran_1_1ue__cell__configuration}{ue\+\_\+cell\+\_\+configuration}} \&}]{ue\+\_\+cell\+\_\+cfg }\end{DoxyParamCaption})}



Returns the specific PUCCH format 2 resource config to be used for CSI, if available. 

\begin{DoxyRemark}{Remarks}
If SR multiplexing is enabled, this resource can be used for CSI + SR. 
\end{DoxyRemark}
\begin{DoxyReturn}{Returns}
If the specific PUCCH resource is available, it returns (i) the pointer to the configuration and (ii) the PUCCH resource indicator corresponding to the PUCCH resource that will be used by the UE. Else, the pointer passed will be {\ttfamily nullptr}, whereas the PUCCH resource indicator is to be ignored. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00165\ \{}
\DoxyCodeLine{00166\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_csi}}\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ to\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ Get\ CSI\ specific\ PUCCH\ resource\ ID\ from\ the\ CSI\ meas\ config.}}
\DoxyCodeLine{00170\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx\_int}}\ =\ get\_pucch\_res\_idx\_for\_csi(ue\_cell\_cfg);}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx\_int}}\ <\ 0)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx\_int}});}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{comment}{//\ Get\ resource\ list\ of\ wanted\ slot.}}
\DoxyCodeLine{00177\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}\ =\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_csi}});}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].rnti\ !=\ rnti\_t::INVALID\_RNTI)\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00180\ \ \ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pucch\_res\_list\ =}
\DoxyCodeLine{00183\ \ \ \ \ \ \ ue\_cell\_cfg.cfg\_dedicated().\mbox{\hyperlink{structsrsran_1_1serving__cell__config_a2fe7ab17cda5bafb76bcabb1e526e556}{ul\_config}}.value().init\_ul\_bwp.pucch\_cfg.value().pucch\_res\_list;}
\DoxyCodeLine{00184\ \ \ \textcolor{comment}{//\ Search\ for\ the\ PUCCH\ resource\ with\ the\ correct\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ list.}}
\DoxyCodeLine{00185\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ =}
\DoxyCodeLine{00186\ \ \ \ \ \ \ std::find\_if(pucch\_res\_list.begin(),\ pucch\_res\_list.end(),\ [\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\_resource}}\&\ res)\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ return\ res.res\_id.cell\_res\_id\ ==\ csi\_pucch\_res\_idx;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \});}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \textcolor{comment}{//\ If\ the\ PUCCH\ res\ with\ correct\ ID\ is\ found,\ then\ allocate\ it\ to\ the\ user.}}
\DoxyCodeLine{00191\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ !=\ pucch\_res\_list.end())\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].rnti\ \ \ \ \ \ \ \ \ \ \ =\ crnti;}
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{csi\_pucch\_res\_idx}}].resource\_usage\ =\ pucch\_resource\_usage::CSI;}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordflow}{return}\ \&(*res\_cfg);}
\DoxyCodeLine{00195\ \ \ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00198\ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_acc21904f68185add3248e3b223025cda}\label{classsrsran_1_1pucch__resource__manager_acc21904f68185add3248e3b223025cda} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!reserve\_next\_f1\_harq\_res\_available@{reserve\_next\_f1\_harq\_res\_available}}
\index{reserve\_next\_f1\_harq\_res\_available@{reserve\_next\_f1\_harq\_res\_available}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{reserve\_next\_f1\_harq\_res\_available()}{reserve\_next\_f1\_harq\_res\_available()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\+\_\+harq\+\_\+resource\+\_\+alloc\+\_\+record}} pucch\+\_\+resource\+\_\+manager\+::reserve\+\_\+next\+\_\+f1\+\_\+harq\+\_\+res\+\_\+available (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Returns the next PUCCH resource available to be used for HARQ-\/\+ACK (format 1). 

\begin{DoxyReturn}{Returns}
If any PUCCH resource available, it returns (i) the pointer to the configuration and (ii) the PUCCH resource indicator corresponding to the PUCCH resource that will be used by the UE. If there are no PUCCH resources available, the pointer passed will be {\ttfamily nullptr}, whereas the PUCCH resource indicator is to be ignored. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00107\ \{}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{return}\ reserve\_next\_harq\_res\_available(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}},\ crnti,\ pucch\_cfg,\ pucch\_format::FORMAT\_1);}
\DoxyCodeLine{00109\ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_af451820441803f58f45ec6d90b265f51}\label{classsrsran_1_1pucch__resource__manager_af451820441803f58f45ec6d90b265f51} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!reserve\_next\_f2\_harq\_res\_available@{reserve\_next\_f2\_harq\_res\_available}}
\index{reserve\_next\_f2\_harq\_res\_available@{reserve\_next\_f2\_harq\_res\_available}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{reserve\_next\_f2\_harq\_res\_available()}{reserve\_next\_f2\_harq\_res\_available()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1pucch__harq__resource__alloc__record}{pucch\+\_\+harq\+\_\+resource\+\_\+alloc\+\_\+record}} pucch\+\_\+resource\+\_\+manager\+::reserve\+\_\+next\+\_\+f2\+\_\+harq\+\_\+res\+\_\+available (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Returns the next PUCCH format 2 resource available to be used for HARQ-\/\+ACK. 

\begin{DoxyRemark}{Remarks}
If SR and CSI multiplexing is enabled, this resource can be used for HARQ-\/\+ACK + SR and/or CSI. 
\end{DoxyRemark}
\begin{DoxyReturn}{Returns}
If any PUCCH resource available, it returns (i) the pointer to the configuration and (ii) the PUCCH resource indicator corresponding to the PUCCH resource that will be used by the UE. If there are no PUCCH resources available, the pointer passed will be {\ttfamily nullptr}, whereas the PUCCH resource indicator is to be ignored. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00115\ \{}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{return}\ reserve\_next\_harq\_res\_available(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}},\ crnti,\ pucch\_cfg,\ pucch\_format::FORMAT\_2);}
\DoxyCodeLine{00117\ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a516af5de56b8abb7e9a015fee28cf28a}\label{classsrsran_1_1pucch__resource__manager_a516af5de56b8abb7e9a015fee28cf28a} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!reserve\_specific\_format2\_res@{reserve\_specific\_format2\_res}}
\index{reserve\_specific\_format2\_res@{reserve\_specific\_format2\_res}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{reserve\_specific\_format2\_res()}{reserve\_specific\_format2\_res()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} pucch\+\_\+resource\+\_\+manager\+::reserve\+\_\+specific\+\_\+format2\+\_\+res (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+harq,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{res\+\_\+indicator,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Returns a specific PUCCH format 2 resource (identified by the res. indicator) to be used for HARQ-\/\+ACK. 

\begin{DoxyRemark}{Remarks}
If SR and CSI multiplexing is enabled, this resource can be used for HARQ-\/\+ACK + SR and/or CSI. 
\end{DoxyRemark}
\begin{DoxyReturn}{Returns}
If the specific PUCCH resource is available, it returns the pointer to the configuration. Else, it returns {\ttfamily nullptr}. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00123\ \{}
\DoxyCodeLine{00124\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}}\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ to\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \textcolor{comment}{//\ Get\ resource\ list\ of\ wanted\ slot.}}
\DoxyCodeLine{00128\ \ \ rnti\_pucch\_res\_id\_slot\_record\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}\ =\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_harq}});}
\DoxyCodeLine{00129\ \ \ \textcolor{comment}{//\ Retrieve\ the\ PUCCH\ resource\ set.}}
\DoxyCodeLine{00130\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq\_f2}}\ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a1e889b531c4701a39575f0525c65bbd5}{pucch\_res\_set}}[PUCCH\_HARQ\_F2\_RES\_SET\_ID].pucch\_res\_id\_list;}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ resource\ indicator\ points\ to\ a\ valid\ resource.}}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_indicator}}\ >=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq\_f2}}.size())\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00135\ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{comment}{//\ Get\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ set.}}
\DoxyCodeLine{00138\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ pucch\_res\_id\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_res\_id\_set\_for\_harq\_f2}}[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_indicator}}].cell\_res\_id;}
\DoxyCodeLine{00139\ \ \ \textcolor{comment}{//\ Get\ the\ PUCCH\ resource\ tracker\ in\ the\ PUCCH\ resource\ manager.}}
\DoxyCodeLine{00140\ \ \ \textcolor{keyword}{auto}\&\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_res\_tracker}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}.ues\_using\_pucch\_res[pucch\_res\_id];}
\DoxyCodeLine{00141\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pucch\_res\_list\ \ \ \ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a39a1ae64711a584a0d36f088bfc7b379}{pucch\_res\_list}};}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ Check\ first\ if\ the\ wanted\ PUCCH\ resource\ is\ available.}}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_res\_tracker}}.rnti\ ==\ rnti\_t::INVALID\_RNTI)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ Search\ for\ the\ PUCCH\ resource\ with\ the\ correct\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ list.}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ =}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ std::find\_if(pucch\_res\_list.begin(),\ pucch\_res\_list.end(),\ [pucch\_res\_id](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\_resource}}\&\ res)\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ return\ res.res\_id.cell\_res\_id\ ==\ pucch\_res\_id;}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ If\ the\ PUCCH\ res\ with\ correct\ ID\ is\ found,\ then\ allocate\ it\ to\ the\ user.}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ !=\ pucch\_res\_list.end())\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_res\_tracker}}.rnti\ \ \ \ \ \ \ \ \ \ \ =\ crnti;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pucch\_res\_tracker}}.resource\_usage\ =\ pucch\_resource\_usage::HARQ\_F2;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \&(*res\_cfg);}
\DoxyCodeLine{00156\ \ \ \ \ \}}
\DoxyCodeLine{00157\ \ \ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00160\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a59b1a37f315491278aa7aad2c290a8c5}\label{classsrsran_1_1pucch__resource__manager_a59b1a37f315491278aa7aad2c290a8c5} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!reserve\_sr\_res\_available@{reserve\_sr\_res\_available}}
\index{reserve\_sr\_res\_available@{reserve\_sr\_res\_available}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{reserve\_sr\_res\_available()}{reserve\_sr\_res\_available()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\+\_\+resource}} \texorpdfstring{$\ast$}{*} pucch\+\_\+resource\+\_\+manager\+::reserve\+\_\+sr\+\_\+res\+\_\+available (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+sr,  }\item[{\mbox{\hyperlink{namespacesrsran_a1d83bcd76f2b7c6251855be8472a46f5}{rnti\+\_\+t}}}]{crnti,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1pucch__config}{pucch\+\_\+config}} \&}]{pucch\+\_\+cfg }\end{DoxyParamCaption})}



Returns the specific PUCCH format 1 resource config to be used for SR, if available. 

\begin{DoxyReturn}{Returns}
If the specific PUCCH resource is available, it returns (i) the pointer to the configuration and (ii) the PUCCH resource indicator corresponding to the PUCCH resource that will be used by the UE. Else, the pointer passed will be {\ttfamily nullptr}, whereas the PUCCH resource indicator is to be ignored. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00202\ \{}
\DoxyCodeLine{00203\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_sr}}\ <\ last\_sl\_ind\ +\ RES\_MANAGER\_RING\_BUFFER\_SIZE,}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PUCCH\ being\ allocated\ to\ far\ into\ the\ future"{}});}
\DoxyCodeLine{00205\ \ \ srsran\_sanity\_check(pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a9cd322ac5ec3ab428121e1a82f81d0cf}{sr\_res\_list}}.size()\ ==\ 1,\ \textcolor{stringliteral}{"{}UE\ SR\ resource\ list\ must\ have\ size\ 1."{}});}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}\ =\ get\_slot\_resource\_counter(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_sr}});}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{comment}{//\ We\ assume\ each\ UE\ only\ has\ 1\ SR\ Resource\ Config\ configured.}}
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}\ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a9cd322ac5ec3ab428121e1a82f81d0cf}{sr\_res\_list}}[0].pucch\_res\_id.cell\_res\_id;}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}].rnti\ !=\ rnti\_t::INVALID\_RNTI)\ \{}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ pucch\_res\_list\ =\ pucch\_cfg.\mbox{\hyperlink{structsrsran_1_1pucch__config_a39a1ae64711a584a0d36f088bfc7b379}{pucch\_res\_list}};}
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ Search\ for\ the\ PUCCH\ resource\ with\ the\ correct\ PUCCH\ resource\ ID\ from\ the\ PUCCH\ resource\ list.}}
\DoxyCodeLine{00217\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ =}
\DoxyCodeLine{00218\ \ \ \ \ \ \ std::find\_if(pucch\_res\_list.begin(),\ pucch\_res\_list.end(),\ [\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}](\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1pucch__resource}{pucch\_resource}}\&\ res)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ return\ res.res\_id.cell\_res\_id\ ==\ sr\_pucch\_res\_id;}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \});}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \textcolor{comment}{//\ If\ the\ PUCCH\ res\ with\ correct\ ID\ is\ found,\ then\ allocate\ it\ to\ the\ user.}}
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_cfg}}\ !=\ pucch\_res\_list.end())\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}].rnti\ \ \ \ \ \ \ \ \ \ \ =\ crnti;}
\DoxyCodeLine{00225\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_record}}.ues\_using\_pucch\_res[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sr\_pucch\_res\_id}}].resource\_usage\ =\ pucch\_resource\_usage::SR;}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{return}\ \&(*res\_cfg);}
\DoxyCodeLine{00227\ \ \ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00230\ \};}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pucch__resource__manager_a81a16bc8a6f73d1d6877b6ef2b973e25}\label{classsrsran_1_1pucch__resource__manager_a81a16bc8a6f73d1d6877b6ef2b973e25} 
\index{srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}!slot\_indication@{slot\_indication}}
\index{slot\_indication@{slot\_indication}!srsran::pucch\_resource\_manager@{srsran::pucch\_resource\_manager}}
\doxysubsubsection{\texorpdfstring{slot\_indication()}{slot\_indication()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pucch\+\_\+resource\+\_\+manager\+::slot\+\_\+indication (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1slot__point}{slot\+\_\+point}}}]{slot\+\_\+tx }\end{DoxyParamCaption})}



Reset all resources to "{}unused"{}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00073\ \{}
\DoxyCodeLine{00074\ \ \ \textcolor{comment}{//\ If\ last\_sl\_ind\ is\ not\ valid\ (not\ initialized),\ then\ the\ check\ sl\_tx\ ==\ last\_sl\_ind\ +\ 1\ does\ not\ matter.}}
\DoxyCodeLine{00075\ \ \ srsran\_sanity\_check(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ last\_sl\_ind.\mbox{\hyperlink{classsrsran_1_1slot__point_a988d40945efc785f48725c857852c922}{valid}}()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{or}}\ slot\_tx\ ==\ last\_sl\_ind\ +\ 1,\ \textcolor{stringliteral}{"{}Detected\ a\ skipped\ slot"{}});}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{comment}{//\ Update\ Slot.}}
\DoxyCodeLine{00078\ \ \ last\_sl\_ind\ =\ slot\_tx;}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ rnti\_pucch\_res\_id\_slot\_record\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}\ =\ get\_slot\_resource\_counter(last\_sl\_ind\ -\/\ 1);}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_rec}}\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}.ues\_using\_pucch\_res)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_rec}}.rnti\ \ \ \ \ \ \ \ \ \ \ =\ rnti\_t::INVALID\_RNTI;}
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ue\_rec}}.resource\_usage\ =\ pucch\_resource\_usage::NOT\_USED;}
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ res\ :\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{res\_counter}}.used\_common\_resources)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ res\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00088\ \ \ \}}
\DoxyCodeLine{00089\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/pucch\+\_\+scheduling/pucch\+\_\+resource\+\_\+manager.\+h\item 
lib/scheduler/pucch\+\_\+scheduling/pucch\+\_\+resource\+\_\+manager.\+cpp\end{DoxyCompactItemize}
