\doxysection{srsran\+::lower\+\_\+phy\+\_\+baseband\+\_\+processor Class Reference}
\hypertarget{classsrsran_1_1lower__phy__baseband__processor}{}\label{classsrsran_1_1lower__phy__baseband__processor}\index{srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}}


Implements the lower physical layer baseband processing core.  




{\ttfamily \#include $<$lower\+\_\+phy\+\_\+baseband\+\_\+processor.\+h$>$}



Inheritance diagram for srsran\+::lower\+\_\+phy\+\_\+baseband\+\_\+processor\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{d2/d36/classsrsran_1_1lower__phy__baseband__processor__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::lower\+\_\+phy\+\_\+baseband\+\_\+processor\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{dd/d1b/classsrsran_1_1lower__phy__baseband__processor__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsrsran_1_1lower__phy__baseband__processor_1_1configuration}{configuration}}
\begin{DoxyCompactList}\small\item\em Collects the parameters necessary to initialize the baseband adaptor, as well as injected dependencies. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1lower__phy__baseband__processor_ade38332d79a8ff3c38edcea7f59c06dc}{lower\+\_\+phy\+\_\+baseband\+\_\+processor}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1lower__phy__baseband__processor_1_1configuration}{configuration}} \&config)
\begin{DoxyCompactList}\small\item\em Constructs a baseband adaptor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1lower__phy__baseband__processor_a6e333fd5ee9fd3fecb288a3987c0b49e}{start}} (\mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{init\+\_\+time}}) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Starts the lower physical layer operation. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1lower__phy__baseband__processor_a76ae5cfac50521ffe9f2a4fd266549ca}{stop}} () \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Stops the lower physical layer operation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1lower__phy__controller}{srsran\+::lower\+\_\+phy\+\_\+controller}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}lower\+\_\+phy\+\_\+controller} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implements the lower physical layer baseband processing core. 

This class interfaces and manages the baseband data flow between the baseband gateways and the processors. This class is agnostic to the sampling rate and radio frame timing. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1lower__phy__baseband__processor_ade38332d79a8ff3c38edcea7f59c06dc}\label{classsrsran_1_1lower__phy__baseband__processor_ade38332d79a8ff3c38edcea7f59c06dc} 
\index{srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}!lower\_phy\_baseband\_processor@{lower\_phy\_baseband\_processor}}
\index{lower\_phy\_baseband\_processor@{lower\_phy\_baseband\_processor}!srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}}
\doxysubsubsection{\texorpdfstring{lower\_phy\_baseband\_processor()}{lower\_phy\_baseband\_processor()}}
{\footnotesize\ttfamily lower\+\_\+phy\+\_\+baseband\+\_\+processor\+::lower\+\_\+phy\+\_\+baseband\+\_\+processor (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1lower__phy__baseband__processor_1_1configuration}{configuration}} \&}]{config }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Constructs a baseband adaptor. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00030\ \ \ srate(config.srate),}
\DoxyCodeLine{00031\ \ \ tx\_buffer\_size(config.tx\_buffer\_size),}
\DoxyCodeLine{00032\ \ \ rx\_buffer\_size(config.rx\_buffer\_size),}
\DoxyCodeLine{00033\ \ \ cpu\_throttling\_time((config.tx\_buffer\_size\ *\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(config.system\_time\_throttling\ *\ 1\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{e6}}))\ /}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.srate.to\_kHz()),}
\DoxyCodeLine{00035\ \ \ rx\_executor(*config.rx\_task\_executor),}
\DoxyCodeLine{00036\ \ \ tx\_executor(*config.tx\_task\_executor),}
\DoxyCodeLine{00037\ \ \ uplink\_executor(*config.ul\_task\_executor),}
\DoxyCodeLine{00038\ \ \ downlink\_executor(*config.dl\_task\_executor),}
\DoxyCodeLine{00039\ \ \ receiver(*config.receiver),}
\DoxyCodeLine{00040\ \ \ transmitter(*config.transmitter),}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{classsrsran_1_1uplink__processor}{uplink\_processor}}(*config.ul\_bb\_proc),}
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{classsrsran_1_1downlink__processor}{downlink\_processor}}(*config.dl\_bb\_proc),}
\DoxyCodeLine{00043\ \ \ rx\_buffers(config.nof\_rx\_buffers),}
\DoxyCodeLine{00044\ \ \ tx\_buffers(config.nof\_tx\_buffers),}
\DoxyCodeLine{00045\ \ \ tx\_time\_offset(config.tx\_time\_offset),}
\DoxyCodeLine{00046\ \ \ rx\_to\_tx\_max\_delay(config.rx\_to\_tx\_max\_delay)}
\DoxyCodeLine{00047\ \{}
\DoxyCodeLine{00048\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classsrsran_1_1interval}{interval<float>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{system\_time\_throttling\_range}}(0,\ 1);}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ srsran\_assert(tx\_buffer\_size,\ \textcolor{stringliteral}{"{}Invalid\ buffer\ size."{}});}
\DoxyCodeLine{00051\ \ \ srsran\_assert(rx\_buffer\_size,\ \textcolor{stringliteral}{"{}Invalid\ buffer\ size."{}});}
\DoxyCodeLine{00052\ \ \ srsran\_assert(config.rx\_task\_executor,\ \textcolor{stringliteral}{"{}Invalid\ receive\ task\ executor."{}});}
\DoxyCodeLine{00053\ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{system\_time\_throttling\_range}}.contains(config.system\_time\_throttling),}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}System\ time\ throttling\ (i.e.,\ \{\})\ is\ out\ of\ the\ range\ \{\}."{}},}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.system\_time\_throttling,}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{system\_time\_throttling\_range}});}
\DoxyCodeLine{00057\ \ \ srsran\_assert(config.tx\_task\_executor,\ \textcolor{stringliteral}{"{}Invalid\ transmit\ task\ executor."{}});}
\DoxyCodeLine{00058\ \ \ srsran\_assert(config.ul\_task\_executor,\ \textcolor{stringliteral}{"{}Invalid\ uplink\ task\ executor."{}});}
\DoxyCodeLine{00059\ \ \ srsran\_assert(config.dl\_task\_executor,\ \textcolor{stringliteral}{"{}Invalid\ downlink\ task\ executor."{}});}
\DoxyCodeLine{00060\ \ \ srsran\_assert(config.receiver,\ \textcolor{stringliteral}{"{}Invalid\ baseband\ receiver."{}});}
\DoxyCodeLine{00061\ \ \ srsran\_assert(config.transmitter,\ \textcolor{stringliteral}{"{}Invalid\ baseband\ transmitter."{}});}
\DoxyCodeLine{00062\ \ \ srsran\_assert(config.ul\_bb\_proc,\ \textcolor{stringliteral}{"{}Invalid\ uplink\ processor."{}});}
\DoxyCodeLine{00063\ \ \ srsran\_assert(config.dl\_bb\_proc,\ \textcolor{stringliteral}{"{}Invalid\ downlink\ processor."{}});}
\DoxyCodeLine{00064\ \ \ srsran\_assert(config.nof\_rx\_ports\ !=\ 0,\ \textcolor{stringliteral}{"{}Invalid\ number\ of\ receive\ ports."{}});}
\DoxyCodeLine{00065\ \ \ srsran\_assert(config.nof\_tx\_ports\ !=\ 0,\ \textcolor{stringliteral}{"{}Invalid\ number\ of\ transmit\ ports."{}});}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ Create\ queue\ of\ receive\ buffers.}}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{while}\ (!rx\_buffers.full())\ \{}
\DoxyCodeLine{00069\ \ \ \ \ rx\_buffers.push\_blocking(std::make\_unique<baseband\_gateway\_buffer\_dynamic>(config.nof\_rx\_ports,\ rx\_buffer\_size));}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \textcolor{comment}{//\ Create\ queue\ of\ transmit\ buffers.}}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{while}\ (!tx\_buffers.full())\ \{}
\DoxyCodeLine{00074\ \ \ \ \ tx\_buffers.push\_blocking(std::make\_unique<baseband\_gateway\_buffer\_dynamic>(config.nof\_tx\_ports,\ tx\_buffer\_size));}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1lower__phy__baseband__processor_a6e333fd5ee9fd3fecb288a3987c0b49e}\label{classsrsran_1_1lower__phy__baseband__processor_a6e333fd5ee9fd3fecb288a3987c0b49e} 
\index{srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}!start@{start}}
\index{start@{start}!srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}}
\doxysubsubsection{\texorpdfstring{start()}{start()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} lower\+\_\+phy\+\_\+baseband\+\_\+processor\+::start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a4057ba65348ba48e6202d60aea8e6235}{baseband\+\_\+gateway\+\_\+timestamp}}}]{init\+\_\+time }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Starts the lower physical layer operation. 

The fist uplink processing block is expected at {\ttfamily init\+\_\+time} and the first downlink processing block transmission will be relative to this time.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em init\+\_\+time} & Initial time in clock ticks. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1lower__phy__controller_a2da906ed015138b6437e08c8f447dbcb}{srsran\+::lower\+\_\+phy\+\_\+controller}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00079\ \{}
\DoxyCodeLine{00080\ \ \ last\_rx\_timestamp\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{init\_time}};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ rx\_state.start();}
\DoxyCodeLine{00083\ \ \ report\_fatal\_error\_if\_not(rx\_executor.\mbox{\hyperlink{classsrsran_1_1task__executor_a7ce182401ef2d2b419bfbed5b5e488f7}{execute}}([\textcolor{keyword}{this}]()\ \{\ ul\_process();\ \}),\ \textcolor{stringliteral}{"{}Failed\ to\ execute\ initial\ uplink\ task."{}});}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ tx\_state.start();}
\DoxyCodeLine{00086\ \ \ report\_fatal\_error\_if\_not(}
\DoxyCodeLine{00087\ \ \ \ \ \ \ downlink\_executor.\mbox{\hyperlink{classsrsran_1_1task__executor_a7ce182401ef2d2b419bfbed5b5e488f7}{execute}}([\textcolor{keyword}{this},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{init\_time}}]()\ \{\ dl\_process(init\_time\ +\ rx\_to\_tx\_max\_delay);\ \}),}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Failed\ to\ execute\ initial\ downlink\ task."{}});}
\DoxyCodeLine{00089\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1lower__phy__baseband__processor_a76ae5cfac50521ffe9f2a4fd266549ca}\label{classsrsran_1_1lower__phy__baseband__processor_a76ae5cfac50521ffe9f2a4fd266549ca} 
\index{srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}!stop@{stop}}
\index{stop@{stop}!srsran::lower\_phy\_baseband\_processor@{srsran::lower\_phy\_baseband\_processor}}
\doxysubsubsection{\texorpdfstring{stop()}{stop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} lower\+\_\+phy\+\_\+baseband\+\_\+processor\+::stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Stops the lower physical layer operation. 

Waits for all asynchronous processes to be over before returning. 

Implements \mbox{\hyperlink{classsrsran_1_1lower__phy__controller_afc974a45c05de4a2c24289dc53c8594b}{srsran\+::lower\+\_\+phy\+\_\+controller}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00092\ \{}
\DoxyCodeLine{00093\ \ \ rx\_state.request\_stop();}
\DoxyCodeLine{00094\ \ \ tx\_state.request\_stop();}
\DoxyCodeLine{00095\ \ \ rx\_state.wait\_stop();}
\DoxyCodeLine{00096\ \ \ tx\_state.wait\_stop();}
\DoxyCodeLine{00097\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/lower/lower\+\_\+phy\+\_\+baseband\+\_\+processor.\+h\item 
lib/phy/lower/lower\+\_\+phy\+\_\+baseband\+\_\+processor.\+cpp\end{DoxyCompactItemize}
