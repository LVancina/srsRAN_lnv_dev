\doxysection{srsran\+::ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl Class Reference}
\hypertarget{classsrsran_1_1ofdm__prach__demodulator__impl}{}\label{classsrsran_1_1ofdm__prach__demodulator__impl}\index{srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}}


Describes a generic OFDM PRACH demodulator.  




{\ttfamily \#include $<$ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl.\+h$>$}



Inheritance diagram for srsran\+::ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{d8/dcb/classsrsran_1_1ofdm__prach__demodulator__impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for srsran\+::ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{dd/dd6/classsrsran_1_1ofdm__prach__demodulator__impl__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{using}} \mbox{\hyperlink{classsrsran_1_1ofdm__prach__demodulator__impl_a20b8a2e97ffe9bf9d2b6687415dae3a2}{dft\+\_\+processors\+\_\+table}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsrsran_1_1ofdm__prach__demodulator__impl_a164863267551f78d41f633d02c382a53}{ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl}} (\mbox{\hyperlink{classsrsran_1_1sampling__rate}{sampling\+\_\+rate}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{srate\+\_\+}}, \mbox{\hyperlink{classsrsran_1_1slotted__id__table}{dft\+\_\+processors\+\_\+table}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dft\+\_\+processors\+\_\+}})
\begin{DoxyCompactList}\small\item\em Builds a PRACH OFDM demodulator. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1ofdm__prach__demodulator__impl_ad6c351530f5dc139e1f2971dbaeb9482}{demodulate}} (\mbox{\hyperlink{classsrsran_1_1prach__buffer}{prach\+\_\+buffer}} \&buffer, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}} $>$ input, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ofdm__prach__demodulator_1_1configuration}{configuration}} \&config) \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{override}}
\begin{DoxyCompactList}\small\item\em Demodulates a PRACH occasion as described in TS38.\+211 Section 5.\+3.\+2. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsrsran_1_1ofdm__prach__demodulator}{srsran\+::ofdm\+\_\+prach\+\_\+demodulator}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{virtual}} {\bfseries \texorpdfstring{$\sim$}{\string~}ofdm\+\_\+prach\+\_\+demodulator} ()=\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{default}}
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Describes a generic OFDM PRACH demodulator. 

\doxysubsection{Member Typedef Documentation}
\Hypertarget{classsrsran_1_1ofdm__prach__demodulator__impl_a20b8a2e97ffe9bf9d2b6687415dae3a2}\label{classsrsran_1_1ofdm__prach__demodulator__impl_a20b8a2e97ffe9bf9d2b6687415dae3a2} 
\index{srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}!dft\_processors\_table@{dft\_processors\_table}}
\index{dft\_processors\_table@{dft\_processors\_table}!srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}}
\doxysubsubsection{\texorpdfstring{dft\_processors\_table}{dft\_processors\_table}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{using}} \mbox{\hyperlink{classsrsran_1_1slotted__id__table}{srsran\+::ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl\+::dft\+\_\+processors\+\_\+table}}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ slotted\_id\_table<\mbox{\hyperlink{namespacesrsran_a0c776fcbbe92d002557487b5ea9c6950}{prach\_subcarrier\_spacing}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<dft\_processor>,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(prach\_subcarrier\_spacing::invalid)>}

\end{DoxyCode}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1ofdm__prach__demodulator__impl_a164863267551f78d41f633d02c382a53}\label{classsrsran_1_1ofdm__prach__demodulator__impl_a164863267551f78d41f633d02c382a53} 
\index{srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}!ofdm\_prach\_demodulator\_impl@{ofdm\_prach\_demodulator\_impl}}
\index{ofdm\_prach\_demodulator\_impl@{ofdm\_prach\_demodulator\_impl}!srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}}
\doxysubsubsection{\texorpdfstring{ofdm\_prach\_demodulator\_impl()}{ofdm\_prach\_demodulator\_impl()}}
{\footnotesize\ttfamily srsran\+::ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl\+::ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1sampling__rate}{sampling\+\_\+rate}}}]{srate\+\_\+,  }\item[{\mbox{\hyperlink{classsrsran_1_1slotted__id__table}{dft\+\_\+processors\+\_\+table}}}]{dft\+\_\+processors\+\_\+ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Builds a PRACH OFDM demodulator. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em srate\+\_\+} & Sampling rate. \\
\hline
\mbox{\texttt{ in}}  & {\em dft\+\_\+processors\+\_\+} & Table with one DFT processor for each of the possible RA subcarrier spacings. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
An assertion is triggered if {\ttfamily dft\+\_\+processors\+\_\+} do not contain a valid DFT processor for each of the possible random access subcarrier spacings. 
\end{DoxyRemark}

\begin{DoxyCode}{0}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00051\ \ \ \ \ srate(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{srate\_}}),\ dft\_processors(std::move(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dft\_processors\_}}))}
\DoxyCodeLine{00052\ \ \ \{}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{using\ }int\_type\ =\ std::underlying\_type\_t<prach\_subcarrier\_spacing>;}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordflow}{for}\ (int\_type\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_scs}}\ \ \ \ \ =\ \textcolor{keyword}{static\_cast<}int\_type\textcolor{keyword}{>}(prach\_subcarrier\_spacing::kHz15),}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_scs\_end}}\ =\ \textcolor{keyword}{static\_cast<}int\_type\textcolor{keyword}{>}(prach\_subcarrier\_spacing::invalid);}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_scs}}\ !=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_scs\_end}};}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_scs}})\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ prach\_subcarrier\_spacing\ ra\_scs\ =\ \textcolor{keyword}{static\_cast<}prach\_subcarrier\_spacing\textcolor{keyword}{>}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_scs}});}
\DoxyCodeLine{00059\ \ \ \ \ \ \ srsran\_assert(dft\_processors.contains(ra\_scs),}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Table\ does\ not\ contain\ a\ DFT\ processor\ for\ \{\}\ subcarrier\ spacing."{}},}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a5fa5b607b51bce906141a06d7ecdebbf}{to\_string}}(ra\_scs));}
\DoxyCodeLine{00062\ \ \ \ \ \ \ srsran\_assert(dft\_processors[ra\_scs],\ \textcolor{stringliteral}{"{}Invalid\ DFT\ processor\ for\ \{\}\ subcarrier\ spacing."{}},\ \mbox{\hyperlink{namespacesrsran_a5fa5b607b51bce906141a06d7ecdebbf}{to\_string}}(ra\_scs));}
\DoxyCodeLine{00063\ \ \ \ \ \ \ srsran\_assert(dft\_processors[ra\_scs]-\/>get\_direction()\ ==\ \mbox{\hyperlink{classsrsran_1_1dft__processor_ad6d2dd1eff168ecf482b422a7c363d40a4c5d06b02c97731aaa976179c62dcf76}{dft\_processor::direction::DIRECT}},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ DFT\ processor\ direction\ for\ \{\}\ subcarrier\ spacing."{}},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a5fa5b607b51bce906141a06d7ecdebbf}{to\_string}}(ra\_scs));}
\DoxyCodeLine{00066\ \ \ \ \ \ \ srsran\_assert(dft\_processors[ra\_scs]-\/>get\_size()\ ==\ srate.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a05c74a02ecc553999bf80a4819f4c7fa}{get\_dft\_size}}(\mbox{\hyperlink{namespacesrsran_a4172874a14aceea21d35086683d66f1b}{ra\_scs\_to\_Hz}}(ra\_scs)),}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ DFT\ processor\ size\ (i.e.,\ \{\})\ for\ \{\}\ subcarrier\ spacing."{}},}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dft\_processors[ra\_scs]-\/>get\_size(),}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a5fa5b607b51bce906141a06d7ecdebbf}{to\_string}}(ra\_scs));}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1ofdm__prach__demodulator__impl_ad6c351530f5dc139e1f2971dbaeb9482}\label{classsrsran_1_1ofdm__prach__demodulator__impl_ad6c351530f5dc139e1f2971dbaeb9482} 
\index{srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}!demodulate@{demodulate}}
\index{demodulate@{demodulate}!srsran::ofdm\_prach\_demodulator\_impl@{srsran::ofdm\_prach\_demodulator\_impl}}
\doxysubsubsection{\texorpdfstring{demodulate()}{demodulate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl\+::demodulate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsrsran_1_1prach__buffer}{prach\+\_\+buffer}} \&}]{buffer,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_adb0c7723c7e69c78add18ca453dd1dbc}{cf\+\_\+t}} $>$}]{input,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1ofdm__prach__demodulator_1_1configuration}{configuration}} \&}]{config }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Demodulates a PRACH occasion as described in TS38.\+211 Section 5.\+3.\+2. 

For long preambles, the input shall contain the cyclic prefix of length $N_{CP,l}^{RA}$) and a time-\/domain sequence of length $N_u$. Also, the number of time-\/domain occasions must be one.

For short preamble formats, the input shall correspond to one slot at configuration\+::pusch\+\_\+scs.

An assertion is triggered if\+:
\begin{DoxyItemize}
\item the input samples are not sufficient,
\item the buffer dimensions cannot contain the demodulated sequences, or
\item the port identifier exceeds the number of ports contained in the destination buffer.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em buffer} & Frequency-\/domain signal corresponding to one PRACH receive occasion. \\
\hline
\mbox{\texttt{ in}}  & {\em input} & PRACH receive window baseband samples. \\
\hline
\mbox{\texttt{ in}}  & {\em config} & PRACH demodulator configuration parameters. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classsrsran_1_1ofdm__prach__demodulator_a8512816c304b2e662d199b68fa9bdf73}{srsran\+::ofdm\+\_\+prach\+\_\+demodulator}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00034\ \{}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ Cyclic\ prefix\ extension\ for\ short\ preambles\ at\ 0\ and\ 0.5\ ms\ from\ the\ start\ of\ the\ subframe.}}
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit}{phy\_time\_unit}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sixteen\_kappa}}\ =\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_aec95e7a791907476aea8a4fb4c7c1f2b}{phy\_time\_unit::from\_units\_of\_kappa}}(16);}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ PUSCH\ symbol\ duration.}}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classsrsran_1_1phy__time__unit}{phy\_time\_unit}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pusch\_symbol\_duration}}\ =}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_aec95e7a791907476aea8a4fb4c7c1f2b}{phy\_time\_unit::from\_units\_of\_kappa}}((144U\ +\ 2048U)\ >>\ \mbox{\hyperlink{namespacesrsran_a226e52de355262a1ad4e998b4cedefd7}{to\_numerology\_value}}(config.pusch\_scs));}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{//\ Validate\ configuration.}}
\DoxyCodeLine{00043\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a7c2e3c58a56b57be024f8bfc3271186d}{is\_short\_preamble}}(config.format))\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_window\_length}}\ =}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_aae60fdd6dfc5e4aad04607ddbe5982b1}{get\_prach\_window\_duration}}(config.format,\ config.pusch\_scs,\ config.start\_symbol,\ config.nof\_td\_occasions)}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ .\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(srate.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a3e20d54a0ea144abe33e32ac198b44e2}{to\_Hz}}());}
\DoxyCodeLine{00047\ \ \ \ \ srsran\_assert(}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ input.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}()\ >=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_window\_length}},}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ number\ of\ input\ samples\ (i.e.,\ \{\})\ must\ be\ equal\ to\ or\ greater\ than\ the\ PRACH\ window\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ input.\mbox{\hyperlink{classsrsran_1_1span_ad0e376d95ca916144eac76f27f0654ac}{size}}(),}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_window\_length}});}
\DoxyCodeLine{00052\ \ \ \ \ srsran\_assert(config.nof\_td\_occasions\ >\ 0,\ \textcolor{stringliteral}{"{}The\ number\ of\ time-\/domain\ occasions\ must\ be\ greater\ than\ 0."{}});}
\DoxyCodeLine{00053\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00054\ \ \ \ \ srsran\_assert(config.nof\_td\_occasions\ ==\ 1,\ \textcolor{stringliteral}{"{}Long\ preambles\ only\ support\ one\ occasion."{}});}
\DoxyCodeLine{00055\ \ \ \}}
\DoxyCodeLine{00056\ \ \ srsran\_assert(config.nof\_td\_occasions\ <=\ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_aae53ad60dded01236f770064bb9e7633}{get\_max\_nof\_td\_occasions}}(),}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ number\ of\ time-\/domain\ occasions\ (i.e.,\ \{\})\ exceeds\ the\ buffer\ maximum\ number\ of\ "{}}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}time-\/domain\ occasions\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.nof\_td\_occasions,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_aae53ad60dded01236f770064bb9e7633}{get\_max\_nof\_td\_occasions}}());}
\DoxyCodeLine{00061\ \ \ srsran\_assert(config.nof\_fd\_occasions\ <=\ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a98309a9f4aaac3f325d16693ef916f33}{get\_max\_nof\_fd\_occasions}}(),}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ number\ of\ frequency-\/domain\ occasions\ (i.e.,\ \{\})\ exceeds\ the\ buffer\ maximum\ number\ of\ "{}}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}frequency-\/domain\ occasions\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.nof\_fd\_occasions,}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a98309a9f4aaac3f325d16693ef916f33}{get\_max\_nof\_fd\_occasions}}());}
\DoxyCodeLine{00066\ \ \ srsran\_assert(config.port\ <\ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a907028ab71829eacba8111ac864ed2da}{get\_max\_nof\_ports}}(),}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ port\ identifier\ (i.e.,\ \{\})\ exceeds\ the\ maximum\ number\ of\ PRACH\ buffer\ ports\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config.port,}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a907028ab71829eacba8111ac864ed2da}{get\_max\_nof\_ports}}());}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_td\_occasion}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_td\_occasion}}\ !=\ config.nof\_td\_occasions;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_td\_occasion}})\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_last\_occasion}}\ =\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_td\_occasion}}\ ==\ (config.nof\_td\_occasions\ -\/\ 1));}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ Get\ preamble\ information\ for\ the\ time\ occasion.}}
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1prach__preamble__information}{prach\_preamble\_information}}\ preamble\_info\ =}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_aaea6c484cd5f8113a5b11434d68e371b}{is\_long\_preamble}}(config.format)\ ?\ \mbox{\hyperlink{namespacesrsran_a41d072dc823c78c2627da83a877dcf5a}{get\_prach\_preamble\_long\_info}}(config.format)}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{namespacesrsran_a33cfd882b612da5eceff76a95662d0b3}{get\_prach\_preamble\_short\_info}}(config.format,}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a0d5bec5128991413e4e3a59ca6e16426}{to\_ra\_subcarrier\_spacing}}(config.pusch\_scs),}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{is\_last\_occasion}});}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pusch\_scs\_Hz}}\ =\ \mbox{\hyperlink{namespacesrsran_a8c3848f1144990e3777cdc7e1ab27cf7}{scs\_to\_khz}}(config.pusch\_scs)\ *\ 1000;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ Calculate\ time-\/domain\ occasion\ symbol\ start.}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start\_symbol}}\ =\ config.start\_symbol\ +\ \mbox{\hyperlink{namespacesrsran_a7c4ecbbc13088764ba440e5bb5f62a35}{get\_preamble\_duration}}(config.format)\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_td\_occasion}};}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{comment}{//\ Calculate\ time-\/domain\ occasion\ start\ time.}}
\DoxyCodeLine{00087\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1phy__time__unit}{phy\_time\_unit}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pusch\_symbol\_duration}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start\_symbol}};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ Add\ sixteen\ kappa\ units\ if\ the\ symbol\ doesn't\ start\ at\ the\ beginning\ of\ the\ slot.}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ >\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_a9759195d4f33e9afbf1c790ab103af94}{phy\_time\_unit::from\_seconds}}(0.0))\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sixteen\_kappa}};}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{comment}{//\ Add\ sixteen\ kappa\ units\ if\ the\ symbol\ starts\ more\ than\ 0.5\ ms\ after\ the\ beginning\ of\ the\ slot.}}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ >\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_a9759195d4f33e9afbf1c790ab103af94}{phy\_time\_unit::from\_seconds}}(0.5e-\/3))\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sixteen\_kappa}};}
\DoxyCodeLine{00097\ \ \ \ \ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{//\ Calculate\ time-\/domain\ occasion\ end\ time.}}
\DoxyCodeLine{00100\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1phy__time__unit}{phy\_time\_unit}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_end}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ +\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}\ +\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_aef1493b57fbc2fdbc433976b4bdec7f4}{symbol\_length}};}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{comment}{//\ Add\ sixteen\ kappa\ to\ the\ cyclic\ prefix\ length\ if\ ...}}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a7c2e3c58a56b57be024f8bfc3271186d}{is\_short\_preamble}}(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}}))\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ occasion\ overlaps\ with\ time\ zero.}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ <=\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_a9759195d4f33e9afbf1c790ab103af94}{phy\_time\_unit::from\_seconds}}(0.0))\ \&\&}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_end}}\ >=\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_a9759195d4f33e9afbf1c790ab103af94}{phy\_time\_unit::from\_seconds}}(0.0)))\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sixteen\_kappa}};}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ occasion\ overlaps\ with\ time\ 0.5ms\ from\ the\ beginning\ of\ the\ slot.}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}\ <=\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_a9759195d4f33e9afbf1c790ab103af94}{phy\_time\_unit::from\_seconds}}(0.5e-\/3))\ \&\&}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_end}}\ >=\ \mbox{\hyperlink{classsrsran_1_1phy__time__unit_a9759195d4f33e9afbf1c790ab103af94}{phy\_time\_unit::from\_seconds}}(0.5e-\/3)))\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}\ +=\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sixteen\_kappa}};}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ Calculate\ occasion\ duration.}}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1phy__time__unit}{phy\_time\_unit}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{occasion\_duration}}\ =\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}\ +\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_aef1493b57fbc2fdbc433976b4bdec7f4}{symbol\_length}};}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sample\_offset}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{t\_occasion\_start}}.\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(srate.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a3e20d54a0ea144abe33e32ac198b44e2}{to\_Hz}}());}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ nof\_samples\ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{occasion\_duration}}.to\_samples(srate.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a3e20d54a0ea144abe33e32ac198b44e2}{to\_Hz}}());}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//\ Select\ view\ of\ the\ input\ samples\ for\ the\ occasion.}}
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_occasion}}\ =\ input.\mbox{\hyperlink{classsrsran_1_1span_ac5f02596fcb6e8f430a3e11e47a6d7e8}{subspan}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sample\_offset}},\ nof\_samples);}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{comment}{//\ Get\ frequency\ mapping\ information,\ common\ for\ all\ frequency-\/domain\ occasions.}}
\DoxyCodeLine{00126\ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information}{prach\_frequency\_mapping\_information}}\ freq\_mapping\_info\ =}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a4ec686128158cd9524f64b7df77762bd}{prach\_frequency\_mapping\_get}}(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}},\ config.pusch\_scs);}
\DoxyCodeLine{00128\ \ \ \ \ srsran\_assert(freq\_mapping\_info.\mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information_a3b237981f4c93ec4f4521c0ba1d09f4d}{nof\_rb\_ra}}\ !=\ PRACH\_FREQUENCY\_MAPPING\_INFORMATION\_RESERVED.nof\_rb\_ra,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ PRACH\ and\ PUSCH\ subcarrier\ spacing\ combination\ resulted\ in\ a\ reserved\ configuration."{}});}
\DoxyCodeLine{00130\ \ \ \ \ srsran\_assert(freq\_mapping\_info.\mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information_ae6530746f66c58e7963de2d1bc4960b0}{k\_bar}}\ !=\ PRACH\_FREQUENCY\_MAPPING\_INFORMATION\_RESERVED.k\_bar,}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ PRACH\ and\ PUSCH\ subcarrier\ spacing\ combination\ resulted\ in\ a\ reserved\ configuration."{}});}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1dft__processor}{dft\_processor}}\&\ dft\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ *dft\_processors[preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}}];}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_scs\_Hz}}\ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a4172874a14aceea21d35086683d66f1b}{ra\_scs\_to\_Hz}}(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}});}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ofdm\_symbol\_len}}\ \ \ \ \ \ =\ dft.\mbox{\hyperlink{classsrsran_1_1dft__processor_afcb93862572be80c25306a1a627b3d07}{get\_size}}();}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cyclic\_prefix\_length}}\ =\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a3b327e535ddff17fbba0e2f9b96169d3}{cp\_length}}.\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(srate.\mbox{\hyperlink{classsrsran_1_1sampling__rate_a3e20d54a0ea144abe33e32ac198b44e2}{to\_Hz}}());}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \ \ \ \ \ \ nof\_symbols\ \ \ \ \ \ \ \ \ \ =\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_aef1493b57fbc2fdbc433976b4bdec7f4}{symbol\_length}}.\mbox{\hyperlink{classsrsran_1_1phy__time__unit_a942e82e30afbcebbc43f1943738f9d19}{to\_samples}}(\mbox{\hyperlink{namespacesrsran_a4172874a14aceea21d35086683d66f1b}{ra\_scs\_to\_Hz}}(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a1cf7f9574b0a8249a736a0b6f39b6f1e}{scs}}));}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ number\ of\ occasions\ and\ symbols\ fit\ in\ the\ buffer.}}
\DoxyCodeLine{00140\ \ \ \ \ srsran\_assert(nof\_symbols\ <=\ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a1655528e85a5647d26138a6c3d7e0539}{get\_max\_nof\_symbols}}(),}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ number\ of\ symbols\ (i.e.,\ \{\})\ must\ be\ less\ than\ or\ equal\ to\ the\ maximum\ number\ of\ symbols\ of\ the\ "{}}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}buffer\ (i.e.,\ \{\})."{}},}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nof\_symbols,}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a1655528e85a5647d26138a6c3d7e0539}{get\_max\_nof\_symbols}}());}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ Prepare\ PRACH\ resource\ grid.}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ K\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pusch\_scs\_Hz}}\ /\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_scs\_Hz}};}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}}\ =\ config.nof\_prb\_ul\_grid\ *\ K\ *\ NRE;}
\DoxyCodeLine{00149\ \ \ \ \ srsran\_assert(}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ dft.\mbox{\hyperlink{classsrsran_1_1dft__processor_afcb93862572be80c25306a1a627b3d07}{get\_size}}()\ >\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}},}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}DFT\ size\ \{\}\ for\ PRACH\ SCS\ \{\}\ is\ not\ sufficient\ for\ K=\{\},\ N\_RB=\{\}.\ The\ minimum\ expected\ DFT\ size\ is\ \{\}."{}},}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ dft.\mbox{\hyperlink{classsrsran_1_1dft__processor_afcb93862572be80c25306a1a627b3d07}{get\_size}}(),}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_scs\_Hz}},}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ K,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ config.nof\_prb\_ul\_grid,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}});}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//\ Process\ each\ PRACH\ symbol.}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}}\ !=\ nof\_symbols;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}})\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ symbol\ time-\/domain\ in\ the\ DFT.}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ srsvec::copy(dft.\mbox{\hyperlink{classsrsran_1_1dft__processor_aa07d386497c47ca798864f6300937cab}{get\_input}}(),}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{input\_occasion}}.\mbox{\hyperlink{classsrsran_1_1span_ac5f02596fcb6e8f430a3e11e47a6d7e8}{subspan}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{cyclic\_prefix\_length}}\ +\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ofdm\_symbol\_len}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ofdm\_symbol\_len}}));}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \ \ \textcolor{comment}{//\ Perform\ DFT.}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dft\_output}}\ =\ dft.\mbox{\hyperlink{classsrsran_1_1dft__processor_a628d1ee463ea4107a2809eeb6cdac552}{run}}();}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ frequency-\/domain\ occasion.}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_fd\_occasion}}\ =\ 0;\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_fd\_occasion}}\ !=\ config.nof\_fd\_occasions;\ ++\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_fd\_occasion}})\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ initial\ subcarrier.}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}}\ =}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ K\ *\ NRE\ *\ (config.rb\_offset\ +\ freq\_mapping\_info.\mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information_a3b237981f4c93ec4f4521c0ba1d09f4d}{nof\_rb\_ra}}\ *\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_fd\_occasion}})\ +\ freq\_mapping\_info.\mbox{\hyperlink{structsrsran_1_1prach__frequency__mapping__information_ae6530746f66c58e7963de2d1bc4960b0}{k\_bar}};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ srsran\_assert(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}}\ +\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a6a616871a84db7e2b294d8d43da76f02}{sequence\_length}}\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}},}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Start\ subcarrier\ \{\}\ plus\ sequence\ length\ \{\}\ exceeds\ PRACH\ grid\ size\ \{\}."{}},}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}},}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a6a616871a84db7e2b294d8d43da76f02}{sequence\_length}},}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}});}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Select\ destination\ PRACH\ symbol\ in\ the\ buffer.}}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_symbol}}\ =\ buffer.\mbox{\hyperlink{classsrsran_1_1prach__buffer_a9393f0ec690ad95fab986ae6d5d93fa3}{get\_symbol}}(config.port,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_td\_occasion}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_fd\_occasion}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{i\_symbol}});}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ views\ of\ the\ lower\ and\ upper\ grid.}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\_grid}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dft\_output}}.\mbox{\hyperlink{classsrsran_1_1span_afa8aa6b2df95cc96ece6e86cf47068e2}{last}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}}\ /\ 2);}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1span}{span<const\ cf\_t>}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\_grid}}\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{dft\_output}}.\mbox{\hyperlink{classsrsran_1_1span_aa4238c2e04ac8c60726db8cc0b687582}{first}}(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}}\ /\ 2);}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ sequence\ map\ starts\ at\ the\ lower\ half\ of\ the\ frequency\ band.}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}}\ <\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}}\ /\ 2)\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Number\ of\ subcarrier\ to\ fill\ in\ the\ lower\ half\ of\ the\ grid.}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ N\ =\ std::min(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}}\ /\ 2\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}},\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a6a616871a84db7e2b294d8d43da76f02}{sequence\_length}});}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ first\ N\ subcarriers\ of\ the\ sequence\ in\ the\ lower\ half\ grid.}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ srsvec::copy(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_symbol}}.first(N),\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{lower\_grid}}.subspan(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}},\ N));}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ the\ remainder\ of\ the\ sequence\ in\ the\ upper\ half\ grid.}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ srsvec::copy(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_symbol}}.last(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a6a616871a84db7e2b294d8d43da76f02}{sequence\_length}}\ -\/\ N),}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\_grid}}.first(preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a6a616871a84db7e2b294d8d43da76f02}{sequence\_length}}\ -\/\ N));}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ the\ sequence\ in\ the\ upper\ half\ grid.}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ srsvec::copy(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_symbol}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{upper\_grid}}.subspan(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_start}}\ -\/\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{prach\_grid\_size}}\ /\ 2,\ preamble\_info.\mbox{\hyperlink{structsrsran_1_1prach__preamble__information_a6a616871a84db7e2b294d8d43da76f02}{sequence\_length}}));}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00201\ \ \ \ \ \}}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/phy/lower/modulation/ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl.\+h\item 
lib/phy/lower/modulation/ofdm\+\_\+prach\+\_\+demodulator\+\_\+impl.\+cpp\end{DoxyCompactItemize}
