\doxysection{srsran\+::security\+::security\+\_\+context Struct Reference}
\hypertarget{structsrsran_1_1security_1_1security__context}{}\label{structsrsran_1_1security_1_1security__context}\index{srsran::security::security\_context@{srsran::security::security\_context}}


Collaboration diagram for srsran\+::security\+::security\+\_\+context\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{de/dfe/structsrsran_1_1security_1_1security__context__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structsrsran_1_1security_1_1security__context_a354f7c24ff486b0578d418bfe22d28ef}{security\+\_\+context}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context}{security\+\_\+context}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\+\_\+ctxt}})
\item 
\mbox{\hyperlink{structsrsran_1_1security_1_1security__context}{security\+\_\+context}} \& \mbox{\hyperlink{structsrsran_1_1security_1_1security__context_af4e38ab4fc5de569f7f48f5688d40e69}{operator=}} (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context}{security\+\_\+context}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\+\_\+ctxt}})
\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context_a2dda30facaa33bd7ddeb6862d618643b}{select\+\_\+algorithms}} (preferred\+\_\+integrity\+\_\+algorithms \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pref\+\_\+inte\+\_\+list}}, preferred\+\_\+ciphering\+\_\+algorithms \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pref\+\_\+ciph\+\_\+list}})
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context_a22b6103239ad3c67d2a422b1071b15e1}{generate\+\_\+as\+\_\+keys}} ()
\item 
\mbox{\hyperlink{structsrsran_1_1security_1_1sec__as__config}{sec\+\_\+as\+\_\+config}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context_a177ece7780c46d7b1fe7c5886e2cea1a}{get\+\_\+as\+\_\+config}} (sec\+\_\+domain domain)
\item 
\mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{sec\+\_\+128\+\_\+as\+\_\+config}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context_a7f668f611fe4ddcd48ca8698de946ebf}{get\+\_\+128\+\_\+as\+\_\+config}} (sec\+\_\+domain domain)
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context_abce1070c0ec21eb0e79d848abc000588}{horizontal\+\_\+key\+\_\+derivation}} (\mbox{\hyperlink{namespacesrsran_ae2a7787d776e7d6ee8959beb6b368286}{pci\+\_\+t}} target\+\_\+pci, \mbox{\hyperlink{classunsigned}{unsigned}} \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\+\_\+ssb\+\_\+arfcn}})
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{structsrsran_1_1security_1_1security__context_a3322775085bc53b940ebe1038108d2d9}\label{structsrsran_1_1security_1_1security__context_a3322775085bc53b940ebe1038108d2d9} 
\mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog\+::basic\+\_\+logger}} \& {\bfseries logger} = srslog\+::fetch\+\_\+basic\+\_\+logger("{}SEC"{})
\item 
\Hypertarget{structsrsran_1_1security_1_1security__context_ad8aa9a91add88894be2a46528586290a}\label{structsrsran_1_1security_1_1security__context_ad8aa9a91add88894be2a46528586290a} 
security\+::sec\+\_\+key {\bfseries k}
\item 
\Hypertarget{structsrsran_1_1security_1_1security__context_a54ba56d51a6583cce119967ccfd3de3e}\label{structsrsran_1_1security_1_1security__context_a54ba56d51a6583cce119967ccfd3de3e} 
security\+::supported\+\_\+algorithms {\bfseries supported\+\_\+int\+\_\+algos}
\item 
\Hypertarget{structsrsran_1_1security_1_1security__context_ac667c44c6594ecc0e422e6fa2d3fefe9}\label{structsrsran_1_1security_1_1security__context_ac667c44c6594ecc0e422e6fa2d3fefe9} 
security\+::supported\+\_\+algorithms {\bfseries supported\+\_\+enc\+\_\+algos}
\item 
\Hypertarget{structsrsran_1_1security_1_1security__context_aa36c15caf3c5f5f53b596e0f8e20cac3}\label{structsrsran_1_1security_1_1security__context_aa36c15caf3c5f5f53b596e0f8e20cac3} 
\mbox{\hyperlink{structsrsran_1_1security_1_1sec__selected__algos}{sec\+\_\+selected\+\_\+algos}} {\bfseries sel\+\_\+algos}
\item 
\Hypertarget{structsrsran_1_1security_1_1security__context_a72f4f46cdc91f3b7bfaa923c50b20ed7}\label{structsrsran_1_1security_1_1security__context_a72f4f46cdc91f3b7bfaa923c50b20ed7} 
\mbox{\hyperlink{structsrsran_1_1security_1_1sec__as__keys}{sec\+\_\+as\+\_\+keys}} {\bfseries as\+\_\+keys}
\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{structsrsran_1_1security_1_1security__context_a354f7c24ff486b0578d418bfe22d28ef}\label{structsrsran_1_1security_1_1security__context_a354f7c24ff486b0578d418bfe22d28ef} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!security\_context@{security\_context}}
\index{security\_context@{security\_context}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{security\_context()}{security\_context()}}
{\footnotesize\ttfamily srsran\+::security\+::security\+\_\+context\+::security\+\_\+context (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context}{security\+\_\+context}} \&}]{sec\+\_\+ctxt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00200\ \ \ \ \ k(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.k),}
\DoxyCodeLine{00201\ \ \ \ \ supported\_int\_algos(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.supported\_int\_algos),}
\DoxyCodeLine{00202\ \ \ \ \ supported\_enc\_algos(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.supported\_enc\_algos),}
\DoxyCodeLine{00203\ \ \ \ \ sel\_algos(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.sel\_algos),}
\DoxyCodeLine{00204\ \ \ \ \ as\_keys(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.as\_keys)}
\DoxyCodeLine{00205\ \ \ \{}
\DoxyCodeLine{00206\ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{structsrsran_1_1security_1_1security__context_a22b6103239ad3c67d2a422b1071b15e1}\label{structsrsran_1_1security_1_1security__context_a22b6103239ad3c67d2a422b1071b15e1} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!generate\_as\_keys@{generate\_as\_keys}}
\index{generate\_as\_keys@{generate\_as\_keys}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{generate\_as\_keys()}{generate\_as\_keys()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} security\+\_\+context\+::generate\+\_\+as\+\_\+keys (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00079\ \{}
\DoxyCodeLine{00080\ \ \ srsran\_sanity\_check(sel\_algos.algos\_selected,\ \textcolor{stringliteral}{"{}Tried\ to\ generate\ AS\ keys,\ but\ no\ algo\ is\ selected"{}});}
\DoxyCodeLine{00081\ \ \ \textcolor{comment}{//\ Generate\ K\_rrc\_enc\ and\ K\_rrc\_int}}
\DoxyCodeLine{00082\ \ \ security::generate\_k\_rrc(as\_keys.k\_rrc\_enc,\ as\_keys.k\_rrc\_int,\ k,\ sel\_algos.cipher\_algo,\ sel\_algos.integ\_algo);}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ Generate\ K\_up\_enc\ and\ K\_up\_int}}
\DoxyCodeLine{00085\ \ \ security::generate\_k\_up(as\_keys.k\_up\_enc,\ as\_keys.k\_up\_int,\ k,\ sel\_algos.cipher\_algo,\ sel\_algos.integ\_algo);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ logger.debug(k.data(),\ k.size(),\ \textcolor{stringliteral}{"{}K\_gNB"{}});}
\DoxyCodeLine{00088\ \ \ logger.debug(as\_keys.k\_rrc\_int.data(),\ as\_keys.k\_rrc\_int.size(),\ \textcolor{stringliteral}{"{}RRC\ Integrity\ Key"{}});}
\DoxyCodeLine{00089\ \ \ logger.debug(as\_keys.k\_rrc\_enc.data(),\ as\_keys.k\_rrc\_enc.size(),\ \textcolor{stringliteral}{"{}RRC\ Encryption\ Key"{}});}
\DoxyCodeLine{00090\ \ \ logger.debug(as\_keys.k\_up\_int.data(),\ as\_keys.k\_up\_int.size(),\ \textcolor{stringliteral}{"{}UP\ Integrity\ Key"{}});}
\DoxyCodeLine{00091\ \ \ logger.debug(as\_keys.k\_up\_enc.data(),\ as\_keys.k\_up\_enc.size(),\ \textcolor{stringliteral}{"{}UP\ Encryption\ Key"{}});}
\DoxyCodeLine{00092\ \}}

\end{DoxyCode}
\Hypertarget{structsrsran_1_1security_1_1security__context_a7f668f611fe4ddcd48ca8698de946ebf}\label{structsrsran_1_1security_1_1security__context_a7f668f611fe4ddcd48ca8698de946ebf} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!get\_128\_as\_config@{get\_128\_as\_config}}
\index{get\_128\_as\_config@{get\_128\_as\_config}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{get\_128\_as\_config()}{get\_128\_as\_config()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1security_1_1sec__128__as__config}{sec\+\_\+128\+\_\+as\+\_\+config}} security\+\_\+context\+::get\+\_\+128\+\_\+as\+\_\+config (\begin{DoxyParamCaption}\item[{sec\+\_\+domain}]{domain }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00110\ \{}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{return}\ truncate\_config(get\_as\_config(domain));}
\DoxyCodeLine{00112\ \}}

\end{DoxyCode}
\Hypertarget{structsrsran_1_1security_1_1security__context_a177ece7780c46d7b1fe7c5886e2cea1a}\label{structsrsran_1_1security_1_1security__context_a177ece7780c46d7b1fe7c5886e2cea1a} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!get\_as\_config@{get\_as\_config}}
\index{get\_as\_config@{get\_as\_config}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{get\_as\_config()}{get\_as\_config()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1security_1_1sec__as__config}{sec\+\_\+as\+\_\+config}} security\+\_\+context\+::get\+\_\+as\+\_\+config (\begin{DoxyParamCaption}\item[{sec\+\_\+domain}]{domain }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00115\ \{}
\DoxyCodeLine{00116\ \ \ srsran\_sanity\_check(sel\_algos.algos\_selected,\ \textcolor{stringliteral}{"{}Tried\ to\ get\ AS\ config,\ but\ no\ algorithms\ are\ selected"{}});}
\DoxyCodeLine{00117\ \ \ \mbox{\hyperlink{structsrsran_1_1security_1_1sec__as__config}{sec\_as\_config}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}};}
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.domain\ =\ domain;}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordflow}{switch}\ (domain)\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordflow}{case}\ sec\_domain::rrc:}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.k\_int\ =\ as\_keys.k\_rrc\_int;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.k\_enc\ =\ as\_keys.k\_rrc\_enc;}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{case}\ sec\_domain::up:}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.k\_int\ =\ as\_keys.k\_up\_int;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.k\_enc\ =\ as\_keys.k\_up\_enc;}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00129\ \ \ \ \ \ \ srsran\_assertion\_failure(\textcolor{stringliteral}{"{}Unsupported\ sec\_domain=\{\}"{}},\ domain);}
\DoxyCodeLine{00130\ \ \ \}}
\DoxyCodeLine{00131\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.integ\_algo\ \ =\ sel\_algos.integ\_algo;}
\DoxyCodeLine{00132\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}}.cipher\_algo\ =\ sel\_algos.cipher\_algo;}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{as\_cfg}};}
\DoxyCodeLine{00134\ \}}

\end{DoxyCode}
\Hypertarget{structsrsran_1_1security_1_1security__context_abce1070c0ec21eb0e79d848abc000588}\label{structsrsran_1_1security_1_1security__context_abce1070c0ec21eb0e79d848abc000588} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!horizontal\_key\_derivation@{horizontal\_key\_derivation}}
\index{horizontal\_key\_derivation@{horizontal\_key\_derivation}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{horizontal\_key\_derivation()}{horizontal\_key\_derivation()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} security\+\_\+context\+::horizontal\+\_\+key\+\_\+derivation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_ae2a7787d776e7d6ee8959beb6b368286}{pci\+\_\+t}}}]{target\+\_\+pci,  }\item[{\mbox{\hyperlink{classunsigned}{unsigned}}}]{target\+\_\+ssb\+\_\+arfcn }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00095\ \{}
\DoxyCodeLine{00096\ \ \ logger.info(\textcolor{stringliteral}{"{}Regenerating\ KgNB\ with\ PCI=\{\},\ SSB-\/ARFCN=\{\}"{}},\ target\_pci,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_ssb\_arfcn}});}
\DoxyCodeLine{00097\ \ \ logger.info(k.data(),\ k.size(),\ \textcolor{stringliteral}{"{}Old\ K\_gNB\ (k\_gnb)"{}});}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \textcolor{comment}{//\ Generate\ K\_NG-\/RAN*}}
\DoxyCodeLine{00100\ \ \ sec\_key\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_ng\_ran\_star}};}
\DoxyCodeLine{00101\ \ \ generate\_k\_ng\_ran\_star(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_ng\_ran\_star}},\ k,\ target\_pci,\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{target\_ssb\_arfcn}});}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \textcolor{comment}{//\ K\_NG-\/RAN*\ becomes\ K\_gNB}}
\DoxyCodeLine{00104\ \ \ k\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{k\_ng\_ran\_star}};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ generate\_as\_keys();}
\DoxyCodeLine{00107\ \}}

\end{DoxyCode}
\Hypertarget{structsrsran_1_1security_1_1security__context_af4e38ab4fc5de569f7f48f5688d40e69}\label{structsrsran_1_1security_1_1security__context_af4e38ab4fc5de569f7f48f5688d40e69} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!operator=@{operator=}}
\index{operator=@{operator=}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsrsran_1_1security_1_1security__context}{security\+\_\+context}} \& srsran\+::security\+::security\+\_\+context\+::operator= (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1security_1_1security__context}{security\+\_\+context}} \&}]{sec\+\_\+ctxt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyCode}{0}
\DoxyCodeLine{00208\ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{this}\ ==\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}})\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ k\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.k;}
\DoxyCodeLine{00213\ \ \ \ \ supported\_int\_algos\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.supported\_int\_algos;}
\DoxyCodeLine{00214\ \ \ \ \ supported\_enc\_algos\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.supported\_enc\_algos;}
\DoxyCodeLine{00215\ \ \ \ \ sel\_algos\ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.sel\_algos;}
\DoxyCodeLine{00216\ \ \ \ \ as\_keys\ \ \ \ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{sec\_ctxt}}.as\_keys;}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00218\ \ \ \}}

\end{DoxyCode}
\Hypertarget{structsrsran_1_1security_1_1security__context_a2dda30facaa33bd7ddeb6862d618643b}\label{structsrsran_1_1security_1_1security__context_a2dda30facaa33bd7ddeb6862d618643b} 
\index{srsran::security::security\_context@{srsran::security::security\_context}!select\_algorithms@{select\_algorithms}}
\index{select\_algorithms@{select\_algorithms}!srsran::security::security\_context@{srsran::security::security\_context}}
\doxysubsubsection{\texorpdfstring{select\_algorithms()}{select\_algorithms()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} security\+\_\+context\+::select\+\_\+algorithms (\begin{DoxyParamCaption}\item[{preferred\+\_\+integrity\+\_\+algorithms}]{pref\+\_\+inte\+\_\+list,  }\item[{preferred\+\_\+ciphering\+\_\+algorithms}]{pref\+\_\+ciph\+\_\+list }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00034\ \{}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ Select\ preferred\ integrity\ algorithm.}}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{inte\_algo\_found}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ nof\_pref\_algos;\ ++i)\ \{}
\DoxyCodeLine{00038\ \ \ \ \ uint16\_t\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}}\ =\ to\_number(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pref\_inte\_list}}[i]);}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}}\ ==\ 0)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ allow\ NIA0}}
\DoxyCodeLine{00041\ \ \ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}NIA0\ selection\ not\ allowed"{}});}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordflow}{if}\ (supported\_int\_algos[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}}\ -\/\ 1])\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{inte\_algo\_found}}\ \ \ \ \ \ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00046\ \ \ \ \ \ \ sel\_algos.integ\_algo\ =\ security::integrity\_algorithm\_from\_number(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}});}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00048\ \ \ \ \ \}}
\DoxyCodeLine{00049\ \ \ \}}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{inte\_algo\_found}})\ \{}
\DoxyCodeLine{00051\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Could\ not\ select\ integrity\ protection\ algorithm"{}});}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00053\ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ Select\ preferred\ ciphering\ algorithm.}}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ciph\_algo\_found}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ <\ nof\_pref\_algos;\ ++i)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ uint16\_t\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}}\ =\ to\_number(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{pref\_ciph\_list}}[i]);}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}}\ ==\ 0)\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ciph\_algo\_found}}\ \ \ \ \ \ \ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00061\ \ \ \ \ \ \ sel\_algos.cipher\_algo\ =\ security::ciphering\_algorithm::nea0;}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{if}\ (supported\_enc\_algos[\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}}\ -\/\ 1])\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ciph\_algo\_found}}\ \ \ \ \ \ \ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00066\ \ \ \ \ \ \ sel\_algos.cipher\_algo\ =\ security::ciphering\_algorithm\_from\_number(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{algo\_id}});}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00068\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \}}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ciph\_algo\_found}})\ \{}
\DoxyCodeLine{00071\ \ \ \ \ logger.error(\textcolor{stringliteral}{"{}Could\ not\ select\ ciphering\ algorithm"{}});}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ \ \ sel\_algos.algos\_selected\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00076\ \}}

\end{DoxyCode}


The documentation for this struct was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/srsran/security/security.\+h\item 
lib/security/security.\+cpp\end{DoxyCompactItemize}
