\doxysection{gtpu\+\_\+pdu.\+h}
\hypertarget{gtpu__pdu_8h_source}{}\label{gtpu__pdu_8h_source}\index{lib/gtpu/gtpu\_pdu.h@{lib/gtpu/gtpu\_pdu.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ 2021-\/2024\ Software\ Radio\ Systems\ Limited}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ This\ file\ is\ part\ of\ srsRAN.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ srsRAN\ is\ free\ software:\ you\ can\ redistribute\ it\ and/or\ modify}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ it\ under\ the\ terms\ of\ the\ GNU\ Affero\ General\ Public\ License\ as}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ published\ by\ the\ Free\ Software\ Foundation,\ either\ version\ 3\ of}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ the\ License,\ or\ (at\ your\ option)\ any\ later\ version.}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ srsRAN\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ GNU\ Affero\ General\ Public\ License\ for\ more\ details.}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ A\ copy\ of\ the\ GNU\ Affero\ General\ Public\ License\ can\ be\ found\ in}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ the\ LICENSE\ file\ in\ the\ top-\/level\ directory\ of\ this\ distribution}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ and\ at\ http://www.gnu.org/licenses/.}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}gtpu\_tunnel\_logger.h"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}srsran/adt/byte\_buffer.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}srsran/adt/optional.h"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}srsran/adt/static\_vector.h"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}fmt/format.h"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesrsran}{srsran}}\ \{}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{/****************************************************************************}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ *\ GTPU\ Header}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ *\ Ref:\ 3GPP\ TS\ 29.281\ v10.1.0\ Section\ 5}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ |\ 8\ |\ 7\ |\ 6\ |\ 5\ |\ 4\ |\ 3\ |\ 2\ |\ 1\ |}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ *\ 1\ \ \ \ \ \ |\ \ Version\ \ |PT\ |\ *\ |\ E\ |\ S\ |PN\ |}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ *\ 2\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ Message\ Type\ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ *\ 3\ \ \ \ \ \ |\ \ \ \ \ Length\ (1st\ Octet)\ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ *\ 4\ \ \ \ \ \ |\ \ \ \ \ Length\ (2nd\ Octet)\ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ *\ 5\ \ \ \ \ \ |\ \ \ \ \ \ TEID\ (1st\ Octet)\ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ *\ 6\ \ \ \ \ \ |\ \ \ \ \ \ TEID\ (2nd\ Octet)\ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ *\ 7\ \ \ \ \ \ |\ \ \ \ \ \ TEID\ (3rd\ Octet)\ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ *\ 8\ \ \ \ \ \ |\ \ \ \ \ \ TEID\ (4th\ Octet)\ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ *\ 9\ \ \ \ \ \ |\ \ \ \ Seq\ Number\ (1st\ Octet)\ \ \ \ \ |}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ *\ 10\ \ \ \ \ |\ \ \ \ Seq\ Number\ (2st\ Octet)\ \ \ \ \ |}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ *\ 11\ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ N-\/PDU\ \ \ \ \ \ \ \ \ \ \ \ \ \ |}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ *\ 12\ \ \ \ \ |\ \ Next\ Extension\ Header\ Type\ \ \ |}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ ***************************************************************************/}}
\DoxyCodeLine{00052\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_BASE\_HEADER\_LEN\ \ \ \ \ \ \ \ \ \ =\ 8;}
\DoxyCodeLine{00053\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_EXTENDED\_HEADER\_LEN\ \ \ \ \ \ =\ 12;}
\DoxyCodeLine{00054\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_NON\_MANDATORY\_HEADER\_LEN\ =\ 4;}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_FLAGS\_VERSION\_MASK\ \ \ \ \ \ \ =\ 0xe0;}
\DoxyCodeLine{00057\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_FLAGS\_VERSION\_V1\ \ \ \ \ \ \ \ \ =\ 0x01;}
\DoxyCodeLine{00058\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_FLAGS\_GTP\_PRIME\_PROTOCOL\ =\ 0x00;}
\DoxyCodeLine{00059\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_FLAGS\_GTP\_PROTOCOL\ \ \ \ \ \ \ =\ 0x01;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MSG\_ECHO\_REQUEST\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 1;}
\DoxyCodeLine{00062\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MSG\_ECHO\_RESPONSE\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 2;}
\DoxyCodeLine{00063\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MSG\_ERROR\_INDICATION\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 26;}
\DoxyCodeLine{00064\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MSG\_SUPPORTED\_EXTENSION\_HEADERS\_NOTIFICATION\ =\ 31;}
\DoxyCodeLine{00065\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MSG\_END\_MARKER\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 254;}
\DoxyCodeLine{00066\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MSG\_DATA\_PDU\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 255;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MAX\_NUM\_HEADER\_EXTENSIONS\ =\ 10;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_MAX\_NUM\_PRIVATE\_EXTENSIONS\ \ \ \ \ =\ 1;}
\DoxyCodeLine{00071\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ GTPU\_PRIVATE\_EXTENSION\_VALUE\_LENGTH\ =\ 1;}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{comment}{//\ GTP-\/U\ extension\ header\ types.\ See\ TS\ 29.281\ v16.2.0,\ figure\ 5.2.1-\/3}}
\DoxyCodeLine{00074\ \textcolor{keyword}{enum\ class}\ gtpu\_extension\_header\_type\ :\ uint8\_t\ \{}
\DoxyCodeLine{00075\ \ \ no\_more\_extension\_headers\ =\ 0b00000000,}
\DoxyCodeLine{00076\ \ \ reserved\_0\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0b00000001,}
\DoxyCodeLine{00077\ \ \ reserved\_1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0b00000010,}
\DoxyCodeLine{00078\ \ \ long\_pdcp\_pdu\_number\_0\ \ \ \ =\ 0b00000011,}
\DoxyCodeLine{00079\ \ \ service\_class\_indicator\ \ \ =\ 0b00100000,}
\DoxyCodeLine{00080\ \ \ udp\_port\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0b01000000,}
\DoxyCodeLine{00081\ \ \ ran\_container\ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0b10000001,}
\DoxyCodeLine{00082\ \ \ long\_pdcp\_pdu\_number\_1\ \ \ \ =\ 0b10000010,}
\DoxyCodeLine{00083\ \ \ xw\_ran\_container\ \ \ \ \ \ \ \ \ \ =\ 0b10000011,}
\DoxyCodeLine{00084\ \ \ nr\_ran\_container\ \ \ \ \ \ \ \ \ \ =\ 0b10000100,}
\DoxyCodeLine{00085\ \ \ pdu\_session\_container\ \ \ \ \ =\ 0b10000101,}
\DoxyCodeLine{00086\ \ \ pdcp\_pdu\_number\ \ \ \ \ \ \ \ \ \ \ =\ 0b11000000,}
\DoxyCodeLine{00087\ \ \ reserved\_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0b11000001,}
\DoxyCodeLine{00088\ \ \ reserved\_3\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0b11000010}
\DoxyCodeLine{00089\ \};}
\DoxyCodeLine{00090\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ to\_string(gtpu\_extension\_header\_type\ type)}
\DoxyCodeLine{00091\ \{}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::no\_more\_extension\_headers:}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}no\ more\ extension\ headers"{}};}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::service\_class\_indicator:}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}service\ class\ indicator"{}};}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::udp\_port:}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}UDP\ port"{}};}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::ran\_container:}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}RAN\ container"{}};}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::long\_pdcp\_pdu\_number\_0:}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::long\_pdcp\_pdu\_number\_1:}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}long\ PDCP\ PDU\ number"{}};}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::xw\_ran\_container:}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}XW\ RAN\ container"{}};}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::nr\_ran\_container:}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}NR\ RAN\ container"{}};}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::pdu\_session\_container:}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}PDU\ session\ container"{}};}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::pdcp\_pdu\_number:}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}PDCP\ PDU\ number"{}};}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::reserved\_0:}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::reserved\_1:}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::reserved\_2:}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_extension\_header\_type::reserved\_3:}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}reserved"{}};}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}invalid"{}};}
\DoxyCodeLine{00119\ \ \ \}}
\DoxyCodeLine{00120\ \};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \textcolor{comment}{//\ 00\ Comprehension\ of\ this\ extension\ header\ is\ not\ required.\ An\ Intermediate\ Node\ shall\ forward\ it\ to\ any\ Receiver}}
\DoxyCodeLine{00123\ \textcolor{comment}{//\ Endpoint}}
\DoxyCodeLine{00124\ \textcolor{comment}{//\ 01\ Comprehension\ of\ this\ extension\ header\ is\ not\ required.\ An\ Intermediate\ Node\ shall\ discard\ the}}
\DoxyCodeLine{00125\ \textcolor{comment}{//\ Extension\ Header\ Content\ and\ not\ forward\ it\ to\ any\ Receiver\ Endpoint.\ Other\ extension\ headers\ shall\ be\ treated}}
\DoxyCodeLine{00126\ \textcolor{comment}{//\ independently\ of\ this\ extension\ header.}}
\DoxyCodeLine{00127\ \textcolor{comment}{//\ 10\ Comprehension\ of\ this\ extension\ header\ is\ required\ by\ the\ Endpoint}}
\DoxyCodeLine{00128\ \textcolor{comment}{//\ Receiver\ but\ not\ by\ an\ Intermediate\ Node.\ An\ Intermediate\ Node\ shall\ forward\ the\ whole\ field\ to\ the\ Endpoint}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\ Receiver.}}
\DoxyCodeLine{00130\ \textcolor{comment}{//\ 11\ Comprehension\ of\ this\ header\ type\ is\ required\ by\ recipient\ (either\ Endpoint\ Receiver\ or\ Intermediate\ Node)}}
\DoxyCodeLine{00131\ \textcolor{keyword}{enum\ class}\ gtpu\_comprehension\ :\ uint8\_t\ \{}
\DoxyCodeLine{00132\ \ \ not\_required\_intermediate\_node\_forward\ \ \ \ \ =\ 0b00000000,}
\DoxyCodeLine{00133\ \ \ not\_required\_intermediate\_node\_discard\ \ \ \ \ =\ 0b00000001,}
\DoxyCodeLine{00134\ \ \ required\_at\_endpoint\_not\_intermediate\_node\ =\ 0b00000010,}
\DoxyCodeLine{00135\ \ \ required\_at\_endpoint\_and\_intermediate\_node\ =\ 0b00000011}
\DoxyCodeLine{00136\ \};}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{comment}{//\ GTP-\/U\ information\ element\ types\ types.\ See\ TS\ 29.281\ Sec.\ 8.1}}
\DoxyCodeLine{00139\ \textcolor{keyword}{enum\ class}\ gtpu\_information\_element\_type\ :\ uint8\_t\ \{}
\DoxyCodeLine{00140\ \ \ recovery\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 14,}
\DoxyCodeLine{00141\ \ \ tunnel\_endpoint\_identifier\_data\_i\ =\ 16,}
\DoxyCodeLine{00142\ \ \ gsn\_address\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 133,}
\DoxyCodeLine{00143\ \ \ extension\_header\_type\_list\ \ \ \ \ \ \ \ =\ 141,}
\DoxyCodeLine{00144\ \ \ private\_extension\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 255}
\DoxyCodeLine{00145\ \};}
\DoxyCodeLine{00146\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ to\_string(gtpu\_information\_element\_type\ type)}
\DoxyCodeLine{00147\ \{}
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_information\_element\_type::recovery:}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Recovery"{}};}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_information\_element\_type::tunnel\_endpoint\_identifier\_data\_i:}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Tunnel\ Endpoint\ Identifier\ Data\ I"{}};}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_information\_element\_type::gsn\_address:}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GSN\ Address"{}};}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_information\_element\_type::extension\_header\_type\_list:}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Extension\ Header\ Type\ List"{}};}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{case}\ gtpu\_information\_element\_type::private\_extension:}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Private\ Extension"{}};}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Reserved"{}};}
\DoxyCodeLine{00161\ \ \ \}}
\DoxyCodeLine{00162\ \};}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00165\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1gtpu__extension__header}{gtpu\_extension\_header}}\ \{}
\DoxyCodeLine{00166\ \ \ gtpu\_extension\_header\_type\ extension\_header\_type\ =\ gtpu\_extension\_header\_type::no\_more\_extension\_headers;}
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer__view}{byte\_buffer\_view}}\ \ \ \ \ \ \ \ \ \ \ container\ \ \ \ \ \ \ \ \ \ \ \ \ =\ \{\};}
\DoxyCodeLine{00168\ \};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00172\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1gtpu__ie__recovery}{gtpu\_ie\_recovery}}\ \{}
\DoxyCodeLine{00175\ \ \ uint8\_t\ \mbox{\hyperlink{structsrsran_1_1gtpu__ie__recovery_a3548b73cd1221d75ff8e3d2541dad024}{restart\_counter}}\ =\ 0;}
\DoxyCodeLine{00176\ \};}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00180\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1gtpu__ie__private__extension}{gtpu\_ie\_private\_extension}}\ \{}
\DoxyCodeLine{00182\ \ \ uint16\_t\ \mbox{\hyperlink{structsrsran_1_1gtpu__ie__private__extension_aa709541c5ba7a27645cacefe2808a6cb}{extension\_identifier}};}
\DoxyCodeLine{00184\ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector<uint8\_t,\ GTPU\_PRIVATE\_EXTENSION\_VALUE\_LENGTH>}}\ \mbox{\hyperlink{structsrsran_1_1gtpu__ie__private__extension_a07cf9e14854e697a07a0af5684236db8}{extension\_value}};}
\DoxyCodeLine{00185\ \};}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00188\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1gtpu__header}{gtpu\_header}}\ \{}
\DoxyCodeLine{00189\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1gtpu__header_1_1gtpu__flags}{gtpu\_flags}}\ \{}
\DoxyCodeLine{00190\ \ \ \ \ uint8\_t\ version\ \ \ \ \ \ \ =\ 1;}
\DoxyCodeLine{00191\ \ \ \ \ uint8\_t\ protocol\_type\ =\ 0;}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ ext\_hdr\ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ seq\_number\ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ n\_pdu\ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00195\ \ \ \}\ flags;}
\DoxyCodeLine{00197\ \ \ uint8\_t\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_ade83a32d4789a2fd12fd116a62488feb}{message\_type}}\ =\ 0;}
\DoxyCodeLine{00201\ \ \ uint16\_t\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_a39886826ab123b8baa2f8e513de6ace1}{length}}\ =\ 0;}
\DoxyCodeLine{00203\ \ \ \mbox{\hyperlink{classsrsran_1_1strong__type}{gtpu\_teid\_t}}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_ae3b4c852c6de6464163d17b94cbf2d93}{teid}}\ =\ \{\};}
\DoxyCodeLine{00205\ \ \ uint16\_t\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_ae75b20f3643bc9e7649f03748762eb3a}{seq\_number}}\ =\ 0;}
\DoxyCodeLine{00207\ \ \ uint8\_t\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_a5057bffec189b15d09bb2ac0dfccee83}{n\_pdu}}\ =\ 0;}
\DoxyCodeLine{00210\ \ \ gtpu\_extension\_header\_type\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_a576ab7133d7cedaa67467e491a265fb1}{next\_ext\_hdr\_type}}\ =\ gtpu\_extension\_header\_type::no\_more\_extension\_headers;}
\DoxyCodeLine{00212\ \ \ \mbox{\hyperlink{classsrsran_1_1static__vector}{static\_vector<gtpu\_extension\_header,\ GTPU\_MAX\_NUM\_HEADER\_EXTENSIONS>}}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_a2dfe989911e7a17a673901a058d3144c}{ext\_list}};}
\DoxyCodeLine{00213\ \};}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00219\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structsrsran_1_1gtpu__dissected__pdu}{gtpu\_dissected\_pdu}}\ \{}
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ \mbox{\hyperlink{structsrsran_1_1gtpu__dissected__pdu_a5ede018c23153c6647cfaff4540dedce}{buf}};}
\DoxyCodeLine{00223\ \ \ \mbox{\hyperlink{structsrsran_1_1gtpu__header}{gtpu\_header}}\ \mbox{\hyperlink{structsrsran_1_1gtpu__dissected__pdu_ac82f4f531c10abb667a61c3aca260e81}{hdr}};}
\DoxyCodeLine{00225\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structsrsran_1_1gtpu__dissected__pdu_a79e40cad41127dfc925f3d9921479845}{hdr\_len}}\ =\ 0;}
\DoxyCodeLine{00226\ \};}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{keywordtype}{bool}\ gtpu\_read\_teid(uint32\_t\&\ teid,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\&\ pdu,\ \mbox{\hyperlink{classsrslog_1_1detail_1_1logger__impl}{srslog::basic\_logger}}\&\ logger);}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00236\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_a91232028f75840975a4fbbd0005a15cf}{gtpu\_dissect\_pdu}}(\mbox{\hyperlink{structsrsran_1_1gtpu__dissected__pdu}{gtpu\_dissected\_pdu}}\&\ dissected\_pdu,\ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ raw\_pdu,\ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ logger);}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00244\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_afd81a8c24d4de479c6bd3887e97d640e}{gtpu\_write\_header}}(\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\&\ pdu,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header}{gtpu\_header}}\&\ header,\ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ logger);}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00251\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacesrsran_a772151f60a31780b164f7b439287d7fa}{gtpu\_write\_ie\_recovery}}(\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\&\ pdu,\ \mbox{\hyperlink{structsrsran_1_1gtpu__ie__recovery}{gtpu\_ie\_recovery}}\&\ ie\_recovery,\ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ logger);}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00258\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacesrsran_afdabf05b11a7928f9bbbdf00662508d5}{gtpu\_write\_ie\_private\_extension}}(\mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pdu,}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structsrsran_1_1gtpu__ie__private__extension}{gtpu\_ie\_private\_extension}}\&\ ie\_priv\_ext,}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ \ \ \ \ \ \ \ logger);}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacesrsran_acfd2dd826547652e6c45c64c4c582626}{gtpu\_supported\_flags\_check}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header}{gtpu\_header}}\&\ header,\ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ logger);}
\DoxyCodeLine{00263\ \textcolor{keywordtype}{bool}\ gtpu\_supported\_msg\_type\_check(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header}{gtpu\_header}}\&\ header,\ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ logger);}
\DoxyCodeLine{00264\ \textcolor{keywordtype}{bool}\ gtpu\_extension\_header\_comprehension\_check(\textcolor{keyword}{const}\ gtpu\_extension\_header\_type\&\ type,\ \mbox{\hyperlink{classsrsran_1_1prefixed__logger}{gtpu\_tunnel\_logger}}\&\ logger);}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00270\ \mbox{\hyperlink{classsrsran_1_1byte__buffer}{byte\_buffer}}\ \mbox{\hyperlink{namespacesrsran_ae99660f61a91a0c747f215e489b639cf}{gtpu\_extract\_t\_pdu}}(\mbox{\hyperlink{structsrsran_1_1gtpu__dissected__pdu}{gtpu\_dissected\_pdu}}\&\&\ dissected\_pdu);}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \}\ \textcolor{comment}{//\ namespace\ srsran}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \textcolor{comment}{//\ Formatters}}
\DoxyCodeLine{00275\ \textcolor{keyword}{namespace\ }fmt\ \{}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \textcolor{comment}{//\ GTP-\/U\ flags}}
\DoxyCodeLine{00278\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00279\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structformatter}{formatter}}<\mbox{\hyperlink{namespacesrsran}{srsran}}::gtpu\_header::gtpu\_flags>\ \{}
\DoxyCodeLine{00280\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ParseContext>}
\DoxyCodeLine{00281\ \ \ \textcolor{keyword}{auto}\ parse(ParseContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(ctx.begin())}
\DoxyCodeLine{00282\ \ \ \{}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordflow}{return}\ ctx.begin();}
\DoxyCodeLine{00284\ \ \ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ FormatContext>}
\DoxyCodeLine{00287\ \ \ \textcolor{keyword}{auto}\ format(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header_1_1gtpu__flags}{srsran::gtpu\_header::gtpu\_flags}}\&\ flags,\ FormatContext\&\ ctx)}
\DoxyCodeLine{00288\ \ \ \ \ \ \ -\/>\ \textcolor{keyword}{decltype}(std::declval<FormatContext>().out())}
\DoxyCodeLine{00289\ \ \ \{}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keywordflow}{return}\ format\_to(ctx.out(),}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}v=\{\}\ pt=\{\}\ e=\{\}\ s=\{\}\ pn=\{\}"{}},}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags.version,}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags.protocol\_type,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags.ext\_hdr,}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags.seq\_number,}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags.n\_pdu);}
\DoxyCodeLine{00297\ \ \ \}}
\DoxyCodeLine{00298\ \};}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00301\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structformatter}{formatter}}<\mbox{\hyperlink{namespacesrsran}{srsran}}::gtpu\_header>\ \{}
\DoxyCodeLine{00302\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ParseContext>}
\DoxyCodeLine{00303\ \ \ \textcolor{keyword}{auto}\ parse(ParseContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(ctx.begin())}
\DoxyCodeLine{00304\ \ \ \{}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordflow}{return}\ ctx.begin();}
\DoxyCodeLine{00306\ \ \ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ FormatContext>}
\DoxyCodeLine{00309\ \ \ \textcolor{keyword}{auto}\ format(\textcolor{keyword}{const}\ \mbox{\hyperlink{structsrsran_1_1gtpu__header}{srsran::gtpu\_header}}\&\ hdr,\ FormatContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(std::declval<FormatContext>().out())}
\DoxyCodeLine{00310\ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{return}\ format\_to(ctx.out(),\ \textcolor{stringliteral}{"{}\{\}\ len=\{\}\ teid=\{:\#x\}"{}},\ hdr.flags,\ hdr.\mbox{\hyperlink{structsrsran_1_1gtpu__header_a39886826ab123b8baa2f8e513de6ace1}{length}},\ hdr.\mbox{\hyperlink{structsrsran_1_1gtpu__header_ae3b4c852c6de6464163d17b94cbf2d93}{teid}});}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ \};}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00316\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structformatter}{formatter}}<\mbox{\hyperlink{namespacesrsran}{srsran}}::gtpu\_extension\_header\_type>\ \{}
\DoxyCodeLine{00317\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ ParseContext>}
\DoxyCodeLine{00318\ \ \ \textcolor{keyword}{auto}\ parse(ParseContext\&\ ctx)\ -\/>\ \textcolor{keyword}{decltype}(ctx.begin())}
\DoxyCodeLine{00319\ \ \ \{}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{return}\ ctx.begin();}
\DoxyCodeLine{00321\ \ \ \}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ FormatContext>}
\DoxyCodeLine{00324\ \ \ \textcolor{keyword}{auto}\ format(\textcolor{keyword}{const}\ srsran::gtpu\_extension\_header\_type\&\ ext\_type,\ FormatContext\&\ ctx)}
\DoxyCodeLine{00325\ \ \ \ \ \ \ -\/>\ \textcolor{keyword}{decltype}(std::declval<FormatContext>().out())}
\DoxyCodeLine{00326\ \ \ \{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{return}\ format\_to(ctx.out(),\ \textcolor{stringliteral}{"{}\{\}"{}},\ to\_string(ext\_type));}
\DoxyCodeLine{00328\ \ \ \}}
\DoxyCodeLine{00329\ \};}
\DoxyCodeLine{00330\ \}\ \textcolor{comment}{//\ namespace\ fmt}}

\end{DoxyCode}
