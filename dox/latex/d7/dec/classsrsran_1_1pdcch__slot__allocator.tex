\doxysection{srsran\+::pdcch\+\_\+slot\+\_\+allocator Class Reference}
\hypertarget{classsrsran_1_1pdcch__slot__allocator}{}\label{classsrsran_1_1pdcch__slot__allocator}\index{srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}}


Collaboration diagram for srsran\+::pdcch\+\_\+slot\+\_\+allocator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=217pt]{d4/d8e/classsrsran_1_1pdcch__slot__allocator__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsrsran_1_1pdcch__slot__allocator_1_1alloc__record}{alloc\+\_\+record}}
\begin{DoxyCompactList}\small\item\em PDCCH grant allocation in a given slot. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsrsran_1_1pdcch__slot__allocator_1_1tree__node}{tree\+\_\+node}}
\begin{DoxyCompactList}\small\item\em DFS decision tree node. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} \mbox{\hyperlink{classsrsran_1_1pdcch__slot__allocator_a28a74d356b7ecdfc54d02cfc0e89d58e}{clear}} ()
\begin{DoxyCompactList}\small\item\em Erase the current PDCCH allocations and stored context for this slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcch__slot__allocator_a25ac2c663be29ce9988d55949d7265ad}{alloc\+\_\+pdcch}} (\mbox{\hyperlink{structsrsran_1_1dci__context__information}{dci\+\_\+context\+\_\+information}} \&pdcch\+\_\+ctx, \mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+alloc}}, \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1search__space__configuration}{search\+\_\+space\+\_\+configuration}} \&ss\+\_\+cfg, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_ac6e34c57d85026f0b685a1bb7f3e3773}{pdcch\+\_\+candidate\+\_\+type}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ss\+\_\+candidates}}, \mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_ac17054a62bfdeb63277e89e3b9969041}{crb\+\_\+index\+\_\+list}} $>$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ss\+\_\+candidate\+\_\+crbs}})
\begin{DoxyCompactList}\small\item\em Searches for an available CCEs in the PDCCH to allocate a DCI. If it finds it, it reserves the CCEs, so they cannot be reused in this same slot. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classbool}{bool}} \mbox{\hyperlink{classsrsran_1_1pdcch__slot__allocator_a67c1ab39fdf0c3de1c01375bf1d29599}{cancel\+\_\+last\+\_\+pdcch}} (\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\+\_\+alloc}})
\begin{DoxyCompactList}\small\item\em Deallocates the last PDCCH CCE space reservation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsrsran_1_1pdcch__slot__allocator_ac1677adaee500b826726787353eca1d5}\label{classsrsran_1_1pdcch__slot__allocator_ac1677adaee500b826726787353eca1d5} 
\index{srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}!````~pdcch\_slot\_allocator@{\texorpdfstring{$\sim$}{\string~}pdcch\_slot\_allocator}}
\index{````~pdcch\_slot\_allocator@{\texorpdfstring{$\sim$}{\string~}pdcch\_slot\_allocator}!srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}pdcch\_slot\_allocator()}{\string~pdcch\_slot\_allocator()}}
{\footnotesize\ttfamily pdcch\+\_\+slot\+\_\+allocator\+::\texorpdfstring{$\sim$}{\string~}pdcch\+\_\+slot\+\_\+allocator (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00030\ \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsrsran_1_1pdcch__slot__allocator_a25ac2c663be29ce9988d55949d7265ad}\label{classsrsran_1_1pdcch__slot__allocator_a25ac2c663be29ce9988d55949d7265ad} 
\index{srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}!alloc\_pdcch@{alloc\_pdcch}}
\index{alloc\_pdcch@{alloc\_pdcch}!srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}}
\doxysubsubsection{\texorpdfstring{alloc\_pdcch()}{alloc\_pdcch()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pdcch\+\_\+slot\+\_\+allocator\+::alloc\+\_\+pdcch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1dci__context__information}{dci\+\_\+context\+\_\+information}} \&}]{pdcch\+\_\+ctx,  }\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc,  }\item[{\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{structsrsran_1_1search__space__configuration}{search\+\_\+space\+\_\+configuration}} \&}]{ss\+\_\+cfg,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_ac6e34c57d85026f0b685a1bb7f3e3773}{pdcch\+\_\+candidate\+\_\+type}} $>$}]{ss\+\_\+candidates,  }\item[{\mbox{\hyperlink{classsrsran_1_1span}{span}}$<$ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{const}} \mbox{\hyperlink{namespacesrsran_ac17054a62bfdeb63277e89e3b9969041}{crb\+\_\+index\+\_\+list}} $>$}]{ss\+\_\+candidate\+\_\+crbs }\end{DoxyParamCaption})}



Searches for an available CCEs in the PDCCH to allocate a DCI. If it finds it, it reserves the CCEs, so they cannot be reused in this same slot. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00044\ \{}
\DoxyCodeLine{00045\ \ \ saved\_dfs\_tree.clear();}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \textcolor{comment}{//\ Create\ an\ DL\ Allocation\ Record.}}
\DoxyCodeLine{00048\ \ \ alloc\_record\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}\{\};}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}.is\_dl\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00050\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}.pdcch\_ctx\ \ \ \ \ \ \ \ \ \ \ \ =\ \&pdcch\_ctx;}
\DoxyCodeLine{00051\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}.ss\_cfg\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ \&ss\_cfg;}
\DoxyCodeLine{00052\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}.pdcch\_candidates\ \ \ \ \ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ss\_candidates}};}
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}.pdcch\_candidate\_crbs\ =\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{ss\_candidate\_crbs}};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ Try\ to\ allocate\ PDCCH\ for\ one\ of\ the\ possible\ CCE\ positions.\ If\ this\ operation\ fails,\ retry\ it,\ but\ using\ a}}
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ different\ permutation\ of\ past\ grant\ CCE\ positions.}}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{if}\ (alloc\_dfs\_node(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}},\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}},\ 0))\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ CCE\ start\ index.}}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}}.pdcch\_ctx-\/>cces.ncce\ =\ dfs\_tree.back().ncce;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{comment}{//\ DCI\ record\ was\ successfully\ allocated.}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ records.push\_back(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{record}});}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ previous\ branches\ of\ the\ DFS\ changed\ in\ order\ for\ this\ new\ PDCCH\ to\ be\ allocated,\ update\ previous}}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \textcolor{comment}{//\ PDCCH\ ncces}}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ saved\_dfs\_tree.empty())\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ i\ =\ 0;\ i\ !=\ dfs\_tree.size()\ -\/\ 1;\ ++i)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ records[dfs\_tree[i].record\_index].pdcch\_ctx-\/>cces.ncce\ =\ dfs\_tree[i].ncce;}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordflow}{if}\ (saved\_dfs\_tree.empty())\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ saved\_dfs\_tree\ =\ dfs\_tree;}
\DoxyCodeLine{00074\ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \}\ \textcolor{keywordflow}{while}\ (get\_next\_dfs(\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}));}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{comment}{//\ Revert\ steps\ to\ initial\ state,\ before\ dci\ record\ allocation\ was\ attempted}}
\DoxyCodeLine{00078\ \ \ dfs\_tree.swap(saved\_dfs\_tree);}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00081\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcch__slot__allocator_a67c1ab39fdf0c3de1c01375bf1d29599}\label{classsrsran_1_1pdcch__slot__allocator_a67c1ab39fdf0c3de1c01375bf1d29599} 
\index{srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}!cancel\_last\_pdcch@{cancel\_last\_pdcch}}
\index{cancel\_last\_pdcch@{cancel\_last\_pdcch}!srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}}
\doxysubsubsection{\texorpdfstring{cancel\_last\_pdcch()}{cancel\_last\_pdcch()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classbool}{bool}} pdcch\+\_\+slot\+\_\+allocator\+::cancel\+\_\+last\+\_\+pdcch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsrsran_1_1cell__slot__resource__allocator}{cell\+\_\+slot\+\_\+resource\+\_\+allocator}} \&}]{slot\+\_\+alloc }\end{DoxyParamCaption})}



Deallocates the last PDCCH CCE space reservation. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \{}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ (records.empty())\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}.result.dl.dl\_pdcchs.empty()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ records.back().pdcch\_ctx\ ==\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}.result.dl.dl\_pdcchs.back().ctx)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}.result.dl.dl\_pdcchs.pop\_back();}
\DoxyCodeLine{00091\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{not}}\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}.result.dl.ul\_pdcchs.empty()\ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{and}}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ records.back().pdcch\_ctx\ ==\ \&\mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}.result.dl.ul\_pdcchs.back().ctx)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{slot\_alloc}}.result.dl.ul\_pdcchs.pop\_back();}
\DoxyCodeLine{00094\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00096\ \ \ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ dfs\_tree.pop\_back();}
\DoxyCodeLine{00099\ \ \ records.pop\_back();}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00101\ \}}

\end{DoxyCode}
\Hypertarget{classsrsran_1_1pdcch__slot__allocator_a28a74d356b7ecdfc54d02cfc0e89d58e}\label{classsrsran_1_1pdcch__slot__allocator_a28a74d356b7ecdfc54d02cfc0e89d58e} 
\index{srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}!clear@{clear}}
\index{clear@{clear}!srsran::pdcch\_slot\_allocator@{srsran::pdcch\_slot\_allocator}}
\doxysubsubsection{\texorpdfstring{clear()}{clear()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacesrsran_a58e7c9f2c51a9ad6a0899b46d5315723}{void}} pdcch\+\_\+slot\+\_\+allocator\+::clear (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Erase the current PDCCH allocations and stored context for this slot. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00033\ \{}
\DoxyCodeLine{00034\ \ \ records.clear();}
\DoxyCodeLine{00035\ \ \ dfs\_tree.clear();}
\DoxyCodeLine{00036\ \ \ saved\_dfs\_tree.clear();}
\DoxyCodeLine{00037\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lib/scheduler/pdcch\+\_\+scheduling/pdcch\+\_\+slot\+\_\+resource\+\_\+allocator.\+h\item 
lib/scheduler/pdcch\+\_\+scheduling/pdcch\+\_\+slot\+\_\+resource\+\_\+allocator.\+cpp\end{DoxyCompactItemize}
