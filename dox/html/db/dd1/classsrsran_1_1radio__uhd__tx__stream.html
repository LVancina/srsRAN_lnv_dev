<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN Docs: srsran::radio_uhd_tx_stream Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">srsRAN Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/def/namespacesrsran.html">srsran</a></li><li class="navelem"><a class="el" href="../../db/dd1/classsrsran_1_1radio__uhd__tx__stream.html">radio_uhd_tx_stream</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../db/d58/classsrsran_1_1radio__uhd__tx__stream-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">srsran::radio_uhd_tx_stream Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements a gateway transmitter based on UHD transmit stream.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d7/dc7/radio__uhd__tx__stream_8h_source.html">radio_uhd_tx_stream.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for srsran::radio_uhd_tx_stream:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d9c/classsrsran_1_1radio__uhd__tx__stream__inherit__graph.png" border="0" usemap="#asrsran_1_1radio__uhd__tx__stream_inherit__map" alt="Inheritance graph"/></div>
<map name="asrsran_1_1radio__uhd__tx__stream_inherit__map" id="asrsran_1_1radio__uhd__tx__stream_inherit__map">
<area shape="rect" title="Implements a gateway transmitter based on UHD transmit stream." alt="" coords="131,407,307,567"/>
<area shape="rect" href="../../d5/de0/classsrsran_1_1baseband__gateway__transmitter.html" title="Baseband gateway &#45; transmission interface." alt="" coords="25,249,213,329"/>
<area shape="poly" title=" " alt="" coords="147,340,181,405,176,408,142,342"/>
<area shape="rect" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html" title="Describes the base interface for baseband gateway interfaces." alt="" coords="5,5,232,171"/>
<area shape="poly" title=" " alt="" coords="121,185,121,249,116,249,116,185"/>
<area shape="rect" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html" title=" " alt="" coords="237,219,401,359"/>
<area shape="poly" title=" " alt="" coords="280,372,261,408,257,405,275,370"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for srsran::radio_uhd_tx_stream:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d8b/classsrsran_1_1radio__uhd__tx__stream__coll__graph.png" border="0" usemap="#asrsran_1_1radio__uhd__tx__stream_coll__map" alt="Collaboration graph"/></div>
<map name="asrsran_1_1radio__uhd__tx__stream_coll__map" id="asrsran_1_1radio__uhd__tx__stream_coll__map">
<area shape="rect" title="Implements a gateway transmitter based on UHD transmit stream." alt="" coords="131,407,307,567"/>
<area shape="rect" href="../../d5/de0/classsrsran_1_1baseband__gateway__transmitter.html" title="Baseband gateway &#45; transmission interface." alt="" coords="25,249,213,329"/>
<area shape="poly" title=" " alt="" coords="147,340,181,405,176,408,142,342"/>
<area shape="rect" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html" title="Describes the base interface for baseband gateway interfaces." alt="" coords="5,5,232,171"/>
<area shape="poly" title=" " alt="" coords="121,185,121,249,116,249,116,185"/>
<area shape="rect" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html" title=" " alt="" coords="237,219,401,359"/>
<area shape="poly" title=" " alt="" coords="280,372,261,408,257,405,275,370"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d4f/structsrsran_1_1radio__uhd__tx__stream_1_1stream__description.html">stream_description</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the necessary parameters to create an UHD transmit stream.  <a href="../../d5/d4f/structsrsran_1_1radio__uhd__tx__stream_1_1stream__description.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1f5d7a33b05b509d71fed714e983f382" id="r_a1f5d7a33b05b509d71fed714e983f382"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f5d7a33b05b509d71fed714e983f382">radio_uhd_tx_stream</a> (uhd::usrp::multi_usrp::sptr &amp;usrp, <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d5/d4f/structsrsran_1_1radio__uhd__tx__stream_1_1stream__description.html">stream_description</a> &amp;description, <a class="el" href="../../df/dc3/classsrsran_1_1task__executor.html">task_executor</a> &amp;<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">async_executor_</a>, <a class="el" href="../../d4/d40/classsrsran_1_1radio__notification__handler.html">radio_notification_handler</a> &amp;<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">notifier_</a>)</td></tr>
<tr class="memdesc:a1f5d7a33b05b509d71fed714e983f382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an UHD transmit stream.  <br /></td></tr>
<tr class="separator:a1f5d7a33b05b509d71fed714e983f382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d781365e20ccc4f258c9e580411b53c" id="r_a7d781365e20ccc4f258c9e580411b53c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d781365e20ccc4f258c9e580411b53c">get_buffer_size</a> () <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a></td></tr>
<tr class="memdesc:a7d781365e20ccc4f258c9e580411b53c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the optimal transmitter buffer size.  <br /></td></tr>
<tr class="separator:a7d781365e20ccc4f258c9e580411b53c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a877e375e9e38819603deba5ef1f8cc03" id="r_a877e375e9e38819603deba5ef1f8cc03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a877e375e9e38819603deba5ef1f8cc03">transmit</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d2/daa/classsrsran_1_1baseband__gateway__buffer__reader.html">baseband_gateway_buffer_reader</a> &amp;data, <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/daa/structsrsran_1_1baseband__gateway__transmitter__metadata.html">baseband_gateway_transmitter_metadata</a> &amp;metadata) <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">override</a></td></tr>
<tr class="memdesc:a877e375e9e38819603deba5ef1f8cc03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits a set of baseband samples at the time instant provided in the metadata.  <br /></td></tr>
<tr class="separator:a877e375e9e38819603deba5ef1f8cc03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f3b4aa01cf226094f5774462c0cb5c" id="r_a03f3b4aa01cf226094f5774462c0cb5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03f3b4aa01cf226094f5774462c0cb5c">stop</a> ()</td></tr>
<tr class="memdesc:a03f3b4aa01cf226094f5774462c0cb5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the transmission.  <br /></td></tr>
<tr class="separator:a03f3b4aa01cf226094f5774462c0cb5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff45befebde956b712a35893c6ebdb0" id="r_aaff45befebde956b712a35893c6ebdb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaff45befebde956b712a35893c6ebdb0">wait_stop</a> ()</td></tr>
<tr class="memdesc:aaff45befebde956b712a35893c6ebdb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until radio is notify_stop.  <br /></td></tr>
<tr class="separator:aaff45befebde956b712a35893c6ebdb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsrsran_1_1baseband__gateway__base"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classsrsran_1_1baseband__gateway__base')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">srsran::baseband_gateway_base</a></td></tr>
<tr class="memitem:aafbff764797512ec4675bbf7b5944725 inherit pub_methods_classsrsran_1_1baseband__gateway__base" id="r_aafbff764797512ec4675bbf7b5944725"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">virtual</a>&#160;</td><td class="memItemRight" valign="bottom"><b>~baseband_gateway_base</b> ()=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">default</a></td></tr>
<tr class="memdesc:aafbff764797512ec4675bbf7b5944725 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides default destructor. <br /></td></tr>
<tr class="separator:aafbff764797512ec4675bbf7b5944725 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa019c53e2d1132218aecfb2ccf1d8335 inherit pub_methods_classsrsran_1_1baseband__gateway__base" id="r_aa019c53e2d1132218aecfb2ccf1d8335"><td class="memItemLeft" align="right" valign="top">
&#160;</td><td class="memItemRight" valign="bottom"><b>baseband_gateway_base</b> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">baseband_gateway_base</a> &amp;<a class="el" href="../../d9/def/namespacesrsran.html#aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>)=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">delete</a></td></tr>
<tr class="memdesc:aa019c53e2d1132218aecfb2ccf1d8335 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forbid copy constructor. <br /></td></tr>
<tr class="separator:aa019c53e2d1132218aecfb2ccf1d8335 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13948f300e303b298a518cba1f6bcbc inherit pub_methods_classsrsran_1_1baseband__gateway__base" id="r_ac13948f300e303b298a518cba1f6bcbc"><td class="memItemLeft" align="right" valign="top">
&#160;</td><td class="memItemRight" valign="bottom"><b>baseband_gateway_base</b> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">baseband_gateway_base</a> &amp;&amp;<a class="el" href="../../d9/def/namespacesrsran.html#aaf684a2cfa98b7f333de7041525a5b29a795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>)=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">delete</a></td></tr>
<tr class="memdesc:ac13948f300e303b298a518cba1f6bcbc inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forbid move constructor. <br /></td></tr>
<tr class="separator:ac13948f300e303b298a518cba1f6bcbc inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82b5985a315b92a8849ac48df7bf557 inherit pub_methods_classsrsran_1_1baseband__gateway__base" id="r_aa82b5985a315b92a8849ac48df7bf557"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">baseband_gateway_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">baseband_gateway_base</a> &amp;)=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">delete</a></td></tr>
<tr class="memdesc:aa82b5985a315b92a8849ac48df7bf557 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forbid copy assigment operator. <br /></td></tr>
<tr class="separator:aa82b5985a315b92a8849ac48df7bf557 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50300910c202c831ccce97f60dea111 inherit pub_methods_classsrsran_1_1baseband__gateway__base" id="r_ae50300910c202c831ccce97f60dea111"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">baseband_gateway_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">baseband_gateway_base</a> &amp;&amp;)=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">delete</a></td></tr>
<tr class="memdesc:ae50300910c202c831ccce97f60dea111 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forbid move assigment operator. <br /></td></tr>
<tr class="separator:ae50300910c202c831ccce97f60dea111 inherit pub_methods_classsrsran_1_1baseband__gateway__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsrsran_1_1uhd__exception__handler"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classsrsran_1_1uhd__exception__handler')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html">srsran::uhd_exception_handler</a></td></tr>
<tr class="memitem:a8f6f77cc15719b76196b3466f446be7c inherit pub_methods_classsrsran_1_1uhd__exception__handler" id="r_a8f6f77cc15719b76196b3466f446be7c"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">typename</a> S , typename... Args&gt; </td></tr>
<tr class="memitem:a8f6f77cc15719b76196b3466f446be7c inherit pub_methods_classsrsran_1_1uhd__exception__handler"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html#a8f6f77cc15719b76196b3466f446be7c">on_error</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> S &amp;format_str, <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">Args</a> &amp;&amp;... args)</td></tr>
<tr class="separator:a8f6f77cc15719b76196b3466f446be7c inherit pub_methods_classsrsran_1_1uhd__exception__handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3e01af04c1c394cb27d1150cfa7e492 inherit pub_methods_classsrsran_1_1uhd__exception__handler" id="r_ac3e01af04c1c394cb27d1150cfa7e492"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">typename</a> F &gt; </td></tr>
<tr class="memitem:ac3e01af04c1c394cb27d1150cfa7e492 inherit pub_methods_classsrsran_1_1uhd__exception__handler"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html#ac3e01af04c1c394cb27d1150cfa7e492">safe_execution</a> (F task)</td></tr>
<tr class="separator:ac3e01af04c1c394cb27d1150cfa7e492 inherit pub_methods_classsrsran_1_1uhd__exception__handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3660e50d52ecd1fa3d426a805030a646 inherit pub_methods_classsrsran_1_1uhd__exception__handler" id="r_a3660e50d52ecd1fa3d426a805030a646"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html#a3660e50d52ecd1fa3d426a805030a646">is_successful</a> () <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a></td></tr>
<tr class="separator:a3660e50d52ecd1fa3d426a805030a646 inherit pub_methods_classsrsran_1_1uhd__exception__handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d9c51ab907c347c37e0d339fe9e88d2 inherit pub_methods_classsrsran_1_1uhd__exception__handler" id="r_a9d9c51ab907c347c37e0d339fe9e88d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dfe/classsrsran_1_1uhd__exception__handler.html#a9d9c51ab907c347c37e0d339fe9e88d2">get_error_message</a> () <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a></td></tr>
<tr class="separator:a9d9c51ab907c347c37e0d339fe9e88d2 inherit pub_methods_classsrsran_1_1uhd__exception__handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classsrsran_1_1baseband__gateway__base"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_methods_classsrsran_1_1baseband__gateway__base')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d8/d6f/classsrsran_1_1baseband__gateway__base.html">srsran::baseband_gateway_base</a></td></tr>
<tr class="memitem:a7b526d002b046f5c6f4a1a8b4a0a0aba inherit pro_methods_classsrsran_1_1baseband__gateway__base" id="r_a7b526d002b046f5c6f4a1a8b4a0a0aba"><td class="memItemLeft" align="right" valign="top">
&#160;</td><td class="memItemRight" valign="bottom"><b>baseband_gateway_base</b> ()=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">default</a></td></tr>
<tr class="memdesc:a7b526d002b046f5c6f4a1a8b4a0a0aba inherit pro_methods_classsrsran_1_1baseband__gateway__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow default constructor for child. <br /></td></tr>
<tr class="separator:a7b526d002b046f5c6f4a1a8b4a0a0aba inherit pro_methods_classsrsran_1_1baseband__gateway__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements a gateway transmitter based on UHD transmit stream. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1f5d7a33b05b509d71fed714e983f382" name="a1f5d7a33b05b509d71fed714e983f382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f5d7a33b05b509d71fed714e983f382">&#9670;&#160;</a></span>radio_uhd_tx_stream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">radio_uhd_tx_stream::radio_uhd_tx_stream </td>
          <td>(</td>
          <td class="paramtype">uhd::usrp::multi_usrp::sptr &amp;</td>          <td class="paramname"><span class="paramname"><em>usrp</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d5/d4f/structsrsran_1_1radio__uhd__tx__stream_1_1stream__description.html">stream_description</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>description</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/dc3/classsrsran_1_1task__executor.html">task_executor</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>async_executor_</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d40/classsrsran_1_1radio__notification__handler.html">radio_notification_handler</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>notifier_</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs an UHD transmit stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">usrp</td><td>Provides the USRP context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">description</td><td>Provides the stream configuration parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">async_executor_</td><td>Provides the asynchronous task executor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">notifier_</td><td>Provides the radio event notification handler. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  129</span>                                                                                 :</div>
<div class="line"><span class="lineno">  130</span>  stream_id(description.id),</div>
<div class="line"><span class="lineno">  131</span>  async_executor(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">async_executor_</a>),</div>
<div class="line"><span class="lineno">  132</span>  notifier(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">notifier_</a>),</div>
<div class="line"><span class="lineno">  133</span>  srate_hz(description.srate_hz),</div>
<div class="line"><span class="lineno">  134</span>  nof_channels(description.ports.size()),</div>
<div class="line"><span class="lineno">  135</span>  discontinuous_tx(description.discontiuous_tx),</div>
<div class="line"><span class="lineno">  136</span>  last_tx_timespec(0.0),</div>
<div class="line"><span class="lineno">  137</span>  power_ramping_buffer(nof_channels, 0)</div>
<div class="line"><span class="lineno">  138</span>{</div>
<div class="line"><span class="lineno">  139</span>  srsran_assert(std::isnormal(srate_hz) &amp;&amp; (srate_hz &gt; 0.0), <span class="stringliteral">&quot;Invalid sampling rate {}.&quot;</span>, srate_hz);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <span class="comment">// Build stream arguments.</span></div>
<div class="line"><span class="lineno">  142</span>  uhd::stream_args_t <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a> = {};</div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>.cpu_format         = <span class="stringliteral">&quot;fc32&quot;</span>;</div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">switch</span> (description.otw_format) {</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">case</span> radio_configuration::over_the_wire_format::DEFAULT:</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">case</span> radio_configuration::over_the_wire_format::SC16:</div>
<div class="line"><span class="lineno">  147</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>.otw_format = <span class="stringliteral">&quot;sc16&quot;</span>;</div>
<div class="line"><span class="lineno">  148</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">case</span> radio_configuration::over_the_wire_format::SC12:</div>
<div class="line"><span class="lineno">  150</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>.otw_format = <span class="stringliteral">&quot;sc12&quot;</span>;</div>
<div class="line"><span class="lineno">  151</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">case</span> radio_configuration::over_the_wire_format::SC8:</div>
<div class="line"><span class="lineno">  153</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>.otw_format = <span class="stringliteral">&quot;sc8&quot;</span>;</div>
<div class="line"><span class="lineno">  154</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  155</span>  }</div>
<div class="line"><span class="lineno">  156</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>.args     = description.args;</div>
<div class="line"><span class="lineno">  157</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>.channels = description.ports;</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="keywordflow">if</span> (!safe_execution([<span class="keyword">this</span>, usrp, &amp;<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>]() {</div>
<div class="line"><span class="lineno">  160</span>        stream          = usrp-&gt;get_tx_stream(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">stream_args</a>);</div>
<div class="line"><span class="lineno">  161</span>        max_packet_size = stream-&gt;get_max_num_samps();</div>
<div class="line"><span class="lineno">  162</span>      })) {</div>
<div class="line"><span class="lineno">  163</span>    printf(<span class="stringliteral">&quot;Error:  failed to create transmit stream %d. %s.\n&quot;</span>, stream_id, get_error_message().c_str());</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  165</span>  }</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <span class="comment">// Use zero padding to absorb power ramping on each new burst.</span></div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordflow">if</span> (discontinuous_tx) {</div>
<div class="line"><span class="lineno">  169</span>    power_ramping_nof_samples = description.srate_hz * <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(description.power_ramping_us) / 1<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">e6</a>;</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment">// Align the number of padding samples to the TX buffer size.</span></div>
<div class="line"><span class="lineno">  172</span>    power_ramping_nof_samples = (power_ramping_nof_samples / max_packet_size) * max_packet_size;</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">aligned_guard_time</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(power_ramping_nof_samples) * 1000000.0 / srate_hz;</div>
<div class="line"><span class="lineno">  174</span>    fmt::print(</div>
<div class="line"><span class="lineno">  175</span>        <span class="stringliteral">&quot;Aligning TX power ramping guard time to the UHD buffer size, i.e., {}. Aligned guard time: {:.1f} us.\n&quot;</span>,</div>
<div class="line"><span class="lineno">  176</span>        max_packet_size,</div>
<div class="line"><span class="lineno">  177</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">aligned_guard_time</a>);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    power_ramping_buffer.<a class="code hl_function" href="../../dd/d27/classsrsran_1_1baseband__gateway__buffer__dynamic.html#ad15aacbac76716c26fd606e69d28b995">resize</a>(power_ramping_nof_samples);</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_channel</a> = 0; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_channel</a> != nof_channels; ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_channel</a>) {</div>
<div class="line"><span class="lineno">  181</span>      srsvec::zero(power_ramping_buffer.<a class="code hl_function" href="../../dd/d27/classsrsran_1_1baseband__gateway__buffer__dynamic.html#aa806221b1a14076dbc8115adabb05b43">get_writer</a>()[<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_channel</a>]);</div>
<div class="line"><span class="lineno">  182</span>    }</div>
<div class="line"><span class="lineno">  183</span>  }</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>  <span class="comment">// Notify FSM that it was successfully initialized.</span></div>
<div class="line"><span class="lineno">  186</span>  state_fsm.<a class="code hl_function" href="../../da/db9/classsrsran_1_1radio__uhd__tx__stream__fsm.html#ab30bd8e3336a855e4c2bcc4cbf01748a">init_successful</a>();</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  <span class="comment">// Create asynchronous task.</span></div>
<div class="line"><span class="lineno">  189</span>  run_recv_async_msg();</div>
<div class="line"><span class="lineno">  190</span>}</div>
<div class="ttc" id="aclasssrsran_1_1baseband__gateway__buffer__dynamic_html_aa806221b1a14076dbc8115adabb05b43"><div class="ttname"><a href="../../dd/d27/classsrsran_1_1baseband__gateway__buffer__dynamic.html#aa806221b1a14076dbc8115adabb05b43">srsran::baseband_gateway_buffer_dynamic::get_writer</a></div><div class="ttdeci">baseband_gateway_buffer_writer &amp; get_writer()</div><div class="ttdoc">Gets the writer interface.</div><div class="ttdef"><b>Definition</b> baseband_gateway_buffer_dynamic.h:111</div></div>
<div class="ttc" id="aclasssrsran_1_1baseband__gateway__buffer__dynamic_html_ad15aacbac76716c26fd606e69d28b995"><div class="ttname"><a href="../../dd/d27/classsrsran_1_1baseband__gateway__buffer__dynamic.html#ad15aacbac76716c26fd606e69d28b995">srsran::baseband_gateway_buffer_dynamic::resize</a></div><div class="ttdeci">void resize(unsigned new_nof_samples)</div><div class="ttdoc">Resize buffer.</div><div class="ttdef"><b>Definition</b> baseband_gateway_buffer_dynamic.h:119</div></div>
<div class="ttc" id="aclasssrsran_1_1radio__uhd__tx__stream__fsm_html_ab30bd8e3336a855e4c2bcc4cbf01748a"><div class="ttname"><a href="../../da/db9/classsrsran_1_1radio__uhd__tx__stream__fsm.html#ab30bd8e3336a855e4c2bcc4cbf01748a">srsran::radio_uhd_tx_stream_fsm::init_successful</a></div><div class="ttdeci">void init_successful()</div><div class="ttdoc">Notifies that the transmit stream has been initialized successfully.</div><div class="ttdef"><b>Definition</b> radio_uhd_tx_stream_fsm.h:76</div></div>
<div class="ttc" id="anamespacesrsran_html_a58e7c9f2c51a9ad6a0899b46d5315723"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">srsran::mask_msb_ones</a></div><div class="ttdeci">constexpr Integer mask_msb_ones(size_t N)</div><div class="ttdoc">Returns an unsigned integer with the N most significant bits (MSB) set to one, and the remaining bits...</div><div class="ttdef"><b>Definition</b> bounded_bitset.h:65</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7d781365e20ccc4f258c9e580411b53c" name="a7d781365e20ccc4f258c9e580411b53c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d781365e20ccc4f258c9e580411b53c">&#9670;&#160;</a></span>get_buffer_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> radio_uhd_tx_stream::get_buffer_size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the optimal transmitter buffer size. </p>
<div class="fragment"><div class="line"><span class="lineno">  360</span>{</div>
<div class="line"><span class="lineno">  361</span>  <span class="keywordflow">return</span> max_packet_size;</div>
<div class="line"><span class="lineno">  362</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a03f3b4aa01cf226094f5774462c0cb5c" name="a03f3b4aa01cf226094f5774462c0cb5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f3b4aa01cf226094f5774462c0cb5c">&#9670;&#160;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> radio_uhd_tx_stream::stop </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the transmission. </p>
<div class="fragment"><div class="line"><span class="lineno">  320</span>{</div>
<div class="line"><span class="lineno">  321</span>  uhd::tx_metadata_t <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">md</a>;</div>
<div class="line"><span class="lineno">  322</span>  state_fsm.stop(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">md</a>);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  <span class="comment">// Send end-of-burst if it is in the middle of a burst.</span></div>
<div class="line"><span class="lineno">  325</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">md</a>.end_of_burst) {</div>
<div class="line"><span class="lineno">  326</span>    std::unique_lock&lt;std::mutex&gt; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">transmit_lock</a>(stream_transmit_mutex);</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment">// Notify end of burst.</span></div>
<div class="line"><span class="lineno">  329</span>    <a class="code hl_struct" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html">radio_notification_handler::event_description</a> event_description = {};</div>
<div class="line"><span class="lineno">  330</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a3f49f91a7ca868389088332fd4a16386">stream_id</a>                                     = stream_id;</div>
<div class="line"><span class="lineno">  331</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a580d960a54861ba14530a9e6ffb077d9">channel_id</a>                                    = 0;</div>
<div class="line"><span class="lineno">  332</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#af4d280f079f4f65848159b4858dd245d">source</a> = <a class="code hl_enumvalue" href="../../db/d79/classsrsran_1_1radio__notification__handler_1_1event__source.html#a7f23df937678f1d803ac52f8af7d91b3a149b528ca682d08b0e3789e03d050fd8">radio_notification_handler::event_source::TRANSMIT</a>;</div>
<div class="line"><span class="lineno">  333</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a1482c13a2ae59d37645e16c95165a630">type</a>   = <a class="code hl_enumvalue" href="../../d1/d66/classsrsran_1_1radio__notification__handler_1_1event__type.html#ada92c8b313b55717e4f4f4be58a1ab58a255d970f7b22582d202136011c492b37">radio_notification_handler::event_type::END_OF_BURST</a>;</div>
<div class="line"><span class="lineno">  334</span>    notifier.<a class="code hl_function" href="../../d4/d40/classsrsran_1_1radio__notification__handler.html#a8b4a990b42877a8054ac67c85543c541">on_radio_rt_event</a>(event_description);</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">// Flatten buffers.</span></div>
<div class="line"><span class="lineno">  337</span>    std::array&lt;cf_t, 4&gt;                          buffer;</div>
<div class="line"><span class="lineno">  338</span>    <a class="code hl_class" href="../../da/daf/classsrsran_1_1static__vector.html">static_vector&lt;void*, RADIO_MAX_NOF_CHANNELS&gt;</a> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">buffs_flat_ptr</a>(nof_channels);</div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> channel = 0; channel != nof_channels; ++channel) {</div>
<div class="line"><span class="lineno">  340</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">buffs_flat_ptr</a>[channel] = (<span class="keywordtype">void</span>*)buffer.data();</div>
<div class="line"><span class="lineno">  341</span>    }</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">// Make UHD buffers.</span></div>
<div class="line"><span class="lineno">  344</span>    uhd::tx_streamer::buffs_type <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">buffs_cpp</a>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">buffs_flat_ptr</a>.data(), nof_channels);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="comment">// Safe transmission. Ignore return.</span></div>
<div class="line"><span class="lineno">  347</span>    safe_execution([<span class="keyword">this</span>, &amp;<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">buffs_cpp</a>, &amp;<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">md</a>]() {</div>
<div class="line"><span class="lineno">  348</span>      <span class="comment">// Actual transmission. Ignore number of transmitted samples.</span></div>
<div class="line"><span class="lineno">  349</span>      stream-&gt;send(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">buffs_cpp</a>, 0, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">md</a>, TRANSMIT_TIMEOUT_S);</div>
<div class="line"><span class="lineno">  350</span>    });</div>
<div class="line"><span class="lineno">  351</span>  }</div>
<div class="line"><span class="lineno">  352</span>}</div>
<div class="ttc" id="aclasssrsran_1_1radio__notification__handler_1_1event__source_html_a7f23df937678f1d803ac52f8af7d91b3a149b528ca682d08b0e3789e03d050fd8"><div class="ttname"><a href="../../db/d79/classsrsran_1_1radio__notification__handler_1_1event__source.html#a7f23df937678f1d803ac52f8af7d91b3a149b528ca682d08b0e3789e03d050fd8">srsran::radio_notification_handler::event_source::TRANSMIT</a></div><div class="ttdeci">@ TRANSMIT</div><div class="ttdoc">The event is from a transmit chain.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:49</div></div>
<div class="ttc" id="aclasssrsran_1_1radio__notification__handler_1_1event__type_html_ada92c8b313b55717e4f4f4be58a1ab58a255d970f7b22582d202136011c492b37"><div class="ttname"><a href="../../d1/d66/classsrsran_1_1radio__notification__handler_1_1event__type.html#ada92c8b313b55717e4f4f4be58a1ab58a255d970f7b22582d202136011c492b37">srsran::radio_notification_handler::event_type::END_OF_BURST</a></div><div class="ttdeci">@ END_OF_BURST</div><div class="ttdoc">Indicates the end of a burst.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:92</div></div>
<div class="ttc" id="aclasssrsran_1_1radio__notification__handler_html_a8b4a990b42877a8054ac67c85543c541"><div class="ttname"><a href="../../d4/d40/classsrsran_1_1radio__notification__handler.html#a8b4a990b42877a8054ac67c85543c541">srsran::radio_notification_handler::on_radio_rt_event</a></div><div class="ttdeci">virtual void on_radio_rt_event(const event_description &amp;description)=0</div><div class="ttdoc">Notifies a new event that affected the real-time operation of the radio.</div></div>
<div class="ttc" id="aclasssrsran_1_1static__vector_html"><div class="ttname"><a href="../../da/daf/classsrsran_1_1static__vector.html">srsran::static_vector</a></div><div class="ttdef"><b>Definition</b> static_vector.h:187</div></div>
<div class="ttc" id="astructsrsran_1_1radio__notification__handler_1_1event__description_html"><div class="ttname"><a href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html">srsran::radio_notification_handler::event_description</a></div><div class="ttdoc">Describes a radio notification.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:138</div></div>
<div class="ttc" id="astructsrsran_1_1radio__notification__handler_1_1event__description_html_a1482c13a2ae59d37645e16c95165a630"><div class="ttname"><a href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a1482c13a2ae59d37645e16c95165a630">srsran::radio_notification_handler::event_description::type</a></div><div class="ttdeci">event_type type</div><div class="ttdoc">Indicates the event type.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:146</div></div>
<div class="ttc" id="astructsrsran_1_1radio__notification__handler_1_1event__description_html_a3f49f91a7ca868389088332fd4a16386"><div class="ttname"><a href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a3f49f91a7ca868389088332fd4a16386">srsran::radio_notification_handler::event_description::stream_id</a></div><div class="ttdeci">unsigned stream_id</div><div class="ttdoc">Indicates the stream identifier that triggered the event if it is available, UNKNOWN_ID otherwise.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:140</div></div>
<div class="ttc" id="astructsrsran_1_1radio__notification__handler_1_1event__description_html_a580d960a54861ba14530a9e6ffb077d9"><div class="ttname"><a href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a580d960a54861ba14530a9e6ffb077d9">srsran::radio_notification_handler::event_description::channel_id</a></div><div class="ttdeci">unsigned channel_id</div><div class="ttdoc">Indicates the stream identifier that triggered the event if it is available, UNKNOWN_ID otherwise.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:142</div></div>
<div class="ttc" id="astructsrsran_1_1radio__notification__handler_1_1event__description_html_af4d280f079f4f65848159b4858dd245d"><div class="ttname"><a href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#af4d280f079f4f65848159b4858dd245d">srsran::radio_notification_handler::event_description::source</a></div><div class="ttdeci">event_source source</div><div class="ttdoc">Indicates the source of the event.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:144</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a877e375e9e38819603deba5ef1f8cc03" name="a877e375e9e38819603deba5ef1f8cc03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a877e375e9e38819603deba5ef1f8cc03">&#9670;&#160;</a></span>transmit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> radio_uhd_tx_stream::transmit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d2/daa/classsrsran_1_1baseband__gateway__buffer__reader.html">baseband_gateway_buffer_reader</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/daa/structsrsran_1_1baseband__gateway__transmitter__metadata.html">baseband_gateway_transmitter_metadata</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>metadata</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transmits a set of baseband samples at the time instant provided in the metadata. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Buffer of baseband samples to transmit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metadata</td><td>Additional parameters for transmission. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>The data buffers must have the same number of channels as the stream. </dd></dl>

<p>Implements <a class="el" href="../../d5/de0/classsrsran_1_1baseband__gateway__transmitter.html#ac3f8ab3290997985e26afbaec57f8119">srsran::baseband_gateway_transmitter</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  194</span>{</div>
<div class="line"><span class="lineno">  195</span>  <span class="comment">// Protect stream transmitter.</span></div>
<div class="line"><span class="lineno">  196</span>  std::unique_lock&lt;std::mutex&gt; lock(stream_transmit_mutex);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  uhd::tx_metadata_t <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_start_padding</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.tx_start.has_value();</div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_end_padding</a>   = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.tx_end.has_value();</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>  uhd::time_spec_t <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>.from_ticks(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.ts, srate_hz);</div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordtype">bool</span>             <a class="code hl_function" href="#a877e375e9e38819603deba5ef1f8cc03">transmit</a>;</div>
<div class="line"><span class="lineno">  205</span>  <span class="keywordflow">if</span> (discontinuous_tx) {</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_start_padding</a>) {</div>
<div class="line"><span class="lineno">  207</span>      <span class="comment">// Set the timespec to the start of the actual transmission if there is head padding in the buffer.</span></div>
<div class="line"><span class="lineno">  208</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a> =</div>
<div class="line"><span class="lineno">  209</span>          <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>.from_ticks(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.ts + <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="../../d9/def/namespacesrsran.html#a4057ba65348ba48e6202d60aea8e6235">baseband_gateway_timestamp</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.tx_start.value()), srate_hz);</div>
<div class="line"><span class="lineno">  210</span>    }</div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">// Update state.</span></div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_function" href="#a877e375e9e38819603deba5ef1f8cc03">transmit</a> = state_fsm.<a class="code hl_function" href="../../da/db9/classsrsran_1_1radio__uhd__tx__stream__fsm.html#a0011309fb1566c196ca2e119f37b4994">on_transmit</a>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.is_empty, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_end_padding</a>);</div>
<div class="line"><span class="lineno">  213</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_function" href="#a877e375e9e38819603deba5ef1f8cc03">transmit</a> = state_fsm.<a class="code hl_function" href="../../da/db9/classsrsran_1_1radio__uhd__tx__stream__fsm.html#a0011309fb1566c196ca2e119f37b4994">on_transmit</a>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  215</span>  }</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>  <span class="comment">// Return if no transmission is required.</span></div>
<div class="line"><span class="lineno">  218</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a877e375e9e38819603deba5ef1f8cc03">transmit</a>) {</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  220</span>  }</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>  <span class="comment">// Notify start of burst.</span></div>
<div class="line"><span class="lineno">  223</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>.start_of_burst) {</div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_struct" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html">radio_notification_handler::event_description</a> event_description;</div>
<div class="line"><span class="lineno">  225</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a3f49f91a7ca868389088332fd4a16386">stream_id</a>  = stream_id;</div>
<div class="line"><span class="lineno">  226</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a580d960a54861ba14530a9e6ffb077d9">channel_id</a> = 0;</div>
<div class="line"><span class="lineno">  227</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#af4d280f079f4f65848159b4858dd245d">source</a>     = <a class="code hl_enumvalue" href="../../db/d79/classsrsran_1_1radio__notification__handler_1_1event__source.html#a7f23df937678f1d803ac52f8af7d91b3a149b528ca682d08b0e3789e03d050fd8">radio_notification_handler::event_source::TRANSMIT</a>;</div>
<div class="line"><span class="lineno">  228</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a1482c13a2ae59d37645e16c95165a630">type</a>       = <a class="code hl_enumvalue" href="../../d1/d66/classsrsran_1_1radio__notification__handler_1_1event__type.html#ada92c8b313b55717e4f4f4be58a1ab58a1ffc0a168c5d1746f80928dbfe6d0342">radio_notification_handler::event_type::START_OF_BURST</a>;</div>
<div class="line"><span class="lineno">  229</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a795d0b5dda3e26354a1150841b702641">timestamp</a>.<a class="code hl_function" href="../../d1/d57/classsrsran_1_1optional.html#ace23a99aaa630fa921abca90844f8bb3">emplace</a>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>.to_ticks(srate_hz));</div>
<div class="line"><span class="lineno">  230</span>    notifier.<a class="code hl_function" href="../../d4/d40/classsrsran_1_1radio__notification__handler.html#a8b4a990b42877a8054ac67c85543c541">on_radio_rt_event</a>(event_description);</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="comment">// Transmit zeros before the actual transmission to absorb power ramping effects.</span></div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">if</span> (discontinuous_tx) {</div>
<div class="line"><span class="lineno">  234</span>      <span class="comment">// Compute the time in number of samples between the end of the last transmission and the start of the current</span></div>
<div class="line"><span class="lineno">  235</span>      <span class="comment">// one.</span></div>
<div class="line"><span class="lineno">  236</span>      <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">transmission_gap</a> = (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a> - last_tx_timespec).<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">to_ticks</a>(srate_hz);</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>      <span class="comment">// Make sure that the power ramping padding starts at least 10 microseconds after the last transmission end.</span></div>
<div class="line"><span class="lineno">  239</span>      <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">minimum_gap_before_power_ramping</a> = srate_hz / 100000.0;</div>
<div class="line"><span class="lineno">  240</span>      <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_padding_samples</a>              = 0;</div>
<div class="line"><span class="lineno">  241</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">transmission_gap</a> &gt; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">minimum_gap_before_power_ramping</a>) {</div>
<div class="line"><span class="lineno">  242</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_padding_samples</a> = std::min(power_ramping_nof_samples, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">transmission_gap</a> - <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">minimum_gap_before_power_ramping</a>);</div>
<div class="line"><span class="lineno">  243</span>      }</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_padding_samples</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_padding_sps_total</a> = 0;</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>        uhd::tx_metadata_t <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>;</div>
<div class="line"><span class="lineno">  249</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>.has_time_spec  = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  250</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>.start_of_burst = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  251</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>.end_of_burst   = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  252</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>.time_spec = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>.time_spec - <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>.from_ticks(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_padding_samples</a>, srate_hz);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>        <span class="comment">// Modify the actual trasnmission metadata, since we have already started the burst with padding.</span></div>
<div class="line"><span class="lineno">  255</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>.start_of_burst = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  256</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>.has_time_spec  = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  258</span>          <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a> = 0;</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>          <a class="code hl_class" href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html">baseband_gateway_buffer_reader_view</a> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_padding</a> =</div>
<div class="line"><span class="lineno">  261</span>              <a class="code hl_class" href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html">baseband_gateway_buffer_reader_view</a>(power_ramping_buffer.<a class="code hl_function" href="../../dd/d27/classsrsran_1_1baseband__gateway__buffer__dynamic.html#a8559899f828ab9d4ed93e08ce22cd56a">get_reader</a>(), 0, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_padding_samples</a>);</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>          <span class="keywordflow">if</span> (!transmit_block(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_padding</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_padding_sps_total</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>)) {</div>
<div class="line"><span class="lineno">  264</span>            printf(<span class="stringliteral">&quot;Error: failed transmitting power ramping padding. %s.\n&quot;</span>, get_error_message().c_str());</div>
<div class="line"><span class="lineno">  265</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  266</span>          }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>          <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">power_ramping_metadata</a>.time_spec += <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a> * srate_hz;</div>
<div class="line"><span class="lineno">  269</span>          <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_padding_sps_total</a> += <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a>;</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>        } <span class="keywordflow">while</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_padding_sps_total</a> &lt; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_padding_samples</a>);</div>
<div class="line"><span class="lineno">  272</span>      }</div>
<div class="line"><span class="lineno">  273</span>    }</div>
<div class="line"><span class="lineno">  274</span>  }</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>  <span class="comment">// Notify end of burst.</span></div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>.end_of_burst) {</div>
<div class="line"><span class="lineno">  278</span>    <a class="code hl_struct" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html">radio_notification_handler::event_description</a> event_description;</div>
<div class="line"><span class="lineno">  279</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a3f49f91a7ca868389088332fd4a16386">stream_id</a>  = stream_id;</div>
<div class="line"><span class="lineno">  280</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a580d960a54861ba14530a9e6ffb077d9">channel_id</a> = 0;</div>
<div class="line"><span class="lineno">  281</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#af4d280f079f4f65848159b4858dd245d">source</a>     = <a class="code hl_enumvalue" href="../../db/d79/classsrsran_1_1radio__notification__handler_1_1event__source.html#a7f23df937678f1d803ac52f8af7d91b3a149b528ca682d08b0e3789e03d050fd8">radio_notification_handler::event_source::TRANSMIT</a>;</div>
<div class="line"><span class="lineno">  282</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a1482c13a2ae59d37645e16c95165a630">type</a>       = <a class="code hl_enumvalue" href="../../d1/d66/classsrsran_1_1radio__notification__handler_1_1event__type.html#ada92c8b313b55717e4f4f4be58a1ab58a255d970f7b22582d202136011c492b37">radio_notification_handler::event_type::END_OF_BURST</a>;</div>
<div class="line"><span class="lineno">  283</span>    event_description.<a class="code hl_variable" href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a795d0b5dda3e26354a1150841b702641">timestamp</a>.<a class="code hl_function" href="../../d1/d57/classsrsran_1_1optional.html#ace23a99aaa630fa921abca90844f8bb3">emplace</a>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a>.to_ticks(srate_hz));</div>
<div class="line"><span class="lineno">  284</span>    notifier.<a class="code hl_function" href="../../d4/d40/classsrsran_1_1radio__notification__handler.html#a8b4a990b42877a8054ac67c85543c541">on_radio_rt_event</a>(event_description);</div>
<div class="line"><span class="lineno">  285</span>  }</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>  <span class="comment">// Determine actual transmission range.</span></div>
<div class="line"><span class="lineno">  288</span>  <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">data_start</a> = discontinuous_tx &amp;&amp; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_start_padding</a> ? <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.tx_start.value() : 0;</div>
<div class="line"><span class="lineno">  289</span>  <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">data_nof_samples</a> =</div>
<div class="line"><span class="lineno">  290</span>      discontinuous_tx &amp;&amp; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_end_padding</a> ? <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.tx_end.value() - <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">data_start</a> : data.get_nof_samples() - <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">data_start</a>;</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>  <span class="comment">// Don&#39;t pass the transmission data to UHD if the transmit buffer is empty.</span></div>
<div class="line"><span class="lineno">  293</span>  <a class="code hl_class" href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html">baseband_gateway_buffer_reader_view</a> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_data</a> =</div>
<div class="line"><span class="lineno">  294</span>      discontinuous_tx &amp;&amp; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_md</a>.is_empty ? <a class="code hl_class" href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html">baseband_gateway_buffer_reader_view</a>(data, 0, 0)</div>
<div class="line"><span class="lineno">  295</span>                                         : <a class="code hl_class" href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html">baseband_gateway_buffer_reader_view</a>(data, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">data_start</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">data_nof_samples</a>);</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>  <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nsamples</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_data</a>.<a class="code hl_function" href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html#a4471be1f5b3f68a86cd60770b0982628">get_nof_samples</a>();</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>  <span class="comment">// Transmit stream in multiple blocks.</span></div>
<div class="line"><span class="lineno">  300</span>  <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples_total</a> = 0;</div>
<div class="line"><span class="lineno">  301</span>  <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a> = 0;</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">if</span> (!transmit_block(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">tx_data</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples_total</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>)) {</div>
<div class="line"><span class="lineno">  304</span>      printf(<span class="stringliteral">&quot;Error: failed transmitting packet. %s.\n&quot;</span>, get_error_message().c_str());</div>
<div class="line"><span class="lineno">  305</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  306</span>    }</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="comment">// Increment timespec.</span></div>
<div class="line"><span class="lineno">  309</span>    <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">uhd_metadata</a>.time_spec += <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a> * srate_hz;</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="comment">// Increment the total amount of received samples.</span></div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples_total</a> += <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples</a>;</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>  } <span class="keywordflow">while</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples_total</a> &lt; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nsamples</a>);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  last_tx_timespec = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">time_spec</a> + uhd::time_spec_t::from_ticks(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">txd_samples_total</a>, srate_hz);</div>
<div class="line"><span class="lineno">  317</span>}</div>
<div class="ttc" id="aclasssrsran_1_1baseband__gateway__buffer__dynamic_html_a8559899f828ab9d4ed93e08ce22cd56a"><div class="ttname"><a href="../../dd/d27/classsrsran_1_1baseband__gateway__buffer__dynamic.html#a8559899f828ab9d4ed93e08ce22cd56a">srsran::baseband_gateway_buffer_dynamic::get_reader</a></div><div class="ttdeci">const baseband_gateway_buffer_reader &amp; get_reader() const</div><div class="ttdoc">Gets the reader interface.</div><div class="ttdef"><b>Definition</b> baseband_gateway_buffer_dynamic.h:108</div></div>
<div class="ttc" id="aclasssrsran_1_1baseband__gateway__buffer__reader__view_html"><div class="ttname"><a href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html">srsran::baseband_gateway_buffer_reader_view</a></div><div class="ttdoc">Implements a baseband gateway buffer reader view based on another reader.</div><div class="ttdef"><b>Definition</b> baseband_gateway_buffer_reader_view.h:33</div></div>
<div class="ttc" id="aclasssrsran_1_1baseband__gateway__buffer__reader__view_html_a4471be1f5b3f68a86cd60770b0982628"><div class="ttname"><a href="../../d5/d5b/classsrsran_1_1baseband__gateway__buffer__reader__view.html#a4471be1f5b3f68a86cd60770b0982628">srsran::baseband_gateway_buffer_reader_view::get_nof_samples</a></div><div class="ttdeci">unsigned get_nof_samples() const override</div><div class="ttdoc">Gets the number of samples.</div><div class="ttdef"><b>Definition</b> baseband_gateway_buffer_reader_view.h:55</div></div>
<div class="ttc" id="aclasssrsran_1_1optional_html_ace23a99aaa630fa921abca90844f8bb3"><div class="ttname"><a href="../../d1/d57/classsrsran_1_1optional.html#ace23a99aaa630fa921abca90844f8bb3">srsran::optional::emplace</a></div><div class="ttdeci">constexpr T &amp; emplace(Args &amp;&amp;... args) noexcept(std::is_nothrow_constructible&lt; T, Args... &gt;::value)</div><div class="ttdoc">Constructs a new object of type T inside the optional&lt;T&gt;'s storage, and sets the optional state to no...</div><div class="ttdef"><b>Definition</b> optional.h:336</div></div>
<div class="ttc" id="aclasssrsran_1_1radio__notification__handler_1_1event__type_html_ada92c8b313b55717e4f4f4be58a1ab58a1ffc0a168c5d1746f80928dbfe6d0342"><div class="ttname"><a href="../../d1/d66/classsrsran_1_1radio__notification__handler_1_1event__type.html#ada92c8b313b55717e4f4f4be58a1ab58a1ffc0a168c5d1746f80928dbfe6d0342">srsran::radio_notification_handler::event_type::START_OF_BURST</a></div><div class="ttdeci">@ START_OF_BURST</div><div class="ttdoc">Indicates an start of a burst.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:90</div></div>
<div class="ttc" id="aclasssrsran_1_1radio__uhd__tx__stream__fsm_html_a0011309fb1566c196ca2e119f37b4994"><div class="ttname"><a href="../../da/db9/classsrsran_1_1radio__uhd__tx__stream__fsm.html#a0011309fb1566c196ca2e119f37b4994">srsran::radio_uhd_tx_stream_fsm::on_transmit</a></div><div class="ttdeci">bool on_transmit(uhd::tx_metadata_t &amp;metadata, uhd::time_spec_t &amp;time_spec, bool is_empty, bool tail_padding)</div><div class="ttdoc">Handles a new transmission.</div><div class="ttdef"><b>Definition</b> radio_uhd_tx_stream_fsm.h:111</div></div>
<div class="ttc" id="aclasssrsran_1_1radio__uhd__tx__stream_html_a877e375e9e38819603deba5ef1f8cc03"><div class="ttname"><a href="#a877e375e9e38819603deba5ef1f8cc03">srsran::radio_uhd_tx_stream::transmit</a></div><div class="ttdeci">void transmit(const baseband_gateway_buffer_reader &amp;data, const baseband_gateway_transmitter_metadata &amp;metadata) override</div><div class="ttdoc">Transmits a set of baseband samples at the time instant provided in the metadata.</div><div class="ttdef"><b>Definition</b> radio_uhd_tx_stream.cpp:192</div></div>
<div class="ttc" id="anamespacesrsran_html_a4057ba65348ba48e6202d60aea8e6235"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a4057ba65348ba48e6202d60aea8e6235">srsran::baseband_gateway_timestamp</a></div><div class="ttdeci">uint64_t baseband_gateway_timestamp</div><div class="ttdoc">Describes a baseband gateway timestamp. It is expressed in multiples of the sample time.</div><div class="ttdef"><b>Definition</b> baseband_gateway_timestamp.h:29</div></div>
<div class="ttc" id="astructsrsran_1_1radio__notification__handler_1_1event__description_html_a795d0b5dda3e26354a1150841b702641"><div class="ttname"><a href="../../de/d0e/structsrsran_1_1radio__notification__handler_1_1event__description.html#a795d0b5dda3e26354a1150841b702641">srsran::radio_notification_handler::event_description::timestamp</a></div><div class="ttdeci">optional&lt; uint64_t &gt; timestamp</div><div class="ttdoc">Optional - Event timestamp.</div><div class="ttdef"><b>Definition</b> radio_notification_handler.h:148</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaff45befebde956b712a35893c6ebdb0" name="aaff45befebde956b712a35893c6ebdb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaff45befebde956b712a35893c6ebdb0">&#9670;&#160;</a></span>wait_stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> radio_uhd_tx_stream::wait_stop </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait until radio is notify_stop. </p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>{</div>
<div class="line"><span class="lineno">  356</span>  state_fsm.wait_stop();</div>
<div class="line"><span class="lineno">  357</span>}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/radio/uhd/<a class="el" href="../../d7/dc7/radio__uhd__tx__stream_8h_source.html">radio_uhd_tx_stream.h</a></li>
<li>lib/radio/uhd/<b>radio_uhd_tx_stream.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
