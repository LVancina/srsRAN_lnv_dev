<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN Docs: lib/ofh/compression/avx2_helpers.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">srsRAN Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_d760f2ccf13f25eca8b78b31880d9d65.html">ofh</a></li><li class="navelem"><a class="el" href="dir_41fc22ec7441721c2ba1196fd9081e7a.html">compression</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">avx2_helpers.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>AVX2 support for OFH Compression algorithms.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;srsran/adt/span.h&quot;</code><br />
<code>#include &lt;immintrin.h&gt;</code><br />
</div>
<p><a href="ofh_2compression_2avx2__helpers_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacesrsran" id="r_namespacesrsran"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesrsran.html">srsran</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5a1f0973b49fa5684529c68848df1b76" id="r_a5a1f0973b49fa5684529c68848df1b76"><td class="memItemLeft" align="right" valign="top"><a id="a5a1f0973b49fa5684529c68848df1b76" name="a5a1f0973b49fa5684529c68848df1b76"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>srsran::ofh::mm256::_mm256_comparator</b> = __m256i (*)(__m256i a, __m256i b)</td></tr>
<tr class="memdesc:a5a1f0973b49fa5684529c68848df1b76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of AVX2 intrinsic calculating min or max values between two vectors. <br /></td></tr>
<tr class="separator:a5a1f0973b49fa5684529c68848df1b76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3680c47c967c06fbff65a00ac3ac5e0a" id="r_a3680c47c967c06fbff65a00ac3ac5e0a"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="#a5a1f0973b49fa5684529c68848df1b76">_mm256_comparator</a> COMPARE&gt; </td></tr>
<tr class="memitem:a3680c47c967c06fbff65a00ac3ac5e0a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a3680c47c967c06fbff65a00ac3ac5e0a">srsran::ofh::mm256::find_rbs_abs_min_max_values</a> (<a class="el" href="classsrsran_1_1span.html">span</a>&lt; uint16_t &gt; abs, __m256i v0_epi16, __m256i v1_epi16, __m256i v2_epi16)</td></tr>
<tr class="memdesc:a3680c47c967c06fbff65a00ac3ac5e0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the maximum (or minimum) 16bit sample in each of the two input resource blocks, returns its absolute value.  <br /></td></tr>
<tr class="separator:a3680c47c967c06fbff65a00ac3ac5e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1877ae3f8653c849ee2f0ba6708d79be" id="r_a1877ae3f8653c849ee2f0ba6708d79be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1877ae3f8653c849ee2f0ba6708d79be">srsran::ofh::mm256::calculate_max_abs</a> (<a class="el" href="classsrsran_1_1span.html">span</a>&lt; unsigned &gt; max_abs, __m256i rb0_epi16, __m256i rb01_epi16, __m256i rb1_epi16)</td></tr>
<tr class="memdesc:a1877ae3f8653c849ee2f0ba6708d79be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds maximum absolute value across 16bit IQ samples in each of the two input resource blocks passed in three AVX2 registers.  <br /></td></tr>
<tr class="separator:a1877ae3f8653c849ee2f0ba6708d79be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>AVX2 support for OFH Compression algorithms. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1877ae3f8653c849ee2f0ba6708d79be" name="a1877ae3f8653c849ee2f0ba6708d79be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1877ae3f8653c849ee2f0ba6708d79be">&#9670;&#160;</a></span>calculate_max_abs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void srsran::ofh::mm256::calculate_max_abs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsrsran_1_1span.html">span</a>&lt; unsigned &gt;</td>          <td class="paramname"><span class="paramname"><em>max_abs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__m256i</td>          <td class="paramname"><span class="paramname"><em>rb0_epi16</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__m256i</td>          <td class="paramname"><span class="paramname"><em>rb01_epi16</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__m256i</td>          <td class="paramname"><span class="paramname"><em>rb1_epi16</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds maximum absolute value across 16bit IQ samples in each of the two input resource blocks passed in three AVX2 registers. </p>
<p>The content of the three input AVX2 registers is represented in the table below. Here RBx means one unique RE (pair of IQ samples, 32 bits long) pertaining to a respective RB: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>rb0_epi16:</code>   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>rb01_epi16:</code>   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>rb1_epi16:</code>   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">max_abs</td><td>A span of two maximum absolute values in the two input RBs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rb0_epi16</td><td>AVX2 register storing 16bit IQ pairs of the first RB. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rb01_epi16</td><td>AVX2 register storing 16bit IQ pairs of the first and second RBs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rb1_epi16</td><td>AVX2 register storing 16bit IQ pairs of the second RB. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3680c47c967c06fbff65a00ac3ac5e0a" name="a3680c47c967c06fbff65a00ac3ac5e0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3680c47c967c06fbff65a00ac3ac5e0a">&#9670;&#160;</a></span>find_rbs_abs_min_max_values()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;_mm256_comparator COMPARE&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void srsran::ofh::mm256::find_rbs_abs_min_max_values </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsrsran_1_1span.html">span</a>&lt; uint16_t &gt;</td>          <td class="paramname"><span class="paramname"><em>abs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__m256i</td>          <td class="paramname"><span class="paramname"><em>v0_epi16</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__m256i</td>          <td class="paramname"><span class="paramname"><em>v1_epi16</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__m256i</td>          <td class="paramname"><span class="paramname"><em>v2_epi16</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the maximum (or minimum) 16bit sample in each of the two input resource blocks, returns its absolute value. </p>
<p>Finds absolute maximum (or minimum, depending on the comparator passed as the template argument) values for each of the two RBs passed in a three AVX2 registers.</p>
<p>Registers are evenly divided between two RBs so that IQ samples of each RB occupy one 128bit lane. The following diagram shows the input format. Here RBx stands for one unique RE (a pair of IQ samples, 32 bits long) pertaining to a respective RB: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>v0_epi16:</code>   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>v1_epi16:</code>   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>v2_epi16:</code>   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB0 RB0   </td><td class="markdownTableBodyNone">RB1 RB1   </td><td class="markdownTableBodyNone">RB1 RB1   </td></tr>
</table>
<p>The function first performs vertical min/max search across the three registers (comparing 16bit samples), then horizontal min/max across elements in each 128bit lane of the resulting vector. Finally, the function takes the absolute value of the two 16bit samples computed thus far and stores them in the output span.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">COMPARE</td><td>AVX2 intrinsic used for comparison, either <code>mm256_min_epi16</code> or <code>_mm256_max_epi16</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">abs</td><td>A span of two absolute values of max (or min) samples in each of the two input RBs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v0_epi16</td><td>AVX2 register storing first four IQ pairs of each of the two RB. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v1_epi16</td><td>AVX2 register storing second four IQ pairs of each of the two RB. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v2_epi16</td><td>AVX2 register storing last four IQ pairs of each of the two RB. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
