<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN Docs: tests/benchmarks/du_high/du_high_benchmark.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">srsRAN Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li><li class="navelem"><a class="el" href="dir_14398671fc603a1b127bf8041b444913.html">benchmarks</a></li><li class="navelem"><a class="el" href="dir_bd8f639c9397cb21fc1eeb3168ac1f30.html">du_high</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">du_high_benchmark.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Benchmarks for the DU-high latency.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;lib/du_high/du_high_executor_strategies.h&quot;</code><br />
<code>#include &quot;lib/du_high/du_high_impl.h&quot;</code><br />
<code>#include &quot;tests/unittests/f1ap/du/f1ap_du_test_helpers.h&quot;</code><br />
<code>#include &quot;tests/unittests/mac/mac_test_helpers.h&quot;</code><br />
<code>#include &quot;srsran/asn1/f1ap/common.h&quot;</code><br />
<code>#include &quot;srsran/du/du_cell_config_helpers.h&quot;</code><br />
<code>#include &quot;srsran/du_high/du_high_configuration.h&quot;</code><br />
<code>#include &quot;srsran/f1u/du/f1u_gateway.h&quot;</code><br />
<code>#include &quot;srsran/support/benchmark_utils.h&quot;</code><br />
<code>#include &quot;srsran/support/event_tracing.h&quot;</code><br />
<code>#include &quot;srsran/support/executors/priority_task_worker.h&quot;</code><br />
<code>#include &quot;srsran/support/executors/task_worker.h&quot;</code><br />
<code>#include &quot;srsran/support/test_utils.h&quot;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbench__params.html">bench_params</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters of the benchmark.  <a href="structbench__params.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdummy__metrics__handler.html">dummy_metrics_handler</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcu__cp__simulator.html">cu_cp_simulator</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulator of the CU-CP from the perspective of the DU. This class should reply to the F1AP messages that the DU sends in order for the DU normal operation to proceed.  <a href="classcu__cp__simulator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classf1u__dummy__bearer.html">f1u_dummy_bearer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy F1-U bearer for the purpose of benchmark.  <a href="classf1u__dummy__bearer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcu__up__simulator.html">cu_up_simulator</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulator of the CU-UP from the perspective of the DU.  <a href="classcu__up__simulator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdu__high__single__cell__worker__manager.html">du_high_single_cell_worker_manager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instantiation of the DU-high workers and executors for the benchmark.  <a href="structdu__high__single__cell__worker__manager.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structphy__metrics.html">phy_metrics</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Metrics collected from the results passed by the MAC to the lower layers.  <a href="structphy__metrics.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphy__simulator.html">phy_simulator</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Emulator of the PHY, FAPI and UE from the perspective of the DU-high. This class should be able to provide the required UE signalling (e.g. HARQ ACKs) for the DU-high normal operation.  <a href="classphy__simulator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdu__high__bench.html">du_high_bench</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">TestBench for the DU-high.  <a href="classdu__high__bench.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6675febfac81170d9943c7e217242bd8" id="r_a6675febfac81170d9943c7e217242bd8"><td class="memItemLeft" align="right" valign="top"><a id="a6675febfac81170d9943c7e217242bd8" name="a6675febfac81170d9943c7e217242bd8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>benchmark_dl_ul_only_rlc_um</b> (<a class="el" href="classsrsran_1_1benchmarker.html">benchmarker</a> &amp;bm, unsigned nof_ues, <a class="el" href="namespacesrsran.html#a7c254965b53e3067931191bc7eda18ac">duplex_mode</a> dplx_mode, unsigned dl_buffer_state_bytes, unsigned ul_bsr_bytes, unsigned max_nof_rbs_per_dl_grant, <a class="el" href="classsrsran_1_1span.html">span</a>&lt; unsigned &gt; du_cell_cores)</td></tr>
<tr class="memdesc:a6675febfac81170d9943c7e217242bd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Benchmark DU-high with DL and/or UL only traffic using an RLC UM bearer. <br /></td></tr>
<tr class="separator:a6675febfac81170d9943c7e217242bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627" id="r_a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top"><a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Benchmarks for the DU-high latency. </p>
<p>In this benchmark, we emulate the behaviors of the CU-CP, CU-UP and PHY in order to simulate a realistic deployment of the instantiated DU-high class. However, there are some simplifications:</p><ul>
<li>the PHY is emulated by a single thread, rather than by separate threads for DL PHY, UL PHY, and slot indications. In practice, this may lead to less contention faced by the notifications of the PHY that reach the MAC.</li>
<li>metrics handlers and E2 agents are instantiated separately from the DU-high class. If these entities have blocking calls, such as mutexes, they may introduce additional latency.</li>
<li>Complicated CU-CP procedures (e.g. reconfig) and their impact on the MAC latency are left out of this benchmark.</li>
<li>The UP traffic is continuous rather than bursty.</li>
<li>The activity of higher priority threads, namely DL PHY and RU threads are not emulated. This will mean that the DU-high threads will be preempted less often than in a real deployment. To circumvent it, we can run a parallel stress job in the same machine. For instance, to run stressors that solely interfere with the gnb_ue and gnb_ctrl threads (and not with the du_cell thread), one can run: <blockquote class="doxtable">
<p>&zwj;sudo stress-ng &ndash;cpu 6 &ndash;taskset 2-7 &ndash;sched fifo &ndash;sched-prio 97 -l 90 </p>
</blockquote>
which will instantiate 6 threads running in cores 2-7 (assuming du_cell is pinned to 0-1), with high priority and a CPU load of 90%. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
