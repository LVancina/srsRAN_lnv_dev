<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN Docs: srsran::fapi_adaptor::fapi_to_phy_translator Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">srsRAN Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/def/namespacesrsran.html">srsran</a></li><li class="navelem"><b>fapi_adaptor</b></li><li class="navelem"><a class="el" href="../../d3/d3f/classsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator.html">fapi_to_phy_translator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../d2/d75/classsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">srsran::fapi_adaptor::fapi_to_phy_translator Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>FAPI-to-PHY message translator.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d0/d55/fapi__to__phy__translator_8h_source.html">fapi_to_phy_translator.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for srsran::fapi_adaptor::fapi_to_phy_translator:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/df8/classsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__inherit__graph.png" border="0" usemap="#asrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator_inherit__map" alt="Inheritance graph"/></div>
<map name="asrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator_inherit__map" id="asrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator_inherit__map">
<area shape="rect" title="FAPI&#45;to&#45;PHY message translator." alt="" coords="14,213,199,428"/>
<area shape="rect" href="../../dc/dee/classsrsran_1_1fapi_1_1slot__message__gateway.html" title="This interface represents the gateway for sending FAPI slot based messages to the underlying PHY." alt="" coords="5,5,208,165"/>
<area shape="poly" title=" " alt="" coords="109,179,109,213,104,213,104,179"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for srsran::fapi_adaptor::fapi_to_phy_translator:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d79/classsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__coll__graph.png" border="0" usemap="#asrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator_coll__map" alt="Collaboration graph"/></div>
<map name="asrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator_coll__map" id="asrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator_coll__map">
<area shape="rect" title="FAPI&#45;to&#45;PHY message translator." alt="" coords="14,213,199,428"/>
<area shape="rect" href="../../dc/dee/classsrsran_1_1fapi_1_1slot__message__gateway.html" title="This interface represents the gateway for sending FAPI slot based messages to the underlying PHY." alt="" coords="5,5,208,165"/>
<area shape="poly" title=" " alt="" coords="109,179,109,213,104,213,104,179"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afdb56eb6020edad22d58db0d2e2f5793" id="r_afdb56eb6020edad22d58db0d2e2f5793"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afdb56eb6020edad22d58db0d2e2f5793">fapi_to_phy_translator</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html">fapi_to_phy_translator_config</a> &amp;config, <a class="el" href="../../dd/d75/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__dependencies.html">fapi_to_phy_translator_dependencies</a> &amp;&amp;<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>)</td></tr>
<tr class="separator:afdb56eb6020edad22d58db0d2e2f5793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff16ea9b0c27d5279edb644296e00530" id="r_aff16ea9b0c27d5279edb644296e00530"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff16ea9b0c27d5279edb644296e00530">dl_tti_request</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d9/d26/structsrsran_1_1fapi_1_1dl__tti__request__message.html">fapi::dl_tti_request_message</a> &amp;msg) <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">override</a></td></tr>
<tr class="memdesc:aff16ea9b0c27d5279edb644296e00530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a downlink TTI request message.  <br /></td></tr>
<tr class="separator:aff16ea9b0c27d5279edb644296e00530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaf761a8eac47d983c64cee5ce5f577e" id="r_adaf761a8eac47d983c64cee5ce5f577e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adaf761a8eac47d983c64cee5ce5f577e">ul_tti_request</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../dd/d88/structsrsran_1_1fapi_1_1ul__tti__request__message.html">fapi::ul_tti_request_message</a> &amp;msg) <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">override</a></td></tr>
<tr class="memdesc:adaf761a8eac47d983c64cee5ce5f577e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends an uplink TTI request message.  <br /></td></tr>
<tr class="separator:adaf761a8eac47d983c64cee5ce5f577e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda731523131cee6da7a8cd2cfbd9d1d" id="r_acda731523131cee6da7a8cd2cfbd9d1d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acda731523131cee6da7a8cd2cfbd9d1d">ul_dci_request</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d3/da0/structsrsran_1_1fapi_1_1ul__dci__request__message.html">fapi::ul_dci_request_message</a> &amp;msg) <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">override</a></td></tr>
<tr class="memdesc:acda731523131cee6da7a8cd2cfbd9d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends an uplink DCI request message.  <br /></td></tr>
<tr class="separator:acda731523131cee6da7a8cd2cfbd9d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93eb39a0b5b3da625d4b9c98d19dbf7c" id="r_a93eb39a0b5b3da625d4b9c98d19dbf7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93eb39a0b5b3da625d4b9c98d19dbf7c">tx_data_request</a> (<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d5/d5f/structsrsran_1_1fapi_1_1tx__data__request__message.html">fapi::tx_data_request_message</a> &amp;msg) <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">override</a></td></tr>
<tr class="memdesc:a93eb39a0b5b3da625d4b9c98d19dbf7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a TX data request message.  <br /></td></tr>
<tr class="separator:a93eb39a0b5b3da625d4b9c98d19dbf7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbabd23e0c88bc437f7bbe1f2483372" id="r_acbbabd23e0c88bc437f7bbe1f2483372"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acbbabd23e0c88bc437f7bbe1f2483372">handle_new_slot</a> (<a class="el" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a> <a class="el" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>)</td></tr>
<tr class="memdesc:acbbabd23e0c88bc437f7bbe1f2483372"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles a new slot.  <br /></td></tr>
<tr class="separator:acbbabd23e0c88bc437f7bbe1f2483372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923923123c04b367cd544f3de1c9e58e" id="r_a923923123c04b367cd544f3de1c9e58e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a923923123c04b367cd544f3de1c9e58e">set_slot_error_message_notifier</a> (<a class="el" href="../../d5/d63/classsrsran_1_1fapi_1_1slot__error__message__notifier.html">fapi::slot_error_message_notifier</a> &amp;<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">fapi_error_notifier</a>)</td></tr>
<tr class="memdesc:a923923123c04b367cd544f3de1c9e58e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the FAPI slot-based, error-specific notifier to the given one.  <br /></td></tr>
<tr class="separator:a923923123c04b367cd544f3de1c9e58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>FAPI-to-PHY message translator. </p>
<p>This class receives slot-based FAPI messages and translates them into PHY specific data types, which can then be processed by the upper PHY.</p>
<p>Translating and processing slot-based FAPI messages involves converting them to the suitable data types for the PHY layer, validation of the contents for each incoming message and selecting and reserving resources in the upper PHY to process the messages.</p>
<dl class="section note"><dt>Note</dt><dd>This class is thread safe and allows calling the <a class="el" href="#acbbabd23e0c88bc437f7bbe1f2483372">handle_new_slot</a> method and the message handlers from different threads. </dd>
<dd>
The translator assumes that only one message of each type can be received within a slot. Receiving multiple messages of the same type in one slot results in undefined behavior. </dd>
<dd>
The translator is designed to work for a sector and subcarrier spacing. Supporting more than one sector and/or subcarrier spacing will require more instances of the translator. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afdb56eb6020edad22d58db0d2e2f5793" name="afdb56eb6020edad22d58db0d2e2f5793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdb56eb6020edad22d58db0d2e2f5793">&#9670;&#160;</a></span>fapi_to_phy_translator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fapi_to_phy_translator::fapi_to_phy_translator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html">fapi_to_phy_translator_config</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d75/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__dependencies.html">fapi_to_phy_translator_dependencies</a> &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>dependencies</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   85</span>                                                                                                   :</div>
<div class="line"><span class="lineno">   86</span>  sector_id(config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#a5dbccec12901fd96d0e32c3e71aa138a">sector_id</a>),</div>
<div class="line"><span class="lineno">   87</span>  nof_slots_request_headroom(config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ab643bbd93aed1404cb2a5c64d741b1cd">nof_slots_request_headroom</a>),</div>
<div class="line"><span class="lineno">   88</span>  logger(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.logger),</div>
<div class="line"><span class="lineno">   89</span>  dl_pdu_validator(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.dl_pdu_validator),</div>
<div class="line"><span class="lineno">   90</span>  ul_request_processor(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.ul_request_processor),</div>
<div class="line"><span class="lineno">   91</span>  ul_rg_pool(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.ul_rg_pool),</div>
<div class="line"><span class="lineno">   92</span>  ul_pdu_validator(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.ul_pdu_validator),</div>
<div class="line"><span class="lineno">   93</span>  ul_pdu_repository(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.ul_pdu_repository),</div>
<div class="line"><span class="lineno">   94</span>  slot_controller_mngr(*<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.dl_processor_pool,</div>
<div class="line"><span class="lineno">   95</span>                       *<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.dl_rg_pool,</div>
<div class="line"><span class="lineno">   96</span>                       sector_id,</div>
<div class="line"><span class="lineno">   97</span>                       config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ab643bbd93aed1404cb2a5c64d741b1cd">nof_slots_request_headroom</a>),</div>
<div class="line"><span class="lineno">   98</span>  pm_repo(std::move(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.pm_repo)),</div>
<div class="line"><span class="lineno">   99</span>  part2_repo(std::move(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dependencies</a>.part2_repo)),</div>
<div class="line"><span class="lineno">  100</span>  error_notifier(dummy_error_notifier),</div>
<div class="line"><span class="lineno">  101</span>  scs(config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ae2d3f2a330e06db42a94143f2d4f62de">scs</a>),</div>
<div class="line"><span class="lineno">  102</span>  scs_common(config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ac1444b431f87239690a260872f275d31">scs_common</a>),</div>
<div class="line"><span class="lineno">  103</span>  prach_cfg(*config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#a1012f6e360f5023d58d17ed09827a2e2">prach_cfg</a>),</div>
<div class="line"><span class="lineno">  104</span>  carrier_cfg(*config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#a4ae3eb5c29f5c215353b5a92dcf6c8af">carrier_cfg</a>),</div>
<div class="line"><span class="lineno">  105</span>  prach_ports(config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#af2a3a84a6078f600c25fbe8a47157107">prach_ports</a>.begin(), config.<a class="code hl_variable" href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#af2a3a84a6078f600c25fbe8a47157107">prach_ports</a>.end())</div>
<div class="line"><span class="lineno">  106</span>{</div>
<div class="line"><span class="lineno">  107</span>  srsran_assert(pm_repo, <span class="stringliteral">&quot;Invalid precoding matrix repository&quot;</span>);</div>
<div class="line"><span class="lineno">  108</span>  srsran_assert(part2_repo, <span class="stringliteral">&quot;Invalid UCI Part2 repository&quot;</span>);</div>
<div class="line"><span class="lineno">  109</span>  srsran_assert(!prach_ports.empty(), <span class="stringliteral">&quot;The PRACH ports must not be empty.&quot;</span>);</div>
<div class="line"><span class="lineno">  110</span>}</div>
<div class="ttc" id="anamespacesrsran_html_a58e7c9f2c51a9ad6a0899b46d5315723"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">srsran::mask_msb_ones</a></div><div class="ttdeci">constexpr Integer mask_msb_ones(size_t N)</div><div class="ttdoc">Returns an unsigned integer with the N most significant bits (MSB) set to one, and the remaining bits...</div><div class="ttdef"><b>Definition</b> bounded_bitset.h:65</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_a1012f6e360f5023d58d17ed09827a2e2"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#a1012f6e360f5023d58d17ed09827a2e2">srsran::fapi_adaptor::fapi_to_phy_translator_config::prach_cfg</a></div><div class="ttdeci">const fapi::prach_config * prach_cfg</div><div class="ttdoc">FAPI PRACH configuration TLV as per SCF-222 v4.0 section 3.3.2.4.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:57</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_a4ae3eb5c29f5c215353b5a92dcf6c8af"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#a4ae3eb5c29f5c215353b5a92dcf6c8af">srsran::fapi_adaptor::fapi_to_phy_translator_config::carrier_cfg</a></div><div class="ttdeci">const fapi::carrier_config * carrier_cfg</div><div class="ttdoc">FAPI carrier configuration TLV as per SCF-222 v4.0 section 3.3.2.4.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:59</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_a5dbccec12901fd96d0e32c3e71aa138a"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#a5dbccec12901fd96d0e32c3e71aa138a">srsran::fapi_adaptor::fapi_to_phy_translator_config::sector_id</a></div><div class="ttdeci">unsigned sector_id</div><div class="ttdoc">Base station sector identifier.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:49</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_ab643bbd93aed1404cb2a5c64d741b1cd"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ab643bbd93aed1404cb2a5c64d741b1cd">srsran::fapi_adaptor::fapi_to_phy_translator_config::nof_slots_request_headroom</a></div><div class="ttdeci">unsigned nof_slots_request_headroom</div><div class="ttdoc">Request headroom size in slots.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:51</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_ac1444b431f87239690a260872f275d31"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ac1444b431f87239690a260872f275d31">srsran::fapi_adaptor::fapi_to_phy_translator_config::scs_common</a></div><div class="ttdeci">subcarrier_spacing scs_common</div><div class="ttdoc">Common subcarrier spacing as per TS38.331 Section 6.2.2.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:55</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_ae2d3f2a330e06db42a94143f2d4f62de"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#ae2d3f2a330e06db42a94143f2d4f62de">srsran::fapi_adaptor::fapi_to_phy_translator_config::scs</a></div><div class="ttdeci">subcarrier_spacing scs</div><div class="ttdoc">Subcarrier spacing as per TS38.211 Section 4.2.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:53</div></div>
<div class="ttc" id="astructsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config_html_af2a3a84a6078f600c25fbe8a47157107"><div class="ttname"><a href="../../d2/d9b/structsrsran_1_1fapi__adaptor_1_1fapi__to__phy__translator__config.html#af2a3a84a6078f600c25fbe8a47157107">srsran::fapi_adaptor::fapi_to_phy_translator_config::prach_ports</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; prach_ports</div><div class="ttdoc">PRACH port list.</div><div class="ttdef"><b>Definition</b> fapi_to_phy_translator.h:61</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aff16ea9b0c27d5279edb644296e00530" name="aff16ea9b0c27d5279edb644296e00530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff16ea9b0c27d5279edb644296e00530">&#9670;&#160;</a></span>dl_tti_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> fapi_to_phy_translator::dl_tti_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d9/d26/structsrsran_1_1fapi_1_1dl__tti__request__message.html">fapi::dl_tti_request_message</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends a downlink TTI request message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Message contents. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="../../dc/dee/classsrsran_1_1fapi_1_1slot__message__gateway.html#ac0393eaddf0f8a34c1d543866a636779">srsran::fapi::slot_message_gateway</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  288</span>{</div>
<div class="line"><span class="lineno">  289</span>  <span class="comment">// :TODO: check the current slot matches the DL_TTI.request slot. Do this in a different class.</span></div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">// :TODO: check the messages order. Do this in a different class.</span></div>
<div class="line"><span class="lineno">  291</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>  <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>(scs, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  292</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>  current_slot = get_current_slot();</div>
<div class="line"><span class="lineno">  293</span>  trace_point tp           = <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a>.now();</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>  <span class="keywordflow">if</span> (!pdsch_repository.empty()) {</div>
<div class="line"><span class="lineno">  296</span>    logger.warning(</div>
<div class="line"><span class="lineno">  297</span>        <span class="stringliteral">&quot;Could not process &#39;{}&#39; PDSCH PDUs from the slot &#39;{}&#39;&quot;</span>, pdsch_repository.pdus.size(), pdsch_repository.slot);</div>
<div class="line"><span class="lineno">  298</span>  }</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>  <span class="comment">// Reset the repository.</span></div>
<div class="line"><span class="lineno">  301</span>  pdsch_repository.reset(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>  <span class="comment">// Release the controller of the previous slot in case that it has not been released before. In case that it already</span></div>
<div class="line"><span class="lineno">  304</span>  <span class="comment">// is released, this call will do nothing.</span></div>
<div class="line"><span class="lineno">  305</span>  slot_controller_mngr.release_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a> - 1);</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>  <span class="comment">// Ignore messages that do not correspond to the current slot.</span></div>
<div class="line"><span class="lineno">  308</span>  <span class="keywordflow">if</span> (!is_message_in_time(msg)) {</div>
<div class="line"><span class="lineno">  309</span>    logger.warning(<span class="stringliteral">&quot;Real-time failure in FAPI: Received late DL_TTI.request from slot {}.{}&quot;</span>, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  310</span>    <span class="comment">// Raise out of sync error.</span></div>
<div class="line"><span class="lineno">  311</span>    error_notifier.get().on_error_indication(fapi::build_out_of_sync_error_indication(</div>
<div class="line"><span class="lineno">  312</span>        msg.sfn, msg.slot, fapi::message_type_id::dl_tti_request, current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a19d7b2faaa1fcc74f3d01560339f7602">sfn</a>(), current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a1808c0aeecc25d6382e49511028c010e">slot_index</a>()));</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a5a81707cbe1f17f0d69414f9c7acb227">l2_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d0/dd4/structsrsran_1_1instant__trace__event.html">instant_trace_event</a>{<span class="stringliteral">&quot;dl_tti_req_late&quot;</span>, instant_trace_event::cpu_scope::global};</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  315</span>  }</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  <span class="comment">// Create controller for the current slot.</span></div>
<div class="line"><span class="lineno">  318</span>  slot_based_upper_phy_controller&amp; controller = slot_controller_mngr.acquire_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>  <span class="comment">// Translate the downlink PDUs.</span></div>
<div class="line"><span class="lineno">  321</span>  <a class="code hl_class" href="../../d5/dea/classsrsran_1_1expected.html">expected&lt;downlink_pdus&gt;</a> pdus = translate_dl_tti_pdus_to_phy_pdus(</div>
<div class="line"><span class="lineno">  322</span>      msg, dl_pdu_validator, logger, scs_common, carrier_cfg.dl_grid_size[<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a226e52de355262a1ad4e998b4cedefd7">to_numerology_value</a>(scs_common)], *pm_repo);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  <span class="comment">// Raise invalid format error.</span></div>
<div class="line"><span class="lineno">  325</span>  <span class="keywordflow">if</span> (!pdus.has_value()) {</div>
<div class="line"><span class="lineno">  326</span>    error_notifier.get().on_error_indication(</div>
<div class="line"><span class="lineno">  327</span>        fapi::build_msg_slot_error_indication(msg.sfn, msg.slot, fapi::message_type_id::dl_tti_request));</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  329</span>  }</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">// Process the PDUs.</span></div>
<div class="line"><span class="lineno">  332</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ssb : pdus.value().ssb) {</div>
<div class="line"><span class="lineno">  333</span>    controller-&gt;process_ssb(ssb);</div>
<div class="line"><span class="lineno">  334</span>  }</div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pdcch : pdus.value().pdcch) {</div>
<div class="line"><span class="lineno">  336</span>    controller-&gt;process_pdcch(pdcch);</div>
<div class="line"><span class="lineno">  337</span>  }</div>
<div class="line"><span class="lineno">  338</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; csi : pdus.value().csi_rs) {</div>
<div class="line"><span class="lineno">  339</span>    controller-&gt;process_nzp_csi_rs(csi);</div>
<div class="line"><span class="lineno">  340</span>  }</div>
<div class="line"><span class="lineno">  341</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pdsch : pdus.value().pdsch) {</div>
<div class="line"><span class="lineno">  342</span>    pdsch_repository.pdus.push_back(pdsch);</div>
<div class="line"><span class="lineno">  343</span>  }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>  <span class="keywordflow">if</span> (msg.<a class="code hl_variable" href="../../d9/d26/structsrsran_1_1fapi_1_1dl__tti__request__message.html#aebee6045acbc5f6f1c1ba8f45c143303">is_last_message_in_slot</a>) {</div>
<div class="line"><span class="lineno">  346</span>    srsran_assert(pdsch_repository.empty(),</div>
<div class="line"><span class="lineno">  347</span>                  <span class="stringliteral">&quot;The DL_TTI.request message in slot &#39;{}&#39; has been marked as the last message in the slot, but a &quot;</span></div>
<div class="line"><span class="lineno">  348</span>                  <span class="stringliteral">&quot;TX_Data.request message is also being expected&quot;</span>,</div>
<div class="line"><span class="lineno">  349</span>                  <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  350</span>    slot_controller_mngr.release_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  351</span>  }</div>
<div class="line"><span class="lineno">  352</span>  <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d7/daa/structsrsran_1_1trace__event.html">trace_event</a>(<span class="stringliteral">&quot;dl_tti_request&quot;</span>, tp);</div>
<div class="line"><span class="lineno">  353</span>}</div>
<div class="ttc" id="aclasssrsran_1_1expected_html"><div class="ttname"><a href="../../d5/dea/classsrsran_1_1expected.html">srsran::expected</a></div><div class="ttdef"><b>Definition</b> expected.h:51</div></div>
<div class="ttc" id="aclasssrsran_1_1slot__point_html"><div class="ttname"><a href="../../df/d3c/classsrsran_1_1slot__point.html">srsran::slot_point</a></div><div class="ttdef"><b>Definition</b> slot_point.h:51</div></div>
<div class="ttc" id="aclasssrsran_1_1slot__point_html_a1808c0aeecc25d6382e49511028c010e"><div class="ttname"><a href="../../df/d3c/classsrsran_1_1slot__point.html#a1808c0aeecc25d6382e49511028c010e">srsran::slot_point::slot_index</a></div><div class="ttdeci">constexpr uint32_t slot_index() const</div><div class="ttdef"><b>Definition</b> slot_point.h:115</div></div>
<div class="ttc" id="aclasssrsran_1_1slot__point_html_a19d7b2faaa1fcc74f3d01560339f7602"><div class="ttname"><a href="../../df/d3c/classsrsran_1_1slot__point.html#a19d7b2faaa1fcc74f3d01560339f7602">srsran::slot_point::sfn</a></div><div class="ttdeci">constexpr uint32_t sfn() const</div><div class="ttdoc">Radio Frame Number. Value: (0..1023).</div><div class="ttdef"><b>Definition</b> slot_point.h:118</div></div>
<div class="ttc" id="anamespacesrsran_html_a226e52de355262a1ad4e998b4cedefd7"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a226e52de355262a1ad4e998b4cedefd7">srsran::to_numerology_value</a></div><div class="ttdeci">constexpr unsigned to_numerology_value(subcarrier_spacing scs)</div><div class="ttdoc">Convert SCS to numerology index ( ).</div><div class="ttdef"><b>Definition</b> subcarrier_spacing.h:50</div></div>
<div class="ttc" id="anamespacesrsran_html_a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">srsran::lower_phy_baseband_buffer_size_policy::slot</a></div><div class="ttdeci">@ slot</div><div class="ttdoc">The buffer size matches the number of samples per slot.</div></div>
<div class="ttc" id="anamespacesrsran_html_a5a81707cbe1f17f0d69414f9c7acb227"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a5a81707cbe1f17f0d69414f9c7acb227">srsran::l2_tracer</a></div><div class="ttdeci">file_event_tracer&lt; L2_TRACE_ENABLED &gt; l2_tracer</div><div class="ttdoc">L2 event tracing. This tracer is used to analyze latencies in the L2 processing of slot indications.</div><div class="ttdef"><b>Definition</b> du_traces.cpp:27</div></div>
<div class="ttc" id="anamespacesrsran_html_a84c18973244331fd6a0b0e1e553e54a1"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">srsran::l1_tracer</a></div><div class="ttdeci">file_event_tracer&lt; L1_TRACE_ENABLED &gt; l1_tracer</div><div class="ttdoc">L1 event tracing. This tracer is used to analyze latencies in the L1 processing.</div><div class="ttdef"><b>Definition</b> du_traces.cpp:25</div></div>
<div class="ttc" id="astructsrsran_1_1fapi_1_1dl__tti__request__message_html_aebee6045acbc5f6f1c1ba8f45c143303"><div class="ttname"><a href="../../d9/d26/structsrsran_1_1fapi_1_1dl__tti__request__message.html#aebee6045acbc5f6f1c1ba8f45c143303">srsran::fapi::dl_tti_request_message::is_last_message_in_slot</a></div><div class="ttdeci">bool is_last_message_in_slot</div><div class="ttdoc">Vendor specific parameters.</div><div class="ttdef"><b>Definition</b> messages.h:443</div></div>
<div class="ttc" id="astructsrsran_1_1instant__trace__event_html"><div class="ttname"><a href="../../d0/dd4/structsrsran_1_1instant__trace__event.html">srsran::instant_trace_event</a></div><div class="ttdoc">Trace event type with defined name, starting point but no duration.</div><div class="ttdef"><b>Definition</b> event_tracing.h:74</div></div>
<div class="ttc" id="astructsrsran_1_1trace__event_html"><div class="ttname"><a href="../../d7/daa/structsrsran_1_1trace__event.html">srsran::trace_event</a></div><div class="ttdoc">Trace event used for events with defined name, starting point and duration.</div><div class="ttdef"><b>Definition</b> event_tracing.h:54</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbbabd23e0c88bc437f7bbe1f2483372" name="acbbabd23e0c88bc437f7bbe1f2483372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbbabd23e0c88bc437f7bbe1f2483372">&#9670;&#160;</a></span>handle_new_slot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> fapi_to_phy_translator::handle_new_slot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a></td>          <td class="paramname"><span class="paramname"><em>slot</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles a new slot. </p>
<p>Handling a new slot consists of the following steps.</p><ul>
<li>Finish processing the PDUs from a past slot.</li>
<li>Update the current slot value to the new one.</li>
<li>Reset the contents of the uplink PDU repository.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slot</td><td>Identifies the new slot. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This method is thread safe and may be called from different threads. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  637</span>{</div>
<div class="line"><span class="lineno">  638</span>  trace_point tp = <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a>.now();</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>  update_current_slot(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>  <span class="comment">// Update the logger context.</span></div>
<div class="line"><span class="lineno">  643</span>  logger.<a class="code hl_function" href="../../db/d1e/classsrslog_1_1detail_1_1logger__impl.html#a4ebcb18cb0dd7f89ede70804b1d3336b">set_context</a>(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>.sfn(), <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>.slot_index());</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>  <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d7/daa/structsrsran_1_1trace__event.html">trace_event</a>(<span class="stringliteral">&quot;handle_new_slot&quot;</span>, tp);</div>
<div class="line"><span class="lineno">  646</span>}</div>
<div class="ttc" id="aclasssrslog_1_1detail_1_1logger__impl_html_a4ebcb18cb0dd7f89ede70804b1d3336b"><div class="ttname"><a href="../../db/d1e/classsrslog_1_1detail_1_1logger__impl.html#a4ebcb18cb0dd7f89ede70804b1d3336b">srslog::detail::logger_impl::set_context</a></div><div class="ttdeci">void set_context(uint32_t a, uint32_t b)</div><div class="ttdoc">Set the specified context value to all the channels of the logger.</div><div class="ttdef"><b>Definition</b> logger.h:77</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a923923123c04b367cd544f3de1c9e58e" name="a923923123c04b367cd544f3de1c9e58e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923923123c04b367cd544f3de1c9e58e">&#9670;&#160;</a></span>set_slot_error_message_notifier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> srsran::fapi_adaptor::fapi_to_phy_translator::set_slot_error_message_notifier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d63/classsrsran_1_1fapi_1_1slot__error__message__notifier.html">fapi::slot_error_message_notifier</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>fapi_error_notifier</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configures the FAPI slot-based, error-specific notifier to the given one. </p>
<div class="fragment"><div class="line"><span class="lineno">  229</span>  {</div>
<div class="line"><span class="lineno">  230</span>    error_notifier = std::ref(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">fapi_error_notifier</a>);</div>
<div class="line"><span class="lineno">  231</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a93eb39a0b5b3da625d4b9c98d19dbf7c" name="a93eb39a0b5b3da625d4b9c98d19dbf7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93eb39a0b5b3da625d4b9c98d19dbf7c">&#9670;&#160;</a></span>tx_data_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> fapi_to_phy_translator::tx_data_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d5/d5f/structsrsran_1_1fapi_1_1tx__data__request__message.html">fapi::tx_data_request_message</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends a TX data request message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Message contents. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="../../dc/dee/classsrsran_1_1fapi_1_1slot__message__gateway.html#aaa73d2080c75baa3ae8fbeac47524f09">srsran::fapi::slot_message_gateway</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  567</span>{</div>
<div class="line"><span class="lineno">  568</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>  current_slot = get_current_slot();</div>
<div class="line"><span class="lineno">  569</span>  trace_point tp           = <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a>.now();</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>  <span class="comment">// Ignore messages that do not correspond to the current slot.</span></div>
<div class="line"><span class="lineno">  572</span>  <span class="keywordflow">if</span> (!is_message_in_time(msg)) {</div>
<div class="line"><span class="lineno">  573</span>    logger.warning(<span class="stringliteral">&quot;Real-time failure in FAPI: Received TX_Data.request from slot {}.{}&quot;</span>, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  574</span>    <span class="comment">// Raise invalid sfn error.</span></div>
<div class="line"><span class="lineno">  575</span>    error_notifier.get().on_error_indication(fapi::build_invalid_sfn_error_indication(</div>
<div class="line"><span class="lineno">  576</span>        msg.sfn, msg.slot, fapi::message_type_id::tx_data_request, current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a19d7b2faaa1fcc74f3d01560339f7602">sfn</a>(), current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a1808c0aeecc25d6382e49511028c010e">slot_index</a>()));</div>
<div class="line"><span class="lineno">  577</span>    <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a5a81707cbe1f17f0d69414f9c7acb227">l2_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d0/dd4/structsrsran_1_1instant__trace__event.html">instant_trace_event</a>{<span class="stringliteral">&quot;tx_data_req_late&quot;</span>, instant_trace_event::cpu_scope::global};</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    pdsch_repository.clear();</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  582</span>  }</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>  <span class="keywordflow">if</span> (msg.pdus.size() != pdsch_repository.pdus.size()) {</div>
<div class="line"><span class="lineno">  585</span>    logger.warning(<span class="stringliteral">&quot;Invalid TX_Data.request. Message contains &#39;{}&#39; payload PDUs but expected &#39;{}&#39;&quot;</span>,</div>
<div class="line"><span class="lineno">  586</span>                   msg.pdus.size(),</div>
<div class="line"><span class="lineno">  587</span>                   pdsch_repository.pdus.size());</div>
<div class="line"><span class="lineno">  588</span>    <span class="comment">// Raise invalid format error.</span></div>
<div class="line"><span class="lineno">  589</span>    error_notifier.get().on_error_indication(fapi::build_msg_tx_error_indication(msg.sfn, msg.slot));</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>    pdsch_repository.clear();</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  594</span>  }</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  <span class="comment">// Check that the slot of the TX_Data.request matches the slot of the PDSCH PDUs stored.</span></div>
<div class="line"><span class="lineno">  597</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a> <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>(scs, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  598</span>  <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a> != pdsch_repository.slot) {</div>
<div class="line"><span class="lineno">  599</span>    logger.warning(<span class="stringliteral">&quot;Received a TX_Data.request message for slot &#39;{}&#39; that does not match slot &#39;{}&#39; of the previous &quot;</span></div>
<div class="line"><span class="lineno">  600</span>                   <span class="stringliteral">&quot;DL_TTI.request message&quot;</span>,</div>
<div class="line"><span class="lineno">  601</span>                   <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>,</div>
<div class="line"><span class="lineno">  602</span>                   pdsch_repository.slot);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>    pdsch_repository.clear();</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  607</span>  }</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>  <span class="comment">// Skip message if there are no PDSCH PDUs inside the repository. This may be caused by an unsupported PDU in the</span></div>
<div class="line"><span class="lineno">  610</span>  <span class="comment">// DL_TTI.request.</span></div>
<div class="line"><span class="lineno">  611</span>  <span class="keywordflow">if</span> (pdsch_repository.empty()) {</div>
<div class="line"><span class="lineno">  612</span>    <span class="comment">// Raise invalid format error.</span></div>
<div class="line"><span class="lineno">  613</span>    error_notifier.get().on_error_indication(fapi::build_msg_tx_error_indication(msg.sfn, msg.slot));</div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  615</span>  }</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>  slot_based_upper_phy_controller&amp; controller = slot_controller_mngr.get_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  618</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0, e = msg.pdus.size(); i != e; ++i) {</div>
<div class="line"><span class="lineno">  619</span>    <span class="comment">// Get transport block data.</span></div>
<div class="line"><span class="lineno">  620</span>    <a class="code hl_class" href="../../da/daf/classsrsran_1_1static__vector.html">static_vector&lt;span&lt;const uint8_t&gt;</a>, <a class="code hl_variable" href="../../dd/de4/classsrsran_1_1pdsch__processor.html#a6c6105b34bc5b25ffb234eddcbfe3f71">pdsch_processor::MAX_NOF_TRANSPORT_BLOCKS</a>&gt; data;</div>
<div class="line"><span class="lineno">  621</span>    <span class="keyword">const</span> <a class="code hl_struct" href="../../db/d97/structsrsran_1_1fapi_1_1tx__data__req__pdu.html">fapi::tx_data_req_pdu</a>&amp;                                                  pdu = msg.pdus[i];</div>
<div class="line"><span class="lineno">  622</span>    data.emplace_back(pdu.tlv_custom.payload, pdu.tlv_custom.length.<a class="code hl_function" href="../../de/dcf/classsrsran_1_1strong__type.html#a1a71ac48ba41b4a070b32e296c177db0">value</a>());</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    <span class="comment">// Process PDSCH.</span></div>
<div class="line"><span class="lineno">  625</span>    controller-&gt;process_pdsch(data, pdsch_repository.pdus[i]);</div>
<div class="line"><span class="lineno">  626</span>  }</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>  slot_controller_mngr.release_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>  <span class="comment">// All the PDSCH PDUs have been processed. Clear the repository.</span></div>
<div class="line"><span class="lineno">  631</span>  pdsch_repository.clear();</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>  <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d7/daa/structsrsran_1_1trace__event.html">trace_event</a>(<span class="stringliteral">&quot;tx_data_request&quot;</span>, tp);</div>
<div class="line"><span class="lineno">  634</span>}</div>
<div class="ttc" id="aclasssrsran_1_1pdsch__processor_html_a6c6105b34bc5b25ffb234eddcbfe3f71"><div class="ttname"><a href="../../dd/de4/classsrsran_1_1pdsch__processor.html#a6c6105b34bc5b25ffb234eddcbfe3f71">srsran::pdsch_processor::MAX_NOF_TRANSPORT_BLOCKS</a></div><div class="ttdeci">static constexpr unsigned MAX_NOF_TRANSPORT_BLOCKS</div><div class="ttdoc">Defines the maximum number of codewords that can be encoded in a PDSCH transmission.</div><div class="ttdef"><b>Definition</b> pdsch_processor.h:54</div></div>
<div class="ttc" id="aclasssrsran_1_1static__vector_html"><div class="ttname"><a href="../../da/daf/classsrsran_1_1static__vector.html">srsran::static_vector</a></div><div class="ttdef"><b>Definition</b> static_vector.h:187</div></div>
<div class="ttc" id="aclasssrsran_1_1strong__type_html_a1a71ac48ba41b4a070b32e296c177db0"><div class="ttname"><a href="../../de/dcf/classsrsran_1_1strong__type.html#a1a71ac48ba41b4a070b32e296c177db0">srsran::strong_type::value</a></div><div class="ttdeci">constexpr T &amp; value()</div><div class="ttdoc">Accessor for the underlying value of the strong type.</div><div class="ttdef"><b>Definition</b> strong_type.h:115</div></div>
<div class="ttc" id="astructsrsran_1_1fapi_1_1tx__data__req__pdu_html"><div class="ttname"><a href="../../db/d97/structsrsran_1_1fapi_1_1tx__data__req__pdu.html">srsran::fapi::tx_data_req_pdu</a></div><div class="ttdoc">Transmission data request PDU information.</div><div class="ttdef"><b>Definition</b> messages.h:839</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acda731523131cee6da7a8cd2cfbd9d1d" name="acda731523131cee6da7a8cd2cfbd9d1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda731523131cee6da7a8cd2cfbd9d1d">&#9670;&#160;</a></span>ul_dci_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> fapi_to_phy_translator::ul_dci_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d3/da0/structsrsran_1_1fapi_1_1ul__dci__request__message.html">fapi::ul_dci_request_message</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends an uplink DCI request message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Message contents. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="../../dc/dee/classsrsran_1_1fapi_1_1slot__message__gateway.html#af6d3cd7dc099c3a1c7d69322a1355be2">srsran::fapi::slot_message_gateway</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  518</span>{</div>
<div class="line"><span class="lineno">  519</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>  current_slot = get_current_slot();</div>
<div class="line"><span class="lineno">  520</span>  trace_point tp           = <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a>.now();</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// Ignore messages that do not correspond to the current slot.</span></div>
<div class="line"><span class="lineno">  523</span>  <span class="keywordflow">if</span> (!is_message_in_time(msg)) {</div>
<div class="line"><span class="lineno">  524</span>    logger.warning(<span class="stringliteral">&quot;Real-time failure in FAPI: Received UL_DCI.request message from slot {}.{}&quot;</span>, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// Raise invalid sfn error.</span></div>
<div class="line"><span class="lineno">  526</span>    error_notifier.get().on_error_indication(fapi::build_invalid_sfn_error_indication(</div>
<div class="line"><span class="lineno">  527</span>        msg.sfn, msg.slot, fapi::message_type_id::ul_dci_request, current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a19d7b2faaa1fcc74f3d01560339f7602">sfn</a>(), current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a1808c0aeecc25d6382e49511028c010e">slot_index</a>()));</div>
<div class="line"><span class="lineno">  528</span>    <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a5a81707cbe1f17f0d69414f9c7acb227">l2_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d0/dd4/structsrsran_1_1instant__trace__event.html">instant_trace_event</a>{<span class="stringliteral">&quot;ul_dci_req_late&quot;</span>, instant_trace_event::cpu_scope::global};</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  530</span>  }</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>  <a class="code hl_class" href="../../da/daf/classsrsran_1_1static__vector.html">static_vector&lt;pdcch_processor::pdu_t, MAX_PUCCH_PDUS_PER_SLOT&gt;</a> pdus;</div>
<div class="line"><span class="lineno">  533</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pdu : msg.pdus) {</div>
<div class="line"><span class="lineno">  534</span>    <span class="comment">// For each DCI in the PDCCH PDU, create a pdcch_processor::pdu_t.</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci</a> = 0, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci_end</a> = pdu.pdu.dl_dci.size(); <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci</a> != <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci_end</a>; ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci</a>) {</div>
<div class="line"><span class="lineno">  536</span>      <a class="code hl_struct" href="../../dd/d62/structsrsran_1_1pdcch__processor_1_1pdu__t.html">pdcch_processor::pdu_t</a>&amp; pdcch_pdu = pdus.emplace_back();</div>
<div class="line"><span class="lineno">  537</span>      convert_pdcch_fapi_to_phy(pdcch_pdu, pdu.pdu, msg.sfn, msg.slot, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci</a>, *pm_repo);</div>
<div class="line"><span class="lineno">  538</span>      <span class="keywordflow">if</span> (!dl_pdu_validator.<a class="code hl_function" href="../../de/d5a/classsrsran_1_1downlink__pdu__validator.html#aee82394ba846721a7093e2980d565c52">is_valid</a>(pdcch_pdu)) {</div>
<div class="line"><span class="lineno">  539</span>        logger.warning(<span class="stringliteral">&quot;Upper PHY flagged a UL DCI PDU with index &#39;{}&#39; as having an invalid configuration. Skipping &quot;</span></div>
<div class="line"><span class="lineno">  540</span>                       <span class="stringliteral">&quot;UL_DCI.request&quot;</span>,</div>
<div class="line"><span class="lineno">  541</span>                       <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">i_dci</a>);</div>
<div class="line"><span class="lineno">  542</span>        <span class="comment">// Raise invalid format error.</span></div>
<div class="line"><span class="lineno">  543</span>        error_notifier.get().on_error_indication(fapi::build_msg_ul_dci_error_indication(msg.sfn, msg.slot));</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  545</span>      }</div>
<div class="line"><span class="lineno">  546</span>    }</div>
<div class="line"><span class="lineno">  547</span>  }</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>                       <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>(scs, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  550</span>  slot_based_upper_phy_controller&amp; controller = slot_controller_mngr.get_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  551</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pdcch_pdu : pdus) {</div>
<div class="line"><span class="lineno">  552</span>    controller-&gt;<a class="code hl_function" href="../../d8/d5d/classsrsran_1_1downlink__processor.html#a270cb11a434b2f13de896d50e7624840">process_pdcch</a>(pdcch_pdu);</div>
<div class="line"><span class="lineno">  553</span>  }</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>  <span class="comment">// No more data to process, controller can be removed.</span></div>
<div class="line"><span class="lineno">  556</span>  <span class="keywordflow">if</span> (msg.is_last_message_in_slot) {</div>
<div class="line"><span class="lineno">  557</span>    srsran_assert(pdsch_repository.empty(),</div>
<div class="line"><span class="lineno">  558</span>                  <span class="stringliteral">&quot;The UL_DCI.request message in slot &#39;{}&#39; has been marked as the last message in the slot, but a &quot;</span></div>
<div class="line"><span class="lineno">  559</span>                  <span class="stringliteral">&quot;TX_Data.request message is also being expected&quot;</span>,</div>
<div class="line"><span class="lineno">  560</span>                  <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  561</span>    slot_controller_mngr.release_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  562</span>  }</div>
<div class="line"><span class="lineno">  563</span>  <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d7/daa/structsrsran_1_1trace__event.html">trace_event</a>(<span class="stringliteral">&quot;ul_dci_request&quot;</span>, tp);</div>
<div class="line"><span class="lineno">  564</span>}</div>
<div class="ttc" id="aclasssrsran_1_1downlink__pdu__validator_html_aee82394ba846721a7093e2980d565c52"><div class="ttname"><a href="../../de/d5a/classsrsran_1_1downlink__pdu__validator.html#aee82394ba846721a7093e2980d565c52">srsran::downlink_pdu_validator::is_valid</a></div><div class="ttdeci">virtual bool is_valid(const ssb_processor::pdu_t &amp;pdu) const =0</div><div class="ttdoc">Validates SSB processor configuration parameters.</div></div>
<div class="ttc" id="aclasssrsran_1_1downlink__processor_html_a270cb11a434b2f13de896d50e7624840"><div class="ttname"><a href="../../d8/d5d/classsrsran_1_1downlink__processor.html#a270cb11a434b2f13de896d50e7624840">srsran::downlink_processor::process_pdcch</a></div><div class="ttdeci">virtual void process_pdcch(const pdcch_processor::pdu_t &amp;pdu)=0</div><div class="ttdoc">Process the given PDCCH PDU.</div></div>
<div class="ttc" id="astructsrsran_1_1pdcch__processor_1_1pdu__t_html"><div class="ttname"><a href="../../dd/d62/structsrsran_1_1pdcch__processor_1_1pdu__t.html">srsran::pdcch_processor::pdu_t</a></div><div class="ttdoc">Collects the PDCCH parameters for a transmission.</div><div class="ttdef"><b>Definition</b> pdcch_processor.h:131</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adaf761a8eac47d983c64cee5ce5f577e" name="adaf761a8eac47d983c64cee5ce5f577e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaf761a8eac47d983c64cee5ce5f577e">&#9670;&#160;</a></span>ul_tti_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> fapi_to_phy_translator::ul_tti_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../dd/d88/structsrsran_1_1fapi_1_1ul__tti__request__message.html">fapi::ul_tti_request_message</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends an uplink TTI request message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Message contents. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="../../dc/dee/classsrsran_1_1fapi_1_1slot__message__gateway.html#a9709e82f938215b584dce8b63927aa60">srsran::fapi::slot_message_gateway</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  453</span>{</div>
<div class="line"><span class="lineno">  454</span>  <span class="comment">// :TODO: check the messages order. Do this in a different class.</span></div>
<div class="line"><span class="lineno">  455</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>  <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>(scs, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  456</span>  <a class="code hl_class" href="../../df/d3c/classsrsran_1_1slot__point.html">slot_point</a>  current_slot = get_current_slot();</div>
<div class="line"><span class="lineno">  457</span>  trace_point tp           = <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a>.now();</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>  <span class="comment">// Clear the repository for the message slot.</span></div>
<div class="line"><span class="lineno">  460</span>  ul_pdu_repository.<a class="code hl_function" href="../../d1/d10/classsrsran_1_1uplink__slot__pdu__repository.html#a2b5581072bcc21f9c586bee02204b18b">clear_slot</a>(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>);</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">// Release the controller of the previous slot in case that it has not been released before. In case that it already</span></div>
<div class="line"><span class="lineno">  463</span>  <span class="comment">// is released, this call will do nothing.</span></div>
<div class="line"><span class="lineno">  464</span>  slot_controller_mngr.release_controller(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a> - 1);</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>  <span class="comment">// Ignore messages that do not correspond to the current slot.</span></div>
<div class="line"><span class="lineno">  467</span>  <span class="keywordflow">if</span> (!is_message_in_time(msg)) {</div>
<div class="line"><span class="lineno">  468</span>    logger.warning(<span class="stringliteral">&quot;Real-time failure in FAPI: Received late UL_TTI.request from slot {}.{}&quot;</span>, msg.sfn, msg.slot);</div>
<div class="line"><span class="lineno">  469</span>    <span class="comment">// Raise out of sync error.</span></div>
<div class="line"><span class="lineno">  470</span>    error_notifier.get().on_error_indication(fapi::build_out_of_sync_error_indication(</div>
<div class="line"><span class="lineno">  471</span>        msg.sfn, msg.slot, fapi::message_type_id::ul_tti_request, current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a19d7b2faaa1fcc74f3d01560339f7602">sfn</a>(), current_slot.<a class="code hl_function" href="../../df/d3c/classsrsran_1_1slot__point.html#a1808c0aeecc25d6382e49511028c010e">slot_index</a>()));</div>
<div class="line"><span class="lineno">  472</span>    <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a5a81707cbe1f17f0d69414f9c7acb227">l2_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d0/dd4/structsrsran_1_1instant__trace__event.html">instant_trace_event</a>{<span class="stringliteral">&quot;ul_tti_req_late&quot;</span>, instant_trace_event::cpu_scope::global};</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  474</span>  }</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>  <a class="code hl_class" href="../../d5/dea/classsrsran_1_1expected.html">expected&lt;uplink_pdus&gt;</a> pdus = translate_ul_tti_pdus_to_phy_pdus(</div>
<div class="line"><span class="lineno">  477</span>      msg, ul_pdu_validator, prach_cfg, carrier_cfg, prach_ports, logger, *part2_repo, sector_id);</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>  <span class="comment">// Raise invalid format error.</span></div>
<div class="line"><span class="lineno">  480</span>  <span class="keywordflow">if</span> (!pdus.has_value()) {</div>
<div class="line"><span class="lineno">  481</span>    error_notifier.get().on_error_indication(</div>
<div class="line"><span class="lineno">  482</span>        fapi::build_msg_slot_error_indication(msg.sfn, msg.slot, fapi::message_type_id::ul_tti_request));</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  484</span>  }</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>  <span class="comment">// Process the PRACHs</span></div>
<div class="line"><span class="lineno">  487</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; context : pdus.value().prach) {</div>
<div class="line"><span class="lineno">  488</span>    ul_request_processor.<a class="code hl_function" href="../../da/dee/classsrsran_1_1uplink__request__processor.html#a6ae857b252d659eccf67da264ae9a359">process_prach_request</a>(context);</div>
<div class="line"><span class="lineno">  489</span>  }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>  <span class="keywordflow">if</span> (pdus.value().pusch.empty() &amp;&amp; pdus.value().pucch.empty()) {</div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  493</span>  }</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <span class="comment">// Add the PUCCH and PUSCH PDUs to the repository for later processing.</span></div>
<div class="line"><span class="lineno">  496</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pdu : pdus.value().pusch) {</div>
<div class="line"><span class="lineno">  497</span>    ul_pdu_repository.<a class="code hl_function" href="../../d1/d10/classsrsran_1_1uplink__slot__pdu__repository.html#ad7442bb45f461fdf2914cde98a606c31">add_pusch_pdu</a>(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>, pdu);</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pdu : pdus.value().pucch) {</div>
<div class="line"><span class="lineno">  500</span>    ul_pdu_repository.<a class="code hl_function" href="../../d1/d10/classsrsran_1_1uplink__slot__pdu__repository.html#ad445c772fe050f6e3125294af52c621f">add_pucch_pdu</a>(<a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>, pdu);</div>
<div class="line"><span class="lineno">  501</span>  }</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>  <span class="comment">// Notify to capture uplink slot.</span></div>
<div class="line"><span class="lineno">  504</span>  <a class="code hl_struct" href="../../db/d92/structsrsran_1_1resource__grid__context.html">resource_grid_context</a> rg_context;</div>
<div class="line"><span class="lineno">  505</span>  rg_context.<a class="code hl_variable" href="../../db/d92/structsrsran_1_1resource__grid__context.html#a520e03a16004ae2879ddb2f934c6b7d8">slot</a>   = <a class="code hl_enumvalue" href="../../d9/def/namespacesrsran.html#a457973e91fb03d0c262578c3bdf460f0a5e97994ed38a2b2f984f3b2b75012bf8">slot</a>;</div>
<div class="line"><span class="lineno">  506</span>  rg_context.<a class="code hl_variable" href="../../db/d92/structsrsran_1_1resource__grid__context.html#a20129b56ffe7fea937bad03d55a5e838">sector</a> = sector_id;</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>  <span class="comment">// Get ul_resource_grid.</span></div>
<div class="line"><span class="lineno">  509</span>  <a class="code hl_struct" href="../../db/d92/structsrsran_1_1resource__grid__context.html">resource_grid_context</a> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">pool_context</a> = rg_context;</div>
<div class="line"><span class="lineno">  510</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">pool_context</a>.<a class="code hl_variable" href="../../db/d92/structsrsran_1_1resource__grid__context.html#a20129b56ffe7fea937bad03d55a5e838">sector</a>                = 0;</div>
<div class="line"><span class="lineno">  511</span>  <a class="code hl_class" href="../../d8/d92/classsrsran_1_1resource__grid.html">resource_grid</a>&amp; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">ul_rg</a>               = ul_rg_pool.<a class="code hl_function" href="../../de/dab/classsrsran_1_1resource__grid__pool.html#a1e6bb07037155aa557847f14da25605d">get_resource_grid</a>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">pool_context</a>);</div>
<div class="line"><span class="lineno">  512</span>  <span class="comment">// Request to capture uplink slot.</span></div>
<div class="line"><span class="lineno">  513</span>  ul_request_processor.<a class="code hl_function" href="../../da/dee/classsrsran_1_1uplink__request__processor.html#ae363f8e1698e2d521e014e25718c149c">process_uplink_slot_request</a>(rg_context, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">ul_rg</a>);</div>
<div class="line"><span class="lineno">  514</span>  <a class="code hl_variable" href="../../d9/def/namespacesrsran.html#a84c18973244331fd6a0b0e1e553e54a1">l1_tracer</a> &lt;&lt; <a class="code hl_struct" href="../../d7/daa/structsrsran_1_1trace__event.html">trace_event</a>(<span class="stringliteral">&quot;ul_tti_request&quot;</span>, tp);</div>
<div class="line"><span class="lineno">  515</span>}</div>
<div class="ttc" id="aclasssrsran_1_1resource__grid__pool_html_a1e6bb07037155aa557847f14da25605d"><div class="ttname"><a href="../../de/dab/classsrsran_1_1resource__grid__pool.html#a1e6bb07037155aa557847f14da25605d">srsran::resource_grid_pool::get_resource_grid</a></div><div class="ttdeci">virtual resource_grid &amp; get_resource_grid(const resource_grid_context &amp;context)=0</div></div>
<div class="ttc" id="aclasssrsran_1_1resource__grid_html"><div class="ttname"><a href="../../d8/d92/classsrsran_1_1resource__grid.html">srsran::resource_grid</a></div><div class="ttdoc">Describes a resource grid class with writer and reader interfaces.</div><div class="ttdef"><b>Definition</b> resource_grid.h:38</div></div>
<div class="ttc" id="aclasssrsran_1_1uplink__request__processor_html_a6ae857b252d659eccf67da264ae9a359"><div class="ttname"><a href="../../da/dee/classsrsran_1_1uplink__request__processor.html#a6ae857b252d659eccf67da264ae9a359">srsran::uplink_request_processor::process_prach_request</a></div><div class="ttdeci">virtual void process_prach_request(const prach_buffer_context &amp;context)=0</div><div class="ttdoc">Processes the PRACH request using the given configuration and context.</div></div>
<div class="ttc" id="aclasssrsran_1_1uplink__request__processor_html_ae363f8e1698e2d521e014e25718c149c"><div class="ttname"><a href="../../da/dee/classsrsran_1_1uplink__request__processor.html#ae363f8e1698e2d521e014e25718c149c">srsran::uplink_request_processor::process_uplink_slot_request</a></div><div class="ttdeci">virtual void process_uplink_slot_request(const resource_grid_context &amp;context, resource_grid &amp;grid)=0</div><div class="ttdoc">Processes the uplink request using the given context and grid.</div></div>
<div class="ttc" id="aclasssrsran_1_1uplink__slot__pdu__repository_html_a2b5581072bcc21f9c586bee02204b18b"><div class="ttname"><a href="../../d1/d10/classsrsran_1_1uplink__slot__pdu__repository.html#a2b5581072bcc21f9c586bee02204b18b">srsran::uplink_slot_pdu_repository::clear_slot</a></div><div class="ttdeci">void clear_slot(slot_point slot)</div><div class="ttdoc">Clears the given slot of the registry.</div><div class="ttdef"><b>Definition</b> uplink_slot_pdu_repository.h:64</div></div>
<div class="ttc" id="aclasssrsran_1_1uplink__slot__pdu__repository_html_ad445c772fe050f6e3125294af52c621f"><div class="ttname"><a href="../../d1/d10/classsrsran_1_1uplink__slot__pdu__repository.html#ad445c772fe050f6e3125294af52c621f">srsran::uplink_slot_pdu_repository::add_pucch_pdu</a></div><div class="ttdeci">void add_pucch_pdu(slot_point slot, const uplink_processor::pucch_pdu &amp;pdu)</div><div class="ttdoc">Adds the given PUCCH PDU to the repository at the given slot.</div><div class="ttdef"><b>Definition</b> uplink_slot_pdu_repository.h:57</div></div>
<div class="ttc" id="aclasssrsran_1_1uplink__slot__pdu__repository_html_ad7442bb45f461fdf2914cde98a606c31"><div class="ttname"><a href="../../d1/d10/classsrsran_1_1uplink__slot__pdu__repository.html#ad7442bb45f461fdf2914cde98a606c31">srsran::uplink_slot_pdu_repository::add_pusch_pdu</a></div><div class="ttdeci">void add_pusch_pdu(slot_point slot, const uplink_processor::pusch_pdu &amp;pdu)</div><div class="ttdoc">Adds the given PUSCH PDU to the repository at the given slot.</div><div class="ttdef"><b>Definition</b> uplink_slot_pdu_repository.h:50</div></div>
<div class="ttc" id="astructsrsran_1_1resource__grid__context_html"><div class="ttname"><a href="../../db/d92/structsrsran_1_1resource__grid__context.html">srsran::resource_grid_context</a></div><div class="ttdoc">Describes the transmission and reception context.</div><div class="ttdef"><b>Definition</b> resource_grid_context.h:31</div></div>
<div class="ttc" id="astructsrsran_1_1resource__grid__context_html_a20129b56ffe7fea937bad03d55a5e838"><div class="ttname"><a href="../../db/d92/structsrsran_1_1resource__grid__context.html#a20129b56ffe7fea937bad03d55a5e838">srsran::resource_grid_context::sector</a></div><div class="ttdeci">unsigned sector</div><div class="ttdoc">Provides the sector identifier.</div><div class="ttdef"><b>Definition</b> resource_grid_context.h:35</div></div>
<div class="ttc" id="astructsrsran_1_1resource__grid__context_html_a520e03a16004ae2879ddb2f934c6b7d8"><div class="ttname"><a href="../../db/d92/structsrsran_1_1resource__grid__context.html#a520e03a16004ae2879ddb2f934c6b7d8">srsran::resource_grid_context::slot</a></div><div class="ttdeci">slot_point slot</div><div class="ttdoc">Provides the slot context within the system frame.</div><div class="ttdef"><b>Definition</b> resource_grid_context.h:33</div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/fapi_adaptor/phy/<a class="el" href="../../d0/d55/fapi__to__phy__translator_8h_source.html">fapi_to_phy_translator.h</a></li>
<li>lib/fapi_adaptor/phy/<b>fapi_to_phy_translator.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
