<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN Docs: srsRAN Project Multi-Container Solution</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">srsRAN Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">srsRAN Project Multi-Container Solution</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md10"></a> This folder contains a multi-container application, composed of:</p>
<ul>
<li>srsRAN gnb: it will build and launch the gnb.</li>
<li>Open5g core: an open source core to use with srsRAN gnb.</li>
<li>Grafana (+ InfluxDB + srsRAN metrics server): a UI solution to monitor metrics from srsRAN gnb.</li>
</ul>
<p>To launch the full multi-container solution, please run:</p>
<div class="fragment"><div class="line">docker compose -f docker/docker-compose.yml up</div>
</div><!-- fragment --><ul>
<li>To force a new build of the containers (including a new build of srsRAN gnb), please add a <code>--build</code> flag at the end of the previous command.</li>
<li>To run it in background, please add a <code>-d</code> flag at the end of the previous command.</li>
<li>For more options, check <code>docker compose up --help</code></li>
</ul>
<p>To see services' output, you can run:</p>
<div class="fragment"><div class="line">docker compose logs [OPTIONS] [SERVICE...]</div>
</div><!-- fragment --><ul>
<li>For more options, check <code>docker compose logs --help</code></li>
</ul>
<p>To stop it:</p>
<div class="fragment"><div class="line">docker compose -f docker/docker-compose.yml down</div>
</div><!-- fragment --><ul>
<li>If you also want to remove all internal data except the setup, you can add <code>--volumes</code> flag at the end of the previous command.</li>
<li>For more options, check <code>docker compose down --help</code></li>
</ul>
<p>If you're not familiarized with <code>docker compose</code> tool, it will be recommended to check its <a href="https://docs.docker.com/compose/">website</a> and <code>docker compose --help</code> output.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Enabling metrics reporting in the gnb</h1>
<p>To be able to see gnb's metric in the UI solution (grafana + influxdb + metrics-server) it's required to enable metrics reporting in the gnb config. For example:</p>
<div class="fragment"><div class="line">metrics:</div>
<div class="line">  enable_json_metrics: true</div>
<div class="line">  addr: 172.19.1.4  # Metrics-server IP</div>
<div class="line">  port: 55555       # Metrics-server Port</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md12"></a>
Run some services</h1>
<p>Instead of running all services provided, a partial run is allowed by doing:</p>
<div class="fragment"><div class="line">docker compose -f docker/docker-compose.yml up &lt;service_to_run&gt;</div>
</div><!-- fragment --><p>Main options are:</p>
<ul>
<li><code>gnb</code>: It will start the srsRAN Project gNB + Open5G core, without UI stack.</li>
<li><code>grafana</code>: It will start the full Grafana + InfluxDB + metrics-server stack, without srsRAN Project gnb and Open5g services.</li>
</ul>
<p>However, any service declared in the docker-compose.yml can be started standalone, like <code>5gc</code> or <code>influxdb</code>.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Customizations</h1>
<ul>
<li>Default docker compose uses <code>configs/gnb_rf_b200_tdd_n78_20mhz.yml</code> config file. You can change it by setting the variable <code>${GNB_CONFIG_PATH}</code> in the shell, in the <code>docker compose up</code> command line or using the existing env-file <code>.env</code>. More info about how to do it in docker documentation here: <a href="https://docs.docker.com/compose/environment-variables/set-environment-variables/">https://docs.docker.com/compose/environment-variables/set-environment-variables/</a></li>
<li>Network: If you are using an existing core-network on same machine, then you can comment the <code>5gc</code> service section and also link your srsran container to some existing AMF N1/N2 subnet, doing something like this:</li>
</ul>
<div class="fragment"><div class="line">  gnb: ...</div>
<div class="line">    networks:</div>
<div class="line">      network1:</div>
<div class="line">          ipv4_address: 192.168.70.163 # Setting a fixed IP in the &quot;network1&quot; net</div>
<div class="line"> </div>
<div class="line">networks:</div>
<div class="line">  network1:</div>
<div class="line">    name: my-pre-existing-network</div>
<div class="line">    external: true</div>
</div><!-- fragment --><p>More info here: <a href="https://docs.docker.com/compose/networking/">https://docs.docker.com/compose/networking/</a></p>
<h1><a class="anchor" id="autotoc_md14"></a>
Advanced Usage</h1>
<h2><a class="anchor" id="autotoc_md15"></a>
Open5GS Container Parameters</h2>
<p>Advanced parameters for the Open5GS container are stored in <a href="open5gs/open5gs.env">open5gs.env</a> file. You can modify it or use a totally different file by setting <code>OPEN_5GS_ENV_FILE</code> variable like in:</p>
<div class="fragment"><div class="line">OPEN_5GS_ENV_FILE=/my/open5gs.env docker compose -f docker/docker-compose.yml up 5gc</div>
</div><!-- fragment --><p>The following parameters can be set:</p>
<ul>
<li>MONGODB_IP (default: 127.0.0.1): This is the IP of the mongodb to use. 127.0.0.1 is the mongodb that runs inside this container.</li>
<li>SUBSCRIBER_DB (default: "001010123456780,00112233445566778899aabbccddeeff,opc,63bfa50ee6523365ff14c1f45f88737d,8000,10.45.1.2"): This adds subscriber data for a single or multiple users to the Open5GS mongodb. It contains either:<ul>
<li>Comma separated string with information to define a subscriber</li>
<li><code>subscriber_db.csv</code>. This is a csv file that contains entries to add to open5gs mongodb. Each entry will represent a subscriber. It must be stored in <code>srsgnb/docker/open5gs/</code></li>
</ul>
</li>
<li>OPEN5GS_IP: This must be set to the IP of the container (here: 10.53.1.2).</li>
<li>UE_IP_BASE: Defines the IP base used for connected UEs (here: 10.45.0).</li>
<li>DEBUG (default: false): This can be set to true to run Open5GS in debug mode.</li>
</ul>
<p>For more info, please check it's own <a class="el" href="md_docker_2open5gs_2README.html">README.md</a>.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Open5GS Container Applications</h2>
<p>Open5Gs container includes other binaries such as</p>
<ul>
<li>5gc: 5G Core Only</li>
<li>epc: EPC Only</li>
<li>app: Both 5G Core and EPC</li>
</ul>
<p>By default 5gc is launched. If you want to run another binary, remember you can use <code>docker compose run</code> to run any command inside the container. For example:</p>
<div class="fragment"><div class="line">docker compose -f docker/docker-compose.yml run 5gc epc -c open5gs-5gc.yml</div>
</div><!-- fragment --><p>If you need to use custom configuration files, remember you can share folder and files between your local PC (host) and the container:</p>
<div class="fragment"><div class="line">docker compose -f docker/docker-compose.yml run -v /tmp/my-open5gs-5gc.yml:/config/my-open5gs-5gc.yml 5gc epc -c /config/my-open5gs-5gc.yml</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
Metric UI Setup</h2>
<p>Change the environment variables define in <code>.env</code> that are used to setup and deploy the stack</p>
<div class="fragment"><div class="line">├── .env         &lt;---</div>
<div class="line">├── docker-compose.yml</div>
<div class="line">├── Dockerfile</div>
<div class="line">└── ...</div>
</div><!-- fragment --><p>You can access grafana in <a href="http://localhost:3300">http://localhost:3300</a>. By default, you'll be in view mode without needing to log in. If you want to modify anything, you need to log in using following credentials:</p>
<ul>
<li>username: <code>admin</code></li>
<li>password: <code>admin</code></li>
</ul>
<p>After your fist log, it will ask you to change the password for a new one, but it can be skipped.</p>
<p>Provisioned Dashboards are into <code>Home &gt; Dashboards</code>. <b>They don't support variable substitution</b>, so if you change default values in <code>.env</code> file, you'll need to go to <code>grafana/dashboards/</code> and manually search and replace values such as influxdb uid or bucket in every <code>.json</code> file.</p>
<p>For more info about the metrics server, please check it's own <a class="el" href="md_docker_2metrics__server_2README.html">README.md</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
