<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN Docs: srsran::pdsch_encoder_hw_impl Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">srsRAN Docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/def/namespacesrsran.html">srsran</a></li><li class="navelem"><a class="el" href="../../d6/d3c/classsrsran_1_1pdsch__encoder__hw__impl.html">pdsch_encoder_hw_impl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../d4/dcb/classsrsran_1_1pdsch__encoder__hw__impl-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">srsran::pdsch_encoder_hw_impl Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Generic hardware-accelerated implementation of the PDSCH encoder.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d5/d82/pdsch__encoder__hw__impl_8h_source.html">pdsch_encoder_hw_impl.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for srsran::pdsch_encoder_hw_impl:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/dab/classsrsran_1_1pdsch__encoder__hw__impl__inherit__graph.png" border="0" usemap="#asrsran_1_1pdsch__encoder__hw__impl_inherit__map" alt="Inheritance graph"/></div>
<map name="asrsran_1_1pdsch__encoder__hw__impl_inherit__map" id="asrsran_1_1pdsch__encoder__hw__impl_inherit__map">
<area shape="rect" title="Generic hardware&#45;accelerated implementation of the PDSCH encoder." alt="" coords="5,139,203,239"/>
<area shape="rect" href="../../d4/d1e/classsrsran_1_1pdsch__encoder.html" title="PDSCH encoder, as per TS38.212 Section 7.2." alt="" coords="25,5,183,91"/>
<area shape="poly" title=" " alt="" coords="107,104,107,138,101,138,101,104"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for srsran::pdsch_encoder_hw_impl:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/da6/classsrsran_1_1pdsch__encoder__hw__impl__coll__graph.png" border="0" usemap="#asrsran_1_1pdsch__encoder__hw__impl_coll__map" alt="Collaboration graph"/></div>
<map name="asrsran_1_1pdsch__encoder__hw__impl_coll__map" id="asrsran_1_1pdsch__encoder__hw__impl_coll__map">
<area shape="rect" title="Generic hardware&#45;accelerated implementation of the PDSCH encoder." alt="" coords="5,139,203,239"/>
<area shape="rect" href="../../d4/d1e/classsrsran_1_1pdsch__encoder.html" title="PDSCH encoder, as per TS38.212 Section 7.2." alt="" coords="25,5,183,91"/>
<area shape="poly" title=" " alt="" coords="107,104,107,138,101,138,101,104"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html">sch_crc</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">CRC calculators used in shared channels.  <a href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aeef0ad6026726eef581c2da29ae4b078" id="r_aeef0ad6026726eef581c2da29ae4b078"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeef0ad6026726eef581c2da29ae4b078">pdsch_encoder_hw_impl</a> (<a class="el" href="../../d9/db9/classbool.html">bool</a> <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_mode_</a>, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">max_tb_size_</a>, <a class="el" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html">sch_crc</a> &amp;c, std::unique_ptr&lt; <a class="el" href="../../d7/d86/classsrsran_1_1ldpc__segmenter__tx.html">ldpc_segmenter_tx</a> &gt; <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">seg</a>, std::unique_ptr&lt; <a class="el" href="../../d3/d5b/classsrsran_1_1hal_1_1hw__accelerator__pdsch__enc.html">hal::hw_accelerator_pdsch_enc</a> &gt; <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw</a>)</td></tr>
<tr class="memdesc:aeef0ad6026726eef581c2da29ae4b078"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDSCH encoder constructor.  <br /></td></tr>
<tr class="separator:aeef0ad6026726eef581c2da29ae4b078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99f3f8cd895b9de3b4bf65dd809264c5" id="r_a99f3f8cd895b9de3b4bf65dd809264c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99f3f8cd895b9de3b4bf65dd809264c5">encode</a> (<a class="el" href="../../de/d4c/classsrsran_1_1span.html">span</a>&lt; <a class="el" href="../../d4/dff/classuint8__t.html">uint8_t</a> &gt; codeword, <a class="el" href="../../de/d4c/classsrsran_1_1span.html">span</a>&lt; <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d4/dff/classuint8__t.html">uint8_t</a> &gt; transport_block, <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/db7/structsrsran_1_1pdsch__encoder_1_1configuration.html">configuration</a> &amp;config) <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">override</a></td></tr>
<tr class="memdesc:a99f3f8cd895b9de3b4bf65dd809264c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full PDSCH encoding.  <br /></td></tr>
<tr class="separator:a99f3f8cd895b9de3b4bf65dd809264c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsrsran_1_1pdsch__encoder"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classsrsran_1_1pdsch__encoder')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d4/d1e/classsrsran_1_1pdsch__encoder.html">srsran::pdsch_encoder</a></td></tr>
<tr class="memitem:a310e80b778a6743fd25c58293af7177c inherit pub_methods_classsrsran_1_1pdsch__encoder" id="r_a310e80b778a6743fd25c58293af7177c"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">virtual</a>&#160;</td><td class="memItemRight" valign="bottom"><b>~pdsch_encoder</b> ()=<a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">default</a></td></tr>
<tr class="memdesc:a310e80b778a6743fd25c58293af7177c inherit pub_methods_classsrsran_1_1pdsch__encoder"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor. <br /></td></tr>
<tr class="separator:a310e80b778a6743fd25c58293af7177c inherit pub_methods_classsrsran_1_1pdsch__encoder"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generic hardware-accelerated implementation of the PDSCH encoder. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aeef0ad6026726eef581c2da29ae4b078" name="aeef0ad6026726eef581c2da29ae4b078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef0ad6026726eef581c2da29ae4b078">&#9670;&#160;</a></span>pdsch_encoder_hw_impl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">srsran::pdsch_encoder_hw_impl::pdsch_encoder_hw_impl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>cb_mode_</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a></td>          <td class="paramname"><span class="paramname"><em>max_tb_size_</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html">sch_crc</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>c</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="../../d7/d86/classsrsran_1_1ldpc__segmenter__tx.html">ldpc_segmenter_tx</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>seg</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="../../d3/d5b/classsrsran_1_1hal_1_1hw__accelerator__pdsch__enc.html">hal::hw_accelerator_pdsch_enc</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>hw</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>PDSCH encoder constructor. </p>
<p>Sets up the internal components, namely LDPC segmenter, all the CRC calculators and the hardware accelerator.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cb_mode</td><td>Defines if the PDSCH encoder operates in CB mode (true) or TB mode (false). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_cb_size</td><td>Defines the maximum supported TB size in bytes (CB mode will be forced for larger TBs). Only used in TB mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seg</td><td>Unique pointer to an LDPC segmenter. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crcs</td><td>Structure with pointers to three CRC calculator objects, with generator polynomials of type <code>CRC16</code>, <code>CRC24A</code> and <code>CRC24B</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hw</td><td>Unique pointer to a hardware-accelerator. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   67</span>                                                                       :</div>
<div class="line"><span class="lineno">   68</span>    cb_mode(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_mode_</a>),</div>
<div class="line"><span class="lineno">   69</span>    max_tb_size(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">max_tb_size_</a>),</div>
<div class="line"><span class="lineno">   70</span>    crc_set({std::move(c.crc16), std::move(c.crc24A), std::move(c.crc24B)}),</div>
<div class="line"><span class="lineno">   71</span>    segmenter(std::move(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">seg</a>)),</div>
<div class="line"><span class="lineno">   72</span>    encoder(std::move(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw</a>))</div>
<div class="line"><span class="lineno">   73</span>  {</div>
<div class="line"><span class="lineno">   74</span>    srsran_assert(crc_set.<a class="code hl_variable" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#ac93905c18440177988c12a7742d89c13">crc16</a>, <span class="stringliteral">&quot;Invalid CRC16 calculator.&quot;</span>);</div>
<div class="line"><span class="lineno">   75</span>    srsran_assert(crc_set.<a class="code hl_variable" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#a785f813c6dcc4abd5099ab3089d552d5">crc24A</a>, <span class="stringliteral">&quot;Invalid CRC24A calculator.&quot;</span>);</div>
<div class="line"><span class="lineno">   76</span>    srsran_assert(crc_set.<a class="code hl_variable" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#a2416e8bf353dadfc4a8c4b1d3de0b9e8">crc24B</a>, <span class="stringliteral">&quot;Invalid CRC24B calculator.&quot;</span>);</div>
<div class="line"><span class="lineno">   77</span>    srsran_assert(crc_set.<a class="code hl_variable" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#ac93905c18440177988c12a7742d89c13">crc16</a>-&gt;get_generator_poly() == crc_generator_poly::CRC16,</div>
<div class="line"><span class="lineno">   78</span>                  <span class="stringliteral">&quot;Not a CRC generator of type CRC16.&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>    srsran_assert(crc_set.<a class="code hl_variable" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#a785f813c6dcc4abd5099ab3089d552d5">crc24A</a>-&gt;get_generator_poly() == crc_generator_poly::CRC24A,</div>
<div class="line"><span class="lineno">   80</span>                  <span class="stringliteral">&quot;Not a CRC generator of type CRC24A.&quot;</span>);</div>
<div class="line"><span class="lineno">   81</span>    srsran_assert(crc_set.<a class="code hl_variable" href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#a2416e8bf353dadfc4a8c4b1d3de0b9e8">crc24B</a>-&gt;get_generator_poly() == crc_generator_poly::CRC24B,</div>
<div class="line"><span class="lineno">   82</span>                  <span class="stringliteral">&quot;Not a CRC generator of type CRC24B.&quot;</span>);</div>
<div class="line"><span class="lineno">   83</span>    srsran_assert(segmenter, <span class="stringliteral">&quot;Invalid LDPC segmenter factory.&quot;</span>);</div>
<div class="line"><span class="lineno">   84</span>    srsran_assert(encoder, <span class="stringliteral">&quot;Invalid hardware-accelerated PDSCH encoder.&quot;</span>);</div>
<div class="line"><span class="lineno">   85</span>  }</div>
<div class="ttc" id="anamespacesrsran_html_a58e7c9f2c51a9ad6a0899b46d5315723"><div class="ttname"><a href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">srsran::mask_msb_ones</a></div><div class="ttdeci">constexpr Integer mask_msb_ones(size_t N)</div><div class="ttdoc">Returns an unsigned integer with the N most significant bits (MSB) set to one, and the remaining bits...</div><div class="ttdef"><b>Definition</b> bounded_bitset.h:65</div></div>
<div class="ttc" id="astructsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc_html_a2416e8bf353dadfc4a8c4b1d3de0b9e8"><div class="ttname"><a href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#a2416e8bf353dadfc4a8c4b1d3de0b9e8">srsran::pdsch_encoder_hw_impl::sch_crc::crc24B</a></div><div class="ttdeci">std::unique_ptr&lt; crc_calculator &gt; crc24B</div><div class="ttdoc">For segment-specific checksums.</div><div class="ttdef"><b>Definition</b> pdsch_encoder_hw_impl.h:48</div></div>
<div class="ttc" id="astructsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc_html_a785f813c6dcc4abd5099ab3089d552d5"><div class="ttname"><a href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#a785f813c6dcc4abd5099ab3089d552d5">srsran::pdsch_encoder_hw_impl::sch_crc::crc24A</a></div><div class="ttdeci">std::unique_ptr&lt; crc_calculator &gt; crc24A</div><div class="ttdoc">For long TB checksums.</div><div class="ttdef"><b>Definition</b> pdsch_encoder_hw_impl.h:46</div></div>
<div class="ttc" id="astructsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc_html_ac93905c18440177988c12a7742d89c13"><div class="ttname"><a href="../../d2/dd1/structsrsran_1_1pdsch__encoder__hw__impl_1_1sch__crc.html#ac93905c18440177988c12a7742d89c13">srsran::pdsch_encoder_hw_impl::sch_crc::crc16</a></div><div class="ttdeci">std::unique_ptr&lt; crc_calculator &gt; crc16</div><div class="ttdoc">For short TB checksums.</div><div class="ttdef"><b>Definition</b> pdsch_encoder_hw_impl.h:44</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_cgraph.png" border="0" usemap="#ad6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_cgraph" alt=""/></div>
<map name="ad6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_cgraph" id="ad6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_cgraph">
<area shape="rect" title="PDSCH encoder constructor." alt="" coords="5,29,195,84"/>
<area shape="poly" title=" " alt="" coords="63,29,63,19,69,10,82,5,100,3,122,6,134,14,131,18,120,11,100,8,83,10,73,15,68,21,68,29"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_icgraph.png" border="0" usemap="#ad6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_icgraph" alt=""/></div>
<map name="ad6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_icgraph" id="ad6/d3c/classsrsran_1_1pdsch__encoder__hw__impl_aeef0ad6026726eef581c2da29ae4b078_icgraph">
<area shape="rect" title="PDSCH encoder constructor." alt="" coords="5,29,195,84"/>
<area shape="poly" title=" " alt="" coords="131,18,120,11,100,8,83,10,73,15,68,21,68,29,63,29,63,19,69,10,82,5,100,3,122,6,134,14"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a99f3f8cd895b9de3b4bf65dd809264c5" name="a99f3f8cd895b9de3b4bf65dd809264c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99f3f8cd895b9de3b4bf65dd809264c5">&#9670;&#160;</a></span>encode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">void</a> pdsch_encoder_hw_impl::encode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d4c/classsrsran_1_1span.html">span</a>&lt; <a class="el" href="../../d4/dff/classuint8__t.html">uint8_t</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>codeword</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d4c/classsrsran_1_1span.html">span</a>&lt; <a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d4/dff/classuint8__t.html">uint8_t</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>transport_block</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">const</a> <a class="el" href="../../d8/db7/structsrsran_1_1pdsch__encoder_1_1configuration.html">configuration</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cfg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Full PDSCH encoding. </p>
<p>General encoding method that includes the four steps of CRC attachment (see TS38.212 Section 7.2.1), transport block segmentation (see TS38.212 Section 7.2.3), codeblock encoding (see TS38.212 Section 7.2.4) and rate matching (see TS38.212 Section 7.2.5), and codeblock concatenation (see TS38.212 Section 7.2.6) into the PDSCH codeword. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">codeword</td><td>Final PDSCH codeword. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transport_block</td><td>Transport block to be transmitted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cfg</td><td>PDSCH configuration parameters. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="../../d4/d1e/classsrsran_1_1pdsch__encoder.html#a8eb8da18e3dd5568c4db69d2434ce5b1">srsran::pdsch_encoder</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>{</div>
<div class="line"><span class="lineno">   38</span>  <span class="comment">// CB mode will be forced if TB mode is requested for a TB larger than the maximum supported size.</span></div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordflow">if</span> (!cb_mode &amp;&amp; transport_block.<a class="code hl_function" href="../../de/d4c/classsrsran_1_1span.html#a251574a211e02a8fea2684eac784fb73">size_bytes</a>() &gt; max_tb_size) {</div>
<div class="line"><span class="lineno">   40</span>    cb_mode = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   41</span>  }</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <span class="comment">// Set the TB encoding parameters (common to all CBs) as required by the hardware-accelerated PDSCH encoder.</span></div>
<div class="line"><span class="lineno">   44</span>  <a class="code hl_struct" href="../../d3/d1e/structsrsran_1_1hal_1_1hw__pdsch__encoder__configuration.html">hal::hw_pdsch_encoder_configuration</a> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw_cfg</a> = {};</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>  <span class="comment">// Segmentation is only required in CB mode.</span></div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_ops</a> = 1;</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_struct" href="../../d2/d94/structsrsran_1_1segmenter__config.html">segmenter_config</a> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>;</div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>.<a class="code hl_variable" href="../../d2/d94/structsrsran_1_1segmenter__config.html#a07cb0f854c348847ba94e20f2a55063e">base_graph</a>     = config.base_graph;</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>.rv             = config.rv;</div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>.mod            = config.mod;</div>
<div class="line"><span class="lineno">   53</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>.Nref           = config.Nref;</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>.nof_layers     = config.nof_layers;</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>.nof_ch_symbols = config.nof_ch_symbols;</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">if</span> (cb_mode) {</div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// Clear the buffer.</span></div>
<div class="line"><span class="lineno">   59</span>    d_segments.clear();</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    <span class="comment">// Segmentation (it includes CRC attachment for the entire transport block and each individual segment).</span></div>
<div class="line"><span class="lineno">   62</span>    segmenter-&gt;segment(d_segments, transport_block, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>);</div>
<div class="line"><span class="lineno">   63</span>  }</div>
<div class="line"><span class="lineno">   64</span>  set_hw_enc_tb_configuration(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw_cfg</a>, transport_block, d_segments, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segmenter_cfg</a>);</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordflow">if</span> (cb_mode) {</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_ops</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw_cfg</a>.nof_segments;</div>
<div class="line"><span class="lineno">   67</span>  }</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <span class="comment">// Validate that all CBs have been succesfully enqueued and dequeued.</span></div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_enqueued_cb_id</a> = 0, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_dequeued_cb_id</a> = 0, offset = 0;</div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordtype">bool</span>     <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">all_enqueued</a> = <span class="keyword">false</span>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">all_dequeued</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   72</span>  <span class="keywordflow">while</span> (!<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">all_enqueued</a> || !<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">all_dequeued</a>) {</div>
<div class="line"><span class="lineno">   73</span>    <span class="comment">// Enqueue each CB in the TB</span></div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">enqueued</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_enqueued_cb_id</a>; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a> != <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_ops</a>; ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>) {</div>
<div class="line"><span class="lineno">   76</span>      <span class="comment">// Update the pointer to the CB to be currently enqueued.</span></div>
<div class="line"><span class="lineno">   77</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_enqueued_cb_id</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>;</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>      <span class="comment">// Get the data to be encoded.</span></div>
<div class="line"><span class="lineno">   80</span>      <a class="code hl_class" href="../../de/d4c/classsrsran_1_1span.html">span&lt;const uint8_t&gt;</a> data;</div>
<div class="line"><span class="lineno">   81</span>      <span class="keywordflow">if</span> (cb_mode) {</div>
<div class="line"><span class="lineno">   82</span>        <span class="comment">// Retrieve the CB.</span></div>
<div class="line"><span class="lineno">   83</span>        <a class="code hl_class" href="../../dd/d3e/classsrsran_1_1described__segment.html">described_segment</a>&amp; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">descr_seg</a> = d_segments[<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>];</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>        <span class="comment">// Set the encoding parameters of the CB as required by the hardware-accelerated PDSCH encoder.</span></div>
<div class="line"><span class="lineno">   86</span>        set_hw_enc_cb_configuration(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw_cfg</a>, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">descr_seg</a>.get_metadata(), <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>);</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>        <span class="comment">// Retrieve the current CB to be encoded.</span></div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordtype">unsigned</span> segment_length       = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">descr_seg</a>.get_data().size()) - <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw_cfg</a>.nof_filler_bits;</div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segment_length_bytes</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">ceil</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(segment_length) / 8.0));</div>
<div class="line"><span class="lineno">   91</span>        data                          = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">descr_seg</a>.get_data().get_buffer().first(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">segment_length_bytes</a>);</div>
<div class="line"><span class="lineno">   92</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   93</span>        <span class="comment">// Set the encoding parameters of the CB as required by the hardware-accelerated PDSCH encoder.</span></div>
<div class="line"><span class="lineno">   94</span>        set_hw_enc_cb_configuration(<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">hw_cfg</a>, {}, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>        <span class="comment">// Encode the full TB at once.</span></div>
<div class="line"><span class="lineno">   97</span>        data = transport_block;</div>
<div class="line"><span class="lineno">   98</span>      }</div>
<div class="line"><span class="lineno">   99</span>      <span class="comment">// Enqueue the hardware-accelerated PDSCH encoding operation.</span></div>
<div class="line"><span class="lineno">  100</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">enqueued</a> = encoder-&gt;enqueue_operation(data, {}, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>      <span class="comment">// Exit the enqueing loop in case the operation couldn&#39;t be enqueued.</span></div>
<div class="line"><span class="lineno">  103</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">enqueued</a>) {</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  105</span>      }</div>
<div class="line"><span class="lineno">  106</span>    }</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="comment">// The loop is exited when all CBs in the TB have been enqueued, the queue is full or because enqueuing failed for a</span></div>
<div class="line"><span class="lineno">  109</span>    <span class="comment">// given CB.</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">enqueued</a>) {</div>
<div class="line"><span class="lineno">  111</span>      <span class="comment">// Update the enqueuing point to ensure that each CB is only enqueued once.</span></div>
<div class="line"><span class="lineno">  112</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_enqueued_cb_id</a> == <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_ops</a> - 1) {</div>
<div class="line"><span class="lineno">  113</span>        ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_enqueued_cb_id</a>;</div>
<div class="line"><span class="lineno">  114</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">all_enqueued</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  115</span>      }</div>
<div class="line"><span class="lineno">  116</span>    }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="comment">// Reset the dequeuing control variables.</span></div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">num_dequeued</a> = 0;</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordtype">bool</span>     <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a>     = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="comment">// Dequeue each CB in the TB</span></div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_dequeued_cb_id</a>; <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a> != <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_enqueued_cb_id</a>; ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>) {</div>
<div class="line"><span class="lineno">  124</span>      <span class="comment">// Update the pointer to the CB to be currently dequeued.</span></div>
<div class="line"><span class="lineno">  125</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_dequeued_cb_id</a> = <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>;</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>      <span class="comment">// In CB mode, select the correct chunk of the output codeword.</span></div>
<div class="line"><span class="lineno">  128</span>      <span class="keywordtype">unsigned</span>      rm_length = 0;</div>
<div class="line"><span class="lineno">  129</span>      <a class="code hl_class" href="../../de/d4c/classsrsran_1_1span.html">span&lt;uint8_t&gt;</a> codeblock;</div>
<div class="line"><span class="lineno">  130</span>      <span class="keywordflow">if</span> (cb_mode) {</div>
<div class="line"><span class="lineno">  131</span>        rm_length = d_segments[<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>].get_metadata().cb_specific.rm_length;</div>
<div class="line"><span class="lineno">  132</span>        srsran_assert(offset + rm_length &lt;= codeword.<a class="code hl_function" href="../../de/d4c/classsrsran_1_1span.html#ad0e376d95ca916144eac76f27f0654ac">size</a>(), <span class="stringliteral">&quot;Wrong codeword length.&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>        codeblock = <a class="code hl_class" href="../../de/d4c/classsrsran_1_1span.html">span&lt;uint8_t&gt;</a>(codeword).<a class="code hl_function" href="../../de/d4c/classsrsran_1_1span.html#ac5f02596fcb6e8f430a3e11e47a6d7e8">subspan</a>(offset, rm_length);</div>
<div class="line"><span class="lineno">  135</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  136</span>        codeblock = codeword;</div>
<div class="line"><span class="lineno">  137</span>      }</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>      <span class="comment">// Make sure at least one operation is dequeued.</span></div>
<div class="line"><span class="lineno">  140</span>      <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  141</span>      <span class="keywordflow">while</span> (!<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a>) {</div>
<div class="line"><span class="lineno">  142</span>        <span class="comment">// Dequeue the hardware-accelerated PUSCH decoding operation (updates the softbuffer too).</span></div>
<div class="line"><span class="lineno">  143</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a> = encoder-&gt;dequeue_operation(codeblock, codeblock_packed, <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">cb_id</a>);</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a>) {</div>
<div class="line"><span class="lineno">  145</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">num_dequeued</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  146</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  147</span>          }</div>
<div class="line"><span class="lineno">  148</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  149</span>          ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">num_dequeued</a>;</div>
<div class="line"><span class="lineno">  150</span>        }</div>
<div class="line"><span class="lineno">  151</span>      }</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>      <span class="comment">// Exit the dequeueing loop in case no more operations can be dequeued.</span></div>
<div class="line"><span class="lineno">  154</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a>) {</div>
<div class="line"><span class="lineno">  155</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  156</span>      }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>      <span class="comment">// Update the dequeuing offset within the TB.</span></div>
<div class="line"><span class="lineno">  159</span>      offset += rm_length;</div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span>    <span class="comment">// The loop is exited when all enqueued CBs have been dequeued or because dequeuing failed for a given CB.</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">dequeued</a>) {</div>
<div class="line"><span class="lineno">  163</span>      <span class="comment">// Dequeueing of a given CB only has to take place once.</span></div>
<div class="line"><span class="lineno">  164</span>      ++<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_dequeued_cb_id</a>;</div>
<div class="line"><span class="lineno">  165</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">last_dequeued_cb_id</a> == <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">nof_ops</a>) {</div>
<div class="line"><span class="lineno">  166</span>        <a class="code hl_function" href="../../d9/def/namespacesrsran.html#a58e7c9f2c51a9ad6a0899b46d5315723">all_dequeued</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  167</span>      }</div>
<div class="line"><span class="lineno">  168</span>    }</div>
<div class="line"><span class="lineno">  169</span>  }</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="aclasssrsran_1_1described__segment_html"><div class="ttname"><a href="../../dd/d3e/classsrsran_1_1described__segment.html">srsran::described_segment</a></div><div class="ttdoc">Describes an LDPC segment or codeblock.</div><div class="ttdef"><b>Definition</b> codeblock_metadata.h:89</div></div>
<div class="ttc" id="aclasssrsran_1_1span_html"><div class="ttname"><a href="../../de/d4c/classsrsran_1_1span.html">srsran::span</a></div><div class="ttdef"><b>Definition</b> span.h:98</div></div>
<div class="ttc" id="aclasssrsran_1_1span_html_a251574a211e02a8fea2684eac784fb73"><div class="ttname"><a href="../../de/d4c/classsrsran_1_1span.html#a251574a211e02a8fea2684eac784fb73">srsran::span::size_bytes</a></div><div class="ttdeci">constexpr size_type size_bytes() const noexcept</div><div class="ttdoc">Returns the size of the sequence in bytes.</div><div class="ttdef"><b>Definition</b> span.h:171</div></div>
<div class="ttc" id="aclasssrsran_1_1span_html_ac5f02596fcb6e8f430a3e11e47a6d7e8"><div class="ttname"><a href="../../de/d4c/classsrsran_1_1span.html#ac5f02596fcb6e8f430a3e11e47a6d7e8">srsran::span::subspan</a></div><div class="ttdeci">span&lt; element_type &gt; subspan(size_type offset, size_type count) const</div><div class="ttdoc">Obtains a span that is a view over the count elements of this span starting at offset offset.</div><div class="ttdef"><b>Definition</b> span.h:232</div></div>
<div class="ttc" id="aclasssrsran_1_1span_html_ad0e376d95ca916144eac76f27f0654ac"><div class="ttname"><a href="../../de/d4c/classsrsran_1_1span.html#ad0e376d95ca916144eac76f27f0654ac">srsran::span::size</a></div><div class="ttdeci">constexpr size_type size() const noexcept</div><div class="ttdoc">Returns the number of elements in the span.</div><div class="ttdef"><b>Definition</b> span.h:168</div></div>
<div class="ttc" id="astructsrsran_1_1hal_1_1hw__pdsch__encoder__configuration_html"><div class="ttname"><a href="../../d3/d1e/structsrsran_1_1hal_1_1hw__pdsch__encoder__configuration.html">srsran::hal::hw_pdsch_encoder_configuration</a></div><div class="ttdoc">Hardware-accelerated PDSCH encoder configuration parameters.</div><div class="ttdef"><b>Definition</b> hw_accelerator_pdsch_enc.h:37</div></div>
<div class="ttc" id="astructsrsran_1_1segmenter__config_html"><div class="ttname"><a href="../../d2/d94/structsrsran_1_1segmenter__config.html">srsran::segmenter_config</a></div><div class="ttdoc">Gathers all segmentation configuration parameters.</div><div class="ttdef"><b>Definition</b> codeblock_metadata.h:146</div></div>
<div class="ttc" id="astructsrsran_1_1segmenter__config_html_a07cb0f854c348847ba94e20f2a55063e"><div class="ttname"><a href="../../d2/d94/structsrsran_1_1segmenter__config.html#a07cb0f854c348847ba94e20f2a55063e">srsran::segmenter_config::base_graph</a></div><div class="ttdeci">ldpc_base_graph_type base_graph</div><div class="ttdoc">Code base graph.</div><div class="ttdef"><b>Definition</b> codeblock_metadata.h:148</div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/phy/upper/channel_processors/<a class="el" href="../../d5/d82/pdsch__encoder__hw__impl_8h_source.html">pdsch_encoder_hw_impl.h</a></li>
<li>lib/phy/upper/channel_processors/<b>pdsch_encoder_hw_impl.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
